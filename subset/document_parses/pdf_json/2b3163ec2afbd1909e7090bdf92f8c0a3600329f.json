{
    "paper_id": "2b3163ec2afbd1909e7090bdf92f8c0a3600329f",
    "metadata": {
        "title": "Antigenic waves of virus-immune co-evolution",
        "authors": [
            {
                "first": "Jacopo",
                "middle": [],
                "last": "Marchi",
                "suffix": "",
                "affiliation": {
                    "laboratory": "Laboratoire de physique de l'\u00c9cole normale sup\u00e9rieure",
                    "institution": "PSL University",
                    "location": {
                        "addrLine": "Sorbonne Universit\u00e9"
                    }
                },
                "email": ""
            },
            {
                "first": "Michael",
                "middle": [],
                "last": "L\u00e4ssig",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Cologne",
                    "location": {
                        "postCode": "50937",
                        "settlement": "Cologne",
                        "country": "Germany"
                    }
                },
                "email": ""
            },
            {
                "first": "Aleksandra",
                "middle": [
                    "M"
                ],
                "last": "Walczak",
                "suffix": "",
                "affiliation": {
                    "laboratory": "Laboratoire de physique de l'\u00c9cole normale sup\u00e9rieure",
                    "institution": "PSL University",
                    "location": {
                        "addrLine": "Sorbonne Universit\u00e9"
                    }
                },
                "email": ""
            },
            {
                "first": "Thierry",
                "middle": [],
                "last": "Mora",
                "suffix": "",
                "affiliation": {
                    "laboratory": "Laboratoire de physique de l'\u00c9cole normale sup\u00e9rieure",
                    "institution": "PSL University",
                    "location": {
                        "addrLine": "Sorbonne Universit\u00e9"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "The evolution of many microbes and pathogens, including circulating viruses such as seasonal influenza, is driven by immune pressure from the host population. In turn, the immune systems of infected populations get updated, chasing viruses even further away. Quantitatively understanding how these dynamics result in observed patterns of rapid pathogen and immune adaptation is instrumental to epidemiological and evolutionary forecasting. Here we present a mathematical theory of co-evolution between immune systems and viruses in a finite-dimensional antigenic space, which describes the cross-reactivity of viral strains and immune systems primed by previous infections. We show the emergence of an antigenic wave that is pushed forward and canalized by cross-reactivity. We obtain analytical results for shape, speed, and angular diffusion of the wave. In particular, we show that viral-immune co-evolution generates a new emergent timescale, the persistence time of the wave's direction in antigenic space, which can be much longer than the coalescence time of the viral population. We compare these dynamics to the observed antigenic turnover of influenza strains, and we discuss how the dimensionality of antigenic space impacts on the predictability of the evolutionary dynamics. Our results provide a concrete and tractable framework to describe pathogen-host co-evolution.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "The evolution of viral pathogens under the selective pressure of its hosts' immunity is an example of rapid coevolution. Viruses adapt in the usual Darwinian sense by evading immunity through antigenic mutations, while immune repertoires adapt by creating memory against previously encountered strains. Some mechanisms of inhost immune evolution, such as the affinity maturation process, are important for the rational design of vaccines. Examples are the seasonal human influenza virus, where vaccine strain selection can be informed by predicting viral evolution in response to collective immunity [1] , as well as chronic infections such as HIV [2] [3] [4] [5] , where coevolution occurs within each host. Because of the relatively short time scales of selection and strain turnover, these dynamics also provide a laboratory for studying evolution and its link to ecology [6] .",
            "cite_spans": [
                {
                    "start": 600,
                    "end": 603,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 648,
                    "end": 651,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 652,
                    "end": 655,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 656,
                    "end": 659,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 660,
                    "end": 663,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 875,
                    "end": 878,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                }
            ],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "It is useful to think of both viral strains and immune protections as living in a common antigenic space [6] , corresponding to an idealized \"shape space\" of binding motifs between antibodies and their cognate epitopes [7] . While the space of molecular recognition is highdimensional, projections onto a low-dimensional effective shape space have provided useful descriptions of the antigenic evolution. In the example of influenza, neutralization data from hemagglutination-inhibition assays can be projected onto a two-dimensional antigenic space [8] [9] [10] . Mapping historical antigenic evolution in this space suggests a co-evolutionary dynamics pushing the virus away from its past positions, where collective immunity has developed. Importantly, the evolution of influenza involves * Corresponding authors. competitive interactions of antigenically distinct clades in the viral population, generating a \"Red Queen\" dynamics of pathogen evolution [11, 12] . Genomic analysis of influenza data has revealed evolution by clonal interference [13] ; this mode of evolution is well-known from laboratory microbial populations [14] . In addition, the viral population may split into subtypes. Such splitting or \"speciation\" events, which are marked by a decoupling of the corresponding immune interactions, happened in the evolution of influenza B [15] and of noroviruses [16] .",
            "cite_spans": [
                {
                    "start": 105,
                    "end": 108,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 219,
                    "end": 222,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 550,
                    "end": 553,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 554,
                    "end": 557,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 558,
                    "end": 562,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 956,
                    "end": 960,
                    "text": "[11,",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 961,
                    "end": 964,
                    "text": "12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 1048,
                    "end": 1052,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 1130,
                    "end": 1134,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 1351,
                    "end": 1355,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 1375,
                    "end": 1379,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "The joint dynamics of viral strains and the immune systems of the host population can be modeled using agent-based simulations [17, 18] that track individual hosts and strains. Such approaches have been used to study the effect of competition on viral genetic diversity [19] , to study geographical effects [20] , and the effect of vaccination [21] . Alternatively, systems of coupled differential equations known as Susceptible-Infected-Recovered (SIR) models may be adapted to incorporate evolutionary mechanisms of antigenic adaptation [6, 22, 23] . Agent-based simulations in 2 dimensions were used to recapitulate the ballistic evolution characteristic of influenza A [18] , and to predict the occurence of splitting and extinction events [24] . In parallel, theory was developed to study the Red Queen effect [12, 25] , based on the well established theory of the traveling fitness wave [26] [27] [28] . While effectively set in one dimension, this class of models can nonetheless predict extinction and splitting events assuming an infinite antigenic genome [12] .",
            "cite_spans": [
                {
                    "start": 127,
                    "end": 131,
                    "text": "[17,",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 132,
                    "end": 135,
                    "text": "18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 270,
                    "end": 274,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 307,
                    "end": 311,
                    "text": "[20]",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 344,
                    "end": 348,
                    "text": "[21]",
                    "ref_id": "BIBREF20"
                },
                {
                    "start": 539,
                    "end": 542,
                    "text": "[6,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 543,
                    "end": 546,
                    "text": "22,",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 547,
                    "end": 550,
                    "text": "23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 673,
                    "end": 677,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 744,
                    "end": 748,
                    "text": "[24]",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 815,
                    "end": 819,
                    "text": "[12,",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 820,
                    "end": 823,
                    "text": "25]",
                    "ref_id": "BIBREF24"
                },
                {
                    "start": 893,
                    "end": 897,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 898,
                    "end": 902,
                    "text": "[27]",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 903,
                    "end": 907,
                    "text": "[28]",
                    "ref_id": "BIBREF27"
                },
                {
                    "start": 1065,
                    "end": 1069,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "In this work, we propose a co-evolutionary theory in an antigenic interaction space of arbitrary dimension d, which is described by joint non-linear stochastic differential equations coupling the population densities of viruses and of protected hosts. We show that these equations admit a d-dimensional antigenic wave solution, and we study its motion, shape, and stability, using simulations and analytical approximations. Based on these results, we discuss how canalization and predictability of antigenic evolution depend on the dimensionality d.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "Our model describes the joint temporal evolution of populations of viruses and immune protections in some effective antigenic space of dimension d. Both viral strains and immune protections are labeled by their position x = (x 1 , . . . , x d ) (or \"phenotype\") in that common antigenic space (Fig. 1A) . In that space, viruses randomly move as a result of antigenic mutations and proliferate through infections of new hosts. Immune memories are added at the past positions of viruses. Immune memories distributed across the host population provide protection that reduces the effective fitness of the virus. We coarsegrain that description by summarizing the viral population by a density n(x, t) of hosts infected by a particular viral strain x, and immunity by a density h(x, t) of immune memories specific to strain x in the host population.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 293,
                    "end": 302,
                    "text": "(Fig. 1A)",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "A. Coarse-grained model of viral-immune co-evolution"
        },
        {
            "text": "At each infection cycle, each host may infect R 0 unprotected hosts, where R 0 is called the basic reproduction number. However, a randomly picked host is susceptible to strain x with probability (1\u2212c(x, t)) M , where c(x, t) is the coverage of strain x by immune memories of the population, and the number M of immune memories carried by each host. Because of cross-reactivity, which allows immune memories to confer protection against closeby strains, immune coverage is given as a function of the density of immune memories:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. Coarse-grained model of viral-immune co-evolution"
        },
        {
            "text": "where H(x \u2212 x ) = exp(\u2212|x \u2212 x |/r) is a cross-reactivity kernel describing how well memory x protects against strain x, and r is the range of the coverage provided by cross-reactivity. In summary, the effective growth rate, or \"fitness\", of the virus is given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. Coarse-grained model of viral-immune co-evolution"
        },
        {
            "text": "The coupled dynamics of viruses and immune memories is then described by the stochastic differential equations (with time in units of infection cycles throughout):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. Coarse-grained model of viral-immune co-evolution"
        },
        {
            "text": "Here \u03b7 is a Gaussian white noise in time and space, \u03b7(x, t)\u03b7(x , t ) = \u03b4(x \u2212 x )\u03b4(t \u2212 t ), accounting for demographic noise [29] . This stochastic term is crucial, as it will drive the evolution of the wave. The diffusion constant D describes the effect of infinitesimal mutations on the phenotype, D = \u00b5 \u03b4x 2 1 /2, where \u00b5 is the mean number of mutations per cycle, and \u03b4x 2 1 the mean squared effect of each mutation along each antigenic dimension (assuming that mutations do not have a systematic bias, \u03b4x 1 = 0). The continuous-diffusion assumption implied by Eq. 2 is only valid when there are many small mutation effects, \u00b5 1 and \u03b4x r, in constrast with regimes where mutations are rare but have a substantial fitness effect drawn from a distribution [25, 30] . Our choice is simpler in that it describes the mutation process through a single parameter D. Along with the choice of the cross-reactivity kernel H, it also naturally preserves the isotropy of the antigenic space.",
            "cite_spans": [
                {
                    "start": 124,
                    "end": 128,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                },
                {
                    "start": 757,
                    "end": 761,
                    "text": "[25,",
                    "ref_id": "BIBREF24"
                },
                {
                    "start": 762,
                    "end": 765,
                    "text": "30]",
                    "ref_id": "BIBREF29"
                }
            ],
            "ref_spans": [],
            "section": "A. Coarse-grained model of viral-immune co-evolution"
        },
        {
            "text": "The total viral population size, or number of infected hosts, N (t) = dx n(x, t) is subject to fluctuations. At the same time, the host population size N h , remains constant because newly added memories (first term of right-hand side of Eq. 3) overwrite existing ones picked uniformly at random (second term of r.h.s. of Eq. 3). Since each host carries M immune receptors, we have dxh(x, t) = M . If we assume that the system reaches an evolutionary steady state, with stable viral population size N (t) = N , then Eq. 3 can be integrated explicitly:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. Coarse-grained model of viral-immune co-evolution"
        },
        {
            "text": "with \u03c4 = M N h /N . This equation shows how the density of protections reflects the past evolution of the viral population.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. Coarse-grained model of viral-immune co-evolution"
        },
        {
            "text": "We simulated (2)-(3) on a square lattice (Methods) and found a stable wave solution ( Fig. 1B-D) . The wave has a stable population size N , and moves approximately ballistically through antigenic space, pushed from behind by the immune memories left in the trail of past viral strains (Fig. 1B) . These memories exert an immune pressure on the viruses, forming a fitness gradient across the width of the wave (Fig. 1C) , favoring the few strains that are furthest from immune memories, at the edge of the wave.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 86,
                    "end": 96,
                    "text": "Fig. 1B-D)",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 286,
                    "end": 295,
                    "text": "(Fig. 1B)",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 410,
                    "end": 419,
                    "text": "(Fig. 1C)",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "B. Antigenic waves"
        },
        {
            "text": "We assume that the solution of the coupled evolution equations (2)-(3) takes the form of a moving quasispecies in a d-dimensional antigenic space,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B. Antigenic waves"
        },
        {
            "text": "Here, we have written the solution in a co-moving frame, in which a motion with constant speed v takes place in the direction of the coordinate x 1 , and fluctuations in the other dimensions, \u03c1(x 2 , . . . , x d , t), centered around x i = 0 for i > 1, are assumed to be independent. In the next sections, we will analyse solutions of this form.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B. Antigenic waves"
        },
        {
            "text": "First, we will project the d-dimensional antigenic wave onto the one-dimensional fitness space; this projection produces a travelling fitness wave [26-28, 31, 32] that determines the antigenic speed v and the mean pair coalescence time T 2 of the viral genealogy. Second, we will study the shape of the d-dimensional quasispecies and determine the fluctuations in the transverse directions. These fluctuations produce a key result of this paper: immune interactions canalize the evolution of the antigenic wave; this constraint can be quantified by characteristic time scales governing the transverse antigenic fluctuations. Canalization is most pronounced in spaces of low dimensionality d and, as we discuss below, affects the predictability of antigenic evolution.",
            "cite_spans": [
                {
                    "start": 147,
                    "end": 162,
                    "text": "[26-28, 31, 32]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "B. Antigenic waves"
        },
        {
            "text": "Projected onto the fitness axis f = f (x, t), the solution is approximately Gaussian (Fig. 1D) . This representation suggests a strong similarity to the fitness wave solution found in models of rapidly adapting populations with an infinite reservoir of beneficial mutations [26-28, 31, 32] . To make the analogy rigorous, we must assume that the fitness gradient in antigenic space is approximately constant, meaning that fitness isolines are straight and equidistant. Mutations along the gradient direction have a fitness effect that is linear in the displacement, while mutations along perpendicular directions are neutral and can be treated independently. Note that while we will use this projection onto fitness to compute the speed of the antigenic wave, the underlying antigenic wave remains in d dimensions; we will come back to transverse fluctuations in the next sections.",
            "cite_spans": [
                {
                    "start": 274,
                    "end": 289,
                    "text": "[26-28, 31, 32]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 85,
                    "end": 94,
                    "text": "(Fig. 1D)",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "C. Speed of antigenic evolution"
        },
        {
            "text": "There are several models of fitness waves that differ in the assumptions on the statistics of mutational effects. Our assumption of diffusive motion makes our projected dynamics equivalent to that studied in ref. [32] , which itself builds on earlier work [27] . This equivalence results from the two key assumptions of the mutation model in antigenic space: mutations have a small effect, and their distribution is isotropic, meaning that there are as many deleterious as beneficial mutations. In the limit where the wave is small compared to the adaptation time scale, v\u03c4 \u03c3, the wave may be replaced by a Dirac delta function at x = (vt, 0, . . . , 0) in Eq. 4. One can then calculate explicitly the immune density (upstream of the wave) and coverage (downstream of the wave, using Eq. 1):",
            "cite_spans": [
                {
                    "start": 213,
                    "end": 217,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 256,
                    "end": 260,
                    "text": "[27]",
                    "ref_id": "BIBREF26"
                }
            ],
            "ref_spans": [],
            "section": "C. Speed of antigenic evolution"
        },
        {
            "text": "where \u0398(x) = 1 for x \u2265 0 and 0 otherwise. This idealized exponential trail of immune protections h(x, t) corresponds to the blue trace of Fig. 1B , and the coverage or fitness gradient to the isolines of Fig. 1C .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 138,
                    "end": 145,
                    "text": "Fig. 1B",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 204,
                    "end": 211,
                    "text": "Fig. 1C",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "C. Speed of antigenic evolution"
        },
        {
            "text": "In the moving frame of the wave, (u, x 2 , . . . , x d ), with u = x 1 \u2212vt, the local immune protection and viral fitness can be expanded locally for u, x i v\u03c4 (see [25] for a similar treatment in a one-dimensional antigenic space):",
            "cite_spans": [
                {
                    "start": 165,
                    "end": 169,
                    "text": "[25]",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "C. Speed of antigenic evolution"
        },
        {
            "text": "is the average population fitness, and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "C. Speed of antigenic evolution"
        },
        {
            "text": "is the fitness gradient. Rescaling the antigenic variable x 1 as sx 1 , this process is equivalent to the evolution of a population where mutation effects are described by diffusion in fitness space with coefficient Ds 2 . This is precisely the model from which the fitness wave solution of Ref. [27, 32] was described (see Appendix). In the following we will use results from these works to describe the antigenic wave. However, we note that in the usual fitness wave theory, population is kept constant by construction, which implies that fitness is only relevant when compared to the mean of the population. By contrast, in our model population size is itself a dynamical variable, and fitness is defined as an absolute growth rate. In this version of the model, the fitness of the whole viral population undergoes continuous negative drift due to the constant adaptation of immune systems, encoded in the \u2212svt term in Eq. 8. This negative fitness drift has an analogous effect to subtracting the mean fitness in models with constant population size, making the equivalence possible.",
            "cite_spans": [
                {
                    "start": 296,
                    "end": 300,
                    "text": "[27,",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 301,
                    "end": 304,
                    "text": "32]",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [],
            "section": "C. Speed of antigenic evolution"
        },
        {
            "text": "The fitness wave theory allows us to make analytical prediction about the properties of the antigenic wave. Let us start with its population size N , which is regulated by how fast the immune system catches up with the wave. The immune turnover time \u03c4 in Eq. 4 is inversely proportional to N : the larger the population size, the faster immune memories are updated, increasing the immune pressure on current viral strains (lower f 0 ), and thus decreasing N . As the moving wave reaches a stable moving state, its size N becomes stable over time, giving the condition (1/N )dN/dt = f 0 = 0, which in turn constraints the ratio between the wave's size and speed:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "C. Speed of antigenic evolution"
        },
        {
            "text": "But the fitness wave theory predicts that the speed of the wave itself depends on the population size. The larger N , the more outliers at the nose of the fitness wave, and the further out they may jump in antigenic space, establishing fitter ancestors of the future population. This results in a fitness wave whose speed depends only weakly on population size and mutation rate (see [32] and Appendix),",
            "cite_spans": [
                {
                    "start": 384,
                    "end": 388,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [],
            "section": "C. Speed of antigenic evolution"
        },
        {
            "text": "where D F = s 2 D and v F = sv are the diffusivity and wave speed in fitness space, which are related to their counterparts in antigenic space through the scaling factor s. Replacing this scaling into Eq. 11 yields a relation between antigenic speed and population size,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "C. Speed of antigenic evolution"
        },
        {
            "text": "which closes the system of equations: using the definition of s (Eq. 9), Eqs. 10 and 12 completely determine N and v as a function of the model's parameters (through a transcendental equation, see Appendix). We validated these theoretical predictions for N and v by comparing them to numerical simulations, which show good agreement over a wide range of parameters ( Fig. 2A-B ). We note that the alternative fitness wave model of Desai and Fisher [28] predicts different scaling relations between speed and population size, including for an arbitrary distribution of fitness effects [30] . The major difference with our description is that we assume infinitesimal and reversible fitness effects. Relaxing that assumption to account for rare but strong mutational effects would affect Eq. 12, but the dependence on N would still be logarithmic at most.",
            "cite_spans": [
                {
                    "start": 448,
                    "end": 452,
                    "text": "[28]",
                    "ref_id": "BIBREF27"
                },
                {
                    "start": 584,
                    "end": 588,
                    "text": "[30]",
                    "ref_id": "BIBREF29"
                }
            ],
            "ref_spans": [
                {
                    "start": 367,
                    "end": 376,
                    "text": "Fig. 2A-B",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "C. Speed of antigenic evolution"
        },
        {
            "text": "The width \u03c3 of the wave in the direction of motion is given by Fisher's theorem, which relates the rate of change of the average fitness to its variance in the population: \u2202 t f = Var(f ). In our description fitness and the antigenic dimension x 1 are linearly related with coefficient s, implying s 2 \u03c3 2 = sv. The result of that prediction for \u03c3 is validated against numerical simulations in Fig. 2C .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 394,
                    "end": 401,
                    "text": "Fig. 2C",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "D. Shape of the antigenic wave"
        },
        {
            "text": "The wave is led by an antigenic 'nose' formed by few outlying strains of reduced cross-reactivity with the concurrent immune population, generating high fitness. These strains have phenotype u c = s\u03c3 4 /4D = v 2 /(4Ds) and fitness su c . They serve as founder strains from which the bulk of the future population will derive some time \u223c u c /v = \u03c3 2 /4D later (see Appendix). As a result, two strains taken at random can trace back their most recent common ancestor to some average time T 2 = \u03b1\u03c3 2 /2D in the past, where \u03b1 \u2248 1.66 is a numerical factor estimated from simulations [32] .",
            "cite_spans": [
                {
                    "start": 579,
                    "end": 583,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [],
            "section": "D. Shape of the antigenic wave"
        },
        {
            "text": "To explain the width \u03c3 \u22a5 of the wave in the other phenotypic dimensions than that of motion (x i>1 ), we note that in these directions evolution is neutral. Two strains taken at random in the bulk are expected to have drifted, or 'diffused' in physical language, by an average squared displacement \u2206x 2 i = 2DT 2 from their common ancestor, so that their mean squared distance is 4D T 2 = 2\u03b1\u03c3 2 along x i . If one assumes an approximately Gaussian wave of width \u03c3 \u22a5 , the mean square distance between two random strains along x i should be equal to 2\u03c3 2 \u22a5 . Equating the two estimates yields \u03c3 2 \u22a5 = \u03b1\u03c3 2 . Fig. 2D checks the validity of this prediction against simulations.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 607,
                    "end": 614,
                    "text": "Fig. 2D",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "D. Shape of the antigenic wave"
        },
        {
            "text": "Both longitudinal and transversal fluctuations in antigenic space are instances of quantitative traits under interference selection generated by multiple small-effect mutations. The width of these traits is governed by the common relation \u2206x 2 i = 2D T 2 \u223c \u03c3 2 , which expresses the effective neutrality of the underlying genetic mutations [33] . This relation says that antigenic variations in all dimensions scale in the same way with the model parameters, and the wave should have an approximately spherical shape. Consistently, here we find a wave with a fixed ratio \u03b1 \u2248 1.66 between transverse and longitudinal variations. This implies a slightly asymmetric shape (which may be non-universal and depend on the microscopic assumptions of our mutation model).",
            "cite_spans": [
                {
                    "start": 340,
                    "end": 344,
                    "text": "[33]",
                    "ref_id": "BIBREF32"
                }
            ],
            "ref_spans": [],
            "section": "D. Shape of the antigenic wave"
        },
        {
            "text": "In what parameter regime is our theory valid? The fitness wave theory we built upon is meant to be valid in the large population size, N 1. In addition, we assumed that the fitness landscape was locally linear across the wave. This approximation should be valid all the way up to the tip of wave, given by u c , since this is where the selection of future founder strains happen. This condition translates into u c r, implying D r 2 / ln(N ) 2 (using u c = v 2 /(4Ds) and Eqs. 9,12), where D is in antigenic unit squared per infection cycle. This result means that one infection cycle will not produce enough mutations for the virus to leave the cross-reactivity range. In that limit, another assumption is automatically fulfilled, namely that the width of the wave be small compared to the span of immune memory: \u03c3 v\u03c4 . Our simulations, which run in the regime of very slow effective diffusion (D/r 2 10 \u22126 ) and have relatively large population sizes (N 10 4 ), satisfy these conditions. This explains the good agreement between analytics and numerics.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "D. Shape of the antigenic wave"
        },
        {
            "text": "The wave solution allows for a simplified picture. The wave travels in the direction of the fitness gradient (or equivalent the gradient of immune coverage) with speed v (Fig. 3A) . Occasionally the population splits into two separate waves that then travel away from each other and from their common ancestor (Fig. 3B) . The tip of the wave's nose, which contains the high-fitness individual that will seed the future population, determines its future position in antigenic space. In the directions perpendicular to the fitness gradient, this position diffuses neutrally with coefficient D. This motivates us to write effective equations of motion for the mean position of the wave:",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 170,
                    "end": 179,
                    "text": "(Fig. 3A)",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 310,
                    "end": 319,
                    "text": "(Fig. 3B)",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "E. Equations of motion of the wave's position"
        },
        {
            "text": "where \u03be and \u03be \u22a5 are Gaussian white noises in the directions along, and perpendicular to, the fitness gradient",
            "cite_spans": [],
            "ref_spans": [],
            "section": "E. Equations of motion of the wave's position"
        },
        {
            "text": "D is an effective diffusivity in the direction of motion resulting from the fluctuations at the nose tip. These fluctuations are different than suggested by D, as they involve feedback mechanisms between the wave's speed v, size N , and advancement of the fitness nose u c . In the following, we do not consider these fluctuations, and focus on perpendicular fluctuations instead.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "E. Equations of motion of the wave's position"
        },
        {
            "text": "F. Angular diffusion and persistence of the antigenic wave",
            "cite_spans": [],
            "ref_spans": [],
            "section": "E. Equations of motion of the wave's position"
        },
        {
            "text": "In the description of Eqs. 13-14, the viral wave is pushed by immune protections left in its trail. The fitness gradient, and thus the direction of motion, points in the direction that is set by the wave's own path. This creates an inertial effect that stabilizes forward motion. On the other hand, fluctuations in perpendicular directions are expected to deviate the course of that motion, contributing to effective angular diffusion. To study this behaviour, we assume that motion is approximately straight in direction x 1 = vt, and study small fluctuations in the perpendicular directions, x \u22a5 = (x 2 , . . . , x d ), with |x \u22a5 | r (as illustrated in Fig. 3C ). Eqs (13)-(14) simplify to (see Appendix):",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 655,
                    "end": 662,
                    "text": "Fig. 3C",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "E. Equations of motion of the wave's position"
        },
        {
            "text": "is an effective memory timescale combining the host's actual immune memory, and the cross-reactivity with strains encountered in the past.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "E. Equations of motion of the wave's position"
        },
        {
            "text": "Eq. 15 may be solved in Fourier space. Defining",
            "cite_spans": [],
            "ref_spans": [],
            "section": "E. Equations of motion of the wave's position"
        },
        {
            "text": "To understand the behaviour at long times T , we expand at small \u03c9: \u2212\u03c9 2 x \u22a5 (\u03c9) \u2248 \u221a 8D\u03be \u22a5 (\u03c9)/T or equivalently in the temporal domain \u2202 2 t x \u22a5 \u2248 \u221a 8D\u03be \u22a5 (t)/T . This implies that the direction of motion,\u00ea \u223c \u2202 x f /|\u2202 x f | \u223c \u2202 t x/|\u2202 t x|, undergoes effective angular diffusion in the long run: \u2202 t\u00ea = \u221a 8D\u03be \u22a5 (t)/(vT ). The persistence time of that inertial motion,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "E. Equations of motion of the wave's position"
        },
        {
            "text": "does not depend explicitly on speed, population size, or the dimension of antigenic space. However, a larger diffusivity implies larger N and v while reducing the persistence time. Likewise, a larger reproduction number R 0 or smaller memory capacity M speeds up the wave and increases its size, but also reduces its persistence time. This implies that, for a fixed number of hosts N h , larger epidemic waves not only move faster across antigenic space, but also change course faster. This persistence time scales as the time it would take a single virus drifting neutrally to escape the crossreactivity range, r 2 /D. For comparison, the much shorter timescale for a population of viruses to escape from the cross-reactivity range r,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "E. Equations of motion of the wave's position"
        },
        {
            "text": "scales with the inverse incidence rate N h /N . This is consistent with the whole population having been infected at least one every \u223c N h /N infection cycles. This separation of time scales is consistent with the observation that evolution in the transverse directions is driven by neutral drift, which is much slower than adaptive evolution in the longitudinal direction. Both t persist and t escape are longer than the coalescence time of the viral population, u c /v \u223c \u03c3 2 /4D, since they reflect long-term memory from the immune system. However, while t escape \u223c N h /N is related to the re-infection period and is thus bounded by the hosts' immune memory (itself bounded by their lifetime, which we do not consider), t persist can be longer than that. This is possible thanks to inertial effects, which are allowed by the high-order dynamics of Eq. 15 generated by the immune system. This very much like when, in mechanics, a massive object set in motion in a given direction will keep that direction without the need for an external force to maintain it. The high-frequency behaviour of (16) has a logarithmic divergence, meaning that the total power of\u00ea is infinite unless we impose a (ultraviolet) cutoff. Such a regularization emerges from the fine structure of the wave. While the motion of the wave is driven by its nose tip, the immune pressure only extends back to the recent past of the bulk of the distribution, which stands at a distance u c away from the nose. In other words, there is a lag (and thus an gap u c in antigenic space) between the most innovative variants that drive viral evolution, and the majority of currently circulating variants which drive host immunity. Mathematically, this implies that the domain of integration of the first term in the right-hand side of (15) should start at t c = u c /v, which regularizes the divergence. A more careful analysis provided in the Appendix shows that this regularization does not affect the long-term diffusive behaviour of the wave.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "E. Equations of motion of the wave's position"
        },
        {
            "text": "We now examine how deflections of the wave in the transverse direction determines the predictability and stability of the viral quasi-species. Assuming t T , angular diffusion causes motion to be deflected as (see Appendix)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "G. Canalization, speciations, and predictability of antigenic evolution"
        },
        {
            "text": "Crucially, this deflection depends on the dimension of the antigenic space, because the displacement acts additively in each of the transversal coordinates. Higher dimension means more deviation from the predictable course of the wave, and thus less predictability. We can define a predictability time scale",
            "cite_spans": [],
            "ref_spans": [],
            "section": "G. Canalization, speciations, and predictability of antigenic evolution"
        },
        {
            "text": "which is the time it takes for prediction errors to become of the order of the cross-reactivity range. In low dimensions, this time scales as a weighted geometric mean between t escape \u223c T and t persist \u223c r 2 /D. However, at high dimensions t predict may be significantly reduced, causing loss of predictability even below t escape . The prediction timescale is distinct from the previously discussed persistence time: t predict involves the integrated displacement in the transversal direction, while t persist quantifies the diffusion of the tangent velocity vector. Thus, t predict may be interpreted as quantifying the predictability of the actual location of the next viral population in antigenic space, while t persist gives the predictability of the general direction of evolution, which changes more slowly. Therefore, the persistence time is both harder to extract from data and less relevant for actionable predictions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "G. Canalization, speciations, and predictability of antigenic evolution"
        },
        {
            "text": "To get a sense of numbers, we can compare our results with epidemiological data, taking the evolution of influenza as an example, with an infection cycle time of 3 days. It is assumed that individuals lose immunity to the circulating strain of the flu within \u223c 5 years \u223c 500 cycles, meaning that the wave would travel a distance r in t = 500, i.e. v/r \u223c 2 \u00b7 10 \u22123 . For instance, with N h = 10 9 -10 10 , R 0 = 2, and M = 1, we may choose D/r 2 = 3\u00b710 \u22126 to get a speed of the same order, v/r \u223c 1.3 \u00b7 10 \u22123 , and t persist \u223c 2\u00b710 4 \u223c 200 years. By contrast, the predictability timescale t predict is much shorter and depends on dimension, albeit slowly, ranging from \u223c 20 years for d = 2 to about 2 years for d = 1000. We stress that these numbers are obtained by scaling laws, and should not be taken as precise quantitative predictions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "G. Canalization, speciations, and predictability of antigenic evolution"
        },
        {
            "text": "Large deflections may also cause speciations, or splits, which occur when two substrains co-exist long enough to become independent from the immune standpoint. This happens when two sub-lineages see the difference of their transverse positions \u2206x \u22a5 become larger than \u2206x 0 \u223c r, within some limited period given by the coalescence time. We estimated the rate of such splitting events using a saddle-point approximation (see Appendix): (20) with \u03b1 some numerical factor. Simulations confirmed the validity of this scaling (Fig. 4a) .",
            "cite_spans": [
                {
                    "start": 434,
                    "end": 438,
                    "text": "(20)",
                    "ref_id": "BIBREF19"
                }
            ],
            "ref_spans": [
                {
                    "start": 520,
                    "end": 529,
                    "text": "(Fig. 4a)",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "G. Canalization, speciations, and predictability of antigenic evolution"
        },
        {
            "text": "The splitting rate grows with the dimension (Fig. 4b) , consistent with the intuition that departure from canalized evolution is easier when more directions of escape are available. Splitting events are expected to strongly affect our ability to predict the future course of the wave. However, the rarity of such events (exponential scaling of k split ) means that they will have a lower impact on predictability than deflections. These results provide a theoretical and quantitative basis from which to assess the effect of dimension on predictability, and possibly estimate d from antigenic time course data of real viral populations.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 44,
                    "end": 53,
                    "text": "(Fig. 4b)",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "G. Canalization, speciations, and predictability of antigenic evolution"
        },
        {
            "text": "In this work, we have developed an analytical theory for studying antigenic waves of viral evolution in response to immune pressure. We showed that predictabilty is limited by two features of antigenic evolution, transversal diffusion and lineage speciations of the antigenic wave, both of which explicitly depend on the dimensionality of antigenic space.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. DISCUSSION"
        },
        {
            "text": "To derive these results, we explicitly embedded the antigenic phenotype in a d-dimensional Euclidean space. This description is different from previous work that considered one- [25] or infinite-dimensional antigenic spaces [12] . It allows for the possibility of compensatory mutations, and makes it easier to compare results with empirical studies of viral evolution projected onto lowdimensional spaces [8, 9] . Unlike these studies, however, our work does not address the question how an effective dimension of antigenic space arises from the molecular architecture of immune interactions. Rather, we focused on the implications of the dimensionality of antigenic space for phenotypic evolution and its predictability.",
            "cite_spans": [
                {
                    "start": 178,
                    "end": 182,
                    "text": "[25]",
                    "ref_id": "BIBREF24"
                },
                {
                    "start": 224,
                    "end": 228,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 406,
                    "end": 409,
                    "text": "[8,",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 410,
                    "end": 412,
                    "text": "9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "III. DISCUSSION"
        },
        {
            "text": "Our results suggest a hierarchy of time scales for viral evolution. The shortest is the coalescence time T 2 , which determines population turnover. Then comes t escape , which is the time it takes the viral population to escape immunity elicited at a previous time point. The longest timescale is the persistence time t persist , which governs the angular diffusion of the wave's direction, but has no bearing on the prediction of the actual position of the dominant strain in antigenic space. That time scale is due to inertial effects. It does not rely directly on the hosts' immune memories, and may thus exceed their individual lifetimes. Finally, the prediction timescale t predict , beyond which prediction accuracy falls below the resolution of cross-reactivity, scales between t escape and t persist at low dimensions. This time scales measures the predictability of transversal fluctuations, and is thus the most relevant for actual predictions of future dominant strains in antigenic space. Importantly, it decreases with the dimension of the antigenic space, and may become arbitrarily low at very high dimensions. The fact that the evolution of influenza strains are hard to predict beyond a year suggests that the effective dimension may indeed be large.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. DISCUSSION"
        },
        {
            "text": "Our solution builds on the fitness wave solution for a diffusion model of mutation effects [27, 32] . It implies a particular dependence of the wave's speed on the population size, Eq. 12. General distribution of noninfinitesimal mutational effects, such as considered in [30] , would yield different expressions for the speed. However, we expect most of our other results to hold-in particular, all expression that do not carry an explicit logarithmic dependence on N , as well the effective equations of motion for the wave. Our results strongly rely on the assumption of a homogeneous, isotropic antigenic space. We expect our results to be affected by anisotropies (e.g. in the mutational or the cross-reactivity Kernels), or by structure in the intrinsic fitness landscape (i.e. not linked to immunity). Such structure may funnel the wave in preferred directions, hinder it, or favor its splitting. Generally, the local geometry and metric of the space is expected to determine the evolutionary behaviour. For instance, Yan et al. [12] assumed a Hamming distance metric in an effectively infinite antigenic space, meaning that any mutation is both an escape mutation and a candidate for a lineage split. By contrast, in our geometry, escape happens only in the direction of the wave, while splits originate from mutations perpendicular to that direction, due to the choice of a Euclidean metric. While our results emphasize the role of the effective dimension d, studying other geometrical effects is an interesting topic for future work.",
            "cite_spans": [
                {
                    "start": 91,
                    "end": 95,
                    "text": "[27,",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 96,
                    "end": 99,
                    "text": "32]",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 272,
                    "end": 276,
                    "text": "[30]",
                    "ref_id": "BIBREF29"
                },
                {
                    "start": 1036,
                    "end": 1040,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [],
            "section": "III. DISCUSSION"
        },
        {
            "text": "Despite these caveats, it is interesting to ask whether the effective antigenic dimension d can be extracted from data. A possible scheme for doing so starts by inferring the effective model parameters. R 0 may be estimated from exponential epidemic growth in a susceptible population. Dependence of key quantities on M such as s is weak. M may be assumed to be of the order of the number of antigenically distinct infections encountered during a host's lifetime, \u223c 4-6 (every 15 years). D/r 2 may be inferred from v/r, which can be estimated from cross-immunity assays or from the incidence rate N/N h . Alternatively, since D/r 2 is the inverse time it takes for mutations to neutrally evade immunity, it could be estimated directly from genomic data by computing the time for unselected mutations (whose rate is inferred from synonymous mutations) to affect antigenic sites. Interestingly, if v/r and D/r 2 can be inferred independently, predictions about the wave's shape, width, angular diffusion and splitting do not depend on the particular choice of fitness wave theory. Assuming that all these parameters are known, the splitting rate, which depends sensitively on d (Fig. 4b) , could be used to infer an effective dimension. Since splitting is rare and may not be observed in practice, one could define instead partial splits, where a sublineage diverges an antigenic distance \u2206x 0 < r from the main lineage, for which the same scaling as Eq. 20 holds (see Appendix). Alternatively, our results could be used to check the consistency of dimensionality-reduction schemes based on serological assays [8] [9] [10] , by testing our predicted relations between the speed of the wave, its width and length, and angular diffusion properties, and ask what choice of dimension best agrees with our theory.",
            "cite_spans": [
                {
                    "start": 1608,
                    "end": 1611,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 1612,
                    "end": 1615,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 1616,
                    "end": 1620,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                }
            ],
            "ref_spans": [
                {
                    "start": 1176,
                    "end": 1185,
                    "text": "(Fig. 4b)",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "III. DISCUSSION"
        },
        {
            "text": "Our framework should be applicable to general hostpathogens systems. For instance, co-evolution between viral phages and bacteria protected by the CRISPR-Cas system [34] is governed by the same principles of escape and adaptation as vertebrate immunity. Even more generally, our theory (Eqs. 2,3) may be relevant to the coupled dynamics of predators and preys interacting in space (geographical or phenotypic), opening potential avenues for experimental tests of these theories in synthetic microbial systems. Given the current context of the global SARS-CoV-2 pandemic, it is natural to ask whether our results could be applicable to predict its evolution. While our theory describes the long-term co-evolution of viral strains with the hosts' immune systems, in which most hosts have been exposed to at least on strain of the virus, SARS-CoV-2 is still in a phase of growth, and has not exhausted the reservoir of susceptible hosts. As the situation develops, it will be interesting to see whether its future evolution follows a Red Queen type of evolution like influenza, goes extinct, or splits into many antigenically independent sublineages. While our model may shed light on these questions, fine microscopic details such as geographical and population structure impose additional challenges for predictions.",
            "cite_spans": [
                {
                    "start": 165,
                    "end": 169,
                    "text": "[34]",
                    "ref_id": "BIBREF33"
                }
            ],
            "ref_spans": [],
            "section": "III. DISCUSSION"
        },
        {
            "text": "We simulated discrete population dynamics of infected hosts n(x, t)) and immune protections n h (x, t) \u2261 N h h(x, t) (all integers) on a 2D square lattice with lattice size \u2206x ranging from 10 \u22125 r to 0.1r. Each time step corresponds to a single infection cycle, \u2206t = 1. At each time step: (1) viral fitness f is computed at each occupied lattice site from the immune coverage Eq. 1; (2) viruses at each occupied lattice site are grown according to their fitness, n(x, t + 1) \u223c Poisson[(1 + f \u2206t)n(x, t)];",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "(3) viruses are mutated by jumping to nearby sites on the lattice; (4) the immune system is updated according to a discrete version of Eq. 3, by implementing n h (x, t + 1) = n h (x, t) + n(x, t) and then removing N (t) protections at random (so that N h remains constant).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "To implement (1), we used a combination of exact computation of Eq. 1 and approximate methods, including one based on non-homogeneous fast Fourier transforms [35, 36] . Details are given in the Appendix.",
            "cite_spans": [
                {
                    "start": 158,
                    "end": 162,
                    "text": "[35,",
                    "ref_id": "BIBREF34"
                },
                {
                    "start": 163,
                    "end": 166,
                    "text": "36]",
                    "ref_id": "BIBREF35"
                }
            ],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "To implement (3), we drew the number of mutants at each occupied site from a binomial distribution Binomial(n(x, t), 1 \u2212 e \u2212\u00b5\u2206t ). The number of new mutations m affecting each of these mutants is drawn from a Poisson distribution of mean \u00b5\u2206t conditioned on having at least 1 mutation. The new location of each mutant is drawn as x + \u03b4x, with \u03b4x = round( m i=1 i ) (rounding is applied to each dimension), where i is a vector of random orientation and modulus drawn from a Gamma distribution of mean \u03b4 \u223c 2\u2206x and shape parameter 20. This distribution was chosen so as to maximize the number of non-zero jumps while maintaining isotropy. We then define D = \u00b5 \u03b4x 2 1 /2. To find the wave solution more rapidly, the viral population was initialized as a Gaussian distribution centered at (0, 0) with size N and width \u03c3 in all dimensions, to which 0.1% additional viruses are randomly added within the interval (0; u c ) along x 1 (N , \u03c3, and u c being all given by the theory prediction). Immune protections are placed according to Eq. 6. The first 20,000 time steps serve to reach steady state and are discarded from the analysis. When a population extinction (N = 0) or explosion (N = N h /2) occurs, the simulation is resumed at an earlier checkpoint to avoid re-equilibrating. Simulations are ended after 5\u00b710 6 steps or after 20 consecutive extinctions or explosions from the same checkpoint.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "In order to analyze the organization of viruses in phenotypic space, we save snapshots of the simulation at regular time intervals. For each saved snapshot we take all the coordinates with n > 0 and then cluster them into separate lineages through the python scikit-learn DB-SCAN algorithm [37] [38] with the minimal number of samples min samples = 10. The parameter defines the maximum distance between two samples that are considered to be in the neighborhood of each other. We perform the clustering for different values of and select the value that minimizes the variance of the 10th nearest neighbor distance. Clustering results are not sensitive to this choice. This preliminary clustering step is refined by merging clusters if their centroids are closer than the sum of the maximum distances of all the points in each cluster from the corresponding centroid.",
            "cite_spans": [
                {
                    "start": 290,
                    "end": 294,
                    "text": "[37]",
                    "ref_id": "BIBREF36"
                },
                {
                    "start": 295,
                    "end": 299,
                    "text": "[38]",
                    "ref_id": "BIBREF37"
                }
            ],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "From the clustered lineages we can easily obtain a series of related observables, such as its speed v obtained as the derivative of the center's position. The width of the lineage profile in the direction of motion \u03c3 as well as in the perpendicular direction \u03c3 \u22a5 are obtained by taking the standard deviaton of the desired component of the distances of all the lineage viruses from the lineage centroid. Reported numbers are time averages of these observables. We can track their separate trajectories in antigenic space. A split of a lineage into two new lineages is defined when two clusters are detected where previously there was one, and their distance is larger than \u2206x 0 , the chosen threshold for calling a split.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "To estimate the persistence time, we first subsample the trajectory so that the distance between consecutive points is bigger than 6( \u03c3 + std(\u03c3)) so that fast fluctuations in the population size do not affect the inference. We take the resulting trajectory angles and smooth them with a sliding window of 5. Then we divide the trajectory into subsegments, and compute the angles mean squared displacement (MSD) over all lineages and all subsegments. We consider time lags only bigger than twice the typical smoothing time, and if the MSD trace is long enough we also require the time lag to be bigger than 2T . Finally we only keep time lag bins with at least 10 datapoints. We fit the resulting time series to a linear function ax + b, and get the persistence time as 2 a . We compute the reduced \u03c7 2 as a goodness-of-fit score. Results are shown for simulations that had enough statistics to perform the fit, lasted at least 10 5 cycles, and had a reduced \u03c7 2 below 3.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "Applying the formulas of the diffusive theory [32] yields in the limit of large populations:",
            "cite_spans": [
                {
                    "start": 46,
                    "end": 50,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "or \u03c3 \u2248 (D/s) 1/3 (24 ln(N (Ds 2 ) 1/3 )) 1/6 ,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "and v \u2248 D 2/3 s 1/3 (24 ln(N (Ds 2 ) 1/3 )) 1/3 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "The fittest in the population is ahead of the bulk by u c = s\u03c3 4 /4D in phenotypic space, with",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "Plugging in (9) yields: The condition u c r, implies that r scales with N faster than u c , r ln(N ). We also want \u03c3 v\u03c4 , therefore The dynamics of the wave in the directions that are orthogonal to x 1 is governed by the projection of (13) onto x \u22a5 = (x 2 , . . . , x d ):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "From (14) we have",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "Taking the derivative along x \u22a5 yields:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "where we assumed |x \u22a5 | r, \u03c4 /v. This derivative is small compared to the gradient along the x 1 , so that we may approximate |\u2202 x c| \u2248 |\u2202 x1 c| = (r + v\u03c4 ) \u22121 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "Replacing into (B1), we obtain:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "with 1/T = 1/\u03c4 + v/r. Using integration by part, this equation can be rewritten as an auto-regressive process on \u2202 t x \u22a5 :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "x dx e \u2212x /x has the property \u221e 0 dx E 1 (x) = 1. Computing the Fourier transform of E 1 (t/T )/T , which is given by \u2212 1 i\u03c9T ln(1 \u2212 i\u03c9T ) and using the rule of convolution in Fourier space yields (16) . Eq. B5 can be re-written in terms of the direction of motion\u00ea = \u2202 t x/|\u2202 t x| \u2248 \u2202 t x/v:",
            "cite_spans": [
                {
                    "start": 197,
                    "end": 201,
                    "text": "(16)",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "Focusing on long-term behaviour yields the angular diffusion equation, \u2202 t\u00ea = \u221a 8D\u03be \u22a5 (t)/(vT ), for the direction of motion\u00ea. The two-point function of\u00ea follows the equation",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "where \u03b7(t) is a unit Gaussian white noise, leading to:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "with t persist = v 2 T 2 /(4D) is defined as the persistence time. Going along the curviline coordinate that follows the trajectory with speed v, we obtain a persistence length of vt persist . The logarithmic divergence at high frequencies in (16) , which is also apparent in the logarithmic divergence in the temporal domain at small t in the auto-regressive Kernel E 1 (t/T )/T . This divergence may be regularized by realizing that there is a lag u c /v between the nose of the wave, which drives the behaviour of the wave, and its bulk. This implies that the integral over the past trajectory encoding the immune memory extends only up t \u2212 u c /v in the past:",
            "cite_spans": [
                {
                    "start": 243,
                    "end": 247,
                    "text": "(16)",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "or after integration by parts:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "with = t c /T 1. In Fourier space this reads:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "where now the K is the Laplace transform of the operator:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "Since E 1 (z) goes to 0 for large z, (z \u2212 K(z)) \u22121 goes as 1/z for z \u2192 \u221e (small time scales), which means that at high frequency fluctuations of \u2202 t x \u22a5 (and thus of the direction of motion\u00ea) track those of \u03be \u22a5 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        },
        {
            "text": "Since E 1 (x) \u223c \u2212\u03b3 \u2212 ln(x) + x at small x, then E 1 ( ) \u2212 E 1 ( (1 + z)) \u2248 ln(1 + z) \u2212 z for moderate z and small , and K(z) \u2248 z \u2212 z 2 /2 + O(z 2 ), so that (z \u2212 K(z)) \u22121 \u223c 2/z 2 . We thus recover that at long time scales \u2202 t x \u22a5 diffuses with diffusivity 4D/T 2 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. METHODS"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Predictive Modeling of Influenza Shows the Promise of Applied Evolutionary Biology",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "H"
                    ],
                    "last": "Morris",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Trends in Microbiology",
            "volume": "26",
            "issn": "",
            "pages": "102--118",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Manipulating the Selection Forces during Affinity Maturation to Generate Cross-Reactive HIV Antibodies",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Cell",
            "volume": "160",
            "issn": "",
            "pages": "785--797",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Relative rate and location of intra-host HIV evolution to evade cellular immunity are predictable",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "P"
                    ],
                    "last": "Barton",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Nature Communications",
            "volume": "7",
            "issn": "",
            "pages": "1--10",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Host-Pathogen Coevolution and the Emergence of Broadly Neutralizing Antibodies in Chronic Infections",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Nourmohammad",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Otwinowski",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "B"
                    ],
                    "last": "Plotkin",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "PLoS genetics",
            "volume": "12",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Optimal evolutionary control for artificial selection on molecular phenotypes",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Nourmohammad",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Eksin",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Forecasting Epidemiological and Evolutionary Dynamics of Infectious Diseases",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Gandon",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Day",
                    "suffix": ""
                },
                {
                    "first": "Cje",
                    "middle": [],
                    "last": "Metcalf",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "T"
                    ],
                    "last": "Grenfell",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Trends in Ecology and Evolution",
            "volume": "31",
            "issn": "",
            "pages": "776--788",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Shape space: an approach to the evaluation of cross-reactivity effects, stability and controllability in the immune system",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "A"
                    ],
                    "last": "Segel",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "S"
                    ],
                    "last": "Perelson",
                    "suffix": ""
                }
            ],
            "year": 1989,
            "venue": "Immunology Letters",
            "volume": "22",
            "issn": "",
            "pages": "91--99",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Mapping the Antigenic and Genetic",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "J"
                    ],
                    "last": "Smith",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "S"
                    ],
                    "last": "Lapedes",
                    "suffix": ""
                },
                {
                    "first": "Jcd",
                    "middle": [],
                    "last": "Jong",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Science",
            "volume": "305",
            "issn": "",
            "pages": "371--377",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Integrating influenza antigenic dynamics with molecular evolution",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Bedford",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "",
            "volume": "2014",
            "issn": "",
            "pages": "1--26",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Antibody landscapes after influenza virus infection or vaccination",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Fonville",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Science",
            "volume": "346",
            "issn": "",
            "pages": "996--1000",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "A new evolutionary law",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Van Valen",
                    "suffix": ""
                }
            ],
            "year": 1973,
            "venue": "Evol Theory",
            "volume": "1",
            "issn": "",
            "pages": "1--30",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Phylodynamic theory of persistence, extinction and speciation of rapidly adapting pathogens",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Yan",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "A"
                    ],
                    "last": "Neher",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "I"
                    ],
                    "last": "Shraiman",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "8",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Clonal interference in the evolution of influenza",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Strelkowa",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "L\u00e4ssig",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Genetics",
            "volume": "192",
            "issn": "",
            "pages": "671--682",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "The fate of competing beneficial mutations in an asexual population",
            "authors": [
                {
                    "first": "P",
                    "middle": [
                        "J"
                    ],
                    "last": "Gerrish",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "E"
                    ],
                    "last": "Lenski",
                    "suffix": ""
                }
            ],
            "year": 1998,
            "venue": "Genetica",
            "volume": "102",
            "issn": "",
            "pages": "127--144",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Lineages of Influenza Type B Virus since 1983",
            "authors": [
                {
                    "first": "P",
                    "middle": [
                        "A"
                    ],
                    "last": "Rota",
                    "suffix": ""
                }
            ],
            "year": 1990,
            "venue": "Virology",
            "volume": "68",
            "issn": "",
            "pages": "59--68",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Evolution of norovirus",
            "authors": [
                {
                    "first": "P",
                    "middle": [
                        "A"
                    ],
                    "last": "White",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Clinical Microbiology and Infection",
            "volume": "20",
            "issn": "",
            "pages": "741--745",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Ecological and immunological determinants of influenza evolution",
            "authors": [
                {
                    "first": "N",
                    "middle": [
                        "M"
                    ],
                    "last": "Ferguson",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "P"
                    ],
                    "last": "Galvanl",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "M"
                    ],
                    "last": "Bush",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Nature",
            "volume": "422",
            "issn": "",
            "pages": "428--433",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Canalization of the evolutionary trajectory of the human influenza virus",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Bedford",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Rambaut",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Pascual",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "BMC Biology",
            "volume": "10",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "The Roles of Competition and Mutation in Shaping Antigenic and Genetic Diversity in Influenza",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Zinder",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Bedford",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Gupta",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Pascual",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "PLoS Pathogens",
            "volume": "9",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Explaining the geographical origins of seasonal influenza A (H3N2). Proceedings of the",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Wen",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Bedford",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Cobey",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Royal Society B: Biological Sciences",
            "volume": "283",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "The beneficial effects of vaccination on the evolution of seasonal influenza",
            "authors": [
                {
                    "first": "F",
                    "middle": [
                        "T"
                    ],
                    "last": "Wen",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Malani",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Cobey",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Dynamics and selection of many-strain pathogens",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Gog",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "T"
                    ],
                    "last": "Grenfell",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Understanding the dynamics of rapidly evolving pathogens through modeling the tempo of antigenic change : In fl uenza as a case study",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Koelle",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kamradt",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Pascual",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Epidemics",
            "volume": "1",
            "issn": "",
            "pages": "129--137",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Multilineage evolution in viral populations driven by host immune systems",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Marchi",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "L\u00e4ssig",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Mora",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "M"
                    ],
                    "last": "Walczak",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Pathogens",
            "volume": "8",
            "issn": "",
            "pages": "1--16",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Antigenic evolution of viruses in host populations",
            "authors": [
                {
                    "first": "I",
                    "middle": [
                        "M"
                    ],
                    "last": "Rouzine",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Rozhnova",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "PLoS Pathogens",
            "volume": "",
            "issn": "",
            "pages": "1--16",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "The solitary wave of asexual evolution",
            "authors": [
                {
                    "first": "I",
                    "middle": [
                        "M"
                    ],
                    "last": "Rouzine",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Wakeley",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Coffin",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Proceedings of the National Academy of Sciences of the United States of America",
            "volume": "100",
            "issn": "",
            "pages": "587--592",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "Front propagation up a reaction rate gradient",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Cohen",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "A"
                    ],
                    "last": "Kessler",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Levine",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Phys. Rev. E -Stat. Nonlinear, Soft Matter Phys",
            "volume": "72",
            "issn": "",
            "pages": "1--11",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "Beneficial mutationselection balance and the effect of linkage on positive selection",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "M"
                    ],
                    "last": "Desai",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "S"
                    ],
                    "last": "Fisher",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Genetics",
            "volume": "176",
            "issn": "",
            "pages": "1759--1798",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "The noisy edge of traveling waves",
            "authors": [
                {
                    "first": "O",
                    "middle": [],
                    "last": "Hallatschek",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Proceedings of the National Academy of Sciences of the United States of America",
            "volume": "108",
            "issn": "",
            "pages": "1783--1787",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "Distribution of fixed beneficial mutations and the rate of adaptation in asexual populations",
            "authors": [
                {
                    "first": "B",
                    "middle": [
                        "H"
                    ],
                    "last": "Good",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [
                        "M"
                    ],
                    "last": "Rouzine",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "J"
                    ],
                    "last": "Balick",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [],
                    "last": "Hallatschek",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "M"
                    ],
                    "last": "Desai",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Proc. Natl. Acad. Sci. U. S. A",
            "volume": "109",
            "issn": "",
            "pages": "4950--4955",
            "other_ids": {}
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "RNA virus evolution via a fitness-space model",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "S"
                    ],
                    "last": "Tsimring",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Levine",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "A"
                    ],
                    "last": "Kessler",
                    "suffix": ""
                }
            ],
            "year": 1996,
            "venue": "Physical Review Letters",
            "volume": "76",
            "issn": "",
            "pages": "4440--4443",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "Genealogies of rapidly adapting populations",
            "authors": [
                {
                    "first": "Neher",
                    "middle": [],
                    "last": "Ra",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [],
                    "last": "Hallatschek",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Proceedings of the National Academy of Sciences of the United States of America",
            "volume": "110",
            "issn": "",
            "pages": "437--479",
            "other_ids": {}
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "Survival of the simplest in microbial evolution",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Held",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Klemmer",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "L\u00e4ssig",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Nature Communications",
            "volume": "10",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "The ecology and evolution of microbial CRISPR-Cas adaptive immune systems",
            "authors": [
                {
                    "first": "E",
                    "middle": [
                        "R"
                    ],
                    "last": "Westra",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Van Houte",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Gandon",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Whitaker",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Philosophical Transactions of the Royal Society B: Biological Sciences",
            "volume": "374",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "Using nfft 3-a software library for various nonequispaced fast fourier transforms",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Keiner",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Kunis",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Potts",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "ACM Transactions on Mathematical Software (TOMS)",
            "volume": "36",
            "issn": "",
            "pages": "1--30",
            "other_ids": {}
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "Fast convolution with radial kernels at nonequispaced knots",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Potts",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Steidl",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Nieslony",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Numerische Mathematik",
            "volume": "98",
            "issn": "",
            "pages": "329--351",
            "other_ids": {}
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "Scikit-learn: Machine learning in Python",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Pedregosa",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Journal of Machine Learning Research",
            "volume": "12",
            "issn": "",
            "pages": "2825--2830",
            "other_ids": {}
        },
        "BIBREF37": {
            "ref_id": "b37",
            "title": "A densitybased algorithm for discovering clusters in large spatial databases with noise",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Ester",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "P"
                    ],
                    "last": "Kriegel",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Sander",
                    "suffix": ""
                },
                {
                    "first": "X",
                    "middle": [],
                    "last": "Xu",
                    "suffix": ""
                }
            ],
            "year": 1996,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "226--231",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "A simple model of viral-host co-evolution predicts the emergence of an antigenic wave. A. Schematic of the co-evolution model. Viruses proliferate while effectively diffusing in antigenic space (here in 2 dimensions) through mutations, with coefficient D. Past virus positions are replaced by immune protections (light blue). Immune protections create a fitness gradient for the viruses (green gradient) favoring strains at the front. Both populations of viruses and immune populations are coarse-grained into densities in antigenic space. B. Snapshot of a numerical simulation of Eq. 2-3 showing the existence of a wave solution. The blue colormap represents the density of immune protections h(x, t) left behind by past viral strains. The current virus density n(x) is shown in red. C. Close-up onto the viral population, showing fitness isolines. The wave moves in the direction of the fitness gradient (arrow) through the enhanced growth of stains at the edge of the wave (black dots). D. Distribution of fitness across the viral population (corresponding to the projection of B. along the fitness gradient). Parameters for B-D: D/r 2 = 3 \u00b7 10 \u22129 , N h = 10 8 , ln R0 = 3, M = 1.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Analytical prediction of wave properties. Shown are the numerical versus analytical predictions for the wave's population size N (A), speed v (B), width \u03c3 along the wave's direction of motion (C), and width \u03c3 \u22a5 in the direction perpendicular to motion (D), with d = 2 dimensions. Length are in units of the cross-reactivity range (so that r = 1, with no loss of generality). Parameters: N h = 10 8 (squares), 10 10 (circles), or 10 12 (triangles); ln R0 = 1 (filled symbols) or 3 (empty symbols); M = 1 (small symbols) or 5 (large symbols).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Stochastic behaviour of the wave: diffusive motion, splits, and extinctions. A. The wave moves forward in antigenic space but is driven by its nose tip, which undergoes antigenic drift (diffusion) in directions perpendicular to its direction of motion. These fluctuations deviate that direction, resulting in effective angular diffusion. B. When antigenic drift is large, the wave may randomly split into subpopulations, creating independent waves going in different directions. Each wave can also go extinct as size fluctuations bring it to 0. C. Cartoon illustrating the wave's angular diffusion. Selection and drift combine to create a inertial random walk of persistence time tpersist. D. Analytical prediction (Eq. 17) for the persistence time, versus estimates from simulations. Symbols and colors are the same as inFig. 2.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Rate of speciation. A. Rescaled rate of splitting events, defined as the emergence of two substrains at distance \u2206x0 = 0.1r from each other in antigenic space, meaning that they are becoming antigenically independent. The predicted scaling, k split \u223c (v 2 /D)e \u2212L , as well as the definition of the collective variable L as a function of the model parameters, are given by Eq. 20. The line shows a linear fit of the logarithm of the ordinate. B. Predicted rate of splitting as a function of the dimension d, for R0 = 2, M = 1, N h = 10 9 , and D/r 2 = 3 \u00b7 10 \u22126 , with \u2206x0 = r.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "stationarity condition (10) we obtain a self-consistent equation for N :",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "which is automatically satisfied by the previous condition.Appendix B: Fluctuations in the direction perpendicular to motion",
            "latex": null,
            "type": "figure"
        }
    },
    "back_matter": [
        {
            "text": "Acknowledgements. The study was supported by the European Research Council COG 724208 and ANR-19-CE45-0018 \"RESP-REP\" from the Agence Nationale de la Recherche and DFG grant CRC 1310 \"Predictability in Evolution\".",
            "cite_spans": [],
            "ref_spans": [],
            "section": "acknowledgement"
        },
        {
            "text": "We decompose the density of viral strains according to the main direction of the wave x 1 :n(x, t) = n 1 (x 1 , t)\u03c6(x 2 , . . . , x d ),where \u03c6 is normalized to 1. Projecting and linearizing Eq. 2 of the main text yields:with s defined by (9) , and \u03b7 1 = dx 2 \u00b7 dx d \u03b7(x, t), so that \u03b7 1 (x 1 , t)\u03b7 1 (x 1 , t ) = \u03b4(x 1 \u2212 x 1 )\u03b4(t \u2212 t ). The change of variablex 1 = sx 1 ,\u1e7d = sv,\u00f1 1 = s \u2212d n 1 , yields the traveling wave equation of Ref. [32] :withD = Ds 2 and \u03b7 1 (Note that this continuous description differs from that used in Ref. [12] , which also describes a fitness wave in antigenic space. Their approach relies on a discrete evolutionary model where each mutation confers a fixed fitness advantage, as described by the fitness wave solution of Desai and Fisher [28] .Appendix C: Rate of speciation A speciation, or split, occurs when two strains starting at the tip of the nose of the fitness wave, and continuing through their progenies, co-exist long enough for them to become independent from the viewpoint of the immune pressure. This happens when their distance in the x \u22a5 direction become larger than some threshold scaling with the cross-reactivity range, \u2206x 0 \u223c r.Assuming t T , angular diffusion causes a strain to bend from the main direction of the wave as:After integration, the expected deviation reads:assuming x \u22a5 (t = 0) = 0. Now if there are two strains a and b co-existing, their divergence in the perpendicular direction is Gaussian distributed with:Two strains are expected to co-exist at the leading edge for a time t before one of them gets absorbed into the bulk and goes extinct. The expected time for that scales as \u223c \u03c4 sw = u c /v = \u03c3 2 /4D = v/4Ds. Assuming splitting events are rare, they occur when two co-existing strains both survive for an unusually long time. The distribution of such rare events is asymptotically given by the probability density function P (t coexist > t) = e \u2212t/\u03c4sw . The probability that the two strains have drifted by at least r before that happens is then given by:.Since we assume that this event is rare, P (\u2206x > \u2206x 0 ; coexist) 1, we make a saddle-point approximation (Laplace method) in the t variable. We look for the maximum ofwith respect to t, \u2202 t L = 0, which gives:Applying Laplace's method with \u2206x = \u2206x 0 along with a linear approximation of L in the vicinity of \u2206x \u2206x 0 , we obtain: We check self-consistently that our approximation of angular diffusion is correct for \u2206x 0 \u223c r. The condition is met when t * T , orThis condition is equivalent to:It is (barely) satisfied for large population sizes (as one can check using Eq. 12 and Eq. 9). Finally, to get the rate of splitting events, we must multiply the probability of a successful splitting event, P (\u2206x > \u2206x 0 ; coexist), by the rate with which branches sprout from the main trunk of the phylogenic tree. Since mutations are modeled by continuous diffusion in antigenic space, such a new branch occurs whenever the individual virus on the trunk of the tree (defined as the virus that will eventually seed the entire future population) reproduces, as the two offspring immediately become antigenically distinct because of diffusion, and thus make two distinct branches. This happens with rate f (u c ) = u c s = v 2 /4D, so that the overall rate of speciation should scale as:Replacing \u2206x 0 = ar, with a a numerical scaling factor, gives the result of the main text.",
            "cite_spans": [
                {
                    "start": 239,
                    "end": 242,
                    "text": "(9)",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 439,
                    "end": 443,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 536,
                    "end": 540,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 771,
                    "end": 775,
                    "text": "[28]",
                    "ref_id": "BIBREF27"
                }
            ],
            "ref_spans": [],
            "section": "Appendix A: Fitness wave theory"
        },
        {
            "text": "To update the fitness at each time step, we used either an exact computation of Eq. 1, or a faster approximate method based non-homogeneous fast Fourier transforms [35, 36] . For the exact computation, c(x, t + \u2206t) \u2212 c(x, t) was calculated at each time step by convolving the Kernel H with n h (x, t + \u2206t) \u2212 n h (x, t) (exploiting the fact that this sum is sparse because not all positions get updated). Both algorithms can be preceded by an extra-approximation for positions x with n h (x , t + \u2206t) > 0 that are far enough from the viral cloud. We approximate the Kernel H by reducing |x \u2212 x | to its projection along the direction given by x \u2212 x n , with x n = dx xn(x)/N . This allows us to pre-compute the contributions of all these x to Eq. 1 with a mere 1D convolution, \u2200x where n(x) > 0, speeding up the computation considerably. We choose the desired combination of approximations based on the convolution computational complexity, driven by the number of positions with n(x, t + \u2206t) > 0 and n h (x, t + \u2206t) \u2212 n h (x, t) > 0. To limit errors accretion we compute the update to the convolution exactly as explained above depending on a proxy for the fitness errors. In addition, the full convolution was recalculated with no approximation every 10000 steps.",
            "cite_spans": [
                {
                    "start": 164,
                    "end": 168,
                    "text": "[35,",
                    "ref_id": "BIBREF34"
                },
                {
                    "start": 169,
                    "end": 172,
                    "text": "36]",
                    "ref_id": "BIBREF35"
                }
            ],
            "ref_spans": [],
            "section": "Appendix D: Details of simulation implementation"
        }
    ]
}