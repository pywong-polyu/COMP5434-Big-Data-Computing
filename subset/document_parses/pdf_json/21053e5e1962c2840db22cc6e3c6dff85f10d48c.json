{
    "paper_id": "21053e5e1962c2840db22cc6e3c6dff85f10d48c",
    "metadata": {
        "title": "Accuracy in near-perfect virus phylogenies",
        "authors": [
            {
                "first": "Joel",
                "middle": [
                    "O"
                ],
                "last": "Wertheim",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of California San Diego",
                    "location": {
                        "addrLine": "La Jolla",
                        "postCode": "92093",
                        "region": "CA",
                        "country": "USA"
                    }
                },
                "email": "jwertheim@health.ucsd.edu"
            },
            {
                "first": "Mike",
                "middle": [],
                "last": "Steel",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Canterbury",
                    "location": {
                        "postCode": "8041",
                        "settlement": "Christchurch",
                        "country": "New Zealand"
                    }
                },
                "email": ""
            },
            {
                "first": "Michael",
                "middle": [
                    "J"
                ],
                "last": "Sanderson",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Arizona",
                    "location": {
                        "postCode": "85721",
                        "settlement": "Tucson",
                        "region": "AZ",
                        "country": "USA"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "Phylogenetic trees from real-world data often include short edges with very few 1 substitutions per site, which can lead to partially resolved trees and poor accuracy. Theory 2 indicates that the number of sites needed to accurately reconstruct a fully resolved tree 3 grows at a rate proportional to the inverse square of the length of the shortest edge. 4 However, when inferred trees are partially resolved due to short edges, \"accuracy\" should 5 be defined as the rate of discovering false splits (clades on a rooted tree) relative to the 6 actual number found. Thus, accuracy can be high even if short edges are common.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Specifically, in a \"near-perfect\" parameter space in which trees are large, the tree length \u03be 8 (the sum of all edge lengths), is small, and rate variation is minimal, the expected false 9 positive rate is less than \u03be/3; the exact value depends on tree shape and sequence length.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "This expected false positive rate is far below the false negative rate for small \u03be and often 11 well below 5% even when some assumptions are relaxed. We show this result analytically 12 for maximum parsimony and explore its extension to maximum likelihood using theory 13 and simulations. For hypothesis testing, we show that measures of split \"support\" that rely 14 on bootstrap resampling consistently imply weaker support than that implied by the false 15 positive rates in near-perfect trees. The near-perfect parameter space closely fits several 16 empirical studies of human virus diversification during outbreaks and epidemics, including 17 Ebolavirus, Zika virus, and SARS-CoV-2, reflecting low substitution rates relative to high 18 transmission/sampling rates in these viruses.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "A \"perfect phylogeny\" is an evolutionary tree constructed from discrete character 23 data in which no character state evolves more than once (Gusfield, 1997; Fernandez-Baca 24 and Lagergren, 2003)-that is, homoplasy (Wake et al., 2011) is absent. Perfect 25 phylogenies rarely exist for real-world datasets, but algorithms can be modified to search 26 efficiently for \"near-perfect\" trees when a small amount of homoplasy is allowed 27 (Fernandez-Baca and Lagergren, 2003; Awasthi et al., 2012). In this paper, we address how 28 best to measure accuracy in such \"near-perfect\" trees, what factors guarantee accuracy is 29 high, and whether real datasets with such minimal levels of homoplasy even exist. 30 The concept of perfect and near-perfect phylogenies played a key role in early 31 attempts to understand the connections among phylogenetic tree reconstruction methods, 32 such as maximum likelihood (ML), maximum parsimony (MP), and maximum 33 compatibility. In a landmark paper, Felsenstein (Felsenstein, 1973) showed that a sufficient 34 condition for ML and MP to infer the same tree was for the expected number of 35 substitutions on edges of the tree to be very small. Then, \"[i]f our assumption were true 36 that evolutionary change is improbable during the relevant period of time, most characters 37 should be uniform over the group. A few would show a single change of state during the 38 evolution of the group. But only very rarely would we find more than one change of state, 39 so that few or no characters would show convergence.\" This last statement may have been 40 the first hint of a probabilistic description of \"near-perfect phylogeny\". This condition can 41 be stated more formally as \u03be 1, where \u03be is the expected number of substitutions per site 42 summed over the entire tree (i.e., the tree length per site). Homoplasy is rare but has a 43 non-zero probability of occurring.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "44 Felsenstein's concluding comment on near-perfect phylogenies was skeptical: \"Real 45 data is certainly not like this...\" (Felsenstein, 1973). Homoplasy has since been viewed as a 46 commonplace feature of phylogenetic datasets (Wake et al., 2011) and, reasonably enough, 47 most phylogenetic theory has been developed with this sentiment as an implicit 48 4 WERTHEIM, STEEL, AND SANDERSON assumption. However, extensive surveys of genetic diversity in RNA viruses have revealed 49 that some viral phylogenies, particularly those associated with outbreaks and epidemics, 50 do exhibit small per site total tree lengths consistent with near-perfect phylogenies (Dudas 51 and Bedford, 2019). These datasets often comprise full-length viral genomes from RNA 52 viruses, which are typically 10-30 kb in length and have a substitution rate of around 10 \u22123 53 substitutions/site/year.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "54",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "The potential of these data to yield fully resolved phylogenies has been of particular 55 interest in epidemiology, because internal nodes in viral trees represent transmission events 56 (Campbell et al., 2018; Grubaugh et al., 2019; Dudas and Bedford, 2019) . This motivates 57 placing a premium on minimizing false negatives (i.e., on deciphering all such transmission 58 events). However, understanding the false positive rate remains a key issue in 59 characterizing phylogenetic accuracy overall (Felsenstein and Kishino, 1993).",
            "cite_spans": [
                {
                    "start": 234,
                    "end": 258,
                    "text": "Dudas and Bedford, 2019)",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Here we explore what assumptions comprise \"near-perfect\" phylogenies and 61 decouple the false-positive and false-negative components of accuracy in such trees. In 62 particular, by focusing on a mathematically tractable case in which tree size is large yet 63 tree length is small, we will show that the false positive rate can be very good, even when 64 the false negative rate is not: most of the clades inferred are probably correct, even though 65 the tree may be only partly resolved. We also survey a set of viral phylogenies that have 66 many properties of this near-perfect space and estimate their accuracy. Finally, we briefly 67 consider phylogenetic \"support\" measures in relation to accuracy in near-perfect data.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Whereas accuracy relates to the overall performance of a tree estimator relative to the true 69 tree, support relates to the probability of making a mistake in deciding about some aspect 70 of that tree-typically the presence of a particular split-using a statistically based 71 decision rule such as the bootstrap support value or a posterior probability (Felsenstein, 72 ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "on T (by the Markovian process described above).",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Given a tree T \u2208 B(n), let d T (e 1 , e 2 ) denote the number of edges of T that lie 136 strictly within the path between e 1 and e 2 (i.e., excluding e 1 and e 2 ). Thus, e 1 and e 2 are 137 adjacent if and only if d T (e 1 , e 2 ) = 0. In addition, let \u03d5 T = (\u03d5 T (0), \u03d5 T (1), . . . , \u03d5 T (n \u2212 3)), 138 where \u03d5 T (i) is the number of (unordered) pairs of edges {e, e } of T for which d T (e, e ) = i. 139 Finally, for i between 1 and n \u2212 3, let 140\u03c6",
            "cite_spans": [
                {
                    "start": 302,
                    "end": 305,
                    "text": "138",
                    "ref_id": null
                },
                {
                    "start": 404,
                    "end": 407,
                    "text": "139",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "135"
        },
        {
            "text": "The probability of a false split is then given by the following theorem (see SI for 141 proof).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "135"
        },
        {
            "text": "Theorem 1 For each T \u2208 B(n), and k 1 we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "142"
        },
        {
            "text": "Theorem 1 shows that for fixed k and n, the shape of T plays a significant role in 143 determining \u03a6 (k) T ; in particular, unbalanced trees (such as caterpillars) will have a smaller 144 value of \u03a6 (k) T than more balanced trees. Indeed, it is possible to calculate the value of \u03a6 (k) T number of leaves), m, and \u03bb (equivalently, FP T is a function of T , m, and \u03be). 155 In general, it is mathematically complicated to describe F P T in terms of these 156 parameters. However, when the number of leaves in a tree grows faster than the number of 157 perfectly compatible characters, it is possible to state a limit result to provide an 158 approximation to F P T for large trees. 159 In the following theorem, we consider the following setting: 160 (I) m\u03be = \u0398(n \u03b2 ) for some 0 < \u03b2 < 1 2 , and 161 (II) m\u03be 2 = O(1), 162 where O(1) refers to dependence on n (thus m\u03be 2 is not growing with n). Note that 163 Condition (I) implies that the number of perfectly evolved characters grows with the 164 number of leaves, but at a rate that is slower than linearly. Conditions (I) and (II) imply 165 that \u03be decreases as n increases. 166 In this setting, we show that the false positive rate is (asymptotically) of the form \u03be 3 167 times a function \u2126 that involves T (via its shape), m, and \u03be. If we now treat \u03be as a 168 variable, then for \u03be = 0, the function \u2126 is close to 1 (for large n) and so F P T initially 169 grows like \u03be/3. However, as \u03be increases, \u2126 begins to decline at an increasing rate, resulting 170 in the false positive rate reaching a maximum value before starting to decrease.",
            "cite_spans": [
                {
                    "start": 83,
                    "end": 86,
                    "text": "143",
                    "ref_id": null
                },
                {
                    "start": 101,
                    "end": 104,
                    "text": "(k)",
                    "ref_id": null
                },
                {
                    "start": 368,
                    "end": 371,
                    "text": "155",
                    "ref_id": null
                },
                {
                    "start": 680,
                    "end": 683,
                    "text": "159",
                    "ref_id": null
                },
                {
                    "start": 815,
                    "end": 818,
                    "text": "162",
                    "ref_id": null
                },
                {
                    "start": 1123,
                    "end": 1126,
                    "text": "166",
                    "ref_id": null
                },
                {
                    "start": 1306,
                    "end": 1309,
                    "text": "168",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "142"
        },
        {
            "text": "To describe this result, we need to define this function \u2126. Let ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "171"
        },
        {
            "text": "Notice that \u2126(T n , \u03be, m) depends on T n only via the coefficients\u03c6 Tn (i), and this 174 dependence is linear. Thus, if D is a distribution on trees (e.g. the PDA or YH), then the expected value of \u2126(T n , \u03be, m) is given by:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "173"
        },
        {
            "text": "For the PDA distribution, the term E P DA [\u03c6 Tn (i)] has an explicit exact value, 177 namely,",
            "cite_spans": [
                {
                    "start": 82,
                    "end": 85,
                    "text": "177",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "173"
        },
        {
            "text": "for all i between 1 and n \u2212 3 (see SI for proof).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "173"
        },
        {
            "text": "Theorem 2 For each n 1, let T n be a binary phylogenetic tree with n leaves, and 180 suppose that Conditions (I) and (II) hold.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "179"
        },
        {
            "text": "(i)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "181"
        },
        {
            "text": "\u00b7 \u2126(T n , \u03be, m) \u00b7 (1 + o(1)),",
            "cite_spans": [],
            "ref_spans": [],
            "section": "181"
        },
        {
            "text": "where o(1) is a term that tends to 0 as n grows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "181"
        },
        {
            "text": "(ii) If T n is sampled from a distribution D (e.g. PDA, YH), then the expected value of Remarks: Note that F P Tn depends only on the shape of the tree T n (and not on 183 how its leaves are labelled), thus for a tree distribution D on either the class of caterpillar 184 trees, or symmetric trees, we have F P Tn = E D [F P Tn ].",
            "cite_spans": [],
            "ref_spans": [],
            "section": "182"
        },
        {
            "text": "Notice also from Fig. 3 that as \u03be increases from 0 the estimate of E D [F P Tn ] given by \u03be 3 \u00b7 \u2126(T n , \u03be, m) for the YH, PDA distributions and for symmetric trees initially increases (approximately linearly) with \u03be but then begins to decrease with increasing \u03be. By contrast, when T n has the caterpillar tree shape, the estimate of F P Tn appears to be constant as \u03be increases from 0 (see Fig. 3 ). Indeed, when T n is a caterpillar tree, the expression for F P Tn in Theorem 2(i) reduces to the following remarkably simple expression as n becomes large:",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 17,
                    "end": 23,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF4"
                },
                {
                    "start": 390,
                    "end": 396,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF4"
                }
            ],
            "section": "185"
        },
        {
            "text": "F P Tn \u223c 4/(3m), and PDA random trees. Ten values of \u03bb in the interval [10 \u22125 , 0.31622] were analyzed.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "185"
        },
        {
            "text": "PAUP was used for MP bootstrapping (same heuristic search as above but with 100 212 replicates \u00d7 10 subreplicates); IQTree2 was used (50 random tree replicates) for SH-aLRT IQTree2 with a JC69 model, minimum branch lengths of 10 \u22129 , and collapsed polytomies.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "211"
        },
        {
            "text": "Clade support was determined using ultrafast bootstrapping (10,000 replicates), SH-aLRT 221 (10,000 replicates), and aBayes. In addition, we also analyzed an iatrogenic HIV-1 outbreak in Cambodia (Rouet et al., 2018) and the first wave of the SARS-CoV-2 epidemic in China 237 (Pekar et al., 2021) . The SARS-CoV-2 phylogeny is the ML tree used in Pekar (Pekar et al., 238 2021) (see Data S1 for list of GISAID Accession IDs Simulations of tree inference with MP, over a large range of tree lengths, \u03be, and 263 other parameters illustrate several known results (Fig. 2) and perhaps a few less well 264 known ones. First, resolution of the inferred tree increases with tree length. Second,",
            "cite_spans": [
                {
                    "start": 187,
                    "end": 216,
                    "text": "Cambodia (Rouet et al., 2018)",
                    "ref_id": null
                },
                {
                    "start": 276,
                    "end": 296,
                    "text": "(Pekar et al., 2021)",
                    "ref_id": null
                },
                {
                    "start": 353,
                    "end": 367,
                    "text": "(Pekar et al.,",
                    "ref_id": null
                },
                {
                    "start": 368,
                    "end": 371,
                    "text": "238",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 560,
                    "end": 568,
                    "text": "(Fig. 2)",
                    "ref_id": "FIGREF32"
                }
            ],
            "section": "220"
        },
        {
            "text": "\"overall\" accuracy, as measured by the RF distance, is optimal at an intermediate tree Yang, 1998; Bininda-Emonds et al., 2001; Steel and Leuenberger, 2017) .",
            "cite_spans": [
                {
                    "start": 87,
                    "end": 98,
                    "text": "Yang, 1998;",
                    "ref_id": null
                },
                {
                    "start": 99,
                    "end": 127,
                    "text": "Bininda-Emonds et al., 2001;",
                    "ref_id": null
                },
                {
                    "start": 128,
                    "end": 156,
                    "text": "Steel and Leuenberger, 2017)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "265"
        },
        {
            "text": "Moreover, when \u03be >> \u03be * , the false positive error rate, FP T , is similar to the false negative 268 rate, FN T , as might be expected because the true and estimated trees are nearly binary;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "267"
        },
        {
            "text": "However, when \u03be << \u03be * , FP T << FN T , and the false positive error rate can remain 271 quite good (< 0.05) over a large range of \u03be even when the false negative error rate is very 272 high. However, the range of tree lengths for which this result holds depends critically on 273 rate variation across edges and sites. When \u03be 1, the false positive rate is low and 274 insensitive to the presence of rate variation; but, when \u03be > 1, the false positive rate is 275 much more sensitive to rate variation-high when variation is present and low when absent 276 (contrast Fig. 2A and Fig. 2B ). In real-world data, as \u03be increases, we expect that evidence 277 of rate variation will become more apparent. Key elements of these findings can be shown 278 analytically in a \"near-perfect\" zone described by a simple evolutionary model. 2 . Accuracy of maximum parsimony phylogeny reconstruction in simulations over a wide range of tree length, \u03be, and other parameters. Open circles are mean false positive error rates; closed circles are mean false negative error rates (log scale left); dashed sigmoidal curve is fractional resolution of estimated tree (linear scale right). Trees are generated by a random proportional-to-distinguishable-arrangement (PDA) model for 513 taxa, from which a sequence alignment length of 1000 sites is generated. The dotted horizontal line is placed at an error rate of 0.05. Asterisk marks the location of the optimal tree length with best overall Robinson-Foulds accuracy, \u03be * . Each point is mean of 1000 replicates \u00d7 100 sub-replicates (see Methods). \"Near-perfect\" values of \u03be 1.0 are shaded. A) JC69 model with no edge length or across-site-rate variation. Because of y-axis log scaling, two y values of zero were set to 0.0001. B) JC69 model with substantial edge length and across-site-rate variation, both modeled as a gamma distribution with shape parameters \u03b1e = \u03b1ASR = 0.25). distributed with mean \u03be; and the probability of more than one change on an edge is low, 287 meaning multiple changes at a site occur on distinct edges. Though these conditions will 288 generate alignments dominated by \"perfect\" sites exhibiting no homoplasy, a few sites may 289 exhibit homoplasy even with \u03be 1, which motivates the term \"near-perfect\". Under these 290 conditions, tree reconstruction methods will tend to infer relatively unresolved trees unless 291 the number of sites is very large.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 566,
                    "end": 573,
                    "text": "Fig. 2A",
                    "ref_id": "FIGREF32"
                },
                {
                    "start": 578,
                    "end": 585,
                    "text": "Fig. 2B",
                    "ref_id": "FIGREF32"
                },
                {
                    "start": 826,
                    "end": 827,
                    "text": "2",
                    "ref_id": "FIGREF32"
                }
            ],
            "section": "267"
        },
        {
            "text": "Rare sites that exhibit homoplasy can introduce false positive splits on the inferred tree ( Fig. 1) . A na\u00efve argument using Equation 1 might suggest that FP T would depend on",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 93,
                    "end": 100,
                    "text": "Fig. 1)",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "292"
        },
        {
            "text": ", namely the ratio of the expected numbers of sites having changes on two edges (i.e., those that are potentially homoplastic and misleading) to those sites having only a single change (those that are reliable), for sufficiently small \u03be. But because only one-third of those two-edge sites are actually homoplastic in a JC69 model,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "292"
        },
        {
            "text": "which implies FP T is small when \u03be is small enough (e.g., FP T < 0.05 whenever \u03be < 0.15).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "292"
        },
        {
            "text": "This approximation can be improved further by recognizing that not all two-edge 294 homoplastic sites induce false positives, depending on their position in the true tree ( Fig.   295 1). Given the evolutionary model, the probability that k perfect sites, and another site f 296 that has evolved with two edge changes will produce a \"false positive\" under MP is",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 173,
                    "end": 183,
                    "text": "Fig.   295",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "293"
        },
        {
            "text": "T (Theorem 1 above). Because this probability is often less than one, FP T can 298 remain below 0.05 at higher values of \u03be than the na\u00efve argument suggests.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "293"
        },
        {
            "text": "If the true tree were known with some precision, the first part of Theorem 2 could 300 be used directly to calculate false positive rates. However, in the \"near-perfect\" parameter 301 space of large n and \u03be 1, estimates of the true tree are likely to be only partially resolved 302 (Fig. 2) . We therefore derive the expected false positive rate for a distribution, D, of 303 randomly generated trees of size n, E D [FP Tn ], generated from parameters based on the 304 inferred tree. In the remainder of this paper, the \"expected false positive rate\" will 305 generally refer to E D [FP Tn ]. We assume that D is usually either a \"proportional-to-distinguishable-arrangement\" (PDA) or Yule-Harding (YH) distribution 307 (Aldous, 2001) , but also consider the two extreme cases of completely unbalanced 308 (caterpillar) trees, and completely balanced (symmetric) trees. Unlike PDA and YH trees, 309 these last two have a constant tree shape (with random leaf labels). From the second part 310 of Theorem 2, we see that, for a JC69 model and trees inferred with MP, the following 311 approximation holds increasingly well as n increases:",
            "cite_spans": [
                {
                    "start": 720,
                    "end": 734,
                    "text": "(Aldous, 2001)",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 282,
                    "end": 290,
                    "text": "(Fig. 2)",
                    "ref_id": "FIGREF32"
                }
            ],
            "section": "299"
        },
        {
            "text": "given the assumption that \u03be is sufficiently small and the number of sites does not grow too 313 quickly with the size of the tree. The function \u2126(T n , \u03be, m), defined in Materials and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "299"
        },
        {
            "text": "Methods, is monotonically decreasing in \u03be and m, and depends on the shape of T .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "314"
        },
        {
            "text": "Simulations indicate that the approximation is close for \u03be 1 (Fig. 3 ), but if many equally 316 parsimonious trees are present, the search algorithm should take a strict consensus of a 317 broad sample of those solutions (Fig. S3 ). E D [FP Tn ] is better on average for PDA than YH 318 trees, and both are bounded between a theoretical worst case error rate for symmetric and 319 best case error rate for caterpillar trees. In fact, the expected false positive rate for the 320 latter is just 4/(3m) in the limit of large n, which is independent of \u03be. but even when ASR variation is large (gamma shape parameter \u03b1 ASR = 0.1), the false 332 positive rate remains slightly below 5% for simulated dataset sizes in the absence of EL 333 variation (Fig. S4 ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 61,
                    "end": 68,
                    "text": "(Fig. 3",
                    "ref_id": "FIGREF4"
                },
                {
                    "start": 221,
                    "end": 229,
                    "text": "(Fig. S3",
                    "ref_id": "FIGREF4"
                },
                {
                    "start": 744,
                    "end": 752,
                    "text": "(Fig. S4",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "315"
        },
        {
            "text": "Departure of the substitution model from the JC69 model assumed in the 335 \"near-perfect\" zone can also increase the expected false positive rate. For example, a 336 strong transition-transversion bias increases E D [FP Tn ] substantially, though it still remains 337 well below 5% under our typical simulation conditions when \u03be 1 (Fig. S5 ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 331,
                    "end": 339,
                    "text": "(Fig. S5",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "334"
        },
        {
            "text": "Thus, the near-perfect tree length of \u03be 1 is a region in which rate variation 339 appears to have less of an impact on false positive rates than when tree lengths are longer.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "338"
        },
        {
            "text": "This suggests that the definition of near-perfect zone in practice can include substantial 341 rate variation as long as \u03be 1. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "340"
        },
        {
            "text": "We estimated key parameters from the trees and underlying data for 11 empirical 344 virus phylogenies ( ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "343"
        },
        {
            "text": "Epidemics with young crown group ages on the order of years or decades (e.g., Zika (Table 1) for maximum parsimony (MP) inference, estimated by simulation using parameters estimated from the data (Table S1 ). Abbreviations given in Table 1 . Simulation experiments assumed ASR variation according to either an invariant sites model (circles) or a gamma distributed model (triangles) and a Yule-Harding random tree distribution (each point is mean of 500 replicates \u00d7 100 sub-replicates). Model point with higher likelihood is shaded. False positive rates assuming PDA random trees are uniformly slightly better (Fig. S6 ). The near-perfect zone of \u03be 1.0 is shaded. Horizontal dashed line indicates a 0.05 expected false positive rate. Nonetheless, some differences were observed, which tended to imply better accuracy for First, the computational expense of ML searches makes it tempting to undertake fewer 378 replicate searches for local optima, but this was as critical to improve the fit to Equation 6 379 for ML as it was for MP (Fig. S7) . Second, ML programs set hard numerical lower bounds 380 strictly greater than zero on edge lengths, often (by default) on the same order as\u03bb, so 381 these must be reset downward to obtain correct tree likelihoods (Morel et al., 2020).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 83,
                    "end": 92,
                    "text": "(Table 1)",
                    "ref_id": "TABREF3"
                },
                {
                    "start": 196,
                    "end": 205,
                    "text": "(Table S1",
                    "ref_id": "TABREF3"
                },
                {
                    "start": 232,
                    "end": 239,
                    "text": "Table 1",
                    "ref_id": "TABREF3"
                },
                {
                    "start": 611,
                    "end": 619,
                    "text": "(Fig. S6",
                    "ref_id": "FIGREF8"
                },
                {
                    "start": 1034,
                    "end": 1043,
                    "text": "(Fig. S7)",
                    "ref_id": null
                }
            ],
            "section": "352"
        },
        {
            "text": "Finally, inferred edge lengths that are larger than these programs' lower bounds but still 383 smaller than about 1/m tend to be included in the ML tree despite weak evidence 384 (IQTree2 issues a warning about this). We saw this in ML searches roughly when \u03be 0.1, 385 when three-state sites become more common in alignments than they were at lower values 386 of \u03be. Even without homoplasy, ML tends to over-resolve trees in a way that elevates 387 E D [FP Tn ]. By collapsing short edge lengths inferred by ML to be less than 1/m, this 388 behavior can be mitigated (Fig. S7 ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 566,
                    "end": 574,
                    "text": "(Fig. S7",
                    "ref_id": null
                }
            ],
            "section": "382"
        },
        {
            "text": "In general, ML is expected to be more accurate than MP under more realistic Notably, aBayes is the only one of the four metrics that is not based on resampling. 403 We explored other factors impacting support in the boundary case of perfect trees.",
            "cite_spans": [
                {
                    "start": 161,
                    "end": 164,
                    "text": "403",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "389"
        },
        {
            "text": "For sequence length, we computed standard support metrics in an ML framework in 405 perfect four-taxon datasets, in which each branch was defined by a single change, and 406 alignments range between 40 nt and 30,000 nt (Fig. S8 On the other hand, in perfect trees from 8-128 taxa, in which the mean edge length 417 remained the same (but therefore \u03be grew with n), mean SH-aLRT and aBayes support was 418 unchanged, but mean ultrafast bootstrap support increased (Fig. S9 ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 219,
                    "end": 227,
                    "text": "(Fig. S8",
                    "ref_id": "FIGREF40"
                },
                {
                    "start": 462,
                    "end": 470,
                    "text": "(Fig. S9",
                    "ref_id": null
                }
            ],
            "section": "404"
        },
        {
            "text": "In this paper, we study a \"near-perfect\" parameter space for phylogenetic inference 421 on large trees with small tree lengths and no rate variation within or between sites or 422 edges. The \"near-perfect\" tree length of \u03be 1 means that few sites exhibit homoplasy and, 423 for MP inference, the false positive rate can be much better than the false negative rate 424 and well under 5% for typical datasets with thousands of sites. The near-perfect conditions 425 defined here to allow mathematical derivations appear to be sufficient but not necessary.",
            "cite_spans": [
                {
                    "start": 269,
                    "end": 272,
                    "text": "423",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "420"
        },
        {
            "text": "For example, with no rate variation, the false positive rate can be very good even when 427 \u03be > 1 ( Fig. 2A, S5) , and, if \u03be < 1, a substantial level of rate variation can be present without elevating the false positive rate by nearly as much as when \u03be > 1 (Fig. 2,4 , S4).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 100,
                    "end": 112,
                    "text": "Fig. 2A, S5)",
                    "ref_id": "FIGREF6"
                },
                {
                    "start": 257,
                    "end": 266,
                    "text": "(Fig. 2,4",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "426"
        },
        {
            "text": "The second case is clearly more relevant in real-world data. The 11 empirical virus 430 datasets all had substantial rate variation and showed a general increase in false positive 431 rate with \u03be, with almost all rates below 5% occurring when \u03be 1, much like the predicted 432 patterns seen in Fig Moreover, m also grows as O(1/\u03bb 2 min ) for ML and some more ad hoc estimators (Erd\u00f6s 464 et al., 1999; Roch, 2019) , implying again that short edges tend to degrade accuracy when 465 accuracy is defined in terms of total agreement between T andT , unlike here. 466 A cryptic factor affecting the false positive rate is tree shape. Highly asymmetric 467 trees have better expected false positive rates than highly symmetric trees, because expected path lengths are longer and it is harder to induce false positive splits by chance 469 (Fig. 1) . Thus, a random sample of PDA trees will have a better E D [FP Tn ] than more 470 symmetrical YH trees. Differences in tree shape among RNA virus phylogenies have long 471 been noted (Grenfell et al., 2004) , such as the typically more asymmetric influenza trees.",
            "cite_spans": [
                {
                    "start": 383,
                    "end": 400,
                    "text": "464 et al., 1999;",
                    "ref_id": null
                },
                {
                    "start": 401,
                    "end": 412,
                    "text": "Roch, 2019)",
                    "ref_id": null
                },
                {
                    "start": 559,
                    "end": 562,
                    "text": "466",
                    "ref_id": null
                },
                {
                    "start": 1025,
                    "end": 1048,
                    "text": "(Grenfell et al., 2004)",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 293,
                    "end": 296,
                    "text": "Fig",
                    "ref_id": null
                },
                {
                    "start": 832,
                    "end": 840,
                    "text": "(Fig. 1)",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "429"
        },
        {
            "text": "Perfect and near-perfect phylogenies have been studied as discrete optimization 473 problems (Gusfield, 1997; Fernandez-Baca and Lagergren, 2003) in which the goal is to Model-based phylogenetic inference methods such as ML and Bayesian inference are 483 generally regarded as theoretically superior to MP, especially for datasets that fit 484 substitution models much more complex than our \"near-perfect\" JC69 model with no rate 485 variation. Though our mathematical results for expected false positive rates were derived 486 for MP, there is both relevant theory and considerable simulation evidence to suggest that 487 in the near-perfect zone, the ML expected false positive rate is approximated by the MP 488 theory, both in terms of its absolute value and its shape as a function of tree length. As \u03be 489 increases, especially above \u03be * , ML consistently has better accuracy than MP, but we 490 conjecture that the false positive rates of MP and ML differ much less as \u03be gets very small.",
            "cite_spans": [
                {
                    "start": 93,
                    "end": 109,
                    "text": "(Gusfield, 1997;",
                    "ref_id": null
                },
                {
                    "start": 110,
                    "end": 145,
                    "text": "Fernandez-Baca and Lagergren, 2003)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "472"
        },
        {
            "text": "Further work is needed to test this conjecture.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "491"
        },
        {
            "text": "The connection between the false positive rate as a measure of accuracy and 493 conventional measures of phylogenetic support appears to be sensitive to the choice of 494 support method when \u03be << 1 (Fig. 6) , 1993; Felsenstein and Kishino, 1993; Efron et al., 1996; Susko, 2008 Susko, , 2009 Alfaro and 499 Holder, 2006; Simmons and Norton, 2014) , but remains somewhat fraught. We hesitate to 500 draw firm conclusions without a formal analysis of support in the \"near-perfect\" parameter 501 space but note the variability in support estimates we found (Fig. 6 ).",
            "cite_spans": [
                {
                    "start": 207,
                    "end": 214,
                    "text": ", 1993;",
                    "ref_id": null
                },
                {
                    "start": 215,
                    "end": 245,
                    "text": "Felsenstein and Kishino, 1993;",
                    "ref_id": null
                },
                {
                    "start": 246,
                    "end": 265,
                    "text": "Efron et al., 1996;",
                    "ref_id": null
                },
                {
                    "start": 266,
                    "end": 277,
                    "text": "Susko, 2008",
                    "ref_id": null
                },
                {
                    "start": 278,
                    "end": 291,
                    "text": "Susko, , 2009",
                    "ref_id": null
                },
                {
                    "start": 292,
                    "end": 320,
                    "text": "Alfaro and 499 Holder, 2006;",
                    "ref_id": null
                },
                {
                    "start": 321,
                    "end": 346,
                    "text": "Simmons and Norton, 2014)",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 198,
                    "end": 206,
                    "text": "(Fig. 6)",
                    "ref_id": "FIGREF8"
                },
                {
                    "start": 554,
                    "end": 561,
                    "text": "(Fig. 6",
                    "ref_id": "FIGREF8"
                }
            ],
            "section": "492"
        },
        {
            "text": "The low false positive rate in near-perfect trees suggests that phylogenies describing We gratefully acknowledge the authors from the originating laboratories and the 518 submitting laboratories, who generated and shared via GISAID the SARS-CoV-2 genomic 519 sequence data on which this research is based. A complete list acknowledging the authors 520 who submitted data analyzed in this study can be found in Data S1. MJS thanks the support. JOW was supported by an NIH-NIAID R01 AI135992. distinct edges of T (mostly we will deal with the case c = 2). The probability that a 18 character evolves on T with 2 edge changes on e 1 , e 2 is p 2 (1 \u2212 p) 2n\u22125 , while the probability 2 that a character evolves on T with 2 state changes is 2n\u22123 2 p 2 (1 \u2212 p) 2n\u22125 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "502"
        },
        {
            "text": "We pause here to make an observation: If a data set consists of characters each of 21 which have evolved on T with either 1 or 2 edge changes, then the maximum parsimony 22 tree(s) and the maximum compatibility tree(s) for this data set will be exactly the same.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "20"
        },
        {
            "text": "Moreover, if there are sufficiently many constant characters, then any maximum likelihood 24 tree will also be one of these trees.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "23"
        },
        {
            "text": "Recall that a split refers to a bipartition of the leaf set [n] into two non-empty 26 subsets (and splits are induced by binary characters). A character that has evolved 27 perfectly on T produces a split, and these splits (across a set of perfectly evolved 28 characters) are compatible and so form a (generally unresolved/non-binary) tree on leaf set 29",
            "cite_spans": [],
            "ref_spans": [],
            "section": "25"
        },
        {
            "text": "[n].",
            "cite_spans": [],
            "ref_spans": [],
            "section": "25"
        },
        {
            "text": "Now suppose that m characters evolve on T and suppose that, of these m 31 characters, k of them are perfectly evolved on T (note that more than one of these 32 characters may correspond to the same split of T ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "30"
        },
        {
            "text": "Next, consider a single additional character f which has evolved on T with two edge 34 changes on e 1 , e 2 (there is no restriction that these are interior edges). The probability that 35 this character f is a binary character is 1 3 (as noted earlier). Moreover, in that case, the 36 bipartition induced by f corresponds to a split of T if and only if e 1 and e 2 are adjacent.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "33"
        },
        {
            "text": "The question now arises as to whether we can discover that f gives a false split of T 38 (without knowing T ), just on the basis of the other k perfectly-evolved characters.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "37"
        },
        {
            "text": "We next introduce some further notation. We will let \u03be denote the expected number of state changes in the tree T per character, under the model described. Thus \u03be equals the per-edge rate \u03bb times the number of edges of T , and so \u03be = \u03bb \u00b7 (2n \u2212 3).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "39"
        },
        {
            "text": "We will also use the following standard notation throughout: we write f (n) \u223c g(n) 40 if the ratio f (n)/g(n) tends to 1 as n becomes large. Note that the sequence \u03d5 T is a topological invariant (i.e. it depends only on the 51 unlabelled shape of the tree) and does not depend on any other parameters mentioned 52 above. Clearly, for any T \u2208 B(n) we have: (2) Thus, Eqn.",
            "cite_spans": [
                {
                    "start": 83,
                    "end": 85,
                    "text": "40",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "39"
        },
        {
            "text": "(1) translates to the identity n\u22123 i=1\u03c6 T (i) = 1. Thus\u03c6 T (i) is the probability 56 that a pair on edges (selected uniformly at random from all pairs) has exactly i edges lying 57 on the path strictly between the two selected edges.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "39"
        },
        {
            "text": "Next we state a simple combinatorial result that will be useful in the proof of the 59 first theorem.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "58"
        },
        {
            "text": "Lemma 1 Let f be a binary character that has evolved on T by 2 edge changes on e 1 and 61 e 2 , and let f be a character that has perfectly evolved on T by a change on a single does not lie on the path in T that is strictly between e 1 and e 2 (i.e. the red edges in Fig. 1) .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 267,
                    "end": 274,
                    "text": "Fig. 1)",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "60"
        },
        {
            "text": "these two partial splits are incompatible, so too are f and f .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "60"
        },
        {
            "text": "Next suppose that e lies in one of the green subtrees of Fig. 1 (C-iii) the split described by f is compatible with k characters that are perfectly evolved 89 on T (by the Markovian process described above).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 57,
                    "end": 63,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "69"
        },
        {
            "text": "The point of these conditions is that we might add the split corresponding to f to 91 the other k compatible spits which still be compatible, but create a 'false positive' split in 92 the resulting tree (note that we do not know a-priori which splits are the perfectly evolved 93 ones, as we are assuming that T is not known).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "90"
        },
        {
            "text": "We now present an exact expression for \u03a6 ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "94"
        },
        {
            "text": "Thus R T (e 1 , e 2 ) is the proportion of interior edges of T that lie between two 98 non-adjacent edges e 1 and e 2 . Next, let \u00b5 T denote the average value of d T (e, e ) over all pairs of edges {e, e } 100 sampled from T . That is:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "94"
        },
        {
            "text": ". ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "94"
        },
        {
            "text": "T is the expected value of",
            "cite_spans": [],
            "ref_spans": [],
            "section": "94"
        },
        {
            "text": "(1 \u2212 R T (e 1 , e 2 )) k when a pair of edges of T is selected uniformly at random from the set of 126 all such pairs. Since f (x) = (1 \u2212 x) k is a convex function, Jensen's inequality then gives:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "125"
        },
        {
            "text": "(1 \u2212 0) k , since there are 3(n \u2212 2) pairs of adjacent edges in T , and 1 3 \u00b7 3(n\u22122) ( 2n\u22123 2 ) = 1 (2n\u22123) , and so applying this to the Eqn. 5 gives the result claimed. T for a given tree T with n leaves involves a 136 summation of just O(n 2 ) terms, so could be calculated fairly easily.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "125"
        },
        {
            "text": "Notice also that in the special case where k = 1, Theorem 2(i) simplifies (via 138 Eqn.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "137"
        },
        {
            "text": "(1)) as follows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "137"
        },
        {
            "text": "Corollary 1",
            "cite_spans": [],
            "ref_spans": [],
            "section": "139"
        },
        {
            "text": "Exact values of \u03a6 (k)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "139"
        },
        {
            "text": "T for classes of trees 140 Proposition 1 8 (i) Let T n denote a caterpillar tree with n leaves. Then \u03a6 T 4 = 0 and for n 5:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "139"
        },
        {
            "text": "Thus, for fixed k we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "139"
        },
        {
            "text": "where o(1) is a term that tends to 0 as n grows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "139"
        },
        {
            "text": "(ii) Let T h denote any tree in B(2 h + 1) obtained by attaching a leaf to the root of a 143 complete balanced binary tree of height h. Then",
            "cite_spans": [],
            "ref_spans": [],
            "section": "142"
        },
        {
            "text": "where:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "142"
        },
        {
            "text": "(iii) Let D be a probability distribution on B(n). Then",
            "cite_spans": [],
            "ref_spans": [],
            "section": "142"
        },
        {
            "text": "In particular, when D is the PDA distribution on B(n) ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "142"
        },
        {
            "text": "For h 1 and i 1, let N h i denote collection of pairs of edges in T h that are separated by exactly i edges, and let n",
            "cite_spans": [],
            "ref_spans": [],
            "section": "142"
        },
        {
            "text": "Notice also that deleting the stem edge of T h+1 (and its incident vertices) produces two 154 copies of T h -we will call these L and R ('left' and 'right').",
            "cite_spans": [],
            "ref_spans": [],
            "section": "142"
        },
        {
            "text": "The set N h+1 i can be partitioned into three classes:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "155"
        },
        {
            "text": "Class 1: A pair of edges consisting of an edge of T h+1 at distance i from the stem 157 edge, together with the stem edge. This set has size u",
            "cite_spans": [],
            "ref_spans": [],
            "section": "156"
        },
        {
            "text": "is as given 158 above.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "156"
        },
        {
            "text": "Class 2: A pair of edges that lie entirely within L or entirely within R. This set has 160 size 2 \u00b7 n (h)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "159"
        },
        {
            "text": "i .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "159"
        },
        {
            "text": "Class 3: A pair of edges {e 1 , e 2 } with e 1 in L and e 2 in R with the distance between 162 e 1 and e 2 being i.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "161"
        },
        {
            "text": "A little care is required to enumerate Class 3. One subcase is that e 1 is not the stem edge of L and e 2 is not the stem edge of R. In that case, the number of choices is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "163"
        },
        {
            "text": "which equals the expression Q(i, h) given in Part (ii). The complementary subcase where e 1 or e 2 is the stem edge of L or R contributes",
            "cite_spans": [],
            "ref_spans": [],
            "section": "163"
        },
        {
            "text": "Combining the above gives the recursion:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "163"
        },
        {
            "text": "which simplifies to:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "163"
        },
        {
            "text": "or equivalently,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "163"
        },
        {
            "text": "Solving this recursion (noting that u ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "163"
        },
        {
            "text": "The expression for E[\u03c6 T (i)] involves an argument in enumerative combinatorics. Let N (n, k) denote the number of (unordered) forests consisting of k rooted binary trees whose leaf sets are disjoint and contain a total of n leaves (we allow a single labeled leaf to be a rooted tree of size 1, otherwise the root of each tree has degree 2). It is easily seen that N (n, 2) is precisely the number of rooted binary trees (2n \u2212 3)!!, since deleting the root of such a tree, produces a forest of two trees with disjoint leaf sets. It turns out there is an exact formula for N (n, r) (from \u223c1990):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "167"
        },
        {
            "text": "N (n, r) = (2n \u2212 r \u2212 1)! (n \u2212 r)!(r \u2212 1)!2 n\u2212r , for r = 1, . . . , n (see e.g. (3), p. 105).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "167"
        },
        {
            "text": "An ordered forest is a forest with a linear ordering on its component trees. If O(n, r) denotes the number of ordered forests consisting of r trees then O(n, r) = r!N (n, r) = r (2n \u2212 r \u2212 1)! (n \u2212 r)!2 n\u2212r .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 77,
                    "end": 87,
                    "text": "If O(n, r)",
                    "ref_id": null
                }
            ],
            "section": "168"
        },
        {
            "text": "Notice that:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "168"
        },
        {
            "text": "To see this observe that twice the right-hand side counts the number of pairs (T, (e 1 , e 2 )) 169",
            "cite_spans": [],
            "ref_spans": [],
            "section": "168"
        },
        {
            "text": "where T \u2208 B(n) and (e 1 , e 2 ) is an ordered pair of non-adjacent edges. Notice that if we 170 delete the path connecting e 1 and e 2 we obtain an ordered forest of rooted trees on the 171 same leaf set as T (cf. Fig. 1 ) . This provides a bijection between these two sets in which 172 the number of strictly edges between e 1 and e 2 in T is equal to i \u2212 3 where i is the number 173 of forests.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 214,
                    "end": 220,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "168"
        },
        {
            "text": "Thus,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "174"
        },
        {
            "text": "and rearranging, gives the result.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "174"
        },
        {
            "text": "To illustrate Part (i), with n = 5 we have \u03a6 T 5 = 8 63 ( 1 2 ) k . Notice that this converges 177 to zero exponentially fast with k (and in general for fixed n this will be the case).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "176"
        },
        {
            "text": "Also, observe that for general values of n and with k = 1 (say) we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "178"
        },
        {
            "text": "Thus, for the simulation involving trees with n = 500 leaves, if these were caterpillars 179 (instead of YH trees), for k = 1 we would expect \u03a6",
            "cite_spans": [],
            "ref_spans": [],
            "section": "178"
        },
        {
            "text": "T to be very close to 2 9 (in agreement 180 with the asymptotic claim in the Part (i) of Proposition 1) which is lower than the 181 simulated values on YH trees, as expected.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "178"
        },
        {
            "text": "To illustrate Part (ii), \u03d5 T 3 (2) = P (2, 3) + Q(2, 3) = 2 4 (2 1 \u2212 1) + 2 2 (2 + 1) = 28.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "12"
        },
        {
            "text": "Notice also that for general h we obtain (as expected)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "12"
        },
        {
            "text": "and \u03d5 T h (i) = 0 for i > 2h \u2212 2.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "12"
        },
        {
            "text": "Notice that for h large, P (i, h) is negligible relative to Q(i, h).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "183"
        },
        {
            "text": "A lower bound on the expected value of \u03a6 for all n 4 we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "184"
        },
        {
            "text": "Moreover,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "184"
        },
        {
            "text": "where o(1) is a term that tends to 0 as n grows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "184"
        },
        {
            "text": "(iii)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "188"
        },
        {
            "text": "where o(1) is a term that tends to 0 as n grows, and c is a constant (independent of 189 n). ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "188"
        },
        {
            "text": "The first step is to apply a classic technique in enumerative combinatorics; namely, 193 we count a certain set \u2126 in two different ways, to obtain an equation. Here, we take the set corresponds to an interior edge of T , and {e 1 , e 2 } \u2208 N A(T ) with the edge of T 196 corresponding to split \u03c3 being strictly within the path connecting e 1 and e 2 .",
            "cite_spans": [
                {
                    "start": 85,
                    "end": 88,
                    "text": "193",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "192"
        },
        {
            "text": "Summing first over all choices of T we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "197"
        },
        {
            "text": "and so,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "197"
        },
        {
            "text": "where |C T | = 2n\u22123 2 \u2212 3(n \u2212 2) is the number of pairs of non-adjacent edges in T .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "197"
        },
        {
            "text": "On the other hand, we can count |\u2126| by first summing over all choices of the split \u03c3 201 (stratified by the size k of the smaller half of the split) and then counting for each such \u03c3 202 the number of T and {e 1 , e 2 }. This gives:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "200"
        },
        {
            "text": "where rb(m) = (2m \u2212 3)!! is the number of rooted trees on a leaf set of size m.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "200"
        },
        {
            "text": "To see this, note that n k is the number of ways to partition [n] into a split \u03c3 of two 205 sets of size k and n \u2212 k, and 1 2 rb(k)rb(n \u2212 k) is the number of trees in B(n) that contain 206 this split (the factor 1 2 is to remedy the double counting that occurs). Finally, given T and 207 \u03c3 there are now (2k \u2212 2)(2(n \u2212 k) \u2212 2) choices of {e 1 , e 2 } where e 1 is an edge of the rooted 208 subtree of T on the leaf set of size k and e 2 is an edge of the rooted subtree of T of size 209 n \u2212 k.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "204"
        },
        {
            "text": "We will apply generating function techniques to calculate an exact expression for term on the right hand side of Eqn. (13). Notice can rewrite Eqn. (13) as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "210"
        },
        {
            "text": "where [x n ]f (x) denote the coefficient of x n in f (x), and hence, even more compactly,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "210"
        },
        {
            "text": "Let rb(n) = (2n \u2212 3)!! (the number of rooted binary trees on a leaf set of size n) and 213 let \u03bd(x) = n 1 rb(n)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "210"
        },
        {
            "text": "n! x n denote the associated exponential generating function. It is well 214 known (see e.g. (3)) that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "210"
        },
        {
            "text": "which has the unique solution",
            "cite_spans": [],
            "ref_spans": [],
            "section": "210"
        },
        {
            "text": "We will use the following relationships which follow easily from Eqn. (16):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "210"
        },
        {
            "text": "where \u03bd (x) = d dx \u03bd(x).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "210"
        },
        {
            "text": "Recall, F (x) from Eqn. (15). We have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "219"
        },
        {
            "text": "Thus,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "219"
        },
        {
            "text": "and this simplifies by Eqns. (18) and (19)) to:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "219"
        },
        {
            "text": "In order to determine the expression in Eqn. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "219"
        },
        {
            "text": "For the third term of Eqn. (20), we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "219"
        },
        {
            "text": "Substituting the expressions on the right hand side of Eqns. (18), (19) and (20) ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "219"
        },
        {
            "text": "The second claim in Part (i) of Theorem 2 follows from the asymptotic equivalence: rb(n) n! \u223c 1 2 \u221a \u03c0 2 n n \u22123/2 together with some standard algebraic manipulation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "231"
        },
        {
            "text": "Part (ii): We apply Theorem 2(Part (ii)) to Part (i) of the current theorem. WIth k \u03b3 \u221a n we obtain:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "232"
        },
        {
            "text": "Part (iii): We apply Proposition 4 of (1) (where \u03b2 = 0 corresponds to the YH 233 distribution). This result shows that in a tree T \u2208 B(n) sampled according to the YH 234 distribution the maximum distance D from any leaf to the root is less than 235 (4.31 + ) log(n) with a probability converging to 1 as n grows. Now \u00b5 T is always less than 236 twice the distance from any leaf in T to any other leaf in T , and this inter-leaf distances is 237 bounded by 2D. The result now follows from Theorem 2(Part (ii)).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "232"
        },
        {
            "text": "Remarks:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "238"
        },
        {
            "text": "Note that Parts (ii) and (iii) imply that for each fixed k,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "239"
        },
        {
            "text": "both converge to 1 3 as n grows, in contrast to the caterpillar case of Part (i) of 241 Proposition 1, where the limit is smaller (e.g. for k = 1, the limit is 2 9 ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "239"
        },
        {
            "text": "Notice also that the lower bounds on E D [\u03a6 ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "242"
        },
        {
            "text": "Conditional on K = k, the value p T is simply given (ignoring terms involving \u03bb of 260 higher than quadratic power) by:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "259"
        },
        {
            "text": "In particular,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "259"
        },
        {
            "text": "We have",
            "cite_spans": [],
            "ref_spans": [],
            "section": "259"
        },
        {
            "text": "Provided that \u03bbm << 1 we may approximate this last equation by:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "259"
        },
        {
            "text": "Thus, provided that m large and \u03bbm < 1 and using using \u00b5 K to estimate K (which is reasonable since m is large, and we are also assuming above that \u03bbn << 1) we obtain:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "259"
        },
        {
            "text": "and solving for \u03bb in this equation, and substituting the estimate of \u03bb into Eqn. (26) gives:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "259"
        },
        {
            "text": "T .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "259"
        },
        {
            "text": "Let us now multiply through by m (the number of characters) to get.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "259"
        },
        {
            "text": "The term on the left (mp T ) has a natural interpretation -it is simply the expected 264 number of characters that have evolved on T by 2 edge changes and that also satisfy the 265 three conditions (C-i)-(C-iii) above. By Equation (27), this can be approximated by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "259"
        },
        {
            "text": "T . Note that this quantity is independent of \u03bb (provided this is sufficiently small 267 that the above approximations are reasonable), and n also is not involved in the first term 268 in the product.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "259"
        },
        {
            "text": "Note that one cannot interpret mp T as the expected number of false splits in a 270 maximum compatibility tree involving the K perfectly evolved characters and the additional characters with 2 changes. This is because some of these latter characters may (c 1 ) P \u2286 P or P \u2286 P .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "269"
        },
        {
            "text": "(c 2 ) e does not lie in P and e does not lie in P .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "287"
        },
        {
            "text": "Proof: The proof involves a case analysis. In particular, we show that:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "288"
        },
        {
            "text": "(1) if (c 1 ) holds then f and f are compatible;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "289"
        },
        {
            "text": "(2) if (c 1 ) fails but (c 2 ) holds, then f and f are compatible; and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "290"
        },
        {
            "text": "(3) if (c 1 ) and (c 2 ) both fail to hold, then f and f are incompatible.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "291"
        },
        {
            "text": "To simplify notation we first introduce some conventions. We will let \u03c3 (respectively 293 \u03c3 ) denote the split of [n] induced by (reversing state) changes on e 1 and e 2 (respectively on e 1 and e 2 ). For subsets V 1 , . . . , V r of [n] we write V 1 \u00b7 \u00b7 \u00b7 V r |\u2212 as shorthand for the split 295 (V 1 \u222a \u00b7 \u00b7 \u00b7 \u222a V r )|([n] \u2212 (V 1 \u222a \u00b7 \u00b7 \u00b7 V r )), and if a subtree within T has leaf set A \u2282 [n] we will 296 denote this subtree by writing t(A). We will also assume that e 1 , e 2 , e 1 , e 2 are four distinct 297 edges (we deal with the case where this fails at the end). Case (1): Suppose that (c 1 ) holds. Without loss of generality we may assume that 299 P \u2286 P and that the order of the path from e 1 to e 2 passes through e 1 and e 2 in this order.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "292"
        },
        {
            "text": "Thus we can represent T as in Fig. 2(i) where A, B, C, D, E denote the (unions of the) leaf 301 sets of the corresponding subtrees determined by this arrangement of the four edges.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 30,
                    "end": 39,
                    "text": "Fig. 2(i)",
                    "ref_id": "FIGREF32"
                }
            ],
            "section": "300"
        },
        {
            "text": "Thus \u03c3 is the split ABDE|C, and \u03c3 is the split AE|BCD. Since the second half of 303 he first split (namely C) is a subset of the second half of the second split (BCD) these two 304 splits are compatible. Note that this argument also holds if one or both of the following 305 identities applies: e 1 = e 1 or e 2 = e 2 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "302"
        },
        {
            "text": "Case (2): Now suppose that (c 1 ) fails but (c 2 ) holds. In this case, by considering the 307 path between e 1 and e 2 we can represent T as in Fig. 2 Finally, we assumed that e 1 , e 2 , e 1 , e 2 are four distinct edges. Otherwise (since 326 e 1 = e 2 and e 1 = e 2 ) we either have: {e 1 , e 2 } = {e 1 , e 2 }, in which case condition (c 1 ) holds, 327 and the two characters f and f induce the same split and so are compatible, or we may 328 assume without loss of generality that e 1 = e 1 and e 2 = e 2 . A similar (though simpler) case 329 analysis to the above leads to the same conclusions as before. In general, it is mathematically complicated to describe FP T in terms of these 352 parameters. However, when the number of leaves in a tree grows faster than the number of 353 perfectly compatible characters, it is possible to state a limit result, in order to provide an 354 approximation to FP T for large trees.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 145,
                    "end": 151,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF32"
                }
            ],
            "section": "306"
        },
        {
            "text": "In the following theorem we consider the following setting: 356 I. m\u03be = \u0398(n \u03b2 ) for some 0 < \u03b2 < 1 2 , and 357 II. m\u03be 2 = O(1), 358 where O(1) refers to dependence on n (thus m\u03be 2 is not growing with n). Note that 359 Condition (I) implies that the number of perfectly-evolved characters grows with the 360 number of leaves, but at a rate that is slower than linearly. When \u03b2 1 2 , Condition (I) also provides a positive probability that more than one perfectly-evolved character will give rise 362 to the same non-trivial split. Conditions (I) and (II) imply that \u03be decreases as n increases. 363 We will show that in this setting, the false positive rate is (asymptotically) of the form \u03be 3 times a function \u2126 that involves T (via its shape), m and \u03be. To describe this result, we need to define this function \u2126. Let",
            "cite_spans": [
                {
                    "start": 128,
                    "end": 131,
                    "text": "358",
                    "ref_id": null
                },
                {
                    "start": 593,
                    "end": 596,
                    "text": "363",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "355"
        },
        {
            "text": "where \u00b5 = 1 2 m\u03be and where\u03c6 Tn (i) is given in Eqn.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "355"
        },
        {
            "text": "(2). For example, for any caterpillar tree, we have 364\u03c6",
            "cite_spans": [],
            "ref_spans": [],
            "section": "355"
        },
        {
            "text": ").",
            "cite_spans": [],
            "ref_spans": [],
            "section": "355"
        },
        {
            "text": "Notice that \u2126(T n , \u03be, m) depends on T n only via the coefficients\u03c6 Tn (i), and this 366 dependence in linear. Thus, if D is a distribution on trees (e.g. the PDA or YH) then the 367 expected value of \u2126(T n , \u03be, m) is given by:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "365"
        },
        {
            "text": "For the PDA distribution, the term E P DA [\u03c6 T (i)] has an explicit exact value, given 369 by Eqn. (9).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "365"
        },
        {
            "text": "Theorem 3 For each n 1, let T n be a binary phylogenetic tree with n leaves, and 371 suppose that Conditions (I) and (II) hold.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "370"
        },
        {
            "text": "(i)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "372"
        },
        {
            "text": "where o(1) is a term that tends to 0 as n grows. and so has expected value 1 2 m\u03be(1 + o(1))). As before, let K denote the number of distinct 378 non-trivial splits of T n that correspond to (one or more) of these perfectly evolved 379 characters. By Condition (I) it follows that each perfectly evolved character is (with 380 probability \u2192 1) generated at most once, and so K is approximated by X 1 , which in turn 381 is approximated (for large n) by a Poisson distribution with mean \u00b5 = 1 2 m\u03be.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "372"
        },
        {
            "text": "Consider now the splits that arise from 2-edge-change characters on T . Denote the 383 number of false splits by X 2 , and the number of true splits by X 2 . The expected value of 384 X 2 is of order m\u03be 2 /n and so it converges to zero as n grows, by Condition (II). By",
            "cite_spans": [],
            "ref_spans": [],
            "section": "382"
        },
        {
            "text": "Proposition 3 and Condition (II), the probability that every pair of the X 2 false splits is 386 compatible (with each other) tends to 1 as n grows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "385"
        },
        {
            "text": "Next, consider splits (true or false) that arise from characters involving 3 or more 388 changes on different edges. If X 3 denotes the number of such characters, then the expected 389 value of X 3 is bounded above by a constant (independent of n) times m\u03be 3 , and by 390 Conditions (I) and (II), the ratio of this to K is of order \u03be 2 (independent of n).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "387"
        },
        {
            "text": "Thus,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "391"
        },
        {
            "text": "where K has a Poisson distribution with expected value \u00b5 = m\u03be 2 , and O(1) refers to 393 a term that is bounded in n (by Condition (II)) and accounts for any non-trivial splits 394 induced by characters that are not perfectly evolved and in the reconstructed tree (as well 395 as for splits from perfectly evolved characters that are 'lost' in a strict consensus by being 396 the only such split in a path between the two edges of a 2-change character), while o(1) 397 refers to a term the tends to zero as n grows due to characters that involve 3 or more edge changes).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "391"
        },
        {
            "text": "Thus, P(K = k) = e \u2212\u00b5 \u00b5 k /k!, and so, under Conditions (I) and (II) we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "399"
        },
        {
            "text": "where \u03c1 := 1 \u2212 i n\u22123 . We now apply the identity: \u221e k=0",
            "cite_spans": [],
            "ref_spans": [],
            "section": "399"
        },
        {
            "text": "x k k!(k+1) = e x \u22121 x , with x = \u03c1\u00b5 to obtain:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "399"
        },
        {
            "text": "Since \u00b5 = m\u03be/2, notice that we can write the term \u03be 2 m 2 in Eqn. (29) as \u03be\u00b5 and so, from 401 Eqns. (29) and (30), we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "399"
        },
        {
            "text": "Finally, canceling the term \u00b5 in the numerator and denominator on the right-hand-side of 403 Eqn. (31) gives the expression in Part (i).",
            "cite_spans": [
                {
                    "start": 89,
                    "end": 92,
                    "text": "403",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "399"
        },
        {
            "text": "Part (ii): This follows directly from Part (i) by linearity of expectation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "404"
        },
        {
            "text": "Part (iii): When T n is a caterpillar tree we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "405"
        },
        {
            "text": "for 1 i n \u2212 3. We can rewrite this as:\u03c6 Tn (i) = 4 2n\u22123 \u00b7 1 \u2212 i n\u22122 , and substituting this into Part (i) we obtain: (1)).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "405"
        },
        {
            "text": "As n \u2192 \u221e we have the asymptotic identity:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "405"
        },
        {
            "text": "where x := e \u2212\u00b5/(n\u22123) .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "405"
        },
        {
            "text": "Now, x converges to 1 from below as n grows (under Conditions (I) and (II)), and 408 so applying the identity \u221e i=1 x i = x/(1 \u2212 x) (for 0 < x < 1), together with the identity 1 \u2212 x \u223c \u00b5/(n \u2212 3) \u223c \u00b5/n = m\u03be/2n (since \u00b5 = 1 2 m\u03be) gives:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "407"
        },
        {
            "text": "noting that the term (2\u03be/3)e \u2212\u00b5 is asymptotically negligible relative to the term it follows where ps(T, D) is the parsimony score of the tree T for the data. We will assume that 426 ps(T, D) << m.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "407"
        },
        {
            "text": "Now, we can write the likelihood function for T as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "427"
        },
        {
            "text": "428 L(T |D) = Q m\u2212n 0 0 \u00b7 Q m 1 \u00b7 q n 1 1 q 2n 2 2 \u00b7 \u00b7 \u00b7 q kn k k ,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "427"
        },
        {
            "text": "where Q 0 = \u03bd 2n\u22123\u2212ps(T,D) , Q 1 = k i=1 (1 \u2212 p i ) in i , q i = p i 1\u2212p i . Clearly, L(T |D) is maximised by setting \u03bd = 1 (regardless of the other parameters). Moreover, the log likelihood critical ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "427"
        },
        {
            "text": "T is a natural quantity to compare with the earlier \u03a6 ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "427"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "The ability of single genes vs full genomes to resolve time REFERENCES",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Dudas",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Bedford",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Public REFERENCES",
            "authors": [
                {
                    "first": "N",
                    "middle": [
                        "D"
                    ],
                    "last": "Grubaugh",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "B"
                    ],
                    "last": "Hodcroft",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Fauver",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "L"
                    ],
                    "last": "Phelan",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Cevik",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Probability distributions on cladograms",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Aldous",
                    "suffix": ""
                }
            ],
            "year": 1995,
            "venue": "Random Discrete",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Springer: IMA Volumes in 463 Mathematics and its Applications 76",
            "authors": [
                {
                    "first": "Eds",
                    "middle": [
                        "D"
                    ],
                    "last": "Structures",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Aldous",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Pemantle",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "1--18",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Maximum likelihood inference of phylogenetic trees, with special 465 reference to a Poisson process model of DNA substitution and to parsimony analysis",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Goldman",
                    "suffix": ""
                }
            ],
            "year": 1990,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "How a false positive split is inferred by maximum parsimony (MP). On true tree (top) sites 1-3 are binary and \"perfect\"; that is, they have only a single change (locations marked by black circles), but site 4 is binary and homoplastic, changing twice (open circles). The dotted line is the path between the two homoplastic changes in site 4. As long as perfect sites do not change along the dotted line path, a false positive split is inferred on the MP tree (bottom).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Tn (i) is given in Eqn. (2). For example, for any caterpillar tree, we have 172\u03c6 Tn (i) = 4(n \u2212 2 \u2212 i)/ 2n\u22123 2",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Tn , denoted E D [F P Tn ], satisfies E D [F P Tn ] = \u03be 3 \u00b7 E D [\u2126(T n , \u03be, m)] \u00b7 (1 + o(1)).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "'-alrt 1000'), aBayes, and ultrafast bootstrapping ('-B 1000'), with additional options 214 enforcing minimum branch lengths of 10 \u22129 and collapsed polytomies. Mean support across 215 replicates was computed. 216 Perfect four-taxon alignments were generated in which each of the five branches had 217 a single, non-homoplastic nucleotide substitution in the alignment and all other sites were 218 constant. Alignment lengths ranged between 40 nt and 30,000 nt. ML trees were inferred in 219",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "of assumptions tend to increase the expected false positive rate above the 323 predictions of Equation 6. For example, adding edge length (EL) variation or 324 across-site-rate (ASR) variation increases E D [FP Tn ] (Figs. 2, 4 and Fig. S4). The difference 325 between predicted E D [FP Tn ] based on Eqn. (6), with no edge length variation, and 326 simulation-based estimates with edge length variation included is small when \u03be << 1 but 327 increases substantially as \u03be increases. When edge length variation is large (gamma shape 328 parameter \u03b1 e = 0.1), there is no longer a local maximum value of E D [FP Tn ] around 329 \u03be = 0.1; instead, E D [FP Tn ] increases monotonically with \u03be and eventually exceeds 5% for 330 the simulated dataset sizes. The impact of ASR variation is deleterious at all values of \u03be, Mean false positive rate in four tree models. Fit to theoretical predictions from Equation 6 (or the limit expression of 4/3m for caterpillar trees: see Methods) are shown by dashed lines. Each point is mean of 1000 replicates \u00d7 100 sub-replicates. Simulation conditions were n = 513, m = 1000, with a JC69 model. Predicted values are not known for YH model.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Effect of edge length variation on expected false positive rate for different values of the shape parameter of the edge length gamma distribution, \u03b1e. Smaller values of \u03b1e correspond to higher rate variation. ASR variation is assumed absent. The dashed curve is the prediction from Eqn. (6), in which both sources of variation are absent. Simulation conditions assumed PDA trees with n = 513, m = 1000, 1000 replicates, 100 subreplicates. Gray rectangle shows \"near-perfect\" values of \u03be 1.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "Expected false positive rates, ED[FPT n ], for 11 empirical virus phylogenetic datasets",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "model conditions and higher rates, something we observed commonly in simulations in 391 which \u03be > \u03be * . However, simulations also suggest that in the near-perfect zone, MP can 392 achieve an E D [FP Tn ] comparable with ML but with much faster running times.393 Accuracy and Support in Near-perfect Trees 394 False positive \"accuracy\", defined as 1 \u2212 E D [FP Tn ], is very high in the near-perfect 395 zone of small tree lengths, whereas conventional support values are quite variable in this 396 zone under the same simulation conditions (Fig. 6). At very low \u03be, the average MP 397 bootstrap support is about the theoretically expected 64% for a single nonhomoplastic 398 substitution supporting an edge (Felsenstein, 1985). Model-based support measures had 399 higher values, with aBayes (Anisimova et al., 2011) being greater than ultrafast bootstrap 400 (Hoang et al., 2018), which, in turn, was greater than SH-aLRT (Guindon et al., 2010), but 401 only aBayes was close to 1 \u2212 E D [FP Tn ] across the range of tree lengths in the near-perfect zone.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "Statistical support measures compared to expected false positive accuracy. The red curve is the mean value of (1 \u2212 ED[FPT n ]) \u00d7 100 in simulations. The near-perfect parameter space is shaded.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": ".2B and Fig. 4. This accords with our simulation results suggesting 433 that the good \"near-perfect\" false positive rates may emerge even when relaxing the strict 434 near-perfect assumption of no rate variation-as long as \u03be 1.435 These and many other empirical findings about RNA virus phylogenies sampled 436 intensively in epidemics postdate much of the extensive body of other work on accuracy 437 and support in phylogenetics. Not surprisingly, little note has been made about the stark 438 contrast between false positive and false negative rates in phylogenies in which tree length 439 is well below the optimal tree length for \"overall accuracy\", since published examples have 440 been relatively rare. The goal of much of the field of phylogenetics is, after all, to maximize tree resolution, even if this effort requires adding (or switching to) sequence data with 442 more variation and thus longer tree lengths. 443 Because \"near-perfect\" datasets reflect a combination of the number of taxa and 444 sites, evolutionary rate and time parameters, and assumptions about the substitution 445 model, they also implicitly reflect sampling of the true tree, which is particularly relevant 446 in epidemic trees in which sampling is far below disease incidence. Sampling can continue 447 over time, increasing n, and the viruses continue to evolve over time, increasing the depth 448 of the tree. Both of these increase \u03be but in different ways; therefore, it is possible for the 449 same RNA virus to have near-perfect and not near-perfect datasets depending on the 450 study. For example, the SARS-Cov2 dataset we included had n = 583 and \u03be = 0.02, well 451 within the \"near-perfect\" zone, but a much more intensively sampled tree over a longer 452 period of time (Lanfear, 2020) with n = 147156 has a tree length of \u03be = 3.89 (after 453 collapsing any edges with \u03bb 1.1 \u00d7 10 \u22126 ), which is remarkably small for such a large tree 454 but lies just outside our definition of near-perfect. 455 Other mathematical results on phylogenetic accuracy have largely focused on either 456 the limiting case of infinite sequence length (\"consistency\"), or the number of sites needed 457 for accurate inference (the \"sequence length requirement\"). For MP, for example, the 458 shortest edge length is critical and lim m\u2192\u221e Prob(T M P = T ) = 1 as long as 459 \u03bb min > \u03be 2 /(1 \u2212 \u03be) (Steel, 2000, Thm. 1(A)). More generally, let m be the number of sites 460 needed for Prob(T M P = T ) to exceed some fixed required accuracy. For the 461 neighbor-joining method m grows exponentially with n (Lacey and Chang, 2006); for ML, 462 m is polynomial or better in n, depending on edge lengths (Roch and Sly, 2017).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF11": {
            "text": "find an optimal tree when, at most, some small number of sites exhibit homoplasy. Little of 475 this work has considered accuracy per se, butGronau et al. (Gronau et al., 2012)    476 highlighted the connection between short edge lengths and false positives, and developed a 477 \"fast converging\" algorithm (i.e., having an O(poly(n)) sequence length requirement) that 478 returns a tree with short edges collapsed when they do not meet a threshold probability of 479 being correct, thus minimizing false positives. The connection between this tree and those 480 built by more conventional methods is unclear, but it may be a promising approach for 481 trees in the near-perfect zone.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF13": {
            "text": "viral epidemics in this zone can be interpreted directly without defaulting to identifying 504 clades with strong support values. Frequent convergent evolution, and recombination in 505 positive-strand RNA viruses, can complicate phylogenetic inference and may increase the 506 false positive rate in real-world trees (Morel et al., 2020). Nonetheless, if individual clade 507 support needs to be invoked, we recommend Bayesian approaches that do not rely on 508 bootstrap resampling of sparse substitutions. 509 The benefit of real-time viral genomic sequencing for public health action became 510 apparent during the 2014-2015 West African Ebola epidemic (Gire et al., 2014), and is a 511 critical component of tracking the COVID-19 pandemic (Oude Munnink et al., 2020; 512Grubaugh et al., 2021). Consequently, the viruses responsible for these diseases, Ebolavirus 513 and SARS-CoV-2, epitomize near-perfect phylogenetic trees in our analysis. We can expect 514 a greater intensity of genomic sequencing accompanying future viral outbreaks, increasing 515 the importance and relevance of near-perfect phylogenies.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF14": {
            "text": "have no conflicts of interest related to this work. and space in outbreak analysis. BMC Evol Biol 19:232. 552 Dudas, G., L. M. Carvalho, T. Bedford, A. J. Tatem, G. Baele, N. R. Faria, D. J. Park, 553 J. T. Ladner, A. Arias, D. Asogun, F. Bielejec, S. L. Caddy, M. Cotten, J. D'Ambrozio, 554 S. Dellicour, A. Di Caro, J. W. Diclaro, S. Duraffour, M. J. Elmore, L. S. Fakoli, 555 O. Faye, M. L. Gilbert, S. M. Gevao, S. Gire, A. Gladden-Young, A. Gnirke, A. Goba, 556 D. S. Grant, B. L. Haagmans, J. A. Hiscox, U. Jah, J. R. Kugelman, D. Liu, J. Lu, 557 C. M. Malboeuf, S. Mate, D. A. Matthews, C. B. Matranga, L. W. Meredith, J. Qu, 558 J. Quick, S. D. Pas, M. V. T. Phan, G. Pollakis, C. B. Reusken, M. Sanchez-Lockhart, 559 S. F. Schaffner, J. S. Schieffelin, R. S. Sealfon, E. Simon-Loriere, S. L. Smits, 560 K. Stoecker, L. Thorne, E. A. Tobin, M. A. Vandi, S. J. Watson, K. West, S. Whitmer, 561 M. R. Wiley, S. M. Winnicki, S. Wohl, R. Wolfel, N. L. Yozwiak, K. G. Andersen, S. O. 562 Blyden, F. Bolay, M. W. Carroll, B. Dahn, B. Diallo, P. Formenty, C. Fraser, G. F. Gao, 563 R. F. Garry, I. Goodfellow, S. Gunther, C. T. Happi, E. C. Holmes, B. Kargbo, S. Keita, 564 P. Kellam, M. P. G. Koopmans, J. H. Kuhn, N. J. Loman, N. Magassouba, D. Naidoo, 565 S. T. Nichol, T. Nyenswah, G. Palacios, O. G. Pybus, P. C. Sabeti, A. Sall, U. Stroher, 566 I. Wurie, M. A. Suchard, P. Lemey, and A. Rambaut. 2017. Virus genomes reveal factors 567 that spread and sustained the Ebola epidemic. Nature 544:309-315. 568 Dyrdak, R., M. Mastafa, E. B. Hodcroft, R. A. Neher, and J. Albert. 2019. Intra-and 569 interpatient evolution of enterovirus D68 analyzed by whole-genome deep sequencing.570 Virus Evolution 5:vez007. 571 Efron, B., E. Halloran, and S. Holmes. 1996. Bootstrap confidence levels for phylogenetic 572 trees. Proceedings of the National Academy of Sciences of the United States of America 573 93:13429-13434. 574 Erd\u00f6s, P. L., M. A. Steel, L. A. Szekely, and T. J. Warnow. 1999. A few logs suffice to 575 build (almost) all trees (i). Random Structures and Algorithms 14:153-184 mAR. Felsenstein, J. 1973. Maximum likelihood and minimum steps methods for estimating 577 evolutionary trees from data on discrete characters. Syst. Zool. 22:240-249. Felsenstein, J. and H. Kishino. 1993. Is there something wrong with the bootstrap on 582 phylogenies? a reply to Hillis and Bull. Systematic Biology 42:182-192. 583 Fernandez-Baca, D. and J. Lagergren. 2003. A polynomial-time algorithm for near-perfect 584 phylogeny. Siam Journal on Computing 32:1115-1127. 585 Gire, S. K., A. Goba, K. G. Andersen, R. S. Sealfon, D. J. Park, L. Kanneh, S. Jalloh, 586 M. Momoh, M. Fullah, G. Dudas, S. Wohl, L. M. Moses, N. L. Yozwiak, S. Winnicki, 587 C. B. Matranga, C. M. Malboeuf, J. Qu, A. D. Gladden, S. F. Schaffner, X. Yang, P. P. 588 Jiang, M. Nekoui, A. Colubri, M. R. Coomber, M. Fonnie, A. Moigboi, M. Gbakie, F. K. 589 Kamara, V. Tucker, E. Konuwa, S. Saffa, J. Sellu, A. A. Jalloh, A. Kovoma, J. Koninga, 590 I. Mustapha, K. Kargbo, M. Foday, M. Yillah, F. Kanneh, W. Robert, J. L. Massally, 591 S. B. Chapman, J. Bochicchio, C. Murphy, C. Nusbaum, S. Young, B. W. Birren, D. S. 592 Grant, J. S. Scheiffelin, E. S. Lander, C. Happi, S. M. Gevao, A. Gnirke, A. Rambaut, 593 R. F. Garry, S. H. Khan, and P. C. Sabeti. 2014. Genomic surveillance elucidates Ebola health actions to control new SARS-CoV-2 variants. Cell 184:1127-1132. 602 Grubaugh, N. D., J. T. Ladner, P. Lemey, O. G. Pybus, A. Rambaut, E. C. Holmes, and 603 K. G. Andersen. 2019. Tracking virus outbreaks in the twenty-first century. Nat 604 Microbiol 4:10-19.605 Guindon, S., J. F. Dufayard, V. Lefort, M. Anisimova, W. Hordijk, and O. Gascuel. 2010. 606 New algorithms and methods to estimate maximum-likelihood phylogenies: assessing the 607 performance of PhyML 3.0. Syst Biol 59:307-21. 608 Gusfield, D. 1997. Algorithms on strings, trees and sequences. Cambridge University Press, 609 New York. 610 Hadfield, J., A. F. Brito, D. M. Swetnam, C. B. F. Vogels, R. E. Tokarz, K. G. Andersen, 611 R. C. Smith, T. Bedford, and N. D. Grubaugh. 2019. Twenty years of West Nile virus 612 spread and evolution in the Americas visualized by Nextstrain. PLoS Pathogens 613 15:e1008042. 614 Hadfield, J., C. Megill, S. M. Bell, J. Huddleston, B. Potter, C. Callender, P. Sagulenko, 615 T. Bedford, and R. A. Neher. 2018. Nextstrain: Real-time tracking of pathogen 616 evolution. Bioinformatics 34:4121-4123. 617 Hillis, D. M. and J. J. Bull. 1993. An empirical test of bootstrapping as a method for 618 assessing confidence in phylogenetic analysis. Systematic Biology 42:182-192. 619 Hoang, D. T., O. Chernomor, A. von Haeseler, B. Q. Minh, and L. S. Vinh. 2018.620 UFBoot2: Improving the ultrafast bootstrap approximation. Molecular Biology and 621 Evolution 35:518-522. Huelsenbeck, J. P. and D. M. Hillis. 1993. Success of phylogenetic methods in the 4-taxon 623 case. Systematic Biology 42:247-264. Methods 14:587-589. 627 Katoh, K. and D. M. Standley. 2013. MAFFT multiple sequence alignment software 628 version 7: improvements in performance and usability. Mol Biol Evol 30:772-80. 629 Lacey, M. R. and J. T. Chang. 2006. A signal-to-noise analysis of phylogeny estimation by 630 neighbor-joining: insufficiency of polynomial length sequences. Mathematical Biosciences 631 199:188-215. 632 Lanfear, R. 2020. A global phylogeny of SARS-CoV-2 sequences from GISAID. 633 Minh, B. Q., H. A. Schmidt, O. Chernomor, D. Schrempf, M. D. Woodhams, A. von 634 Haeseler, and R. Lanfear. 2020. IQ-TREE 2: New models and efficient methods for 635 phylogenetic inference in the genomic era. Molecular Biology and Evolution 636 37:1530-1534. 637 Morel, B., P. Barbera, L. Czech, B. Bettisworth, L. Hubner, S. Lutteropp, D. Serdari, 638 E. G. Kostaki, I. Mamais, A. M. Kozlov, P. Pavlidis, D. Paraskevis, and A. Stamatakis. 639 2020. Phylogenetic analysis of SARS-CoV-2 data is difficult. Molecular Biology and 640 Evolution . 641 Oude Munnink, B. B., D. F. Nieuwenhuijse, M. Stein, A. O'Toole, M. Haverkate, 642 M. Mollers, S. K. Kamga, C. Schapendonk, M. Pronk, P. Lexmond, A. van der Linden, 643 T. Bestebroer, I. Chestakova, R. J. Overmars, S. van Nieuwkoop, R. Molenkamp, A. A. 644 van der Eijk, C. GeurtsvanKessel, H. Vennema, A. Meijer, A. Rambaut, J. van Dissel, 645 R. S. Sikkema, A. Timen, M. Koopmans, and t. Dutch-Covid-19 response. 2020. Rapid 646 SARS-CoV-2 whole-genome sequencing and analysis for informed public health 647 decision-making in the Netherlands. Nature Medicine 26:1405-1410. star tree. Systematic Biology 57:602-612. 675 Susko, E. 2009. Bootstrap support is not first-order correct. Systematic Biology 676 58:211-223. 677 Tuffley, C. and M. Steel. 1997. Links between maximum likelihood and maximum 678 parsimony under a simple model of site substitution. Bulletin of Mathematical Biology 679 59:581-607. 680 Wake, D. B., M. H. Wake, and C. D. Specht. 2011. Homoplasy: From detecting pattern to 681 determining process and mechanism of evolution. Science 331:1032-1035. 682 Warnow, T. 2013. Large-scale multiple sequence alignment and phylogeny estimation. 683 Pages 85-146 in Models and algorithms for genome evolution (C. Chauve, 684 N. El-Mabrouk, and E. Tannier, eds.). Springer, London. 685 Yang, Z. 1998. On the best evolutionary rate for phylogenetic analysis. Let B(n) denote the set of unrooted binary phylogenetic trees with leaf set 3 [n] = {1, 2, . . . , n}. Thus, B(n) = (2n \u2212 5)!!. Note that a tree T \u2208 B(n) has 2n \u2212 3 edges. 4 Consider a Jukes-Cantor model in which all edges have the same value of \u03bb. Thus, the 5 probability of a state change between the endpoints of an edge e, denoted p e , is given by 6 p e = p where p = 3 4 (1 \u2212 exp(\u22124\u03bb/3)). 7 A character refers to the assignment of states to the taxa at a given site of an 8 alignment. Let us say that a character evolves 'perfectly' on T if there is a single change of 9 state across one interior edge (say e) and no change of state any other edge of T . The 10 probability that this occurs for any given interior edge e is: p e e =e (1 \u2212 p e ) = p(1 \u2212 p) 2n\u22124 . 11 Note that this probability does not depend on the particular choice of e or on the shape of 12 T . Note also that a perfectly evolved character has at least two species present in each 13 state (otherwise the change would have been on a pendant edge of T ). 14 We will say that a character f evolves on T with c edge changes on e 1 , . . . , e c if 15 state changes occur on edges e 1 , . . . , e c and on no other edge of T . More briefly, we say that 16 f evolves on T with c edge changes if f evolves with c edge changes for some set of c 17",
            "latex": null,
            "type": "figure"
        },
        "FIGREF15": {
            "text": "Given a tree T \u2208 B(n), let d T (e 1 , e 2 ) denote the number of edges of T that lie strictly within the path between e 1 and e 2 (i.e. excluding e 1 and e 2 ). Thus, e 1 and e 2 are 43 adjacent if and only if d T (e 1 , e 2 ) = 044 Next, given T \u2208 B(n), let \u03d5 T = (\u03d5 T (0), \u03d5 T (1), . . . , \u03d5 T (n \u2212 3)) where \u03d5 T (i)is the 45 number of (unordered) pairs of edges {e, e } of T for which d T (e, e ) = i. Thus 46 \u03d5 T (0) = 3(n \u2212 2), however the other values comprising \u03d5 T depend on the shape of T . In particular, for a complete balanced binary tree with n = 2 h leaves we have \u03d5 T (i) = 0 for all 48 i 2 log 2 (n) \u2212 2, while for a caterpillar tree with the same number of leaves we have 49 \u03d5 T (i) > 0 for all i n \u2212 3.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF17": {
            "text": "since both sides of this equation count the number of pairs of edges of T . For i",
            "latex": null,
            "type": "figure"
        },
        "FIGREF18": {
            "text": "interior edge e. Then f and f are compatible (i.e. induce compatible splits) if and only if e63",
            "latex": null,
            "type": "figure"
        },
        "FIGREF19": {
            "text": "(including the stem 70 edge of that subtree), say subtree t i for i \u2208 {0, 1, . . . , r + 1}. We consider the possible 71 cases: (1) e \u2208 {e 1 , e 2 }, or (2) e is an edge of t 0 or t r+1 or (3) e is an edge of t i or its stem 72 edge for i \u2208 {1, . . . , r}. Let X i \u2282 [n] denote the subset of leaves of T that are leaves of t i .73In case (1), it suffices by symmetry to consider the case e = e 1 . Then f induces the74 full split X 0 |([n] \u2212 X 0 ) while f induces the full split (X 0 \u222a X r+1 )|([n] \u2212 (X 0 \u222a X r+1 ))and 75 these two splits are compatible, since the set on the left of the first split is contained in the 76 set on the left of the second split. 77 In case (2), it suffices by symmetry to consider the case where e is an edge of t 0 . In 78 that case f induces a full split of the for Y |([n] \u2212 Y ) where Y \u2286 X 0 , and this split is again 79 compatible with the full split (X 0 \u222a X r+1 )|([n] \u2212 (X 0 \u222a X r+1 )) induced by f since Y is a 80 subset of the left part of this split. 81 In case (3), suppose that e is an edge of t i or its stem edge. In that case, f induces 82 the split W |([n] \u2212 W ) where W \u2286 X i , and since X 0 \u222a X r+1 \u2286 [n] \u2212 W it follows that f is 83 compatible with f . This completes the proof of Lemma 1. be the probability that a character f that has evolved on T with 2 85 edge changes has the following three additional properties: 86 (C-i) it is a binary character, 87 (C-ii) the corresponding split is not a split of T , and88",
            "latex": null,
            "type": "figure"
        },
        "FIGREF20": {
            "text": ". Firstly, let C T be the collection of all 95 (unordered) pairs of non-adjacent edges in T . Thus |C T | = T (e 1 , e 2 ) = d T (e 1 , e 2 ) n \u2212 3 ,",
            "latex": null,
            "type": "figure"
        },
        "FIGREF21": {
            "text": "A representation of T determined by the pair {e1, e2} on which changes of state occur for character f . When f is a binary character, a perfectly evolved character f will be compatible with f provided f corresponds to a change of state on an edge in the green portions of the tree; otherwise, if the change is on one of the r \u2212 1 edges marked in red, the two characters will be incompatible.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF22": {
            "text": "Proof: Part (i): Under the Jukes-Cantor model, the (conditional) probability that a 103 randomly evolved character f is binary, given that is has evolved on T with 2 edge changes 104 is 1 3 . To see this, let e 1 , e 2 denote the two edges on which there are state changes. Then if 105 the state at the left-hand end vertex of e 1 (as shown in Fig. 1) is \u03b1 and the state on the 106 right end vertex of e 1 is \u03b2 then for f to be a binary character we require e 2 to involve the 107 transition from \u03b2 back to \u03b1 (which is one of the three possible other states that \u03b2 can 108 change to on e 2 , and each change has equal probability under the Jukes-Cantor model). 109 Now consider a single random character f that has perfectly evolved on T . Since 110 (a) each of the n \u2212 3 interior edges of T has the same probability of being the 'change 111 edge' associated with f , and (b) f is compatible with f if and only if the associated 112 change edge for that character does not lie on the path that is (strictly) between e 1 and e 2 113 (by Lemma 1) and (c) the proportion of interior edges of T that do not lie strictly between 114the edges e 1 and e 2 is 1 \u2212 R T (e 1 , e 2 ), it follows that the probability that f is compatible 115 with f is 1 \u2212 R T (e 1 , e 2 ).116Thus, for k characters that have independently perfectly evolved on T the 117 probability that each of them is compatible with f is (1 \u2212 R T (e 1 , e 2 )) k .118Finally, each choice for f across all pairs of edges of T (nor just the non-adjacent 119 pairs) has equal probability, and if we let \u03b7(e 1 , e 2 ) = 1 if {e 1 , e 2 } are not adjacent, and 0 120 otherwise, then the probability that f satisfies properties (C-i), (C-ii) and (C-iii) above is the average value of 1 3 \u00b7 \u03b7(e 1 , e 2 ) \u00b7 (1 \u2212 R T (e 1 , e 2 )) k across all 2n",
            "latex": null,
            "type": "figure"
        },
        "FIGREF23": {
            "text": "Theorem 2(i) shows that for fixed k and n, the shape of T plays a 131 significant role in determining \u03a6(k) T ; in particular, pectinate trees (such as caterpillars) will 132 have a smaller value of \u03a6 (k) T than more balanced trees. Indeed, it is possible to exactly 133 calculate the value of \u03a6 (k) T for the two extreme families: caterpillars and fully-balanced 134 trees to determine the extent of this dependence, as we describe in the next section. Notice 135 also that the exact computation of \u03a6 (k)",
            "latex": null,
            "type": "figure"
        },
        "FIGREF24": {
            "text": "Proof: Part (i): For n 4 any path of length in T n that lies strictly between two edges {e, e } is a path of interior edges, and there are precisely four such pairs of edges that correspond to the same path. Moreover, the number of interior edge paths of T n of length n \u2212 3 \u2212 j is j + 1 for each j between 0 and n \u2212 algebraic manipulation leads to the stated expression. The last part of 148 (i) follows from the asymptotic identity: n j=1 j k \u223c n k+1 k . let U h i be the set of edges e of T h , excluding the stem edge, for which 151 there are exactly i 0 edges strictly between e and the stem edge. If we also let 152 u (h) (i) = |U h i | then it is easily seen that:",
            "latex": null,
            "type": "figure"
        },
        "FIGREF25": {
            "text": "i h) leads to the expression for 164 \u03d5 T (h) given in Part (ii). 165 Part (iii): Eqn. (8) follows by linearity of expectation (and interchanging the order 166 of expectation operators).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF26": {
            "text": "Let T be a tree in B(n) sampled from the PDA or YH distribution. Then, 186",
            "latex": null,
            "type": "figure"
        },
        "FIGREF27": {
            "text": "Part (i): For T \u2208 B(n) let N A(T ) be the collection of (unordered) pairs 191 {e 1 , e 2 } of non-adjacent edges of T .",
            "latex": null,
            "type": "figure"
        },
        "FIGREF28": {
            "text": "(14) we consider the coefficient of x n in F (x) 2 221 (i.e. [x n ]F (x) 2 ) by considering the three terms on the right of Eqn. (20). For the first term 222 of Eqn. (20), Eqn. (17)) gives: \u03bd (x) 2 = 1 1\u22122x and so 223 [x n ]x 2 \u03bd (x) 2 = [x n\u22122 ]\u03bd (x) 2 = [x n\u22122 ](1 \u2212 2x) \u22121 = 2 n\u22122 .",
            "latex": null,
            "type": "figure"
        },
        "FIGREF29": {
            "text": "corresponding terms in Eqn (20) allows us now to determine the expression for |\u2126| 227 given by Eqn. (14), as follows: the expression for |\u2126| given by Eqn. (24) into Eqn. (12) and rearranging 230 terms, gives the claimed expression for E P DA [E C T [R T ]].",
            "latex": null,
            "type": "figure"
        },
        "FIGREF30": {
            "text": "] allow k to grow faster with n for YH 243 trees than PDA (essentially because in a Yule tree, there are on average fewer edges on 244 paths between leaves, so fewer 'red' edges on the path between e 1 , e 2 (seeFig. 1). In this245 lower bound we are undercounting by ignoring the red portions to the left of e 1 and right 246 of e 2 by considering only cases where e 1 and e 2 are both pendant edges (this undercounting 247 is valid since we are stating a lower bound on E D [\u03a6 Theorem 2 describes the probability that a single character satisfies the 250 three conditions (C-i)-(C-iii) above, conditional on this character having evolved on T 251 with 2 edge changes (thus \u03a6 (k) T should be viewed as a conditional probability). This raises 252 two further natural question: for a given character, what is the probability p T that such a 253 character will evolve so as to satisfy conditions (Ci)-(Ciii)? And how many such characters 254 should we expect to see? For these questions, the number k of perfectly evolved characters 255 should now be treated as a random variable, K. Thus, let K be the random variable 256 corresponding to the number of distinct (and nontrivial) splits generated from those 257 characters (from within the m characters in total) that have perfectly evolved on T . The 258 variable K lies between 0 and m. Let \u00b5 K be the expected value of K.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF31": {
            "text": "be incompatible with each other (even though they are compatible with the K perfectly 273 evolved characters).274The case where > 1 binary characters evolve with 2 edge changes on T275 So far we have considered the impact of a single binary character that has evolved 276 on T with 2 edge changes. What happens if there is more than one such character? In 277 particular, when will two such characters (which induce false splits) be compatible with 278 each other? The following result provides a concise characterisation. This result is also 279 relevant to case for more than two such characters, since a collection of binary characters is 280 compatible if and only if every pair of characters is compatible. 281 Proposition 3 Suppose that f and f are two binary characters that have evolved on T , 282 each with with 2 edge changes (say e 1 , e 2 for f and e 1 and e 2 for f ). Let P (respectively, 283 P ) denote the set of edges in the path in T consisting of e 1 , e 2 (respectively e 1 and e 2 ) and 284 the edges on the path between them. Then f and f are compatible if and only if either 285 one of the following two conditions holds: 286",
            "latex": null,
            "type": "figure"
        },
        "FIGREF32": {
            "text": "The cases for the proof of Proposition 3",
            "latex": null,
            "type": "figure"
        },
        "FIGREF33": {
            "text": "(ii) and e 1 and e 2 either both lie the 308 subtree t(A) or t(C) or else e 1 lies in t(B i ) and e 2 lies in t(B j ) for some i, j (we allow i = j) 20 First suppose that e 1 , e 2 both lie within t(A). Then \u03c3 = A |\u2212 for a subset of A of 310 A and since \u03c3 = AC|B these two splits are compatible. A similar argument holds if e 1 , e 2 311 both lie within t(C). Alternatively, suppose that e 1 is an edge in t(B i ) and e 2 is an edge of 312 t(B j ) (we allow i = j). Then \u03c3 = B |\u2212 for a subset of B, and since \u03c3 = AC|\u2212 these two 313 splits are also compatible (since B \u2229 (A \u222a C) = \u2205).314Case(3): Finally suppose that Case (c 1 ) and Case (c 2 ) both fail. Without loss of 315 generality we may assume that e 1 lies within P . In this case we can represent tree T as316 shown in Fig. 2(iii). Thus \u03c3 = (A \u222a D)|\u2212. 317 By the assumption that Case (c 1 ) and Case (c 2 ) both fail, it follows that e 2 lies in 318 one of the following trees t(A), t(D), t(B i ), or t(C j ), for some i, j. By symmetry, there are 319 just two sub-cases to consider: (i) e 2 lies in t(A) or (ii) e 2 lies in t(B i ). In subcase (i) 320 \u03c3 = CDA |\u2212 where A is a proper subset of A, and C is the union of the leaf sets in 321 C 1 , . . . C s . Thus \u03c3 = CDA |\u2212 is incompatible with \u03c3 = AD|\u2212 since neither of the sets on 322 the left of the split contains the other. 323 In subcase (ii), \u03c3 = B CD|\u2212 for a proper subset B of B (the strict containment is 324 because e 1 and e 2 are not adjacent) and so again \u03c3 and \u03c3 are incompatible.325",
            "latex": null,
            "type": "figure"
        },
        "FIGREF34": {
            "text": "A consequence of Proposition 3 and our earlier results is that if n is large 332 in comparison to k then a small number ( ) of 2-state characters evolved randomly on T 333 are likely to be (i) compatible with each other, (ii) compatible with the k perfectly evolved 334 characters, and (iii) not be splits of T , and thus show up as false splits on the 335 reconstructed (max compatabiilty or max parsimony) tree. To see this, observe first that the probability that (c 2 ) occurs tends to 1 as n \u2192 \u221e for fixed k (this holds for any choice 337 of T , or a randomly sampled tree from the PDA or YH distribution \u2020 . Second, a collection 338 of binary characters is compatible if and only if each pair of them is compatible, and so if 339 and k are fixed (or grow sufficiently slowly with n, depending on the tree shape) the 340 probability that all false splits of T are present in the MP or MC tree (along with the 341 splits corresponding to the k perfectly compatible characters of T ) tends to 1 as n \u2192 \u221e. 342 Estimating the false positive rate 343 Given a binary phylogenetic tree T , and m characters evolved randomly on T by 344 the model described earlier, the false positive rate (FP T ) is the expected value of the 345 proportion of non-trivial splits in the reconstructed tree (using MC, say) that are not in T 346 (here we assume that if the reconstructed tree is a star, this proportion (which is 347 technically 0/0) is zero). Recall that \u03be is the expected number of state changes in the tree 348 T per character, under the model described earlier. FP T is a function of the three 349 parameters T (specifically, its shape and number of leaves), m and \u03bb (equivalently, FP T is 350 a function of T , m and \u03be).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF36": {
            "text": "ii) If T n is sampled from a distribution D (e.g. PDA, YH) then the expected value ofFP Tn , denoted E D [FP Tn ], satisfies E D [FP Tn ] = \u03be 3 \u00b7 E D [\u2126(T n , \u03be, m)] (1 + o(1)).Proof: Part (i): For convenience, we will write T in place of T n The number X 1 of 375 perfectly evolved characters on T has a binomial distribution (m trials, with the probability 376 of success of \u03be 2 (1 + o(1)) (since the proportion of interior edge in T is (n \u2212 3)/(2n \u2212 3)",
            "latex": null,
            "type": "figure"
        },
        "FIGREF37": {
            "text": "Eqn. (33) under Conditions (I) and (II). This completes the proof. T \u2208 B(n) and a data set D consisting of a sequence of m characters. Let n i 415 be the number of these characters that have parsimony score i on T , for i 0 (thus n 0 is 416 the number of constant-state characters present in the data, n 1 is the number of characters 417 present that could have perfectly evolved on T etc). We will assume that (i) each character 418 has a unique most-parsimonious representation on T and (ii) no edge is involved in a state 419 change for more than one character (under a most-parsimonious representation on T ).420These conditions are reasonable under conditions (1) and (2) described earlier for 421 large n, where n 0 >> n 1 >> n 2 . . . and where m grows more slowly than n so changes on 422 edges are likely to be 'well-spaced'. We consider a likelihood setting where an edge counted 423 by n i has probability p i and an edge not used in any most parsimonious reconstruction has i = ps(T, D),",
            "latex": null,
            "type": "figure"
        },
        "FIGREF38": {
            "text": "0 for all i 1; in particular, the optimal p i values are all equal, and applying429    Eqn.(34)  shows that L(T |D) is then a monotone decreasing function of ps(T, D). In this 430 case, as noted in (2) (p. 353), the MP tree(s) maximize this optimal likelihood score.431 Appendix 2: The probability a false split does not appear 432 Now consider any given binary tree T , a character f that has evolved on T by 2 433 edge changes on e 1 , e 2 , together with k perfectly evolved characters on T (with all the 434 characters independently evolved under the Jukes-Cantor model with p e constant across 435 the edges of T ). (e 1 , e 2 ) be the probability that f satisfies conditions (C-i) and (C-ii) above 437 (i.e. it is binary, and corresponds to a split that is not in T ), and this split does not occur 438 in either the MP (or MC) tree for the data that consists of f together with k perfectly 439 evolved characters. In the case of ties (in constructing the MP or MC tree) (1 \u2212 R T (e 1 , e 2 )) k \u2212 1 2 kR T (e 1 , e 2 )(1 \u2212 R T (e 1 , e 2 )) k\u22121 . Proof: Let B be a binomial random variable consisting of k trials, with the 442 probability of success on each trial of R T (e 1 , e 2 ) = d T (e 1 ,e 2 ) (e 1 , e 2 ) = 1 3 1 \u2212 P(B = 0) \u2212 1 2 P(B = 1) . The factor of 1/2 is to allow for the breaking 444 of a tie when B = 1 between the two MC (or MP) trees.445Observe that if e 1 and e 2 are adjacent, then R T (e 1 , e 2 ) = 0 and so P(be the expected value of \u03a8 (k)T (e 1 , e 2 ) across all pairs of edges {e 1 , e 2 }.448Thus, \u03a8",
            "latex": null,
            "type": "figure"
        },
        "FIGREF39": {
            "text": "Mean expected false positive rate in the near-perfect zone of \u03be 1 for three different breadths of MP tree search algorithm for a PDA distribution of trees (1,10, and 100 random addition sub-replicates per simulation replicate; 1000 simulation replicates). Predicted values from Eqn. 2 (main text) is given by dashed line. Effect of across-site-rate variation on expected false positive rate for MP inference for different values of the \u03b1ASR shape parameter of the ASR gamma distribution. Smaller \u03b1 values have higher rate variation. Edge length variation is assumed absent. Dashed curve is the prediction from Eqn. 2 (main text), in which both sources of variation are absent. Tree search algorithm has 100 subreplicates per simulation replicate; Effect of model complexity on expected false positive rates for MP. JC69 model (open circles) corresponds to near-perfect assumptions in shaded box (\u03be 1). HKY model (closed triangles) has a transition:transversion ratio of 5 and equal base frequencies. HKY+ASR+EL model (closed diamonds) has a transition:transversion ratio of 5 and also rate variation across sites (\u03b1ASR = 1) and edges ((\u03b1e = 1)). Points are means of 1000 replicates \u00d7 100 sub-replicates. Mean false positive rates estimated for 11 viral phylogenetic data sets, as a function of \u03be and other parameters estimated from the data. Simulations used parameters given in",
            "latex": null,
            "type": "figure"
        },
        "FIGREF40": {
            "text": "Five measures of clade support estimated on perfect four-taxon trees as alignment length varies. Each edge of the tree has exactly one site with a substitution on that edge; all other sites are constant. Support metrics using bootstrap resampling are denoted with solid shapes.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "Full Bayesian inference was also performed in MrBayes",
            "latex": null,
            "type": "table"
        },
        "TABREF1": {
            "text": "the Bayesian Information Criterion (BIC) inIQTree2 (Kalyaanamoorthy et al., 2017).Edge length (per site) variation was assumed to follow a gamma distribution: which was shown by Bedford and Hartl for an equivalent parameterization(Bedford and   Hartl, 2008). Virus trees were preprocessed, setting any edge lengths < 1.1 \u00d7 10 \u22126 to zero, assuming these reflected ML numeric artifacts. Then, \u03bb was estimated from the observed sum of per site edge lengths divided by 2n \u2212 3, and Eqn. 5 was then used to estimate \u03b1 e .Ideally, we would fit the data to the random tree model, but standard methods",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "leaves. Each of the 2n \u2212 3 edges of T have length \u03bb, and thus the total tree length is",
            "latex": null,
            "type": "table"
        },
        "TABREF3": {
            "text": "S1) and used simulation to estimate expected false positive",
            "latex": null,
            "type": "table"
        },
        "TABREF4": {
            "text": "Parameters of 11 empirical virus phylogenies",
            "latex": null,
            "type": "table"
        },
        "TABREF6": {
            "text": "Bayesian estimates and those that use bootstrap resampling, in light of our other results, suggests that resampling methods used in the presence of splits defined by only a single informative site may fail to integrate relevant information about low tree lengths.",
            "latex": null,
            "type": "table"
        },
        "TABREF7": {
            "text": ". The aBayes method corresponds well to what is implied by 1 \u2212 E D [FP Tn ], but resampling methods using either likelihood or parsimony correspond less well. The connection between phylogenetic accuracy and support in frequentist and Bayesian settings has been studied in detail(Felsenstein, 1985; Hillis and",
            "latex": null,
            "type": "table"
        },
        "TABREF8": {
            "text": "k) n=number of leaves; m=number of sites; \u03be=tree length; Res=Fractional resolution on tree; r XY =rate parameter of the GTR matrix from base X to Y ;f X =frequency of base X; \u03b1e=edge rate variation gamma shape parameter; \u03b1ASR=across-site rate variation gamma shape parameter; pINV=fraction of invariant sites",
            "latex": null,
            "type": "table"
        },
        "TABREF9": {
            "text": "and are for MP assuming ASR variation follows either an invariant sites model (circles) or a gamma distributed model (triangles), with higher likelihood model point shaded, all assuming a PDA distribution of trees (100 subreplicates per simulation replicate; 500 simulation replicates). Near-perfect zone of \u03be 1 is shaded. Horizontal dashed line indicates a 0.05 FP rate.Fig. 7. Mean false positive rate in the near-perfect zone of \u03be 1 for maximum likelihood searches in IQTree2 using different search breadths and corrections. Each point is the mean in 500 replicate simulations with a PDA distribution of trees. Open plusses: one subreplicate search per simulation replicate; open triangles: one subreplicate plus 3-state correction; open circles: 10 subreplicate searches plus 3-state correction and trees combined via strict consensus. closed squares:100 subreplicate searches plus 3-state correction and trees combined via strict consensus.The \"3-state correction\" collapses edges less than 1/m substitutions per site, prior to consensus (m = 1000 sites). For comparison to theory for MP, predicted values from Eqn. 2 are given by dashed line.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": []
}