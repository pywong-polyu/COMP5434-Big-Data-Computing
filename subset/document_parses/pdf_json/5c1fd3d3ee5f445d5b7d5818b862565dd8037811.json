{
    "paper_id": "5c1fd3d3ee5f445d5b7d5818b862565dd8037811",
    "metadata": {
        "title": "Observation data compression for variational assimilation of dynamical systems",
        "authors": [
            {
                "first": "Sibo",
                "middle": [],
                "last": "Cheng",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Imperial College London",
                    "location": {
                        "country": "UK"
                    }
                },
                "email": ""
            },
            {
                "first": "Didier",
                "middle": [],
                "last": "Lucor",
                "suffix": "",
                "affiliation": {
                    "laboratory": "Laboratoire Interdisciplinaire des Sciences du Num\u00e9rique",
                    "institution": "CNRS",
                    "location": {
                        "country": "France"
                    }
                },
                "email": ""
            },
            {
                "first": "Jean-Philippe",
                "middle": [],
                "last": "Argaud",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "EDF R&D Saclay",
                    "location": {
                        "country": "France"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "Accurate estimation of error covariances (both background and observation) is crucial for efficient observation compression approaches in data assimilation of large-scale dynamical problems. We propose a new combination of a covariance tuning algorithm with existing PCA-type data compression approaches, either observation-or information-based, with the aim of reducing the computational cost of real-time updating at each assimilation step. Relying on a local assumption of flow-independent error covariances, dynamical assimilation residuals are used to adjust the covariance in each assimilation window. The estimated covariances then contribute to better specify the principal components of either the observation dynamics or the state-observation sensitivity. The proposed approaches are first validated on a shallow water twin experiment with correlated and non-homogeneous observation error. Proper selection of flow-independent assimilation windows, together with sampling density for background error estimation, and sensitivity of the approaches to the observations error covariance knowledge, are also discussed and illustrated with various numerical tests and results. The method is then applied to a more challenging industrial hydrological model with real-world data and non-linear transformation operator provided by an operational precipitation-flow simulation software.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Data assimilation (DA) is applied in a wide range of industrial problems, such as numerical weather prediction (NWP) [1] , hydrology, fire forecasting [2] or nuclear engineering [3] . Recently, DA methods have also been used to COVID-19 pandemic analysis, including predicting disease diffusion and proposing optimal vaccination strategies ( [4] ). DA algorithms are often used in dynamical systems for continuously updating state estimation/prediction. They have recently made their way to other fields such as biomedical applications [5] or quantitative economics [6] . These methods rely on a weighted combination of different sources of noisy information, including prior numerical estimation (also known as background states) and real-time observations, to improve field reconstruction or parameters calibration. DA methods are often used to deal with problems of large dimensions, especially in NWP [7] , [8] (up to 10 9 ) or in geoscience [9] , leading to computational difficulty for real-time updating, if not infeasible. Several strategies for optimizing the computational cost have been developed, including graph-based domain localization [10] , observations selection [11] , matrix decomposition [12] or reduced-order Kalman Filter [13] . It is also a common practice to combine DA algorithms with classical dynamical system reduction techniques, such as the Proper Orthogonal Decomposition (POD) or the Empirical Interpolation Method (EIM e.g. [14] ). Most of these methods rely on either precise knowledge of state variables (e.g. modes in POD) or strong prior assumptions (e.g. cut-off radius in domain localization [15] ). Meanwhile, with the increase of available observation precision in DA applications, the observation data compression via low-rank approximation methods has been continuously studied for alleviating the computational cost, especially in a sequential data assimilation chain. These methods, which consist of extracting principal information in observation data, have been widely applied in various branches of engineering, especially for high dimensional problems. An important advantage of observation compression, regarding other methods that directly reduce the state space dimension, is that no extra operation/knowledge of the state dynamics is required, making the compression error more controllable and estimable. Two classical compression methods are discussed and implemented in this work: the POD-type projection by extracting principal components in the observation dynamic [16] and the information-based compression based on the information entropy analysis [8] . The latter aims to select the most impacting observations to the analyzed state by calculating the prior-posterior information entropy gap. Since the noises are introduced by prior errors in DA systems, the information entropy estimation relies on both background and observation error covariance matrices.",
            "cite_spans": [
                {
                    "start": 117,
                    "end": 120,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 151,
                    "end": 154,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 178,
                    "end": 181,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 342,
                    "end": 345,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 536,
                    "end": 539,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 566,
                    "end": 569,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 905,
                    "end": 908,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 911,
                    "end": 914,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 946,
                    "end": 949,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 1151,
                    "end": 1155,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 1181,
                    "end": 1185,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 1209,
                    "end": 1213,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 1245,
                    "end": 1249,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 1458,
                    "end": 1462,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 1632,
                    "end": 1636,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 2524,
                    "end": 2528,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 2609,
                    "end": 2612,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "For both observation-and information-based approaches, the data compression is carried out with a noise-normalized dataset [7] , [8] . The knowledge of prior error covariances thus becomes crucial for applying these methods. However, the specification of these covariances, especially the background matrix, remains one of the most challenging problems in data assimilation due to the high dimension of the problem and limited prior data [17] , [18] . Much attention was given to improving the error covariance specification in dynamical data assimilation models, particularly by the meteorological society. Several methods have been developed to this end, such as the NMC approach [19] , the DI01 [20] iterative method and the Desroziers estimation [21] . In this paper, we focus on the latest. Unlike some other methods (e.g. [20] , [18] ), the Desroziers estimation does not depend on the specific structure of the error covariances, and it provides a non-parametric estimation of full covariances as output of the algorithm. Based on the residual analysis in variational assimilation, this approach has been widely applied in industrial problems, especially in NWP. Recent works of [22] prove its convergence in the ideal case. Another considerable strength of the Desroziers estimation is that dynamic residual data can be used for the covariance estimation. For this reason, a huge ensemble size is not required for high dimensional problems, unlike, for instance, in the NMC method.",
            "cite_spans": [
                {
                    "start": 123,
                    "end": 126,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 129,
                    "end": 132,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 438,
                    "end": 442,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 445,
                    "end": 449,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 682,
                    "end": 686,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 698,
                    "end": 702,
                    "text": "[20]",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 750,
                    "end": 754,
                    "text": "[21]",
                    "ref_id": "BIBREF20"
                },
                {
                    "start": 828,
                    "end": 832,
                    "text": "[20]",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 835,
                    "end": 839,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 1186,
                    "end": 1190,
                    "text": "[22]",
                    "ref_id": "BIBREF21"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In this paper, based on the Desroziers estimation, we have introduced the concept of piecewise covariance estimation for both observation-and information-based compression strategies. We apply the Desroziers method to estimate error covariances in a fixed time range, also known as the flow-independent window where the error covariances are supposed to be time-invariant. Therefore, the choice of the flow-independent window and the residual samplings play an essential role in this algorithm. The window size should be sufficiently long to gather enough time-variant sampling but not too long to consider the error covariances, especially the background matrix, being constant.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The observation-and information-based (with piecewise covariances estimation) data compression are first implemented in a twin experiment framework using 2D shallow water equations with a linear transformation operator. The observation covariance is supposed to be perfectly known a priori. The two approaches with different choices of flow-independent windows are compared in this model while changing the truncation parameter. Numerical results show that the observation-based (POD-type) compression is in general over-performed by the informationbased approach and that a non-balanced sampling in piecewise covariance estimation results in a less optimal compression. We then apply these methods to a real-world hydrological model to improve river flow prediction/reanalysis by correcting historical daily precipitation measures [23] . Both the precipitation and the river flow data are spatially distributed. The physical simulation is performed using the operating MORDOR-TS software [24] , developed by EDF and the study area is around the Tarn river, in the south of France. The precipitation-flow simulation is carried out through conceptual watersheds modeling, which ensures its high computational efficiency. In this hydrological application, both the background and the observation matrices are estimated using the Desroziers method with daily observed flow data for around 10 years (1990 to 2000) . Results show that in this industrial application where both B and R are not well known, the performance of the information-based strategy is similar to the one of observation-based.",
            "cite_spans": [
                {
                    "start": 832,
                    "end": 836,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 989,
                    "end": 993,
                    "text": "[24]",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 1386,
                    "end": 1409,
                    "text": "10 years (1990 to 2000)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The paper is organized as follows. In section 2, the principle and the notation of data assimilation are briefly introduced. We then introduce the observation-and information-based compression strategies in section 3. The applications of 2D shallow water twin experiments and an industrial hydrological model are shown respectively in section 5 and 6. We finish the paper with a discussion.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The objective of data assimilation algorithms is to improve the estimation of some physical fields or parameters x based on two sources of information: a prior simulation/forecast x b and an observation vector y. The theoretical value of the current state is denoted by a vector x true , also known as the true state. Variational DA algorithms aim to find an optimally weighted compromise between the prior estimation x b and the observation y by minimising the cost function J defined as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Variational data assimilation"
        },
        {
            "text": "where H denotes the transformation operator from the state space to one of the observations. B and R are the associated error covariance matrices, i.e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Variational data assimilation"
        },
        {
            "text": "Thus the inverse of these covariance matrices (i.e. B \u22121 , R \u22121 ) represents the weights of these two information sources in the objective function. Prior errors b , y are supposed to be centered Gaussian, characterised by the error covariance matrices, i.e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Variational data assimilation"
        },
        {
            "text": "The optimization problem of Eq. 1, so called three-dimensional variational (3D-Var) formulation, is a general representation of variational assimilation while the model error is not considered. The output of Eq. 1 is denoted as x a , i.e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Variational data assimilation"
        },
        {
            "text": "If H can be approximated by some linear operator H, Eq. 6 can be solved via BLUE (Best Linearized Unbiased Estimator) formulation,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Variational data assimilation"
        },
        {
            "text": "where A = Cov(x a \u2212 x true ) is the analyzed error covariance and the K matrix, given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Variational data assimilation"
        },
        {
            "text": "is so called the Kalman gain matrix. In the rest of this paper, we denote H as the linearized transformation operator. The case when H is non-linear is more challenging for finding the minimum of Eq. 1, especially for high-dimensional problems. The resolution involves often gradient descent algorithms (relying on algorithms such as \"L-BFGS-B\" [25] and on adjoint-based [11] numerical techniques.",
            "cite_spans": [
                {
                    "start": 345,
                    "end": 349,
                    "text": "[25]",
                    "ref_id": "BIBREF24"
                },
                {
                    "start": 371,
                    "end": 375,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "Variational data assimilation"
        },
        {
            "text": "Variational assimilation algorithms could be applied to dynamical systems through sequential applications using a transition operator M t k \u2192t k+1 (from time t k to t k+1 ), where",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Variational data assimilation"
        },
        {
            "text": "The forecasting thus depends on the knowledge of transition operator M t k \u2192t k+1 and the corrected state at the current time x a,t k . Typically, the current background state is often given by the forecasting from the previous step, i.e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Variational data assimilation"
        },
        {
            "text": "Obviously, a more accurate reanalysis x a,t k\u22121 leads to a more reliable forecasting x b,t k . It is known that as long as the transformation operator H and the transition operator M are linear, the analysis based on the variational method and the Kalman filter results in the same forecasting [9] , for dynamical (4D-Var) assimilation problems. Theoretically, the evolution of the B matrix could also be estimated thanks to the transition operator. However, in practice, the pefect knowledge of M is often unavailable. Much attention is given to quantify the model error in assimilation, for example, in weak-constraint 4D-VAR [26] . Recent work of [27] involves deep learning techniques to improve the estimation of M t k\u22121 \u2192t k .",
            "cite_spans": [
                {
                    "start": 294,
                    "end": 297,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 628,
                    "end": 632,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 650,
                    "end": 654,
                    "text": "[27]",
                    "ref_id": "BIBREF26"
                }
            ],
            "ref_spans": [],
            "section": "Variational data assimilation"
        },
        {
            "text": "DA algorithms are often used to perform real-time corrections of dynamical systems with large dimensions, leading to an essential requirement of computational efficiency. In this work, we are interested in a low-rank approximations of the observation vector which can reduce the cost of real-time updating in DA algorithms.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Observation data compression"
        },
        {
            "text": "The works of [28] and [29] are based on a PCA-type reduction of the observation dynamics. More precisely, a set of n obs observation snapshots is represented by a matrix Y \u2208 R [dim(y)\u00d7n obs ] where each column Y[:, .] represents an individual observation vector of dimension m at a fixed time t i , i.e.",
            "cite_spans": [
                {
                    "start": 13,
                    "end": 17,
                    "text": "[28]",
                    "ref_id": "BIBREF27"
                },
                {
                    "start": 22,
                    "end": 26,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [],
            "section": "Observation-based compression (OC)"
        },
        {
            "text": "Thus Y describes the evolution of the observation vector y including observation error. We work with the error-normalized data R \u22121/2 Y [7] whose empirical covariance C can be written and decomposed as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Observation-based compression (OC)"
        },
        {
            "text": "where the columns ofL are the principal components andD represents the associated eigenvalues in a decreasing order. This decomposition is known as the principal component analysis (PCA) decomposition. We can construct a projection operatorL q with minimum loss of information (represented by eigenvalues in the covariance matrix) by simply keeping the q first columns inL. q is also known as the truncation parameter. In fact, this projection operator can also be obtained by a singular value decomposition (SVD), without computing the full covariance matrix C, i.e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Observation-based compression (OC)"
        },
        {
            "text": "whereL q and\u1e7c q are orthogonal matrices, i.e.L q TL q =\u1e7c q T\u1e7c q = I and\u03a3\u03a3 T =D since all eigenvalues are non negative. The assumption is made for the observation error covariances to be constant (flow-independent), which is a common pratice in data assimilation (e.g [7] ). For each DA optimization, instead of updating with the full observation vector y, the correction is made with the reduced observation\u1ef9",
            "cite_spans": [
                {
                    "start": 267,
                    "end": 270,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Observation-based compression (OC)"
        },
        {
            "text": "The new observation error covarianceR and the new state-observation transformation op-eratorH can be written as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Observation-based compression (OC)"
        },
        {
            "text": "The DA algorithm can then be performed on (x b ,\u1ef9 q , B,R q ,H q ) instead of (x b , y, B, R, H). This method could be seen as a classical POD approach applied to error-normalised observation data by extracting modes of higher variances against time. It is pointed out by [28] and [7] that performing PCA on noise-normalised observation data can improve the method efficiency and reduce the impact of observation error during the compression procedure.",
            "cite_spans": [
                {
                    "start": 272,
                    "end": 276,
                    "text": "[28]",
                    "ref_id": "BIBREF27"
                },
                {
                    "start": 281,
                    "end": 284,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Observation-based compression (OC)"
        },
        {
            "text": "The observation-based data reduction retains the principal directions of the observation dynamic. However, these directions are not necessarily the most impacting in state correction. A continuous effort has been devoted to quantify and compute the sensitivity of the analysis states to the observations (e.g. [11] ), which leads to a more refined observation compression in DA. More precisely, this sensitivity may be expressed by the influence matrix S [30] , defined as",
            "cite_spans": [
                {
                    "start": 310,
                    "end": 314,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 455,
                    "end": 459,
                    "text": "[30]",
                    "ref_id": "BIBREF29"
                }
            ],
            "ref_spans": [],
            "section": "Information-based compression (IC)"
        },
        {
            "text": "According to [8] , the information given by the influence matrix can be roughly quantified via two indicators, the degree of freedom for signal (DFS) which represents the prior-posterior mutual information and the entropy reduction (ER) which represents the evolution of Shannon information content, respectively defined as",
            "cite_spans": [
                {
                    "start": 13,
                    "end": 16,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Information-based compression (IC)"
        },
        {
            "text": "where H is the entropy of a distribution, noted here H(x) for simplicity. Eqs. 18 ",
            "cite_spans": [
                {
                    "start": 79,
                    "end": 81,
                    "text": "18",
                    "ref_id": "BIBREF17"
                }
            ],
            "ref_spans": [],
            "section": "Information-based compression (IC)"
        },
        {
            "text": "As stated in the work of [31] , the observation projection operator which minimizes the information loss is given byL q R \u22121/2 , whereL q is the matrix whose columns contain the eigenvectors of MM T = R \u22121/2 HBH T R \u22121/2 . DA algorithms could then be performed wit\u0125",
            "cite_spans": [
                {
                    "start": 25,
                    "end": 29,
                    "text": "[31]",
                    "ref_id": "BIBREF30"
                }
            ],
            "ref_spans": [],
            "section": "Information-based compression (IC)"
        },
        {
            "text": "We remind that, from the computational point of view, the only difference between the OC and IC is the way the low-rank projection L q is obtained. For both approaches, the specification of error covariance matrices (either background or observation) is crucial to provide an efficient compression. On the other hand, data compression strategies can reduce the computational cost of covariance tuning methods, especially for multidimensional and multivariate problems. Therefore, the precise knowledge of HBH T and R is crucial for this method. However, as pointed out by [8] , the condition number of the analysis covariance matrix A can be higher when using IC approach compared to performing DA with the full observation data set. Therefore, the risk of matrix ill-conditioning is worth monitoring when applying this compression method.",
            "cite_spans": [
                {
                    "start": 572,
                    "end": 575,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Information-based compression (IC)"
        },
        {
            "text": "The determination of the truncated parameter q, i.e. number of modes kept in the reduced space, is crucial in data compression. The choice of the threshold often depends on available data [32] . Several criteria were considered, such as the information losing rate E q and the matrix conditioning a posteriori \u00b5 q , defined as",
            "cite_spans": [
                {
                    "start": 188,
                    "end": 192,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [],
            "section": "Optimal truncation parameter for compression methods"
        },
        {
            "text": "where \u03a3 is the diagonal matrices with all eigenvalues of the covariance matrix and \u03c3 i,i=1.. represent the associated real eigenvalues in the decreasing order of absolute value. According to the study of [33] , an optimal choice of the truncation parameter can be obtained by combining the two previous indicators, with an objective function f , defined as",
            "cite_spans": [
                {
                    "start": 204,
                    "end": 208,
                    "text": "[33]",
                    "ref_id": "BIBREF32"
                }
            ],
            "ref_spans": [],
            "section": "Optimal truncation parameter for compression methods"
        },
        {
            "text": "Assuming ||\u03c3 q \u2212 \u03c3 1 || >> ||\u03c3 q \u2212 \u03c3 q\u22121 ||, one could easily prove that Eq. 25 achieves the minimum when \u03c3 q = \u221a \u03c3 1 . With this choice, we manage to both reduce the matrix ill-conditioning and remove less significant modes, as proved in real-world DA application [33] . Another advantage of this criteria is that the computation of the full spectrum of covariances is not required. By applying Lancozs-type methods [34] , we can stop the algorithm when the current eigenvalue is inferior to \u221a \u03c3 1 .",
            "cite_spans": [
                {
                    "start": 265,
                    "end": 269,
                    "text": "[33]",
                    "ref_id": "BIBREF32"
                },
                {
                    "start": 417,
                    "end": 421,
                    "text": "[34]",
                    "ref_id": "BIBREF33"
                }
            ],
            "ref_spans": [],
            "section": "Optimal truncation parameter for compression methods"
        },
        {
            "text": "The R matrix is required for both OC and IC approaches. Furthermore, the construction ofL T q in IC requires a precise knowledge of the matrix production HBH T . However, the knowledge of both matrices often remains challenging in data assimilation [17] . Continuous effort was devoted to improve the error covariances specification [35] , [18] . A classical approach based on residual analysis, and later a more complete version are respectively given by [36] and [21] . They show that under the assumption of flow-independent error covariance, i.e. B and R being invariant against time in a certain period, the following equations hold",
            "cite_spans": [
                {
                    "start": 249,
                    "end": 253,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 333,
                    "end": 337,
                    "text": "[35]",
                    "ref_id": "BIBREF34"
                },
                {
                    "start": 340,
                    "end": 344,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 456,
                    "end": 460,
                    "text": "[36]",
                    "ref_id": "BIBREF35"
                },
                {
                    "start": 465,
                    "end": 469,
                    "text": "[21]",
                    "ref_id": "BIBREF20"
                }
            ],
            "ref_spans": [],
            "section": "Piecewise estimation of error covariances"
        },
        {
            "text": "Under these hypothesis, combining Eq. 26 and 27 leads to",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Piecewise estimation of error covariances"
        },
        {
            "text": "In order to somewhat alleviate these strong hypotheses, a simple idea is to take the expectation operators in Eq. 26, 27 and 28 in assimilation windows where the flow-independent assumption stands, resulting in a piecewise estimation of both B and R. More precisely, a sequence of estimated background matrices B T i could be computed via residual covariances, where T i refer to flow-independent periods of B in a dynamical system. In other words, B is considered as invariant between t = T i and t = T i+1 . The estimation of R T i , if required, follows the same principle using Eq. 26. When the knowledge of R matrix is precise a priori, the estimation of Eq. 27 is privileged because of its lower computational cost since no evaluation of the analyzed state x a is required. According to [36] , when the observation error is dominated by background",
            "cite_spans": [
                {
                    "start": 793,
                    "end": 797,
                    "text": "[36]",
                    "ref_id": "BIBREF35"
                }
            ],
            "ref_spans": [],
            "section": "Piecewise estimation of error covariances"
        },
        {
            "text": "By definition,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Piecewise estimation of error covariances"
        },
        {
            "text": "represents the background error covariances projected in the observation space.Therefore the information-based observation compression which is based on a PCA-type analysis, can also be interpreted as a projection of y along the directions where the background errors are most important. Recently, it was also reported in the literature (e.g. [37] ) that the convergence (towards the exact observation matrix) of the iterative method can still be ensured when the background and observation error correlation length-scales are similar, which was contrary to what was previously thought [38] . Although this innovation-based covariance estimation approach has been widely applied in DA applications, some drawbacks have also been noticed. For example, the application of this method in real problems often requires post-processing of the R matrix. It is shown in [23] that the regularized matrix may converge to some other solution rather than the exact observation matrix.",
            "cite_spans": [
                {
                    "start": 343,
                    "end": 347,
                    "text": "[37]",
                    "ref_id": "BIBREF36"
                },
                {
                    "start": 586,
                    "end": 590,
                    "text": "[38]",
                    "ref_id": "BIBREF37"
                },
                {
                    "start": 862,
                    "end": 866,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [],
            "section": "Piecewise estimation of error covariances"
        },
        {
            "text": "For evaluating the performance of different data compression approaches, we set up a twin experiment framework with a simplified 2D shallow water dynamical model which is frequently used for testing data assimilation algorithms ( (e.g [11] , [18] ). A cylinder of water is positioned in the middle of the study field of size 20mm \u00d7 20mm and released at the initial time t = 0s (i.e. with no initial speed), leading to a non-linear wave-propagation. The dynamics of the water level h (in mm), as well as horizontal and vertical velocity (in 0.1m/s) field (respectively denoted as u and v), is given by the non-conservative shallow water equations",
            "cite_spans": [
                {
                    "start": 235,
                    "end": 239,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 242,
                    "end": 246,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                }
            ],
            "ref_spans": [],
            "section": "Experiments set up"
        },
        {
            "text": "where b = 0.1 is the viscous drag coefficient and the earth gravity constant g is thus scaled to 1. These equations are discretized in a 20\u00d720 regular grid, solved by first-order finite difference method with a time discretization \u03b4 t = 10 \u22124 s. This resolution is considered as the reference (i.e. the true state x true ) latter when performing DA algorithms. The state variables in this DA modeling are the combination of the velocity fields {u} 20\u00d720 and {v} 20\u00d720 . The evolution of the reference (x true,t ) state is illustrated in Fig. 1 . Spatially correlated prior error is then generated artificially for simulating the background state with a standard deviation \u03c3 b,0 = 0.2, i.e.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 537,
                    "end": 543,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Experiments set up"
        },
        {
            "text": "The background error correlation matrix corr(B) is set to be isotropic (rotational invariant), following the second-order auto-aggressive (SOAR, also known as Balgovind) function,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experiments set up"
        },
        {
            "text": "where r denotes the spatial distance and L B is the correlation scale length, fixed as L B = 4 in this application. Being part of Matern kernels, the SOAR function is often used in DA for prior error correlation modeling [18] , [3] thanks to its smoothness and good conditioning. The simulation of The observations in these twin experiments are generated from the model equivalent based on the true states (i.e H(x true )), separately for the fields u and v, respectively denoted as y u and y v . For both fields, the observation y t = [y u,t , y v,t ] at time t is the sum of u t and v t in a 2 \u00d7 2 cells area with an observation error yt , y u,i,j,t = u true,2i,2j,t + u true,2i+1,2j,t + u true,2i,2j+1,t + u true,2i+1,2j+1,t + y u,i,j,t (33) and identical for y v,i,j,t . Thus y represents also the evolution of the velocity field u and v with a \"coarser\" measure as shown in Fig. 1 [g-h] .",
            "cite_spans": [
                {
                    "start": 221,
                    "end": 225,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 228,
                    "end": 231,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 740,
                    "end": 744,
                    "text": "(33)",
                    "ref_id": "BIBREF32"
                }
            ],
            "ref_spans": [
                {
                    "start": 879,
                    "end": 891,
                    "text": "Fig. 1 [g-h]",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Experiments set up"
        },
        {
            "text": "In these experiments, we have set a non-homogeneous observation error covariance where the error deviation in the center (of radius 4) of the field is 4 times higher, compared to boundary observations as show in Fig. 3 [a]. They are both of the same order of magnitude as \u03c3 b,0 , following also the SOAR function with a smaller scale length L R = 1, compared to background error correlation. The full error covariance R of observations y (after being converted to a 1D vector by concatenating rows of the original 2D grid model), supposed invariant against time, is illustrated in Fig. 3 [b] . The R matrix is supposed to be known in this application, thus only 10 observation trajectories {y \u03b3=1...10 t } are generated to simulate an ensemble of small size while evaluating HBH T through Eq. 27. In this experiment, we make the choice to circumvent the difficulty by setting a temporal correlated b,t , as the background noises are only added at the beginning of the simulation, and a temporal uncorrelated y,t . In fact, temporally correlated background errors are difficult to handle for the Desroziers method since it treats the innovation quantities as independent samples for covariance estimation. These assumptions are realistic and widely adopted in DA problems since background simulations are often taken successively while observations are usually discrete. However, it is beneficial to have both time uncorrelated b,t and y,t for Desroziers-type estimation, as long as the error covariance could still be considered flow-independent [22] . ",
            "cite_spans": [
                {
                    "start": 1546,
                    "end": 1550,
                    "text": "[22]",
                    "ref_id": "BIBREF21"
                }
            ],
            "ref_spans": [
                {
                    "start": 212,
                    "end": 218,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 581,
                    "end": 591,
                    "text": "Fig. 3 [b]",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Experiments set up"
        },
        {
            "text": "We then apply different strategies of observation compression and compare the performance of 3D-Var data assimilation using the reduced observation data. For each assimilation, only the current observation y t is used to correct the background state x b,t . Thanks to the 1000 background trajectories {x \u03b3=1...1000 b,t } simulated, the exact B E,t matrix can be empirically estimated at different time steps, allowing an accurate estimation of analysis error covariance A t via Eq. 8 since the R matrix is supposed to be known. The matrix trace Tr(A) then represents the sum of marginal analysis error, equivalent to the square of L 2 norm, i.e E (||x a \u2212 x t || 2 2 ), often used as an important indicator of DA schemes [18] .",
            "cite_spans": [
                {
                    "start": 721,
                    "end": 725,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                }
            ],
            "ref_spans": [],
            "section": "Numerical results for different compression strategies"
        },
        {
            "text": "Another objective of this experiment is to inspect the impact on the assimilation error given by different sampling densities, which is critical in information-based compression, as stated in the introduction. We display three sampling strategies for HBH T ",
            "cite_spans": [
                {
                    "start": 255,
                    "end": 256,
                    "text": "T",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Numerical results for different compression strategies"
        },
        {
            "text": "We illustrate in Fig. 4[d] , the evolution of E posterior against the truncation parameter q, varying from 0 to 200. In fact, when q = 200, all methods are equivalent since we work with the full observation data. From Fig. 4[d] , we observe that all the information-based strategies with different sampling densities are always more optimal compared to the observation-based method for q \u2208 (0, 200). We apply the stopping criteria as described in section 3.3, by calculating the eigenvalues of HBH T for the medium sampling strategy. We obtain the optimal truncation parameter q optimal = 29. The distribution of these eigenvalues are shown by the right vertical axes in Fig. 4 [d](numerical log scale is represented by the right vertical axis in matching color). With 29 modes, the assimilation correction is achieved from 53.3% to 69.8%, compared to the background model equivalent H(x b ) as shown in table 1, which is compatible to the results obtained in [8] when L B > L R . Among the three sampling strategies, the one of \"IC medium\" owns the lowest output error variances, close to the optimal information-based compression where the HBH T is computed directly using B E,t . The latter, drawn with blue color in Fig. 4[d] , stands for an optimal target for all information-based approaches since we suppose the exact background matrix is out of reach for data compression. As shown in this experiment, the choice of sampling strategy can significantly impact the compression optimality. If the samplings are too close, the residuals might not be uncorrelated, and if the samplings are too sparse, the flow independence of the B matrix could be threatened. We remind that the stopping criteria for the truncation parameter q varies for the different sampling strategies as shown in table 1. However, in this experiment the values of the optimal truncation parameters obtained do not qualitatively change the results as shown in Fig. 4[d] .",
            "cite_spans": [
                {
                    "start": 960,
                    "end": 963,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [
                {
                    "start": 17,
                    "end": 26,
                    "text": "Fig. 4[d]",
                    "ref_id": null
                },
                {
                    "start": 218,
                    "end": 227,
                    "text": "Fig. 4[d]",
                    "ref_id": null
                },
                {
                    "start": 671,
                    "end": 677,
                    "text": "Fig. 4",
                    "ref_id": null
                },
                {
                    "start": 1220,
                    "end": 1229,
                    "text": "Fig. 4[d]",
                    "ref_id": null
                },
                {
                    "start": 1935,
                    "end": 1944,
                    "text": "Fig. 4[d]",
                    "ref_id": null
                }
            ],
            "section": "Numerical results for different compression strategies"
        },
        {
            "text": "In Fig. 4[a,c] , we display the evolution of the exact background error variances (i.e. Tr(B E,t )) and error correlation (for fixed distances, r = 1 and r = 2) against time. The estimation of background error correlation in the 2D space, also based on B E,t , is calibrated using the same method shown in [18] . We observe that the error variances increase continuously for both u and v while the spatial error correlation tends to shrink, both being significantly time-variant between t = 0s and t = 1.4s. In order to illustrate the non-linear and turbulent nature of error propagation, we show in Fig. 4 [b] the error evolution ||x b,t \u2212 x true,t || 2 of a single background trajectory. Obviously, these facts lead to problem of flow independent assumption for the IC large approach (between 0s and 2s), conducing a less optimal compression strategy as shown in Fig. 4 [d]. From this twin experiment, we notice the advantage of information-based compression by selecting the most impacting observation components. The optimal sampling strategy may strongly depend on the characteristics (e.g chaosity, stability) of the dynamical system. Until now, we have shown that, in the idealised case where the observation matrix is known a priori and the transformation operator is time-invariant, the information-based approach exhibits advantageous performance compared to the observation-based approach. However, as pointed out by [8] , IC approach can be sensitive to prior errors of covariance estimation. In order to investigate the impact of a potential misknowledge of matrix R, we present here two cases where the difference between the assumed/estimated matrix R A and the exact matrix R is voluntarily large. We explore two cases where the amplitude and the structure are misspecified, respectively:",
            "cite_spans": [
                {
                    "start": 306,
                    "end": 310,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 1428,
                    "end": 1431,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [
                {
                    "start": 3,
                    "end": 14,
                    "text": "Fig. 4[a,c]",
                    "ref_id": null
                },
                {
                    "start": 600,
                    "end": 606,
                    "text": "Fig. 4",
                    "ref_id": null
                },
                {
                    "start": 865,
                    "end": 871,
                    "text": "Fig. 4",
                    "ref_id": null
                }
            ],
            "section": "Numerical results for different compression strategies"
        },
        {
            "text": "\u2022 (a): R A has the same correlation structure as R with an homogeneous marginal error variance (i.e. R A,i,i = 0.04 which is different to R (cf. Fig. 3(a) ).)",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 145,
                    "end": 154,
                    "text": "Fig. 3(a)",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Numerical results for different compression strategies"
        },
        {
            "text": "\u2022 (b): The correlation scale L R A is set to be 5 while L R = 1 as explained in section 5.1 with same marginal error variances.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Numerical results for different compression strategies"
        },
        {
            "text": "In both cases, the observation compression is implemented using R A while the observation matrix in the reduced space is set to be R",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Numerical results for different compression strategies"
        },
        {
            "text": "instead of the identity matrix in Eq. 16 and Eq. 22. The performance of these compression methods is illustrated in Fig. 5 , respectively for case (a) and (b). The optimal IC solutions (same as the blue lines in Fig. 4(d) ) are drawn in dashed blue lines for comparison purposes. Both OC and IC approaches exhibit less optimal performance compared to Fig. 4 . Furthermore, as shown in Fig. 5(a) , the IC method can be more sensitive to the mis-specification of the R matrix amplitude, leading in this case to larger output error variances while IC behaves better than OC for misspecified R matrix correlation length. The vertical line represents the stopping criteria of \u03c3 q = \u221a \u03c3 1 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 116,
                    "end": 122,
                    "text": "Fig. 5",
                    "ref_id": "FIGREF6"
                },
                {
                    "start": 212,
                    "end": 221,
                    "text": "Fig. 4(d)",
                    "ref_id": null
                },
                {
                    "start": 351,
                    "end": 357,
                    "text": "Fig. 4",
                    "ref_id": null
                },
                {
                    "start": 385,
                    "end": 394,
                    "text": "Fig. 5(a)",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "Numerical results for different compression strategies"
        },
        {
            "text": "The compression strategies introduced in previous sections are applied to a hydrological application using a precipitation-flow simulator MORDOR-TS developed by \u00c9lectrict\u00e9 de France (EDF, the French electric utility company). This software is widely applied in operating hydraulic/horological problems, e.g. [39] , [24] , [40] . Based on information on spatially distributed physical parameters, such as precipitation or temperature, it provides a simulation of river flow relying on conceptual watersheds modeling. For more details about MORDOR-TS, interested readers are referred to [24] and [23] . MORDOR-TS is used as a non-linear state-observation transformation operator in data assimilation. We concentrate on a study area in the south of France, around the Tarn river where 9 streamflow gauges positioned at different mesh outlets are available. The Tarn river, being known for its extreme variability of water-level values and high sensitivity to precipitations [23] , is an ideal benchmark for comparing different DA strategies. Located downstream, the Tarn river outlet at Millau (hereby denoted as TM) is of particular interest in the hydrological study. As an example, we show in Fig. 6 the simulated and daily observed Tarn river discharges at Millau, for 3 months in 1990 with the averaged precipitation over 28 spatially distributed regions (see [23] ). Significant impacts of precipitation on the river flow of TM is observed with a delay of 2 to 5 days. The objective of this DA modeling is to improve the river flow prediction and reanalysis (history matching) by performing corrections on the daily precipitation in the 28 regions. Other physical quantities (e.g temperature) are considered as invariant parameters in this study. The variational assimilation is performed using the ADAO [41] package of SALOME platform, also developed by EDF. As mentioned in [23] , performing DA correction on all precipitation inputs (i.e 28 regions) can probably introduce an over-parameterization and thus induces an overfitting, with a high risk to deteriorate flow forecasts. Therefore, we make the choice to proceed with uniform additional increments \u03be p t for all 28 regions, depending only on time t. Incremental variables \u03be r,j (j = 1..8) on the eight parameters which determine the initial (at t = 0) reservoir level is also added in the state space to adjust the river flow at the beginning of each assimilation window. These windows are fixed of 30 days, leading to an observation vector of dimension 270 with 9 gauges. Temporal correlation is considered for both background and observation errors. The DA modelling is summarized in Table 2 and a more detailed description can be found in [23] and [40] . The main objective of this application stands for improving short-range flow forecasting by correcting historical precipitation. Since the impact of the precipitation on the river flow is only significant within 3 to 4 days (see [23] for details), we fix the prediction window to 3 days in this study.",
            "cite_spans": [
                {
                    "start": 308,
                    "end": 312,
                    "text": "[39]",
                    "ref_id": "BIBREF38"
                },
                {
                    "start": 315,
                    "end": 319,
                    "text": "[24]",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 322,
                    "end": 326,
                    "text": "[40]",
                    "ref_id": "BIBREF39"
                },
                {
                    "start": 585,
                    "end": 589,
                    "text": "[24]",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 594,
                    "end": 598,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 971,
                    "end": 975,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 1362,
                    "end": 1366,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 1807,
                    "end": 1811,
                    "text": "[41]",
                    "ref_id": "BIBREF40"
                },
                {
                    "start": 1879,
                    "end": 1883,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 2705,
                    "end": 2709,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 2714,
                    "end": 2718,
                    "text": "[40]",
                    "ref_id": "BIBREF39"
                },
                {
                    "start": 2950,
                    "end": 2954,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [
                {
                    "start": 1193,
                    "end": 1199,
                    "text": "Fig. 6",
                    "ref_id": "FIGREF7"
                },
                {
                    "start": 2649,
                    "end": 2656,
                    "text": "Table 2",
                    "ref_id": null
                }
            ],
            "section": "DA modelling for flow reanalysis/prediction"
        },
        {
            "text": "state: x dim(x) Observations: y dim(y) invariant parameters Incremental 3DVar \u03be p t \u03be r,j 38 river flow Q q,t 270 temperature, etc Table 2 : Details of DA modelling where t = 0..29 is the time (days) relative to the beginning of the assimilation window; q = 1..9 represents the 9 gauges where \u03be p t , \u03be r,j represent respectively the increments of daily precipitation and initial reservoir level.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 131,
                    "end": 138,
                    "text": "Table 2",
                    "ref_id": null
                }
            ],
            "section": "DA modelling"
        },
        {
            "text": "Despite that MORDOR-TS is computationally efficient (it may take only a few CPU seconds to simulate a spatially distributed flow simulation of several years), the application of variational assimilation algorithms could be expensive, due to the non-linearity of the transformation operator. As shown in Table. 2, in this DA modeling, the dimension of the observation vector is much larger compared to the state dimension, promoting the utilization of observation data compression. We then implement DA algorithms in the hydrological model with compressed data using either OC or IC approaches. To make the compression strategies more general, in both cases the principal components are constructed using the daily observed flow data from 1990 to 2000 in the 9 gauges. The objective of this study is to make an efficient use of the observation vector y with an optimal number of modes selected, which we expect to be much smaller than the full observation dimension (dim(y) = 270).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 303,
                    "end": 309,
                    "text": "Table.",
                    "ref_id": null
                }
            ],
            "section": "Observation compression"
        },
        {
            "text": "A major hurdle of this application is that the a priori knowledge of both B and R is very limited. As a remedy, we start as described in [23] , by considering the background covariance matrix B of Balgovind-type since we wish to model the existence of temporal correlation in the precipitation data. Moreover, the initial R matrix is set to be diagonal. The DI01 algorithm [20] is then applied several times to to come up with a reasonable approximation of the ratio between Tr(B) and Tr(R) at the first stage. In a second stage, we then perform the estimation of HBH T and R, relying on Desroziers formulation (respectively Eq. 26 and 28) using 3400 assimilation windows of 30 days from 1990 to 2000. By then, post-processing is required to ensure the symmetric positive definiteness (SPD) of the R matrix. More precisely,",
            "cite_spans": [
                {
                    "start": 137,
                    "end": 141,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 373,
                    "end": 377,
                    "text": "[20]",
                    "ref_id": "BIBREF19"
                }
            ],
            "ref_spans": [],
            "section": "Observation compression"
        },
        {
            "text": "where \u00b5 = 0.1 and C = Tr(R) \u00d7 I. The Desroziers method is iterated twice, using the same data set, to ensure the stability of the estimated matrices. The algorithm outputs produced after the first and the second iterations are very similar as shown in [23] . We emphasize that the estimated R matrix is not only used for the observation compression but also in the DA algorithm in the full observation space. The HBH T matrix is obtained through Eq. 27, once the R matrix is specified. As a remark, even if the system considered here is not very large, the computational burden associated with the data assimilation of this nonlinear system (for which prior information is degraded) remains important because of a multi-stage tuning approach which combined several offline and online covariance tuning algorithms can be implemented to improve the reanalysis and the forecasting accuracy of this hydrological application. However, these methods are computationally expensive, especially when iterations are needed (e.g. [18] ). With advanced data compression methods, the computational burden can be released, allowing more precise covariance tuning to improve the DA performance.",
            "cite_spans": [
                {
                    "start": 252,
                    "end": 256,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 1019,
                    "end": 1023,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                }
            ],
            "ref_spans": [],
            "section": "Observation compression"
        },
        {
            "text": "Extracting the principal componentsL andL, respectively based on estimated HBH T and R, we then apply the compression methodology described in sect.3. The objective is to compare the assimilation output x a,compression and x a,full , obtained using either the compressed observation y q ,\u1ef9 q or the full observation vector y. More precisely, we are interested in the observation minus analysis (O-A) innovation quantity for both flow reanalysis and forecast. Varying the truncated parameter q, DA processes are performed respectively with (x b ,\u1ef9 q , B,R q ,H q ) and (x b ,\u0177 q , B,R q ,\u0124 q ) for 12 assimilation windows in 1993, each of 30 days starting at the first day of every month. We draw the averaged compressed/full O-A innovation ratio \u2207, defined as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DA with compressed data 6.3.1. Averaged performance"
        },
        {
            "text": "in Fig. 7 for both reanalysis[a] and prediction[b] at TM. More particularly, \u2207 = 100% means the reanalysis/prediction accuracy of the current solution is equivalent to the one obtained with the full observation vector. We observe from Fig. 7 that the performance of these two approaches is similar to the reanalysis while the observation-based method is slightly more optimal on average for flow forecasting. The evolution of the reconstruction error ( Fig. 7[a] ) is much smoother, compared to the prediction error (( Fig. 7[b] )), both against the truncation parameter. In fact, the reconstruction error is estimated using assimilation windows of 30 days while prediction windows are solely of 3 days. Therefore, the estimation of the prediction ratio has significantly more sampling noise. Furthermore, since both B and R are not well specified a priori, extra noise can be introduced while estimating the information entropy. For both methods, the assimilation results obtained using 15 to 20 modes (around 5% to 7.5% of total observation dimension) are close to the full rank solution in terms of both reanalysis and prediction. Without deteriorating the assimilation result, these compression strategies make the DA algorithm certainly more efficient, allowing more optimization iterations if needed.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 3,
                    "end": 9,
                    "text": "Fig. 7",
                    "ref_id": "FIGREF8"
                },
                {
                    "start": 235,
                    "end": 241,
                    "text": "Fig. 7",
                    "ref_id": "FIGREF8"
                },
                {
                    "start": 453,
                    "end": 462,
                    "text": "Fig. 7[a]",
                    "ref_id": "FIGREF8"
                },
                {
                    "start": 519,
                    "end": 528,
                    "text": "Fig. 7[b]",
                    "ref_id": "FIGREF8"
                }
            ],
            "section": "DA with compressed data 6.3.1. Averaged performance"
        },
        {
            "text": "We draw the reconstructed river flow (i.e H(x a )) at TM of each of those 12 assimilation windows, for both corrections with compressed and full observation data in Fig. 8 where the yellow stars represent the daily observations. Based on the method described in Eq. 25, the optimal truncation parameter reads q optima l = 22. Here, we display the results when q = 10 in order to voluntary emphasize the difference between the two approaches as shown in Fig 7. A vertical line in each graph separates the reanalysis (left) and the prediction (right). We notice that the reconstructed curves issued from OC (blue) and IC (red) are similar in most cases, both being adequately close to the full rank assimilation (green), compared to the original simulation. Some exceptions can be found, for example, in the assimilation window of December 1993 where the prediction is covered by a flood period. It seems that the information-based approach provides a better performance, especially for flow forecasting at that moment. In general, as demonstrated in [23] , meteorological factors can impact the assimilation precision significantly. DA algorithms often perform better during drought periods (see Jun, July, August in Fig. 8 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  1  2  3  4  5  6  7  8  9 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  1  2  3  4  5  6  7  8  9 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  1  2  3  4  5  6  7  8  9 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  1  2  3  4  5  6  7  8  9 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  1  2  3  4  5  6  7  8  9  10 1993-8 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  1  2  3  4  5  6  7  8  9  10 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  1  2  3  4  5  6  7  8  9 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  1  2  3  4  5  6  7  8  9 1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  1  2  3  4  5  6  7  8  9 ",
            "cite_spans": [
                {
                    "start": 1049,
                    "end": 1053,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [
                {
                    "start": 165,
                    "end": 171,
                    "text": "Fig. 8",
                    "ref_id": "FIGREF18"
                },
                {
                    "start": 453,
                    "end": 459,
                    "text": "Fig 7.",
                    "ref_id": "FIGREF8"
                },
                {
                    "start": 1216,
                    "end": 1222,
                    "text": "Fig. 8",
                    "ref_id": "FIGREF18"
                },
                {
                    "start": 1223,
                    "end": 1359,
                    "text": "1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  1  2  3  4  5  6  7  8  9",
                    "ref_id": null
                },
                {
                    "start": 1360,
                    "end": 1500,
                    "text": "1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  1  2  3  4  5  6  7  8  9",
                    "ref_id": null
                },
                {
                    "start": 1501,
                    "end": 1637,
                    "text": "1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  1  2  3  4  5  6  7  8  9",
                    "ref_id": null
                },
                {
                    "start": 1638,
                    "end": 1778,
                    "text": "1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  1  2  3  4  5  6  7  8  9",
                    "ref_id": null
                },
                {
                    "start": 1779,
                    "end": 1923,
                    "text": "1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  1  2  3  4  5  6  7  8  9  10",
                    "ref_id": null
                },
                {
                    "start": 1931,
                    "end": 2071,
                    "text": "1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  1  2  3  4  5  6  7  8  9  10",
                    "ref_id": null
                },
                {
                    "start": 2072,
                    "end": 2212,
                    "text": "1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  1  2  3  4  5  6  7  8  9",
                    "ref_id": null
                },
                {
                    "start": 2213,
                    "end": 2349,
                    "text": "1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  1  2  3  4  5  6  7  8  9",
                    "ref_id": null
                },
                {
                    "start": 2350,
                    "end": 2490,
                    "text": "1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  1  2  3  4  5  6  7  8  9",
                    "ref_id": null
                }
            ],
            "section": "Performance in each DA window"
        },
        {
            "text": "Sequential data assimilation algorithms can be computationally challenging, especially for large scale systems such as NWP, remote sensing, or geophysical problems. Data compression techniques commonly used in DA problems have recently received increasing interest in reducing the computational burden. Much effort has been devoted to improving the algorithm efficiency without diminishing the accuracy of assimilation reconstruction and forecasting. Classical compression approaches consist of either extracting the principal vectors of observation dynamics or identifying the directions that contribute the most to the prior-posterior information gap. For both methods, the lack of precise knowledge on prior error covariances stands for an essential obstacle, as mentioned in several previous studies. Furthermore, the limited number of background/observation trajectories often entails a poor empirical estimation. In this paper, we have introduced a concept of observation compression benefiting from existing piecewise covariance estimation, establishing a natural connection between the posterior error covariance diagnosis and data compression techniques. More precisely, we assume that the error covariances (both B and R) are flow-independent over some specific time periods, which allows an estimation based on time-variant residuals. Therefore, a much smaller number of background/observation trajectories are required for non-parametric covariance estimation. Different estimation formulations are possible depending on the prior knowledge of the R matrix. The choice of flow-independent windows, as well as the residual sampling densities, is essential in these approaches, especially for the HBH T estimation. When the samplings are either too dense or too sparse, the assumptions of covariance estimation approaches might be unsatisfied, leading to a less optimal observation compression. These aspects are numerically analyzed in the twin experiments of a 2D shallow water model with non-linear dynamics with the perfect knowledge of the R. Numerical results show a significant advantage of the information-based compression in terms of assimilation accuracy, compared to the observation-based one. As for the industrial hydrological model, posterior covariance estimation which requires the knowledge of the analyzed states x a , is needed since the R matrix is not known a priori. In this application, both the OC and IC compression methods rely on the flow-independent estimation of R, showing competitive performance regarding the flow reanalysis and the forecasting accuracy. A meteorological effect is also briefly discussed in this hydrological application, which indicates that different numbers of modes should be chosen in different periods of the year regarding the hydrological properties. Future work can be considered to improve the algorithm efficiency and flexibility under industrial conditions, for example, by using parametric covariance tuning methods or spatial localization techniques. Another important limitation of the current approach stands for the time invariance of the observations error covariance on some time-scale, limiting for instance the use of moving observation sensors. Indeed, if observation positions change, both the observation matrix R and the transformation operator H can not be considered flow-independent, leading to difficulties when applying Desroziers-type methods. Future work can be considered to use interpolation approaches to construct a global observation set which includes all timevariant observation positions. Another perspective of this study could be to further examine the optimal choice of the sampling density while estimating the error covariances, for example, with the help of uncertainty quantification methods for dynamical systems.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Overview of global data assimilation developments in numerical weatherprediction centres",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Rabier",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "131",
            "issn": "",
            "pages": "3215--3233",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Towards predictive data-driven simulations of wildfire spread-part i: Reduced-cost ensemble kalman filter based on a polynomial chaos surrogate model for parameter estimation",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "C"
                    ],
                    "last": "Rochoux",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Ricci",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Lucor",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Cuenot",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Trouv\u00e9",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Natural Hazards and Earth System Sciences",
            "volume": "14",
            "issn": "",
            "pages": "2951--2973",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "An inverse-distance-based fitting term for 3D-Var data assimilation in nuclear core simulation",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Gong",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Yu",
                    "suffix": ""
                },
                {
                    "first": "Q",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Quan",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Annals of Nuclear Energy",
            "volume": "141",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Optimal vaccination strategies for covid-19 based on dynamical social networks with real-time updating",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Cheng",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Arcucci",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "C"
                    ],
                    "last": "Pain",
                    "suffix": ""
                },
                {
                    "first": "Y.-K",
                    "middle": [],
                    "last": "Guo",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2103.00485"
                ]
            }
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Cardiovascular modeling with adapted parametric inference",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Lucor",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [
                        "P"
                    ],
                    "last": "Le Ma\u00eetre",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "ESAIM: ProcS",
            "volume": "62",
            "issn": "",
            "pages": "91--107",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Data assimilation for parameter estimation in economic modelling",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Nadler",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Arcucci",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Guo",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "15th International Conference on Signal-Image Technology & Internet-Based Systems (SITIS) 2019",
            "volume": "",
            "issn": "",
            "pages": "649--656",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "The use of principal component analysis for the assimilation of high-resolution infrared sounder observations for numerical weather prediction",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "D"
                    ],
                    "last": "Collard",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "P"
                    ],
                    "last": "Mcnally",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [
                        "I"
                    ],
                    "last": "Hilton",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "B"
                    ],
                    "last": "Healy",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "C"
                    ],
                    "last": "Atkinson",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "136",
            "issn": "",
            "pages": "2038--2050",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Data compression in the presence of observational error correlations",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Fowler",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Tellus A: Dynamic Meteorology and Oceanography",
            "volume": "71",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Data assimilation in the geosciences: An overview of methods, issues, and perspectives",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Carrassi",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Bocquet",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Bertino",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Evensen",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Climate Change",
            "volume": "9",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "A graph clustering approach to localization for adaptive covariance tuning in data assimilation based on state-observation mapping, accepted for publication in Mathematical Geosciences",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Cheng",
                    "suffix": ""
                },
                {
                    "first": "J.-P",
                    "middle": [],
                    "last": "Argaud",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Iooss",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Pon\u00e7ot",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Lucor",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2001.11860"
                ]
            }
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Low-rank approximations for computing observation impact in 4D-Var data assimilation",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Cioaca",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Sandu",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Computers & Mathematics with Applications",
            "volume": "67",
            "issn": "",
            "pages": "2112--2126",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "A parallel implementation of the ensemble kalman filter based on modified cholesky decomposition",
            "authors": [
                {
                    "first": "E",
                    "middle": [
                        "D"
                    ],
                    "last": "Nino-Ruiz",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Sandu",
                    "suffix": ""
                },
                {
                    "first": "X",
                    "middle": [],
                    "last": "Deng",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Journal of Computational Science",
            "volume": "36",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "A simplified reduced order Kalman filtering and application to altimetric data assimilation in tropical pacific",
            "authors": [
                {
                    "first": "I",
                    "middle": [],
                    "last": "Hoteit",
                    "suffix": ""
                },
                {
                    "first": "D.-T",
                    "middle": [],
                    "last": "Pham",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Blum",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "Journal of Marine Systems",
            "volume": "36",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Sensor placement in nuclear reactors based on the generalized empirical interpolation method",
            "authors": [
                {
                    "first": "J.-P",
                    "middle": [],
                    "last": "Argaud",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Bouriquet",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Caso",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Gong",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Maday",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [],
                    "last": "Mula",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Journal of Computational Physics",
            "volume": "363",
            "issn": "",
            "pages": "354--370",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "On diagnosing observation-error statistics with local ensemble data assimilation",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Waller",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "L"
                    ],
                    "last": "Dance",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "K"
                    ],
                    "last": "Nichols",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "143",
            "issn": "",
            "pages": "2677--2686",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "The direct assimilation of principal components of IASI spectra in the ECMWF 4D-Var",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Matricardi",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "P"
                    ],
                    "last": "Mcnally",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "140",
            "issn": "",
            "pages": "573--582",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Background error covariance modelling",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Fisher",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Seminar on Recent developments in data assimilation for atmosphere and ocean",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Background error covariance iterative updating with invariant observation measures for data assimilation",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Cheng",
                    "suffix": ""
                },
                {
                    "first": "J.-P",
                    "middle": [],
                    "last": "Argaud",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Iooss",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Lucor",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Pon\u00e7ot",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Stochastic Environmental Research and Risk Assessment",
            "volume": "33",
            "issn": "",
            "pages": "2033--2051",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "The National Meteorological Center's spectral statisticalinterpolation analysis system",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "F"
                    ],
                    "last": "Parrish",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "C"
                    ],
                    "last": "Derber",
                    "suffix": ""
                }
            ],
            "year": 1992,
            "venue": "Monthly Weather Review",
            "volume": "120",
            "issn": "",
            "pages": "1747--1763",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Diagnosis and adaptive tuning of observation-error parameters in a variational assimilation",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Desroziers",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Ivanov",
                    "suffix": ""
                }
            ],
            "year": 2001,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "127",
            "issn": "",
            "pages": "1433--1452",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "Diagnosis of observation, background and analysis-error statistics in observation space",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Desroziers",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Berre",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Chapnik",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Poli",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "131",
            "issn": "",
            "pages": "3385--3396",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Justification for estimating observation-error covariances with the Desroziers diagnostic",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Bathmann",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "144",
            "issn": "",
            "pages": "1965--1974",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Error covariance tuning in variational data assimilation: application to an operating hydrological model",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Cheng",
                    "suffix": ""
                },
                {
                    "first": "J.-P",
                    "middle": [],
                    "last": "Argaud",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Iooss",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Lucor",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Pon\u00e7ot",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "Stochastic Environmental Research and Risk Assessment",
            "volume": "35",
            "issn": "",
            "pages": "1019--1038",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Impact of mesoscale spatial variability of climatic inputs and parameters on the hydrological response",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Rouhier",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "Le"
                    ],
                    "last": "Lay",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Garavaglia",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Moine",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Hendrickx",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Monteil",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Ribstein",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Journal of Hydrology",
            "volume": "553",
            "issn": "",
            "pages": "13--25",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Eigenvalues, invariant factors, highest weights, and schubert calculus",
            "authors": [
                {
                    "first": "W",
                    "middle": [],
                    "last": "Fulton",
                    "suffix": ""
                }
            ],
            "year": 2000,
            "venue": "Bulletin of The American Mathematical Society",
            "volume": "37",
            "issn": "",
            "pages": "209--250",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "Time-space weak-constraint data assimilation for nonlinear models",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Uboldi",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kamachi",
                    "suffix": ""
                }
            ],
            "year": 2000,
            "venue": "Tellus A",
            "volume": "52",
            "issn": "",
            "pages": "412--421",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "Combining data assimilation and machine learning to emulate a dynamical model from sparse and noisy observations: A case study with the Lorenz 96 model",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Brajard",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Carrassi",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Bocquet",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Bertino",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Journal of Computational Science",
            "volume": "44",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "A principal component noise filter for high spectral resolution infrared measurements",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Antonelli",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "E"
                    ],
                    "last": "Revercomb",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [
                        "A"
                    ],
                    "last": "Sromovsky",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "L"
                    ],
                    "last": "Smith",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "O"
                    ],
                    "last": "Knuteson",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "C"
                    ],
                    "last": "Tobin",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "K"
                    ],
                    "last": "Garcia",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "B"
                    ],
                    "last": "Howell",
                    "suffix": ""
                },
                {
                    "first": "H.-L",
                    "middle": [],
                    "last": "Huang",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [
                        "A"
                    ],
                    "last": "Best",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Journal of Geophysical Research: Atmospheres",
            "volume": "109",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Hyperspectral data noise characterization using principle component analysis: Application to the atmospheric infrared sounder",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Tobin",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Antonelli",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Revercomb",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Dutcher",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Turner",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Taylor",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Knuteson",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Vinson",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Journal of Applied Remote Sensing",
            "volume": "1",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "Influence-matrix diagnostic of a data assimilation system",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Cardinali",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Pezzulli",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [],
                    "last": "Andersson",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "130",
            "issn": "",
            "pages": "2767--2786",
            "other_ids": {}
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "Information-based data selection for ensemble data assimilation",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Migliorini",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "139",
            "issn": "",
            "pages": "2033--2054",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "Component retention in principal component analysis with application to cdna microarray data",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Cangelosi",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Goriely",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Biology Direct",
            "volume": "2",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "Optimal reduced space for variational data assimilation",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Arcucci",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Mottet",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Pain",
                    "suffix": ""
                },
                {
                    "first": "Y.-K",
                    "middle": [],
                    "last": "Guo",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Journal of Computational Physics",
            "volume": "379",
            "issn": "",
            "pages": "51--69",
            "other_ids": {}
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "An iteration method for the solution of the eigenvalue problem of linear differential and integral operators",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Lanczos",
                    "suffix": ""
                }
            ],
            "year": 1950,
            "venue": "Journal of research of the National Bureau of Standards",
            "volume": "45",
            "issn": "",
            "pages": "255--282",
            "other_ids": {}
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "A review of innovation-based methods to jointly estimate model and observation error covariance matrices in ensemble data assimilation",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Tandeo",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Ailliot",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Bocquet",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Carrassi",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Miyoshi",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Pulido",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Zhen",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Monthly Weather Review",
            "volume": "",
            "issn": "",
            "pages": "1--68",
            "other_ids": {}
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "The verification of objective analyses: Diagnostics of analysis system performance",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Hollingsworth",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "L\u00f6nnberg",
                    "suffix": ""
                }
            ],
            "year": 1989,
            "venue": "Meteorology and Atmospheric Physics",
            "volume": "40",
            "issn": "",
            "pages": "3--27",
            "other_ids": {}
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "Theoretical insight into diagnosing observation error correlations using observation-minus-background and observation-minus-analysis statistics",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Waller",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "L"
                    ],
                    "last": "Dance",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "K"
                    ],
                    "last": "Nichols",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "142",
            "issn": "",
            "pages": "418--431",
            "other_ids": {}
        },
        "BIBREF37": {
            "ref_id": "b37",
            "title": "Property and first application of an error-statistics tuning method in variational assimilation",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Chapnik",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Desroziers",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Rabier",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [],
                    "last": "Talagrand",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Quarterly Journal of the Royal Meteorological Society",
            "volume": "130",
            "issn": "",
            "pages": "2253--2275",
            "other_ids": {}
        },
        "BIBREF38": {
            "ref_id": "b38",
            "title": "Pr\u00e9vision op\u00e9rationnelle des apports de la Durance \u00e0 Serre-Pon\u00e7on \u00e0 l'aide du mod\u00e8le MORDOR. Bilan de l'ann\u00e9e 1994-1995",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Gar\u00e7on",
                    "suffix": ""
                }
            ],
            "year": 1996,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "71--76",
            "other_ids": {}
        },
        "BIBREF39": {
            "ref_id": "b39",
            "title": "Error covariance specification and localization in data assimilation with industrial application",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Cheng",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF40": {
            "ref_id": "b40",
            "title": "User documentation, in the SALOME 9.3 platform, of the ADAO module for \"Data Assimilation and Optimization",
            "authors": [
                {
                    "first": "J.-P",
                    "middle": [],
                    "last": "Argaud",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "the same discretization of Eq. 30 (except the initial conditions) is used as background states at time t in the DA modeling. For the knowledge of the exact 1 background error covariance B E,t at different time, 10 3 background trajectories {x \u03b3=1...1000 b,t } are independently generated via Eq. 31. This exact matrix, hidden for compression approaches, is seldomly used to evaluate the performance of DA algorithms with reduced observation. To simulate an industrial context, only 10 trajectories {x \u03b3=1...10 b,t } are used in the piecewise estimation of HBH T of a flow-independent window, making the ensemble size (10) much smaller than the problem dimension (20 \u00d7 20 = 400).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Evolution of the shallow water model of h, u, v (true states) at different time steps (a-f) and the error-free model equivalent H(x true ) for observations (g-h).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Simple sketch illustrating the three IC sampling strategies. The two vertical blue lines indicate where data assimilation experiments take place (as mentioned in Eq. 34).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "The observation error variance of y u and y v in the shallow water model[a] and the Balgovind error covariances (R) after the observation vector (originally in a 2D grid) being converted to a 1D vector[b]",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "estimation with different assumed flow-independent periods [T s , T f ], \u2022 IC small: Dense sampling in a small period, \u2206 t = 0.001s with T s = 0.16s and T f = 0.18s \u2022 IC large: Sparse sampling in a long period, \u2206 t = 0.1s with T s = 0s and T f = 2s \u2022 IC medium: Between IC small and IC large, with \u2206 t = 0.01s T s = 0.1s and T f = 0.3s, as shown in Fig. 2, where \u2206 t is the uniform time discretization between two snapshots. For all these three strategies, the HBH T is estimated via 20 time steps (i.e T f \u2212 T s = 20\u2206 t ), each with 10 background ({x \u03b3=1...10 b,t }) and observation ({y \u03b3=1...10 t }) states/residuals. To gain a robust comparison, the posterior error variance E posterior is averaged using Tr(A t ) at four different time, included in all three assumed flow-independent windows, E posterior = Tr(A t ) 4 for t \u2208 {0.16, 0.165, 0.170, 0.175}.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "The ratio of background minus analysis innovation (||H(x b ) \u2212 H(x a )|| 2 ) using compressed observation, relative to the one obtained with full observation [a]: evolution of the exact background variance of u (Tr(B u )) and v (Tr(B v )) against time; [b]: evolution of ||x b,t \u2212 x true,t || 2 of a single background trajectory; [c]: evolution of average error correlation, of fixed distances (r = 1 and r = 2) in the 2D space; [d]: analysis error variance E posterior (left y-axis) and eigenvalues of the estimated background error covariance in observation space (HBH T ) (right y-axis) of the medium sampling strategy as a function of the truncation parameter for t \u2208 [0.16s, 0.18s].",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "Evolution of error variance when the observation matrix is mis-specified.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "Example of simulation predicted by MORDOR-TS using daily precipitation, and observed Tarn discharges at Millau for three months in 1990. Simultaneous observed precipitations are in red bars (with the scale on the right vertical axis).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "Evolution of \u2207, averaged using 12 assimilation windows, against the number of truncation parameter q for reanalysis[a] and prediction[b] at TM.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF18": {
            "text": "The reconstructed and predicted river flow at TM for OC (obs) (q = 10), IC (info) (q = 10) and full rank DA solutions of different months in 1993. The left side of the vertical line represents the flow reanalysis while the right side represents the prediction",
            "latex": null,
            "type": "figure"
        },
        "TABREF2": {
            "text": "",
            "latex": null,
            "type": "table"
        },
        "TABREF3": {
            "text": ") where the prior observation minus background (O-B) innovations are more consistent (i.e always being under-estimated or over-estimated). Contrarily, in flood periods where O-B innovations are usually more turbulent, more careful attention might be taken when performing compression methods.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "The authors would like to thank Dr. Bertrand Iooss and Dr. Ang\u00e9lique Pon\u00e7ot for fruitful discussions about the compression methodology and the hydrological application. This work was supported by EDF R&D. This research was partially funded by the Leverhulme Centre for Wildfires, Environment and Society through the Leverhulme Trust, grant number RC-2018-023. The authors are grateful to an anonymous reviewer for the useful remarks on the manuscript.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Acknowledgement"
        }
    ]
}