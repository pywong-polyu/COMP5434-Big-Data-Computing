{"paper_id": "f25fde80df624acbc1d0c9268aa7725a25036fb8", "metadata": {"title": "Modeling and Computation of High Efficiency and Efficacy Multi-Step Batch Testing for Infectious Diseases", "authors": [{"first": "Hongshik", "middle": [], "last": "Ahn", "suffix": "", "affiliation": {"laboratory": "", "institution": "Brook University Stony Brook", "location": {"postCode": "11794-3600", "region": "NY"}}, "email": ""}, {"first": "Haoran", "middle": [], "last": "Jiang", "suffix": "", "affiliation": {"laboratory": "", "institution": "Brook University Stony Brook", "location": {"postCode": "11794-3600", "region": "NY"}}, "email": ""}, {"first": "Xiaolin", "middle": [], "last": "Li", "suffix": "", "affiliation": {"laboratory": "", "institution": "Brook University Stony Brook", "location": {"postCode": "11794-3600", "region": "NY"}}, "email": ""}]}, "abstract": [{"text": "We propose a mathematical model based on probability theory to optimize COVID-19 testing by a multi-step batch testing approach with variable batch sizes. This model and simulation tool dramatically increase the efficiency and efficacy of the tests in a large population at a low cost. The proposed method combines statistical modeling with numerical methods to solve nonlinear equations and obtain optimal batch sizes at each step of tests, with the flexibility to incorporate geographic and demographic information. We also conducted a Monte Carlo simulation study to verify this theory. Our simulation results show that our method reduces the false negative rate by 80%. Our method substantially improves the false positive rate and positive predictive value as well. The proposed method will be particularly useful for the prevention of a second wave of the coronavirus outbreaks, and more generally for the early stages of future pandemics. The proposed work will have broader impacts on medical testing for contagious diseases in general.", "cite_spans": [], "ref_spans": [], "section": "Abstract"}], "body_text": [{"text": "To fight the COVID-19 pandemic with limited resources, batch tests are recommended by pooling multiple swab samples from each individual. Samples from different individuals are pooled into one batch and then a high-throughput PCR test is conducted (Cheng, 2020; Clark, 2020; Lohse et al., 2020; Shani-Narkiss et al., 2020) . By grouping individuals, batch testing significantly reduces the number of tests, providing an efficient method to detect community transmission (Hogan et al., 2020) . Batch testing has become more relevant recently, as state and local governments seek to test as many people as possible to transition safely back to normal life. For example, a recent press release by the US FDA indicates developers' interest in incorporating pooling samples for domestic testing (Shuren, 2020) . According to a CNN report, Dr. Anthony Fauci of the National Institute of Allergy and Infectious Diseases said that The White House coronavirus task force was seriously considering pooled testing for COVID-19 and acknowledged that the current testing strategy has proven inadequate (Acosta and Fossum, 2020) . Places abroad such as South Korea started using pooling methods to sample in batches of a fixed size in high-risk communities (Park and Koo, 2020; Kwak, 2020; Korea Center for Disease Control & Prevention, 2020) . However, the drawback to batch testing is a much higher false negative rate than individual testing.", "cite_spans": [{"start": 248, "end": 261, "text": "(Cheng, 2020;", "ref_id": "BIBREF1"}, {"start": 262, "end": 274, "text": "Clark, 2020;", "ref_id": "BIBREF2"}, {"start": 275, "end": 294, "text": "Lohse et al., 2020;", "ref_id": "BIBREF7"}, {"start": 295, "end": 322, "text": "Shani-Narkiss et al., 2020)", "ref_id": "BIBREF9"}, {"start": 470, "end": 490, "text": "(Hogan et al., 2020)", "ref_id": "BIBREF3"}, {"start": 790, "end": 804, "text": "(Shuren, 2020)", "ref_id": "BIBREF10"}, {"start": 1089, "end": 1114, "text": "(Acosta and Fossum, 2020)", "ref_id": "BIBREF0"}, {"start": 1243, "end": 1263, "text": "(Park and Koo, 2020;", "ref_id": "BIBREF8"}, {"start": 1264, "end": 1275, "text": "Kwak, 2020;", "ref_id": "BIBREF5"}, {"start": 1276, "end": 1328, "text": "Korea Center for Disease Control & Prevention, 2020)", "ref_id": null}], "ref_spans": [], "section": "Introduction"}, {"text": "In this study, we introduce a batch-based approach which simultaneously addresses the problem of limited resources and testing accuracy. We consider a multi-step testing procedure with variable batch sizes where each step divides the population into subpopulations based on the previous step's results. These subpopulations are further divided into batches for testing. We introduce a method to estimate the optimal batch sizes given the infection rates of subpopulations to efficiently and accurately test most, if not the entire, population. The proposed method incorporates test errors and optimizes batch sizes at each step and for each subpopulation. Shani-Narkiss et al. (2020) also considered a multi-step testing procedure with variable batch sizes. However, their approach assumes that there are no test errors, and their batch sizes are restricted to powers of two.", "cite_spans": [{"start": 656, "end": 683, "text": "Shani-Narkiss et al. (2020)", "ref_id": "BIBREF9"}], "ref_spans": [], "section": "Introduction"}, {"text": "We recommend taking multiple test samples from each person in a single visit. The first sample will be included in a batch PCR test. The samples are then split into subpopulations with negative test results (batch negative) and positive test results (batch positive). Each subpopulation is given another round of batch tests where the batch size increases for the batch negatives and decreases for the batch positives. We iterate this procedure on each subpopulation, where at each step we can estimate the infection rate. This process is continued until one of the following conditions is satisfied: (i) the process results in three batch negatives or three batch positives, (ii) the infection rate of the subpopulation becomes higher than 30%, (iii) the optimal batch size is reduced to 2. Details of this procedure are given in Section 2.5. To apply our approach most effectively, we can first divide the population based on infection rates, for example by dividing based on geography, population density, proximity to highly infected regions, etc. Information given by various methods including mobile apps and online mapping (Lee and Lee, 2020) may help track the virus and divide the population into different groups.", "cite_spans": [{"start": 1130, "end": 1149, "text": "(Lee and Lee, 2020)", "ref_id": "BIBREF6"}], "ref_spans": [], "section": "Introduction"}, {"text": "We also address the efficacy of the tests. The false negative rate of the COVID-19 PCR test for an individual is known to be near 15%, ranging from 10 to 30% (Clark, 2020; Xiao et al., 2020; West et al., 2020; Yang and Yan, 2020) . By one-step batch testing, the false negative rate increases (Shuren, 2020) . By our multi-step batch testing procedure, the false negative rate is substantially reduced. To the best of our knowledge, no other studies have attempted estimating optimal batch sizes by taking testing errors into account.", "cite_spans": [{"start": 158, "end": 171, "text": "(Clark, 2020;", "ref_id": "BIBREF2"}, {"start": 172, "end": 190, "text": "Xiao et al., 2020;", "ref_id": "BIBREF12"}, {"start": 191, "end": 209, "text": "West et al., 2020;", "ref_id": "BIBREF11"}, {"start": 210, "end": 229, "text": "Yang and Yan, 2020)", "ref_id": "BIBREF13"}, {"start": 293, "end": 307, "text": "(Shuren, 2020)", "ref_id": "BIBREF10"}], "ref_spans": [], "section": "Introduction"}, {"text": "If three batch negatives occur before getting three batch positives, then we conclude that the individuals in the batch of the final round are not infected. For people whose samples result in three batch positives before three batch negatives, each sample needs to be tested individually to find out which was positive. To reduce the false negative rate, up to three individual tests are performed for the samples from each individual in this group. For a population of size 100,000 with an infection rate of .1%, if the false negative rate is 15% and false positive rate is 1% for an individual test, then our method requires less than 7,000 tests to test the entire population. Results for different infection rates are detailed in Section 3. The simulation results show that our method reduces the false negative rate to approximately 3%, and the false positive rate to near zero.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "It is a well-known fact that the positive predictive value (PPV) is very low when the infection rate is low even if the sensitivity is very high. For a false positive rate of 1% and false negative rate of 15%, the PPV of an individual test is 8% for an infection rate of .1%, and 46% for an infection rate of 1%. According to our simulation, our multi-step batch testing procedure improves the PPV to 89% and 93%, respectively. This is because individual tests are conducted on the subject in the final positive batches which have higher infection rates than the entire population (see Section 2.4 and Section 3).", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "The original purpose for batch testing was to prevent the spread of disease in high-risk communities by testing everyone, symptomatic or not. However, the proposed method can be applied to the general population, due to its flexibility in dealing with various infection rates and its substantially greater sensitivity compared to individual testing and current batch testing approaches. More specifically, our method can accurately test a large population with limited resources by dividing the population based on infection rates, for example based on geography, population density, proximity to highly infected regions, etc. This method can be applied to effectively combat a second wave of the current pandemic and even a future pandemic of new diseases.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "We begin by studying a simple case where the accuracy of a virus screening test is 100%. Suppose that the infection rate in a population is p (rate of no infection is q = 1 \u2212 p) and the accuracy of a virus screening test is 100%. Let X be a random variable denoting the number of positive cases in a batch of size n. Then X follows a binomial distribution with n trials and success rate p. The probability of k positive cases in the batch is", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size assuming no testing errors"}, {"text": "and the probability that the batch is tested negative is P (X = 0) = (1 \u2212 p) n = q n .", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size assuming no testing errors"}, {"text": "Using an initial guess of the batch size n, we want to estimate q. Let A = P (X = 0). Then after a good number of batch tests, we can estimate q by", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size assuming no testing errors"}, {"text": "Suppose we test a population in batches of size n, then test all individuals who were in positively tested batches. For a population of size N , the expected total number of tests to be performed to identify all positive carriers is", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size assuming no testing errors"}, {"text": "To find the optimal n, we minimize T (n) as", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size assuming no testing errors"}, {"text": "We can solve this equation for n numerically.", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size assuming no testing errors"}, {"text": "We conduct a hypothesis testing with null hypothesis H 0 : The subject is healthy versus alternative hypothesis H 1 : The subject is infected. To reduce testing errors, we propose a procedure of conducting multiple rounds of batch tests before carrying out individual tests for a selected group. Denote the probability of a Type I error (false positive rate) as \u03b1 and the probability of a Type II error (false negative rate) as \u03b2. Let the infection rate be p 1 and q 1 = 1 \u2212 p 1 in the initial batch tests for the whole population, and X the random variable denoting the number of positive cases in a batch of size n 1 . Then the probability of a batch negative based on (1) can be obtained as", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "Using an initial guess of the batch size n 1 , we want to estimate q 1 . After a good number of batch tests, we can estimate q 1 by", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "Suppose all the subjects in the positive batches get individual PCR tests. If the size of the entire population is N 1 , the required number of tests can be obtained from (2) by substituting (3) for q n as", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "To find the optimal batch size x, we minimize T 1 (x) as", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "This can be solved for x numerically. In this study, we used the secant method to solve the equation. The optimal batch size n 1 is either floor(x) or ceiling(x) which has the lower value of T (\u00b7). The initial batch tests can be conducted using n 1 for the whole population. Continuing this process, after the (i \u2212 1)th round, the subjects have been divided into subpopulations. Each subpopulation was batch tested with batch sizes determined from that round. Fixing one of these subpopulations, we now split it into two smaller subpopulations for the ith round, according to the batch test results from the (i \u2212 1)th round. Let N i denote the number of subjects in population belonging to test-negative batches from the (i \u2212 1)th round, and p i denote the infection rate of this subpopulation. The expected size of the subpopulation in the ith round of batch tests is", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "In this subpopulation, the probability that at least one subject in a batch is infected is", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "and the probability that all the subjects in a batch are not infected is 1 \u2212 r i . The estimated number of infected subjects in this subpopulation is", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "Here, E(X i\u22121 )/P (X i\u22121 > 0) is the expected number of infected subjects in a test-positive batch in the (i \u2212 1)th round, where X i\u22121 is a binomial random variable with n i\u22121 trials and success rate p i\u22121 . Therefore, the infection rate", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "of the subpopulation in the ith round can be used for estimating the optimal batch size and the required number of tests. The optimal number of required tests can be obtained by replacing n 1 with n i and q 1 with q i in (3) and (5) to get", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "and the optimal batch size for this round is obtained by minimizing T i (\u00b7). For example, suppose the estimated infection rate is p 1 = .01 and \u03b1 = .01, \u03b2 = .15 for the population of size 100,000. Then T 1 (x) in (5) is minimized when n 1 = 12. For the second round, the expected subpopulation size is obtained from (6) as N 2 = 100, 000 .84(.99) 12 + .15 = 89,456. From (7), r 2 = .15 1 \u2212 (.99) 12 / (1 \u2212 .01)(.99) 12 + 0.15 1 \u2212 (.99) 12 = .019 and the estimated infection rate in this subpopulation is obtained from (8) as p 2 = (.01)(.019)/ 1 \u2212 (.99) 12 = 0.00167. For this infection rate, the optimal batch size n 2 = 27 is obtained by minimizing T 2 (x) in (9).", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "Further, we can estimate the optimal batch size for the subpopulation consisting of batch posi- tives. In the (i \u2212 1)th round, the probability that a batch of size n i\u22121 is tested positive is", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "The size of this subpopulation can be modified from (6) as", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "In this subpopulation, the probability that at least one subject in a batch is infected is", "cite_spans": [], "ref_spans": [], "section": "Optimal batch size given testing errors"}, {"text": "and the probability that all the subjects are not infected is 1 \u2212 r i . The estimated infection rate p i in this subpopulation can be obtained as (8). This infection rate can be used for estimating the optimal batch size n i and the required number of tests for the subpopulation in the ith round. The accuracy of these formulae developed in this section has been confirmed by matching results with the simulation results given in Section 3. Figure 1 displays the optimal batch size and the required number of batches for a population of size 100,000 as the infection rate ranges from .001 to .25 for the first round, and the false negative rate ranges from .1 to .25. The false positive rate is fixed at .01. Table 1 displays the optimal batch sizes for different infection rates (a) when no testing errors are assumed and (b) when the false negative rate is 15% and the false positive rate is 1%. Table 2 : Probability in each cell of the confusion matrix for single batch testing.", "cite_spans": [], "ref_spans": [{"start": 442, "end": 450, "text": "Figure 1", "ref_id": "FIGREF0"}, {"start": 710, "end": 717, "text": "Table 1", "ref_id": "TABREF0"}, {"start": 899, "end": 906, "text": "Table 2", "ref_id": null}], "section": "Optimal batch size given testing errors"}, {"text": "Test \u2212 (a) (1 \u2212 \u03b1)P (X = 0) (b) \u03b2P (X > 0) Result + (c) \u03b1P (X = 0) (d) (1 \u2212 \u03b2)P (X > 0)", "cite_spans": [], "ref_spans": [], "section": "True condition No samples are infected At least one sample is infected"}, {"text": "Let us consider one-step batch testing. If a batch is tested negative, then we conclude that all samples in the batch are negative. If a batch is tested positive, then each sample in the batch needs to be tested individually. Let the binomial random variable X denote the number of positive cases for a batch of size n with an infection rate of p. We continue to denote \u03b1 as the probability of a Type I error and \u03b2 as the probability of a Type II error for an individual test. Table 2 displays the probabilities for the confusion matrix.", "cite_spans": [], "ref_spans": [{"start": 477, "end": 484, "text": "Table 2", "ref_id": null}], "section": "Sensitivity and specificity of a batch test"}, {"text": "In cells (b) and (d), at least one sample is infected in each batch. It can be deduced that all the samples in cell (b) are negative, and no more tests are given. The probability that an infected individual is incorrectly tested negative from the batch test is \u03b2P (X > 0)[p/P (X > 0)] = \u03b2p. In cell (d), the probability that an infected individual is correctly tested positive from the batch test", "cite_spans": [], "ref_spans": [], "section": "Sensitivity"}, {"text": "An individual test is given to each sample in this cell, and the probability that a sample is incorrectly tested negative is", "cite_spans": [], "ref_spans": [], "section": "Sensitivity"}, {"text": "Therefore, the false negative rate is obtained as", "cite_spans": [], "ref_spans": [], "section": "Sensitivity"}, {"text": "For example, if \u03b2 = .15, then the false negative rate of batch testing is .85(2 \u2212 .85) = .2775, and thus the sensitivity is .7225. For \u03b2 = .1, .2 and .25, the sensitivity of batch testing is .81, .64 and .5625, respectively. Note that the sensitivity of a batch test depends on neither the infection rate nor the batch size. The above result is supported by our simulation given in Section 3. It confirms that the sensitivity is decreased by conventional batch testing. In contrast, our multi-step batch testing method has a significantly higher sensitivity than conventional individual tests as well as single batch testing according to our simulation studies.", "cite_spans": [], "ref_spans": [], "section": "Sensitivity"}, {"text": "Uninfected samples can be in any of the four cells in Table 2 . In cell (a), all the samples are correctly tested negative and the probability of that is", "cite_spans": [], "ref_spans": [{"start": 54, "end": 61, "text": "Table 2", "ref_id": null}], "section": "Specificity"}, {"text": "In cell (c), all the samples go through individual tests. The probability that a sample is correctly tested negative in the individual tests is", "cite_spans": [], "ref_spans": [], "section": "Specificity"}, {"text": "In cells (b) and (d), the expected infection rate in each batch is p/P (X > 0). The samples in cell (b) do not go through individual tests, and the probability that an uninfected sample is correctly tested negative in batch testing in this cell is", "cite_spans": [], "ref_spans": [], "section": "Specificity"}, {"text": "In cell (d), the probability that an uninfected sample is correctly tested negative in individual tests is", "cite_spans": [], "ref_spans": [], "section": "Specificity"}, {"text": "The sum of (10), (11), (12) and (13) is", "cite_spans": [], "ref_spans": [], "section": "Specificity"}, {"text": "Therefore, the specificity of batch testing is", "cite_spans": [], "ref_spans": [], "section": "Specificity"}, {"text": "Unlike the sensitivity of batch testing, the batch size, infection rate, probability of a Type I (14) using a fixed batch size of 10, and using the optimal batch size is given in Table 3 . The specificity is substantially improved by batch testing. These results closely match with our simulation results given in Section 3.", "cite_spans": [], "ref_spans": [{"start": 179, "end": 186, "text": "Table 3", "ref_id": "TABREF1"}], "section": "Specificity"}, {"text": "Let us define E as the event that an individual is infected by the virus, and B as the event that an individual got a positive test result. Then by the Bayes' Rule, PPV (positive predictive value: an individual is infected given a positive test result) is (1) Specificity is .99", "cite_spans": [], "ref_spans": [], "section": "PPV and NPV"}, {"text": "(2) Infection rate and NPV (negative predictive value: an individual is not infected given a negative test result) is", "cite_spans": [], "ref_spans": [], "section": "PPV and NPV"}, {"text": "For example, if the infection rate in the population is 1%, sensitivity is 85%, and specificity is 99%, then P (E) = 0.01, P (B|E) = 0.85 and P B C |E C = 0.99. Therefore, the PPV is .4620 and the NPV is .9985. If the infection rate is .1%, then the PPV is .0078 and the NPV is .9998. For the infection rates p \u2208 [.001, .2], sensitivity within the range of [.75, .90 ] and the specificity of .99, Table 4 illustrates PPV and NPV. Figure 2 displays the PPV (above) and NPV (below). The PPV is substantially improved by our multi-step batch testing procedure (see Section 3). ", "cite_spans": [{"start": 357, "end": 366, "text": "[.75, .90", "ref_id": null}], "ref_spans": [{"start": 397, "end": 404, "text": "Table 4", "ref_id": "TABREF2"}, {"start": 430, "end": 438, "text": "Figure 2", "ref_id": null}], "section": "PPV and NPV"}, {"text": "More than 3 batch negatives may not be necessary in the procedure because the infection rate substantially decreases in later rounds. Figure 3 illustrates the proposed batch test procedure. We will further investigate the optimal number of batch tests and the stopping rule in this study. For batch negatives, the batch size increases substantially with most of the subjects remaining in the next round because the infection rate decreases. For batch positives, the subpopulation size substantially decreases in the next round. In this group, not all the samples in the batch are infected, so we can find a sample without infection in the next round of batch tests. This way, the number of required tests to cover the whole population decreases significantly. It is possible to identify all positive carriers in the population if a sufficient number of swab samples can be obtained from each person in a single visit.", "cite_spans": [], "ref_spans": [{"start": 134, "end": 142, "text": "Figure 3", "ref_id": null}], "section": "Multi-step batch testing procedure"}, {"text": "We assume 15% false negative rate and 1% false positive rate of an individual for a population of size 100,000 in this section. Table 5 shows the change in the infection rate and corresponding optimal batch size throughout the process shown in Figure 3 for a population with infection rates of .1% and 1%. In the first round, the optimal batch size is 35 resulting in 2,858 batch tests when the infection rate is .1%, and the optimal batch size is 12 resulting in 8,334 batch tests when the infection rate is 1%. Note that the number of batch tests for the first round can be slightly different from this estimation due to the trial for estimating the infection rate with (4) using a small subset of the population with an initial guess of the batch size. The subsequent rounds do not require this trial because the infection rates of subpopulations can be estimated as (8) using the values obtained in the previous rounds. For the ith round, the number of batch tests can be obtained by ceiling(N i /n i ). We count only the bold-faced numbers starting the first round because the rest are duplicates. In each of Round 2 and Round 3, the bold-faced subpopulation sizes (N i ) add up to 100,000 if we ignore the rounding error. In Round 4, the bold-faced subpopulation sizes plus N in the final column for already finished (\u2212 \u2212 \u2212 and + + +) rows add up to 100,000. The calculation is similar for Round 5. The final two columns show the infection rate and resulting subpopulation size in each of the terminal nodes (rectangular frames) in Figure 3 . For each infection rate, since the individuals in an upper half of the last column got 3 batch negatives, they do not need individual tests. A lower half of the last column needs individual tests because they got 3 batch positives. Thus, the total number of individual tests is the sum of these 10 numbers. The total number of tests can be obtained by adding the number of batch tests in Round 1, the number of batch tests obtained from the bold-faced numbers in the subsequent rounds, and the number of individual tests.", "cite_spans": [], "ref_spans": [{"start": 128, "end": 135, "text": "Table 5", "ref_id": "TABREF3"}, {"start": 244, "end": 252, "text": "Figure 3", "ref_id": null}, {"start": 1538, "end": 1546, "text": "Figure 3", "ref_id": null}], "section": "Multi-step batch testing procedure"}, {"text": "The expected number of tests to identify all positive carriers is 6,144 (5,696 batch tests and 448 individual tests) when the infection rate is .1%, and 22,436 (19,409 batch tests and 3,027 individual tests) when the infection rate is 1%. To reduce the false negative rate, we propose to conduct simultaneous tests for three samples from each individual in the group of 3 batch positives. Then the number of individual tests is 3 times the sum of the 10 numbers at the bottom of the last column. The decision is made by majority voting. After these simultaneous individual tests, the expected number of tests becomes 7,040 when the infection rate is .1% and 28,490 when the infection rate is 1%.", "cite_spans": [], "ref_spans": [], "section": "Multi-step batch testing procedure"}, {"text": "To preserve testing resources, the simultaneous individual tests can be modified as sequential individual tests as follows: We conduct up to 3 tests for the same person sequentially until a positive test occurs. Let us define E as the event that an individual is infected by the virus, and B i as the event that an individual got a positive result in the ith individual test. Then the probability that a sample is tested positive in the first test is", "cite_spans": [], "ref_spans": [], "section": "Multi-step batch testing procedure"}, {"text": "the probability that a person is tested negative and then tested positive is", "cite_spans": [], "ref_spans": [], "section": "Multi-step batch testing procedure"}, {"text": "and a person is tested negative twice is", "cite_spans": [], "ref_spans": [], "section": "Multi-step batch testing procedure"}, {"text": "Thus, the expected number of the individual tests for each person is", "cite_spans": [], "ref_spans": [], "section": "Multi-step batch testing procedure"}, {"text": "We can obtain the expected total number of sequential individual tests by substituting the infection rate and the subpopulation size in each of the bottom 10 rows of the last two columns. For the infection rate of .1%, the expected number of sequential individual tests in (15) is 1,155, and the expected number of tests for the whole procedure becomes 6,851. For the infection rate of 1%, the expected number of sequential individual tests is 7,236, and the expected number of tests for the ", "cite_spans": [], "ref_spans": [], "section": "Multi-step batch testing procedure"}, {"text": "We conducted a Monte Carlo simulation study to evaluate the efficiency and efficacy of the proposed batch testing procedure. In this simulation, we assume that the sensitivity and specificity of tests are 85% and 99%, respectively. A population of 100,000 people is randomly generated 100 times. The infection rates of .1%, 1%, 3%, 5% and 10% are chosen. Table 6 compares our methods with conventional individual tests as well as single batch testing using various accuracy measures. We compare the accuracy measures for (A) conventional individual tests, (B) one-step batch testing with a fixed batch size of 10, (C) one-step batch testing with optimal batch sizes as proposed in this study, (D) proposed multi-step batch tests ending with three batch negatives or three batch positives, with an individual test given to three batch positives, (E) our multi-step batch tests given in (D), with 3 simultaneous individual tests for three batch positives, (F) our multi-step batch tests given in (D), with up to 3 individual tests for three batch positives. In (E), the decision for the simultaneous individual tests is made by majority voting. For (C), (D), (E) and (F), the optimal batch sizes estimated in Section 2.5 are used in the subpopulations in each step. For each of the infection rates, the overall accuracy, sensitivity, specificity, PPV and NPV are calculated, and the required number of tests to cover the whole population is calculated from this simulation, and the values are averaged over the 100 repetitions. The fixed batch size of 10 given in (B) has been used in South Korea for high-risk facilities. For multi-step batch testing, individual tests are conducted to the subpopulation if the infection rate exceeds 30% in any step as mentioned in Section 1. The accuracy measures of methods (B) and (C) are very close. However, (C) requires fewer tests by using the optimal batch sizes. Note that the number of required tests in methods (D), (E) and (F) are close to the estimated numbers derived in Section 2.5. The sensitivity is reduced in the single batch tests (given in (B) and (C)) to approximately 72% from conventional individual tests. This is because if a batch is tested negative, then all the samples in the batch are considered uninfected, and no further tests are given. The results are in line with the sensitivity of 72.25% for one-step batch testing obtained in Section 2.3.1. By the multi-step batch testing given in (D), the sensitivity is substantially improved from the single batch tests to approximately 83%. After conducting simultaneous individual tests for the 3 batch positives (given in (E)), the sensitive is increased to over 91%, and sequential individual tests in (F) further improves it to approximately 97%. This improvement is achieved because the simultaneous tests or sequential individual tests are given to small target subpopulations obtained by our test procedure. As mentioned in Section 2.3.2, the specificity is significantly improved by batch testing from conventional individual testing. The specificity of method (E) is close to 1 because the simultaneous individual tests substantially reduce the false positive rate. The specificity of single batch testing obtained in this simulation closely matches with the expected value given in (14). See also Table 3 . The improvement of the PPV by our procedure is extraordinary. As discussed in Section 2.4 (also shown in (A) of Table 6 ), the PPV of an individual test is 8% and 46% when the infection rates are .1% and 1%, respectively. According to our simulation, a single-step batch testing with optimal batch sizes improves this to 65% and 88%, respectively. Our procedure shown in (F) further improves it to 89% and 93%, respectively. Method (F) gives lower PPV, but higher sensitivity than Method (E). This is tradeoff between simultaneous tests and sequential tests.", "cite_spans": [], "ref_spans": [{"start": 355, "end": 362, "text": "Table 6", "ref_id": "TABREF4"}, {"start": 3317, "end": 3324, "text": "Table 3", "ref_id": "TABREF1"}, {"start": 3439, "end": 3446, "text": "Table 6", "ref_id": "TABREF4"}], "section": "Simulation Studies"}, {"text": "The overall number of batch tests from the simulation is close to the estimated number from our model given in Section 2.2. For .1% infection rate, the number of batch tests in the simulation is 5,700 and the estimated number is 5,696. For 1% infection rate, the numbers are 19,495 from the simulation and 19,409 from our estimation. However, the simulated number of individual tests for samples with 3 batch positives is slightly higher than the predicted value. This is likely due to randomness. This discrepancy does not significantly impact the overall number of tests because the size of the subpopulation requiring individual tests is very small (approximately 0.5% for .1% infection rate, and around 3% for 1% infection rate) compared to the whole population. For .1% infection rate, for example, 509 people received individual tests in the simulation (given in (D)), whereas the model estimates that 448 people need individual tests. This means approximately 99.5% of the population do not require individual tests. The model estimate of this value is 99.552% (100,000-448), and the simulated value is 99.491% (100,000-509).", "cite_spans": [], "ref_spans": [], "section": "Simulation Studies"}, {"text": "Note that the overall accuracy is mostly affected by specificity because the infection rates are low. We can incorporate geographic and demographic information for more realistic calculation.", "cite_spans": [], "ref_spans": [], "section": "Simulation Studies"}, {"text": "The COVID-19 pandemic changed our lifestyle, seriously impacted the global economy, and took many precious lives. To get back to normalcy, or prevent a second wave of the disease, we need a rapid testing of the virus for all the residents of each community. Unlike other coronavirus outbreaks we experienced in the past, the disease rapidly spreads silently by asymptomatic carriers. Since only patients with symptoms have been getting tests, it is a challenging task to identify asymptomatic COVID-19 carriers. In most countries including the US, some patients with symptoms could not get tests due to the limited testing capacity. To conduct testing a broader population more efficiently, batch testing methods have been introduced.", "cite_spans": [], "ref_spans": [], "section": "Discussion"}, {"text": "The South Korean Center for Disease Control & Prevention used a single-step batch testing for long-term care facilities with a fixed batch size of 10 for the entire staff and patients. As seen in our simulation studies, batch testing increases the false negative rate, although this approach can monitor high-risk groups without symptoms by reducing the number of tests needed to cover the entire community. In this paper, we proposed a multi-step batch testing procedure to substantially decrease the false negative rate using a small number of test kits to completely test a large population. The improvement of PPV from individual testing is also remarkable, thus our multi-step approach can be trusted for reliable results. Note that the sampling portion of our procedure can be implemented by taking multiple test samples obtained from each person in a single visit. Table 5 shows that the proposed batch procedure is effective for a population with a low or moderate infection rate. For the groups of 3 batch positives, we proposed 3 simultaneous or sequential individual tests, depending on the speed of assessment and supply of testing resources. For example, if the test results are delayed, then the simultaneous tests are recommended. If the test results can be obtained fast enough, then the sequential tests will be more cost effective.", "cite_spans": [], "ref_spans": [{"start": 872, "end": 879, "text": "Table 5", "ref_id": "TABREF3"}], "section": "Discussion"}, {"text": "Our approach will be useful for the prevention of a second wave of coronavirus, and more generally for early stages of future pandemics. Our method is most effective for diseases with infection rates of up to 3%. We do not recommend this approach for highly contagious large populations with infection rates greater than 5%, as the prescribed amount of tests becomes very large. Shuren (2020) addresses that conventional batch testing has a higher chance of false negative results because samples are diluted, but it works well when there is a low prevalence of cases. In contrast, our method is also useful for moderate size, highly contagious communities which require accurate virus screening for the entire community. In future studies, we will investigate optimal stopping rules to further improve the efficiency and efficacy of the multi-step batch testing procedure.", "cite_spans": [{"start": 379, "end": 392, "text": "Shuren (2020)", "ref_id": "BIBREF10"}], "ref_spans": [], "section": "Discussion"}], "bib_entries": {"BIBREF0": {"ref_id": "b0", "title": "Fauci says task force 'seriously considering' new testing strategy", "authors": [{"first": "J", "middle": [], "last": "Acosta", "suffix": ""}, {"first": "S", "middle": [], "last": "Fossum", "suffix": ""}], "year": 2020, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF1": {"ref_id": "b1", "title": "Statistical methods for batch screening of input populations by stage and group in COVID-19 nucleic acid testing. medRxiv", "authors": [{"first": "Y", "middle": ["Y"], "last": "Cheng", "suffix": ""}], "year": 2020, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"DOI": ["10.1101/2020.04.02.20050914"]}}, "BIBREF2": {"ref_id": "b2", "title": "Fear of the false negative COVID-19 test", "authors": [{"first": "C", "middle": [], "last": "Clark", "suffix": ""}], "year": 2020, "venue": "MedPage Today", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF3": {"ref_id": "b3", "title": "Sample pooling as a strategy to detect community transmission of SARS-CoV-2", "authors": [{"first": "C", "middle": ["A"], "last": "Hogan", "suffix": ""}, {"first": "M", "middle": ["K"], "last": "Sahoo", "suffix": ""}, {"first": "B", "middle": ["A"], "last": "Pinsky", "suffix": ""}], "year": 2020, "venue": "Journal of the American Medical Association", "volume": "323", "issn": "19", "pages": "1967--1969", "other_ids": {"DOI": ["10.1001/jama.2020.5445"]}}, "BIBREF4": {"ref_id": "b4", "title": "Frequently asked questions for KCDC on COVID-19 (updated on 24 April). Press Release", "authors": [], "year": 2020, "venue": "Korea Center for Disease Control & Prevention", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF5": {"ref_id": "b5", "title": "Korea considers testing pooled samples for vulnerable groups", "authors": [{"first": "S", "middle": [], "last": "Kwak", "suffix": ""}], "year": 2020, "venue": "Korea Biomedical Review", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF6": {"ref_id": "b6", "title": "Testing on the move: South Korea's rapid response to the COVID-19 pandemic", "authors": [{"first": "D", "middle": [], "last": "Lee", "suffix": ""}, {"first": "J", "middle": [], "last": "Lee", "suffix": ""}], "year": 2020, "venue": "Transportation Research Interdisciplinary Perspectives", "volume": "5", "issn": "", "pages": "", "other_ids": {"DOI": ["10.1016/j.trip.2020.100111"]}}, "BIBREF7": {"ref_id": "b7", "title": "Pooling of samples for testing for SARS-CoV-2 in asymptomatic people. The Lancet Infectious Diseases", "authors": [{"first": "S", "middle": [], "last": "Lohse", "suffix": ""}, {"first": "T", "middle": [], "last": "Pfuhl", "suffix": ""}, {"first": "B", "middle": [], "last": "Berk\u00f3-G\u00f6ttel", "suffix": ""}, {"first": "J", "middle": [], "last": "Rissland", "suffix": ""}, {"first": "T", "middle": [], "last": "Gei\u00dfler", "suffix": ""}, {"first": "B", "middle": [], "last": "G\u00e4rtner", "suffix": ""}, {"first": "S", "middle": ["L"], "last": "Becker", "suffix": ""}, {"first": "S", "middle": [], "last": "Schneitler", "suffix": ""}, {"first": "S", "middle": [], "last": "Smola", "suffix": ""}], "year": 2020, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"DOI": ["10.1016/S1473-3099(20)30362-5"]}}, "BIBREF8": {"ref_id": "b8", "title": "S. Korea to start using pooling methods to test 10 samples at a time", "authors": [{"first": "D", "middle": ["H"], "last": "Park", "suffix": ""}, {"first": "B", "middle": ["K"], "last": "Koo", "suffix": ""}], "year": 2020, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF9": {"ref_id": "b9", "title": "Efficient and practical sample pooling for high-throughput PCR diagnosis of COVID-19. medRxiv", "authors": [{"first": "H", "middle": [], "last": "Shani-Narkiss", "suffix": ""}, {"first": "O", "middle": ["D"], "last": "Gilday", "suffix": ""}, {"first": "N", "middle": [], "last": "Yayon", "suffix": ""}, {"first": "I", "middle": ["D"], "last": "Landau", "suffix": ""}], "year": 2020, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"DOI": ["10.1101/2020.04.06.20052159"]}}, "BIBREF10": {"ref_id": "b10", "title": "Coronavirus (COVID-19) Update: Facilitating diagnostic test availability for asymptomatic testing and sample pooling", "authors": [{"first": "J", "middle": [], "last": "Shuren", "suffix": ""}], "year": 2020, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF11": {"ref_id": "b11", "title": "COVID-19 testing: The threat of false-negative results", "authors": [{"first": "C", "middle": ["P"], "last": "West", "suffix": ""}, {"first": "V", "middle": ["M"], "last": "Montori", "suffix": ""}, {"first": "P", "middle": [], "last": "Sampathkumar", "suffix": ""}], "year": 2020, "venue": "Mayo clinic Proceedings", "volume": "95", "issn": "6", "pages": "1127--1129", "other_ids": {"DOI": ["10.1016/j.mayocp.2020.04.004"]}}, "BIBREF12": {"ref_id": "b12", "title": "False-negative of RT-PCR and prolonged nucleic acid conversion in COVID-19: Rather than recurrence", "authors": [{"first": "A", "middle": ["T"], "last": "Xiao", "suffix": ""}, {"first": "Y", "middle": ["X"], "last": "Tong", "suffix": ""}, {"first": "S", "middle": [], "last": "Zhang", "suffix": ""}], "year": 2020, "venue": "Journal of Medical Virology", "volume": "", "issn": "", "pages": "", "other_ids": {"DOI": ["10.1002/jmv.25855"]}}, "BIBREF13": {"ref_id": "b13", "title": "Patients with RT-PCR-confirmed COVID-19 and normal chest CT", "authors": [{"first": "W", "middle": [], "last": "Yang", "suffix": ""}, {"first": "F", "middle": [], "last": "Yan", "suffix": ""}], "year": 2020, "venue": "Radiology", "volume": "295", "issn": "2", "pages": "", "other_ids": {"DOI": ["10.1148/radiol.2020200702"]}}}, "ref_entries": {"FIGREF0": {"text": "Optimal batch size (left) and required number of batches (right) for the first round of batch tests. False positive rate: .01, population size: 100,000.", "latex": null, "type": "figure"}, "FIGREF1": {"text": "PPV (above) and NPV (below). Proposed multi-step batch testing procedure. The oval nodes indicate intermediate nodes and the rectangular nodes indicate terminal nodes.", "latex": null, "type": "figure"}, "TABREF0": {"text": "Optimal batch size (a) when there are no testing errors, and (b) when the false negative rate is .15, false positive rate is .01 for individual tests.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>p\u2217 </td><td>.001 </td><td>.002 </td><td>.003 </td><td>.004 </td><td>.005 </td><td>.006 </td><td>.007 </td><td>.008 </td><td>.009 </td><td>.01 </td><td>.02 </td><td>.03\n</td></tr><tr><td>(a) </td><td>32 </td><td>23 </td><td>19 </td><td>16 </td><td>15 </td><td>13 </td><td>12 </td><td>12 </td><td>11 </td><td>11 </td><td>8 </td><td>6\n</td></tr><tr><td>(b) </td><td>35 </td><td>25 </td><td>21 </td><td>18 </td><td>16 </td><td>15 </td><td>14 </td><td>13 </td><td>12 </td><td>12 </td><td>8 </td><td>7\n</td></tr><tr><td>p </td><td>.04 </td><td>.05 </td><td>.06 </td><td>.07 </td><td>.08 </td><td>.09 to </td><td>.12 </td><td>.13 to .17 </td><td>.18 to .25\n</td><td>\u00a0</td></tr><tr><td>(a) </td><td>6 </td><td>5 </td><td>5 </td><td>4 </td><td>4 </td><td>\u00a0</td><td>4 </td><td>3 </td><td>\u00a0</td><td>\u00a0</td><td>3\n</td><td>\u00a0</td></tr><tr><td>(b) </td><td>6 </td><td>6 </td><td>5 </td><td>5 </td><td>5 </td><td>\u00a0</td><td>4 </td><td>4 </td><td>\u00a0</td><td>\u00a0</td><td>3\n</td><td>\u00a0</td></tr></table></body></html>"}, "TABREF1": {"text": "Specificity for single batch testing with fixed batch size of 10 and optimal batch size for the false positive rate of .01, .03, and the false negative rate of .1, .15, .2, .25 for individual tests.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>\u03b1 \u03b2 </td><td>\u00a0</td><td>Infection rate </td><td>.001 </td><td>.01 </td><td>.03 </td><td>.05 </td><td>.10\n</td></tr><tr><td>Batch size 10 </td><td>Specificity </td><td>.9998 </td><td>.9991 </td><td>.9978 </td><td>.9966 </td><td>.9944\n</td></tr><tr><td>.1 </td><td>Optimal batch size </td><td>Batch size </td><td>34 </td><td>11 </td><td>7 </td><td>5 </td><td>4\n</td></tr><tr><td>\u00a0</td><td>\u00a0</td><td>Specificity </td><td>.9996 </td><td>.9990 </td><td>.9984 </td><td>.9982 </td><td>.9975\n</td></tr><tr><td>\u00a0</td><td>Batch size 10 </td><td>Specificity </td><td>.9998 </td><td>.9992 </td><td>.9979 </td><td>.9968 </td><td>.9948\n</td></tr><tr><td>.15 </td><td>Optimal batch size </td><td>Batch size </td><td>35 </td><td>12 </td><td>7 </td><td>6 </td><td>4\n</td></tr><tr><td>.01 </td><td>\u00a0</td><td>Specificity </td><td>.9996 </td><td>.9990 </td><td>.9985 </td><td>.9980 </td><td>.9976\n</td></tr><tr><td>\u00a0</td><td>Batch size 10 </td><td>Specificity </td><td>.9998 </td><td>.9992 </td><td>.9980 </td><td>.9970 </td><td>.9951\n</td></tr><tr><td>.2 </td><td>Optimal batch size </td><td>Batch size </td><td>36 </td><td>12 </td><td>7 </td><td>6 </td><td>4\n</td></tr><tr><td>\u00a0</td><td>\u00a0</td><td>Specificity </td><td>.9996 </td><td>.9991 </td><td>.9986 </td><td>.9981 </td><td>.9978\n</td></tr><tr><td>\u00a0</td><td>Batch size 10 </td><td>Specificity </td><td>.9998 </td><td>.9993 </td><td>.9981 </td><td>.9972 </td><td>.9954\n</td></tr><tr><td>.25 </td><td>Optimal batch size </td><td>Batch size </td><td>37 </td><td>12 </td><td>7 </td><td>6 </td><td>5\n</td></tr><tr><td>\u00a0</td><td>\u00a0</td><td>Specificity </td><td>.9996 </td><td>.9991 </td><td>.9987 </td><td>.9982 </td><td>.9974\n</td></tr><tr><td>\u00a0</td><td>Batch size 10 </td><td>Specificity </td><td>.9989 </td><td>.9968 </td><td>.9928 </td><td>.9895 </td><td>.9831\n</td></tr><tr><td>.1 </td><td>Optimal batch size </td><td>Batch size </td><td>34 </td><td>11 </td><td>7 </td><td>5 </td><td>4\n</td></tr><tr><td>\u00a0</td><td>\u00a0</td><td>Specificity </td><td>.9983 </td><td>.9966 </td><td>.9947 </td><td>.9943 </td><td>.9920\n</td></tr><tr><td>\u00a0</td><td>Batch size 10 </td><td>Specificity </td><td>.9989 </td><td>.9970 </td><td>.9932 </td><td>.9900 </td><td>.9840\n</td></tr><tr><td>.15 </td><td>Optimal batch size </td><td>Batch size </td><td>36 </td><td>12 </td><td>7 </td><td>6 </td><td>4\n</td></tr><tr><td>.03 </td><td>\u00a0</td><td>Specificity </td><td>.9983 </td><td>.9965 </td><td>.9950 </td><td>.9935 </td><td>.9924\n</td></tr><tr><td>\u00a0</td><td>Batch size 10 </td><td>Specificity </td><td>.9989 </td><td>.9971 </td><td>.9936 </td><td>.9906 </td><td>.9849\n</td></tr><tr><td>.2 </td><td>Optimal batch size </td><td>Batch size </td><td>37 </td><td>12 </td><td>7 </td><td>6 </td><td>4\n</td></tr><tr><td>\u00a0</td><td>\u00a0</td><td>Specificity </td><td>.9983 </td><td>.9967 </td><td>.9952 </td><td>.9939 </td><td>.9928\n</td></tr><tr><td>\u00a0</td><td>Batch size 10 </td><td>Specificity </td><td>.9989 </td><td>.9972 </td><td>.9939 </td><td>.9911 </td><td>.9859\n</td></tr><tr><td>.25 </td><td>Optimal batch size </td><td>Batch size </td><td>38 </td><td>13 </td><td>8 </td><td>6 </td><td>5\n</td></tr><tr><td>\u00a0</td><td>\u00a0</td><td>Specificity </td><td>.9983 </td><td>.9966 </td><td>.9950 </td><td>.9942 </td><td>.9917\n</td></tr></table></body></html>"}, "TABREF2": {"text": "PPV and NPV.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>Sensitivity(1)\n</td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td></tr><tr><td>p(2) </td><td>\u00a0</td><td>.75 </td><td>.77 </td><td>.79 </td><td>.81 </td><td>.83 </td><td>.85 </td><td>.87 </td><td>.89 </td><td>.90\n</td></tr><tr><td>.001 </td><td>PPV </td><td>.0070 </td><td>.0072 </td><td>.0073 </td><td>.0075 </td><td>.0077 </td><td>.0078 </td><td>.0080 </td><td>.0082 </td><td>.0083\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9997 </td><td>.9998 </td><td>.9998 </td><td>.9998 </td><td>.9998 </td><td>.9998 </td><td>.9999 </td><td>.9999 </td><td>.9999\n</td></tr><tr><td>.002 </td><td>PPV </td><td>.1307 </td><td>.1337 </td><td>.1367 </td><td>.1397 </td><td>.1426 </td><td>.1455 </td><td>.1485 </td><td>.1514 </td><td>.1528\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9995 </td><td>.9995 </td><td>.9996 </td><td>.9996 </td><td>.9997 </td><td>.9997 </td><td>.9997 </td><td>.9998 </td><td>.9998\n</td></tr><tr><td>.004 </td><td>PPV </td><td>.2315 </td><td>.2362 </td><td>.2409 </td><td>.2455 </td><td>.2500 </td><td>.2545 </td><td>.2589 </td><td>.2633 </td><td>.2655\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9990 </td><td>.9991 </td><td>.9991 </td><td>.9992 </td><td>.9993 </td><td>.9994 </td><td>.9995 </td><td>.9996 </td><td>.9996\n</td></tr><tr><td>.006 </td><td>PPV </td><td>.3116 </td><td>.3173 </td><td>.3229 </td><td>.3284 </td><td>.3338 </td><td>.3391 </td><td>.3443 </td><td>.3495 </td><td>.3520\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9985 </td><td>.9986 </td><td>.9987 </td><td>.9988 </td><td>.9990 </td><td>.9991 </td><td>.9992 </td><td>.9993 </td><td>.9994\n</td></tr><tr><td>.008 </td><td>PPV </td><td>.3769 </td><td>.3831 </td><td>.3892 </td><td>.3951 </td><td>.4010 </td><td>.4067 </td><td>.4123 </td><td>.4178 </td><td>.4206\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9980 </td><td>.9981 </td><td>.9983 </td><td>.9985 </td><td>.9986 </td><td>.9988 </td><td>.9989 </td><td>.9991 </td><td>.9992\n</td></tr><tr><td>.01 </td><td>PPV </td><td>.4310 </td><td>.4375 </td><td>.4438 </td><td>.5500 </td><td>.4560 </td><td>.4620 </td><td>.4677 </td><td>.4734 </td><td>.4762\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9975 </td><td>.9977 </td><td>.9979 </td><td>.9981 </td><td>.9983 </td><td>.9985 </td><td>.9987 </td><td>.9989 </td><td>.9990\n</td></tr><tr><td>.02 </td><td>PPV </td><td>.6048 </td><td>.6111 </td><td>.6172 </td><td>.6231 </td><td>.6288 </td><td>.6343 </td><td>.6397 </td><td>.6449 </td><td>.6475\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9949 </td><td>.9953 </td><td>.9957 </td><td>.9961 </td><td>.9965 </td><td>.9969 </td><td>.9973 </td><td>.9977 </td><td>.9979\n</td></tr><tr><td>.03 </td><td>PPV </td><td>.6988 </td><td>.7043 </td><td>.7096 </td><td>.7147 </td><td>.7197 </td><td>.7244 </td><td>.7291 </td><td>.7335 </td><td>.7357\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9923 </td><td>.9929 </td><td>.9935 </td><td>.9941 </td><td>.9947 </td><td>.9953 </td><td>.9960 </td><td>.9966 </td><td>.9969\n</td></tr><tr><td>.05 </td><td>PPV </td><td>.7978 </td><td>.8021 </td><td>.8061 </td><td>.8100 </td><td>.8137 </td><td>.8173 </td><td>.8208 </td><td>.8241 </td><td>.8257\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9869 </td><td>.9879 </td><td>.9890 </td><td>.9900 </td><td>.9910 </td><td>.9921 </td><td>.9931 </td><td>.9942 </td><td>.9947\n</td></tr><tr><td>.08 </td><td>PPV </td><td>.8671 </td><td>.8701 </td><td>.8729 </td><td>.8757 </td><td>.8783 </td><td>.8808 </td><td>.8832 </td><td>.8856 </td><td>.8867\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9785 </td><td>.9802 </td><td>.9819 </td><td>.9836 </td><td>.9853 </td><td>.9870 </td><td>.9887 </td><td>.9904 </td><td>.9913\n</td></tr><tr><td>.10 </td><td>PPV </td><td>.8929 </td><td>.8953 </td><td>.8978 </td><td>.9000 </td><td>.9022 </td><td>.9043 </td><td>.9063 </td><td>.9082 </td><td>.9091\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9727 </td><td>.9748 </td><td>.9770 </td><td>.9791 </td><td>.9813 </td><td>.9834 </td><td>.9856 </td><td>.9878 </td><td>.9889\n</td></tr><tr><td>.15 </td><td>PPV </td><td>.9298 </td><td>.9315 </td><td>.9331 </td><td>.9346 </td><td>.9361 </td><td>.9375 </td><td>.9388 </td><td>.9401 </td><td>.9408\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9573 </td><td>.9606 </td><td>.0639 </td><td>.9672 </td><td>.9706 </td><td>.9740 </td><td>.9774 </td><td>.9808 </td><td>.9825\n</td></tr><tr><td>.20 </td><td>PPV </td><td>.9494 </td><td>.9506 </td><td>.9518 </td><td>.9529 </td><td>.9540 </td><td>.9551 </td><td>.9560 </td><td>.9570 </td><td>.9574\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9406 </td><td>.9451 </td><td>.9496 (1)Specificity is .99 </td><td>.9542 </td><td>.9588 (2)Infection rate\n</td><td>.9635 </td><td>.9682 </td><td>.9730 </td><td>.9754\n</td></tr></table></body></html>"}, "TABREF3": {"text": "Batch test procedure * : population size 100,000, false negative rate 15% & false positive rate 1% for individual tests, infection rates .1% and 1%. rate= .1%. The first round requires 2858 tests with batch size 35.", "latex": null, "type": "table"}, "TABREF4": {"text": "Simulation results: 100 repetitions, population size 100,000, sensitivity 85% & specificity 99% for individual tests; mean with standard deviation in parentheses. Conventional individual tests b One-step batch tests with a fixed batch size of 10, individual tests for positive batches c One-step batch tests with variable optimal batch sizes; individual tests for positive batches d Multi-step batch tests ending with 3 batch negatives or 3 batch positives; individual tests for 3 batch positives e (D) with 3 simultaneous individual tests with majority voting for 3 batch positives. f (D) with maximum 3 sequential individual tests until getting a positive test (1) infection rate (2) overall accuracy (3) sensitivity (4) specificity (5) Number of required tests (6) number of batch tests + number of individual tests", "latex": null, "type": "table"}, "TABREF5": {"text": "Table 5: Batch test procedure \u2217: population size 100,000, false negative rate 15% & false positive\nrate 1% for individual tests, infection rates .1% and 1%.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>\u00a0</td><td>Infection rate= </td><td>.1%. The first round requires </td><td>2858 tests </td><td>with batch size </td><td>35.\n</td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td></tr><tr><td>\u00a0</td><td>\u00a0</td><td>Round 2 </td><td>\u00a0</td><td>\u00a0</td><td>Round 3 </td><td>\u00a0</td><td>Round 4 </td><td>\u00a0</td><td>Round 5 </td><td>Final\n</td></tr><tr><td>Tests </td><td>(1)\np2 </td><td>(2)\nN\n2 </td><td>(3)\nn2 </td><td>p3 </td><td>N3 </td><td>n3 </td><td>p4 </td><td>N4 </td><td>n4 </td><td>p5 </td><td>N5 </td><td>n5 </td><td>p </td><td>N\n</td></tr><tr><td>\u2212\u2212\u2212 </td><td>2e-4 </td><td>96109 </td><td>88 </td><td>2e-5 </td><td>94047 </td><td>224 </td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>4e-6 </td><td>92684\n</td></tr><tr><td>\u2212\u2212+\u2212 </td><td>2e-4 </td><td>96109 </td><td>88 </td><td>2e-5 </td><td>94047 </td><td>224 </td><td>.001 </td><td>1363 </td><td>30 </td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>2e-4 </td><td>1302\n</td></tr><tr><td>\u2212+\u2212\u2212 </td><td>2e-4 </td><td>96109 </td><td>88 </td><td>.006 </td><td>2062 </td><td>15 </td><td>.001 </td><td>1888 </td><td>35 </td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>2e-4 </td><td>1814\n</td></tr><tr><td>+\u2212\u2212\u2212 </td><td>.022 </td><td>3891 </td><td>8 </td><td>.004 </td><td>3322 </td><td>18 </td><td>6e-4 </td><td>3102 </td><td>45 </td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>1e-4 </td><td>3000\n</td></tr><tr><td>\u2212\u2212++\u2212 </td><td>2e-4 </td><td>96109 </td><td>88 </td><td>2e-5 </td><td>94047 </td><td>224 </td><td>.001 </td><td>1363 </td><td>30 </td><td>.027 </td><td>61 </td><td>7 </td><td>.005 </td><td>51\n</td></tr><tr><td>\u2212+\u2212+\u2212 </td><td>2e-4 </td><td>96109 </td><td>88 </td><td>.006 </td><td>2062 </td><td>15 </td><td>.001 </td><td>1888 </td><td>35 </td><td>.022 </td><td>74 </td><td>8 </td><td>.004 </td><td>63\n</td></tr><tr><td>\u2212++\u2212\u2212 </td><td>2e-4 </td><td>96109 </td><td>88 </td><td>.006 </td><td>2062 </td><td>15 </td><td>.062 </td><td>175 </td><td>5 </td><td>.012 </td><td>133 </td><td>10 </td><td>.002 </td><td>118\n</td></tr><tr><td>+\u2212\u2212+\u2212 </td><td>.022 </td><td>3891 </td><td>8 </td><td>.004 </td><td>3322 </td><td>18 </td><td>6e-4 </td><td>3102 </td><td>45 </td><td>.016 </td><td>102 </td><td>9 </td><td>.003 </td><td>90\n</td></tr><tr><td>+\u2212+\u2212\u2212 </td><td>.022 </td><td>3891 </td><td>8 </td><td>.004 </td><td>3322 </td><td>18 </td><td>.049 </td><td>220 </td><td>6 </td><td>.010 </td><td>169 </td><td>12 </td><td>.002 </td><td>152\n</td></tr><tr><td>+ +\u2212\u2212\u2212 </td><td>.022 </td><td>3891 </td><td>8 </td><td>.13 </td><td>568 </td><td>4 </td><td>.03 </td><td>362 </td><td>7 </td><td>.005 </td><td>300 </td><td>15 </td><td>.001 </td><td>278\n</td></tr><tr><td>+ + + </td><td>.022 </td><td>3891 </td><td>8 </td><td>.13 </td><td>568 </td><td>4 </td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>.30 </td><td>206\n</td></tr><tr><td>+ +\u2212+ </td><td>.022 </td><td>3891 </td><td>8 </td><td>.13 </td><td>568 </td><td>4 </td><td>.03 </td><td>362 </td><td>7 </td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>.15 </td><td>62\n</td></tr><tr><td>+\u2212++ </td><td>.022 </td><td>3891 </td><td>8 </td><td>.004 </td><td>3322 </td><td>18 </td><td>.049 </td><td>220 </td><td>6 </td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>.18 </td><td>51\n</td></tr><tr><td>\u2212+++ </td><td>2e-4 </td><td>96109 </td><td>88 </td><td>.006 </td><td>2062 </td><td>15 </td><td>.062 </td><td>175 </td><td>5 </td><td>\u00a0</td><td>\u00a0</td><td>\u00a0</td><td>.22 </td><td>42\n</td></tr><tr><td>+ +\u2212\u2212+ </td><td>.022 </td><td>3891 </td><td>8 </td><td>.13 </td><td>568 </td><td>4 </td><td>.03 </td><td>362 </td><td>7 </td><td>.005 </td><td>300 </td><td>15 </td><td>.06 </td><td>23\n</td></tr><tr><td>+\u2212+\u2212+ </td><td>.022 </td><td>3891 </td><td>8 </td><td>.004 </td><td>3322 </td><td>18 </td><td>.049 </td><td>220 </td><td>6 </td><td>.010 </td><td>169 </td><td>12 </td><td>.08 </td><td>17\n</td></tr><tr><td>+\u2212\u2212++ </td><td>.022 </td><td>3891 </td><td>8 </td><td>.004 </td><td>3322 </td><td>18 </td><td>6e-4 </td><td>3102 </td><td>45 </td><td>.016 </td><td>102 </td><td>9 </td><td>.11 </td><td>13\n</td></tr><tr><td>\u2212++\u2212+ </td><td>2e-4 </td><td>96109 </td><td>88 </td><td>.006 </td><td>2062 </td><td>15 </td><td>.062 </td><td>175 </td><td>5 </td><td>.012 </td><td>133 </td><td>10 </td><td>.10 </td><td>14\n</td></tr><tr><td>\u2212+\u2212++ </td><td>2e-4 </td><td>96109 </td><td>88 </td><td>.006 </td><td>2062 </td><td>15 </td><td>.001 </td><td>1888 </td><td>35 </td><td>.022 </td><td>74 </td><td>8 </td><td>.13 </td><td>11\n</td></tr><tr><td>\u2212\u2212+++ </td><td>2e-4 </td><td>96109 </td><td>88 </td><td>2e-5 </td><td>94047 </td><td>224 </td><td>.001 </td><td>1363 </td><td>30 </td><td>.027 </td><td>61 </td><td>7 </td><td>.15 </td><td>9\n</td></tr></table></body></html>"}, "TABREF6": {"text": "Table 6: Simulation results: 100 repetitions, population size 100,000, sensitivity 85% & specificity\n99% for individual tests; mean with standard deviation in parentheses.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>p(1) </td><td>\u00a0</td><td>.001 </td><td>.01 </td><td>.03 </td><td>.05 </td><td>.10\n</td></tr><tr><td>(A)a </td><td>Acc.(2) </td><td>.9899 (.0003) </td><td>.9886 (.0004) </td><td>.9858 (.0003) </td><td>.9830 (.0004) </td><td>.9760 (.0005)\n</td></tr><tr><td>Indiv. </td><td>Sens.(3) </td><td>.8519 (.0365) </td><td>.8493 (.0112) </td><td>.8504 (.0060) </td><td>.8494 (.0046) </td><td>.8503 (.0035)\n</td></tr><tr><td>Tests </td><td>Spec.(4) </td><td>.9900 (.0003) </td><td>.9900 (.0003) </td><td>.9900 (.0003) </td><td>.9900 (.0003) </td><td>.9900 (.0004)\n</td></tr><tr><td>PPV </td><td>.0787 (.0083) </td><td>.4627 (.0128) </td><td>.7247 (.0075) </td><td>.8168 (.0051) </td><td>.9045 (.0032)\n</td></tr><tr><td>\u00a0</td><td>NPV </td><td>.9999 (.0000) </td><td>.9985 (.0001) </td><td>.9953 (.0002) </td><td>.9921 (.0003) </td><td>.9835 (.0004)\n</td></tr><tr><td>(B)b </td><td>#Tests(5) </td><td>100,000 (0) </td><td>100,000 (0) </td><td>100,000 (0) </td><td>100,000 (0) </td><td>100,000 (0)\n</td></tr><tr><td>Acc. </td><td>.9996 (.0001) </td><td>.9964 (.0002) </td><td>.9896 (.0004) </td><td>.9831 (.0004) </td><td>.9675 (.0007)\n</td></tr><tr><td>Single </td><td>Sens. </td><td>.7305 (.0452) </td><td>.7237 (.0131) </td><td>.7223 (.0088) </td><td>.7226 (.0078) </td><td>.7229 (.0057)\n</td></tr><tr><td>Batch </td><td>Spec. </td><td>.9998 (.0000) </td><td>.9992 (.0001) </td><td>.9979 (.0002) </td><td>.9968 (.0002) </td><td>.9947 (.0002)\n</td></tr><tr><td>Tests </td><td>PPV </td><td>.8143 (.0376) </td><td>.8995 (.0111) </td><td>.9148 (.0058) </td><td>.9222 (.0043) </td><td>.9386 (.0026)\n</td></tr><tr><td>Fixed </td><td>NPV </td><td>.9997 (.0001) </td><td>.9972 (.0002) </td><td>.9914 (.0003) </td><td>.9856 (.0004) </td><td>.9700 (.0007)\n</td></tr><tr><td>Size 10 </td><td>#Tests </td><td>11,832 (146) </td><td>19,041 (297) </td><td>33,117 (377) </td><td>44,646 (472) </td><td>65,771 (459)\n</td></tr><tr><td>(C)c </td><td>Acc. </td><td>.9993 (.0001) </td><td>.9962 (.0002) </td><td>.9902 (.0003) </td><td>.9843 (.0004) </td><td>.9700 (.0006)\n</td></tr><tr><td>Single </td><td>Sens. </td><td>.7218 (.0471) </td><td>.7198 (.0146) </td><td>.7226 (.0066) </td><td>.7226 (.0065) </td><td>.7218 (.0051)\n</td></tr><tr><td>Batch </td><td>Spec. </td><td>.9996 (.0001) </td><td>.9990 (.0001) </td><td>.9985 (.0001) </td><td>.9980 (.0001) </td><td>.9976 (.0002)\n</td></tr><tr><td>Tests </td><td>PPV </td><td>.6526 (.0401) </td><td>.8800 (.0114) </td><td>.9371 (.0050) </td><td>.9508 (.0034) </td><td>.9712 (.0019)\n</td></tr><tr><td>Variable </td><td>NPV </td><td>.9997 (.0001) </td><td>.9972 (.0002) </td><td>.9915 (.0002) </td><td>.9856 (.0004) </td><td>.9699 (.0006)\n</td></tr><tr><td>Sizes </td><td>#Tests </td><td>6,732 (359) </td><td>18,888 (358) </td><td>31,469 (310) </td><td>39,935 (380) </td><td>54,897 (284)\n</td></tr><tr><td>B+Ind(6) </td><td>2858+3874 </td><td>8334+10554 </td><td>14186+17283 </td><td>16668+23267 </td><td>25000+29897\n</td></tr><tr><td>(D)d </td><td>Acc. </td><td>.9998 (.0000) </td><td>.9980 (.0001) </td><td>.9941 (.0002) </td><td>.9906 (.0003) </td><td>.9814 (.0004)\n</td></tr><tr><td>Multi- </td><td>Sens. </td><td>.8238 (.0385) </td><td>.8263 (.0115) </td><td>.8292 (.0067) </td><td>.8306 (.0056) </td><td>.8297 (.0036)\n</td></tr><tr><td>Step </td><td>Spec. </td><td>1.000 (.0000) </td><td>.9998 (.0000) </td><td>.9992 (.0001) </td><td>.9990 (.0001) </td><td>.9983 (.0001)\n</td></tr><tr><td>Batch </td><td>PPV </td><td>.9574 (.0227) </td><td>.9716 (.0055) </td><td>.9704 (.0035) </td><td>.9772 (.0022) </td><td>.9817 (.0015)\n</td></tr><tr><td>Tests </td><td>NPV </td><td>.9998 (.0000) </td><td>.9982 (.0001) </td><td>.9947 (.0002) </td><td>.9912 (.0003) </td><td>.9814 (.0004)\n</td></tr><tr><td>#Tests </td><td>6,219 (164) </td><td>22,935 (293) </td><td>42,580 (300) </td><td>56,099 (328) </td><td>83,989 (399)\n</td></tr><tr><td>(E)e </td><td>B+Ind </td><td>5710+509 </td><td>19495+3440 </td><td>31832+10748 </td><td>41553+14546 </td><td>58617+25372\n</td></tr><tr><td>Acc. </td><td>.9999 (.0000) </td><td>.9991 (.0001) </td><td>.9974 (.0002) </td><td>.9958 (.0002) </td><td>.9916 (.0003)\n</td></tr><tr><td>(D) with </td><td>Sens. </td><td>.9122 (.0306) </td><td>.9158 (.0095) </td><td>.9160 (.0057) </td><td>.9164 (.0038) </td><td>.9165 (.0025)\n</td></tr><tr><td>Simul. </td><td>Spec. </td><td>1.0000 (.0000) </td><td>1.000 (.0000) </td><td>1.0000 (.0000) </td><td>1.0000 (.0000) </td><td>.9999 (.0000)\n</td></tr><tr><td>Indiv. </td><td>PPV </td><td>.9980 (.0043) </td><td>.9993 (.0009) </td><td>.9991 (.0006) </td><td>.9994 (.0003) </td><td>.9995 (.0002)\n</td></tr><tr><td>Tests </td><td>NPV </td><td>.9999 (.0000) </td><td>.9991 (.0001) </td><td>.9974 (.0002) </td><td>.9956 (.0002) </td><td>.9908 (.0003)\n</td></tr><tr><td>for 3 +'s </td><td>#Tests </td><td>7,224 (259) </td><td>29,794 (507) </td><td>64,087 (651) </td><td>85,191 (699) </td><td>134,774 (923)\n</td></tr><tr><td>B+Ind </td><td>5700+1524 </td><td>19489+10305 </td><td>31825+32262 </td><td>41560+43631 </td><td>58626+76148\n</td></tr><tr><td>(F)f </td><td>Acc. </td><td>.9999 (.0000) </td><td>.9990 (.0001) </td><td>.9969 (.0002) </td><td>.9958 (.0002) </td><td>.9926 (.0003)\n</td></tr><tr><td>(D) w/ </td><td>Sens. </td><td>.9710 (.0170) </td><td>.9697 (.0049) </td><td>.9725 (.0029) </td><td>.9727 (.0025) </td><td>.9727 (.0019)\n</td></tr><tr><td>Seq. </td><td>Spec. </td><td>.9999 (.0000) </td><td>.9993 (.0001) </td><td>.9976 (.0002) </td><td>.9970 (.0002) </td><td>.9948 (.0003)\n</td></tr><tr><td>Indiv. </td><td>PPV </td><td>.8919 (.0296) </td><td>.9309 (.0081) </td><td>.9272 (.0044) </td><td>.9449 (.0032) </td><td>.9543 (.0023)\n</td></tr><tr><td>Tests </td><td>NPV </td><td>1.000 (.0000) </td><td>.9997 (.0000) </td><td>.9991 (.0001) </td><td>.9986 (.0001) </td><td>.9970 (.0002)\n</td></tr><tr><td>for 3 +'s </td><td>#Tests </td><td>7,040 (231) </td><td>27,928 (474) </td><td>58,476 (583) </td><td>75,990 (561) </td><td>116,445 (728)\n</td></tr><tr><td>B+Ind aConventional individual tests\n</td><td>5704+1336 </td><td>19487+8441 </td><td>31838+26638 </td><td>41544+34446 </td><td>58625+57820\n</td></tr></table></body></html>"}}, "back_matter": [{"text": "Xiaolin Li and Haoran Jiang are supported in part by US Army Research Office grant W911NF-18-10346, Xiaolin Li and Hongshik Ahn are supported by the US Army Research Office through the equipment grant W911NF-20-10159. The authors thank Andrew Ahn for useful discussions and giving valuable comments on a draft of this paper.", "cite_spans": [], "ref_spans": [], "section": "Acknowledgments"}]}