{"paper_id": "6e2cd0b42dec19f72031adbf7fc70aab2bea0141", "metadata": {"title": "Modelling the Extremes of Seasonal Viruses and Hospital Congestion: The Example of Flu in a Swiss Hospital", "authors": [{"first": "Setareh", "middle": [], "last": "Ranjbar", "suffix": "", "affiliation": {"laboratory": "", "institution": "University of Lausanne", "location": {}}, "email": ""}, {"first": "Eva", "middle": [], "last": "Cantoni", "suffix": "", "affiliation": {"laboratory": "", "institution": "University of Geneva", "location": {}}, "email": ""}, {"first": "Val\u00e9rie", "middle": [], "last": "Chavez-Demoulin", "suffix": "", "affiliation": {"laboratory": "", "institution": "University of Lausanne", "location": {}}, "email": ""}, {"first": "Giampiero", "middle": [], "last": "Marra", "suffix": "", "affiliation": {"laboratory": "", "institution": "University College London", "location": {}}, "email": ""}, {"first": "Rosalba", "middle": [], "last": "Radice", "suffix": "", "affiliation": {}, "email": ""}, {"first": "Katia", "middle": [], "last": "Jaton-Ogay", "suffix": "", "affiliation": {"laboratory": "", "institution": "CHUV", "location": {"settlement": "Lausanne"}}, "email": ""}]}, "abstract": [{"text": "Viruses causing flu or milder coronavirus colds are often referred to as \"seasonal viruses\" as they tend to subside in warmer months. In other words, meteorological conditions tend to impact the activity of viruses, and this information can be exploited for the operational management of hospitals. In this study, we use three years of daily data from one of the biggest hospitals in Switzerland and focus on modelling the extremes of hospital visits from patients showing flu-like symptoms and the number of positive cases of flu. We propose employing a discrete Generalized Pareto distribution for the number of positive and negative cases, and a Generalized Pareto distribution for the odds of positive cases. Our modelling framework allows for the parameters of these distributions to be linked to covariate effects, and for outlying observations to be dealt with via a robust estimation approach. Because meteorological conditions may vary over time, we use meteorological and not calendar variations to explain hospital charge extremes, and our empirical findings highlight their significance. We propose a measure of hospital congestion and a related tool to estimate the resulting CaRe (Charge-at-Risk-estimation) under different meteorological conditions. The relevant numerical computations can be easily carried out using the freely available GJRM R package. The introduced approach could be applied to several types of seasonal disease data such as those derived from the new virus SARS-CoV-2 and its COVID-19 disease which is at the moment wreaking havoc worldwide. The empirical effectiveness of the proposed method is assessed through a simulation study.", "cite_spans": [], "ref_spans": [], "section": "Abstract"}], "body_text": [{"text": "Congestion is of paramount concern for most large size hospitals. At the time of writing, hospitals across the world are experiencing congestion due to the coronavirus pandemic. Predicting both the number of visits to the hospital and potential pandemic considerably helps the operational management of hospitals. Empirical evidence suggests that the flu virus is more vulnerable in warm weather, hence making it more common for epidemics to proliferate in fall and winter months in the northern hemisphere. The role of weather in the spread of flu is not yet fully understood and researchers have attempted to address this question. Roussel et al. (2016) studied the impact of six climate variables (related to temperature, humidity and sunshine) on flu spread, whereas Towers et al. (2013) analysed waves of influenza and climate patterns. Davis et al. (2012) examined the hypothesis that cold and/or dry weather enhances human pneumonia and influenza mortality, whereas Firestone et al. (2012) quantified the association between the hazard of flu infection and air temperature, humidity, rainfall and wind velocity. It has been generally found that flu's transmission is mostly dependent on humidity and temperature (Lowen and Steel, 2014) , with cold and dry weather making flu more active. In this paper, we approach the problem from the point of view of hospitals facing the risk of congestion and hence the need for assessing the efficiency of the flu testing process. Specifically, we aim at understanding and quantifying the impact of weather related variables on the probability of obtaining: a high number of positive flu tested patients (epidemic), a high number of negative flu tested patients (inefficiency), and high values of positive odds (number of positive flu over negative flu tested patients).", "cite_spans": [{"start": 634, "end": 655, "text": "Roussel et al. (2016)", "ref_id": "BIBREF19"}, {"start": 771, "end": 791, "text": "Towers et al. (2013)", "ref_id": "BIBREF21"}, {"start": 842, "end": 861, "text": "Davis et al. (2012)", "ref_id": "BIBREF3"}, {"start": 973, "end": 996, "text": "Firestone et al. (2012)", "ref_id": "BIBREF10"}, {"start": 1219, "end": 1242, "text": "(Lowen and Steel, 2014)", "ref_id": "BIBREF14"}], "ref_spans": [], "section": "Introduction"}, {"text": "We use three years (2016/2017, 2017/2018 and 2018/2019) of daily data from 01/07/2016 to 21/06/2019 which give us n = 1086 observations on the number of visits and positive cases for flu at the Lausanne University Hospital 1 (CHUV), one of the largest hospitals in Switzerland, with a capacity of 1000 somatic beds. q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q Recording a case of flu is per se an extreme event in the sense there are generally no flu cases registered on a \"normal\" day. This justifies the use of exceedances of positive cases over the threshold of 1, and then to model these 290 exceedances using extreme value theory. Although flu positive cases are registered roughly between November and May, the epidemic appears at a different time each year, with patterns that differ across the years. Similar considerations apply to the negative cases shown in Figure 2 , where the chosen threshold is 15, which gives us 230 exceedances. The choice of threshold corresponds to a certain level of inefficiency of the flu testing process (each test is expensive and costs 180 Swiss francs). It is not economically desirable to have too many negative cases. Consider, for example, the current case of SARS-CoV-2. Some countries do not have enough testing kits and those that are available tend to be used to detect/confirm positive cases. The different patterns observed across years suggest that the calendar day variable is not a good predictor for use within the framework of hospital management of flu (positive or negative) cases. This may be in part due to meteorological variation across years and perhaps also to climate change. As for the latter, we do not have enough data to test for a long term effect. Regarding the meteorological aspect, we propose to build a model for non-identically distributed discrete extremes where covariate effects can be accounted for. The discrete generalized Pareto distribution (D-GPD) provides a theoretically justified law for discrete extremes (Hitz et al., 2017) , whereas, in the same spirit of generalized additive models for location, scale and shape (Rigby and Stasinopoulos, 2005) , distributional parameters are made dependent on meteorological effects. The estimation approach needs to account for outlying observations as elaborated further in the next paragraph.", "cite_spans": [{"start": 19, "end": 55, "text": "(2016/2017, 2017/2018 and 2018/2019)", "ref_id": null}, {"start": 4835, "end": 4854, "text": "(Hitz et al., 2017)", "ref_id": null}, {"start": 4946, "end": 4977, "text": "(Rigby and Stasinopoulos, 2005)", "ref_id": "BIBREF18"}], "ref_spans": [{"start": 3709, "end": 3717, "text": "Figure 2", "ref_id": "FIGREF4"}], "section": "Introduction"}, {"text": "From the point of view of the management of hospital congestion due to an epidemic, a measure of interest is the odds of positive cases as shown in Figure 3 (recall that this is the ratio between the number of positive and negative cases). This value is continuous and a high number reflects a state of epidemic which in turn means that the hospital has to prepare for congestion. We define these odds to be high if they are above a threshold of 0.05, a value that is justified by a graphical technique explained in Section 2.1. The number of threshold exceedances in this case is 280. As shown in Figure 3 , some isolated extreme values appear outside the periods of flu epidemic. These points are found either at the very beginning of the flu period (a bell of alarm for hospitals since there are far more positive than negative cases) or at the end of the epidemic in early spring (corresponding to residual cases). Based on classical extreme value theory (EVT) the Generalized Pareto distribution (GPD) is the appropriate distribution to model such extremes and we build a model based on the GPD where the distributional parameters depend on meteorological factors. It is important to stress that testing patients for flu in hospital is a process that requires human intervention. As such, the recording process on certain days (e.g., 31st of December) will be different as compared to that of other days. This contaminates the underlying distribution of the data by creating outliers which have to be dealt with. To this end, we adapt the methodology introduced by Aeberhard et al. (2019) to the specific context of this paper. To the best of our knowledge no previous work has attempted to build extreme value models based on GPD and D-GPD, where the distributional parameters are allowed to be specified as functions of covariates and the presence of outlying observations is accounted for by using a theoretically founded robust estimation approach. The newly introduced models are available through the GJRM R package (Marra and Radice, 2020) which greatly simplifies the implementation of our approach, making it as simple as a canned procedure.", "cite_spans": [{"start": 1570, "end": 1593, "text": "Aeberhard et al. (2019)", "ref_id": "BIBREF0"}, {"start": 2027, "end": 2051, "text": "(Marra and Radice, 2020)", "ref_id": "BIBREF16"}], "ref_spans": [{"start": 148, "end": 156, "text": "Figure 3", "ref_id": "FIGREF6"}, {"start": 598, "end": 606, "text": "Figure 3", "ref_id": "FIGREF6"}], "section": "Introduction"}, {"text": "When we apply our proposed approach to the hospital data, we find that our three responses of interest depend on meteorological conditions. Specifically, our results suggest that the risk of congestion (extreme positive cases) increases when temperatures go down, and in periods of no sun and no rain. The risk of testing inefficiently (extreme negative cases) significantly increases in periods of no sun and no rain. The risk of outbreak (extreme odds of positive cases) increases in cold periods. We quantify these results in Section 3.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "In Section 2, we describe the proposed robust regression methodology for extremes. Section 3 reports the results of the empirical analysis for the flu hospital data while Section 4 presents the findings from a simulation study. We conclude in Section 5. q q q q q q q q q qq q qq q qq q qqq q q qq qqqq q q q q q q q q q q q q q q q q q q qq q q q q q q q q qq q q q q q q q q q q q q q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq q q q q q q q q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq q q q q q q q q q q q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qqq q q qq qq q qqq qq q q qq q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq q q q q q q q q q q ", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "Extreme value theory is the field of statistics dedicated to the study of events with low occurrence frequencies and large amplitudes. Such events are rare in relation to the bulk of a population, which makes them hard to model and difficult to predict. Section 2.1 discusses the concepts of peaks-over-threshold and Charge-at-Risk-estimation (CaRe), and describes the approach used to derive the extreme distribution used to analyze the discrete outcomes of this paper. Section 2.2 discusses the robust approach used to estimate GPD and D-GPD models whose distributional parameters are allowed to depend on covariate effects.", "cite_spans": [], "ref_spans": [], "section": "Robust Regression Methodology for Peaks-Over-Threshold"}, {"text": "One of the classical theories of extremes for a common continuous random variable is based on the probabilistic limit result for exceedances of high thresholds. The so-called peaksover-threshold (POT) consists of a limiting result for the times and sizes of exceedances over some high level. Letting (Y i ) i\u22651 be a sequence of independent and identically distributed (iid) random variables in [0, y F ), with common continuous distribution F , we concentrate on the sizes of exceedances over some high threshold. In other words, the focus is on the right tail of distribution F . The result by Balkema and de Haan (1974) allows for the approximation of the conditional distribution of the exceedances above a high threshold u. If there exist normalizing sequences {a n > 0} and {b n } such that for u \u2192 y F ,", "cite_spans": [{"start": 595, "end": 621, "text": "Balkema and de Haan (1974)", "ref_id": "BIBREF1"}], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "for some Z following a non-degenerate probability distribution on [0, \u221e), where d \u2192 denotes weak convergence, then it is possible to model the limiting distribution of the exceedances Y \u2212 u|Y > u with a Generalized Pareto distribution (GPD), that is,", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "where \u03be \u2208 IR is the shape parameter and \u03c3 > 0 the scale parameter. The case \u03be = 0 is interpreted as the limit. Parameter \u03be provides information about the heaviness of the tail of the underlying distribution F . More formally, condition (1) means that Y belongs to the maximum domain of attraction of an extreme value distribution with shape parameter \u03be and we write Y \u2208 MDA(\u03be). Some examples are the Pareto distribution,", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "for which we take a n = \u03ban 1/\u03b1 /\u03b1, b n = \u03ban 1/\u03b1 \u2212 \u03ba, and is in MDA(1/\u03b1) (Fr\u00e9chet case). The exponential distribution, F (y) = 1 \u2212 e \u2212\u03bby , \u03bb > 0, y \u2265 0, for which we take a n = 1/\u03bb, b n = (log n)/\u03bb, and is in MDA(0) (Gumbel-case).", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "Essentially all commonly encountered continuous distributions are in the maximum domain of attraction of an extreme value distribution. If the tail of F decays like a power function then F is in MDA(\u03be > 0). Distributions such as Burr, log-gamma, Cauchy, Pareto and Student-t as well as various mixture models are heavy-tailed. The Gumbel class characterized by \u03be = 0 contains light-tailed distributions such as the Gaussian, lognormal, exponential and gamma whose tail decay roughly exponentially. The so-called Weibull class, defined by \u03be < 0, contains distributions that are bounded above (e.g., uniform and Beta distributions). In other words, for a wide class of distributions, the distribution of the excesses over a high threshold can be approximated by the GPD. This result suggests that if we choose u high enough then we can assume that result (2) holds for some parameters \u03be and \u03c3. In practice, such parameters are estimated by fitting a GPD to the excess amounts over the threshold u, relying on the standard properties of maximum likelihood estimators for \u03be > \u22120.5.", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "The choice of u is important; a very low threshold would lead to high bias whereas a very high threshold to high variance. For practical purposes, a suitable threshold u is chosen using data-analytic tools such as the mean residual life plot. This is based on the fact that if excess losses over threshold u can be characterized by a GPD with parameters \u03be < 1 and \u03c3, then it is easy to show that for any higher threshold", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "so that the mean excess function is linear in v above u. In empirical applications, the mean residual life plot (which shows the empirical mean excess against increasing threshold values) is a useful tool to choose the threshold and also to determine the adequacy of the GPD model as an approximation of the excess distribution. For a linear mean excess function characterizing the GPD class, the best threshold candidate is any value for which the mean excess looks linear. Figure 5 shows mean residual life plots for the odds of positive cases without removing outliers (top panel) and after removing 1% of the largest values (bottom panel). The graphs support the presence of a contamination effect due to outliers, which may indeed make the choice of the threshold difficult. This is standard for mixed distributions.", "cite_spans": [], "ref_spans": [{"start": 475, "end": 483, "text": "Figure 5", "ref_id": "FIGREF8"}], "section": "GPD, D-GPD and CaRe"}, {"text": "Taking the point of view of the hospital's risk management, an important quantity is the quantile of Y given that Y > u because it quantifies the information about the charge load the hospital has to be ready for under different scenarios of congestion. In practice, for a fixed threshold u, given that Y > u, and a horizon of h days, the p-quantity, called Charge-at-Risk-estimation (CaRe), is the value of Y that might be exceeded one time in h days. This is defined as", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "where h = 1/(1 \u2212 p). As an example, during a flu period (Y > u), 97%-CaRe roughly corresponds to the value of Y that might be exceeded once in a month. In a financial context, a related value is the co-called Value-at-Risk imposed by the Basel committee and used, for instance, to measure the risk of loss on a specific portfolio of financial assets.", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "For a discrete random variable R, using the GPD to approximate the distribution's tail behaviour can be inappropriate. As pointed out by Hitz et al. (2017) , many common distributions such as the Poisson, geometric and negative binomial are not in any maximum domain of interest. Hitz et al. (2017) proposed two methods for modelling the tails of discrete observations from distributions with infinite support. In this paper, we briefly recall one of them. Defining the discrete maximum domain of attraction as D-MDA, we write R \u2208D-MDA(\u03be) with \u03be \u2265 0 if there exists a continuous random variable Y such that P (R \u2265 r) = P (Y \u2265 r) for r = 0, 1, 2, . . .. Then, for large integers u, we have (2), tends to a discrete generalized Pareto distribution (D-GPD) defined by", "cite_spans": [{"start": 137, "end": 155, "text": "Hitz et al. (2017)", "ref_id": null}, {"start": 280, "end": 298, "text": "Hitz et al. (2017)", "ref_id": null}], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "for r = 0, 1, 2, . . ., where\u1e20 denotes the survival function of G (see Hitz et al. (2017) and references therein).", "cite_spans": [{"start": 71, "end": 89, "text": "Hitz et al. (2017)", "ref_id": null}], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "In risk management, as mentioned ealier, the quantile is a quantity of interest. In what follows, we derive such an expression for the D-GPD. Let p \u2208 (0, 1) be the probability for which we seek a quantile, we then solve", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "As in (4) for the continuous context, the p%-CaRe for the discrete case is", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "where denotes the ceiling function (the smallest integer greater than or equal to).", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "The next section provides details on the robust estimation approach employed to fit extreme value models based on the GPD and D-GPD, where \u03c3 and \u03be can be specified as functions of covariate effects.", "cite_spans": [], "ref_spans": [], "section": "GPD, D-GPD and CaRe"}, {"text": "In the context of POT models for continuous variables through GPD excess size approximations, employing techniques that allow for flexible forms of dependence on covariates are very attractive in empirical applications (Davison and Smith, 1990) . To this end, Chavez-Demoulin and Davison (2005) employed the framework of generalized additive models (Hastie and Tibshirani, 1990; Wood, 2017) to estimate flexibly the shape and scale parameters of an orthogonal reparametrization of the GPD. Yee and Stephenson (2007) proposed instead the use of vector generalized additive models. These modelling strategies are philosophically consistent with generalized additive models for location, scale and shape (Rigby and Stasinopoulos, 2005) , where, for any continuous or discrete distribution F \u03b8 , with \u03b8 being a d-dimensional parameter vector with virtually any d > 0, all distributional parameters are allowed to depend on covariate effects. This type of modelling has received a great deal of interest since its introduction and some researchers also refer to it as distributional or multi-parameter regression. The classical and perhaps most commonly known software implementation of such models is the gamlss R package (Rigby and Stasinopoulos, 2005) . Another implementation is available via the gamlss() function from the GJRM R package (Marra and Radice, 2020) which has been extended to incorporate the models developed in this paper.", "cite_spans": [{"start": 219, "end": 244, "text": "(Davison and Smith, 1990)", "ref_id": "BIBREF4"}, {"start": 280, "end": 294, "text": "Davison (2005)", "ref_id": "BIBREF2"}, {"start": 349, "end": 378, "text": "(Hastie and Tibshirani, 1990;", "ref_id": "BIBREF11"}, {"start": 379, "end": 390, "text": "Wood, 2017)", "ref_id": "BIBREF22"}, {"start": 490, "end": 515, "text": "Yee and Stephenson (2007)", "ref_id": "BIBREF23"}, {"start": 701, "end": 732, "text": "(Rigby and Stasinopoulos, 2005)", "ref_id": "BIBREF18"}, {"start": 1218, "end": 1249, "text": "(Rigby and Stasinopoulos, 2005)", "ref_id": "BIBREF18"}], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "For i = 1, . . . , n, where n denotes the sample size, let Y i be independently sampled from F \u03b8 i (with density or probability function f \u03b8 i ), where \u03b8 i = (\u03b8 i1 , . . . , \u03b8 id ) and x i is a vector of covariates of dimension p (which can include binary, categorical, and continuous variables, for instance). The distributional assumption of Y i is understood to be conditional on all covariates. This is achieved by assuming for each parameter \u03b8 ij , for j = 1, . . . , d, that", "cite_spans": [], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "where the g j are one-to-one transformations or link functions (ensuring that the parameters range restrictions are met), \u03b2 j0 \u2208 R are overall intercepts, x ijk denotes the kth sub-vector of covariates pertaining to term j and observation i, and the K j functions f jk (\u00b7) represent generic covariate effects (which can be of any pre-specified parametric form such as linear or quadratic, or can be non-parametric). Each of these functions are approximated by a linear combination of J kj basis functions b kjl (x ikj ) and regression", "cite_spans": [], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": ". This (regression spline) approach allows for a vast variety of covariate effects. We refer the reader to Wood (2017) for all the options available and that are supported by our implementation. Note that, in our case study, linear specifications were deemed to be sufficient to model the variation in the response variables of interest.", "cite_spans": [{"start": 107, "end": 118, "text": "Wood (2017)", "ref_id": "BIBREF22"}], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "For GPD and D-GDP, we have that \u03b8 i = (\u03b8 i1 , \u03b8 i2 ) = (\u03be i , \u03c3 i ), hence d = 2. The choices of one-to-one transformations have to guarantee that the parameters lie in their admissible definition spaces. For GPD, with probability function defined as in Equation (2), we have g 1 (\u03be i ) = log (\u03be i + 0.5) and g 2 (\u03c3 i ) = log (\u03c3 i ) .", "cite_spans": [], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "For D-GDP, with probability function given by Equation (5), we employ g 1 (\u03be i ) = \u03be i and g 2 (\u03c3 i ) = log (\u03c3 i ) .", "cite_spans": [], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "The above choices ensure that \u03c3 i is positive for both distributions, that \u03be i > \u22120.5 for GPD (otherwise parameter estimation is non-regular in the sense that the score statistic is not asymptotically normal as argued by Davison and Smith (1990) ), and that \u03be i > 0 for D-GDP as required (Hitz et al., 2017) .", "cite_spans": [{"start": 221, "end": 245, "text": "Davison and Smith (1990)", "ref_id": "BIBREF4"}, {"start": 288, "end": 307, "text": "(Hitz et al., 2017)", "ref_id": null}], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "Let \u03b4 be the vector of the model's parameters to be estimated. This includes the coefficients associated with (7). Model fitting is performed by maximizing the log-likelihood", "cite_spans": [], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "log f y i |\u03b8 . Note that, although not required for our case study, our implementation supports the presence of non-parametric components. In this case, the objective function would be augmented by a penalty term defined as 1/2\u03b4 S\u03b4, where S is a matrix that depends on the choice of basis functions for the nonparametric terms, and on a set of smoothing parameters that controls the trade-off between fit and smoothness.", "cite_spans": [], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "If outlying observations occur in the data, classical model fitting will suffer from a lack of robustness, which will adversely affect parameter estimates. To deal with this, we adopt the methodology of Aeberhard et al. (2019) which essentially consists of reducing the likelihood contributions of low log-likelihood values while leaving large log-likelihood evaluations essentially unchanged. This is achieved through a function \u03c1 c applied to the log-likelihood components, so that the objective function becomes\u02dc", "cite_spans": [{"start": 203, "end": 226, "text": "Aeberhard et al. (2019)", "ref_id": "BIBREF0"}], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "is a correction factor ensuring Fisher consistency, and \u03c1 c is directly derived from the specified \u03c1 c through \u03c1 c (z) = z \u2212\u221e exp(s)\u03c1 c (s) ds with \u03c1 c (s) = \u2202\u03c1 c (s)/\u2202s. The tuning constant c > 0 in \u03c1 c regulates the trade-off between loss of estimation efficiency (should the data exactly come from the assumed model) and the magnitude of the maximum estimation bias (should the data not come from the postulated model). For any given c, \u03c1 c is assumed to be convex, monotonically increasing and twice continuously differentiable over R, and to have bounded first derivative \u03c1 c within [0, 1]. The latter can be interpreted as a multiplicative robustness weight, as one would add when weighting the estimating equations in robust M -estimation. An advantage of the approach is that it leads to a natural definition of robust information criteria.", "cite_spans": [], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "Regarding the choice of \u03c1 c , Aeberhard et al. (2019) recommend using the log-logistic function first proposed by Eguchi and Kano (2001) : \u03c1 c (z) = log 1+exp(z+c) 1+exp(c) , for c > 0, with corresponding \u03c1 c (z) = exp(z) \u2212 exp(c) log 1 + exp(z + c) and first derivative \u03c1 c (z) = exp(z + c)/ 1 + exp(z + c) . It holds that lim c\u2192\u221e \u03c1 c (z) = z so that an increasingly large c value leads to the (non-robust) original (\u03b4). The value of c is tuned via a simulation based procedure that controls how the robustness weights at the score level (represented by \u03c1 c ) behave under data generated from the assumed model. The user can decide the level of down-weighting to be achieved with respect to maximum likelihood (e.g., 95%). Aeberhard et al. (2019) established the Fisher consistency of\u03b4 as well as its asymptotic Gaussian distribution and asymptotic variance-covariance matrix which can be used to construct confidence intervals. The authors discussed a Bayesian inferential result as well. This is advantageous because such a result does not rely on asymptotic considerations, and intervals for non-linear functions of the model's parameters (e.g., CaRe) can be reliably and efficiently obtained via posterior simulation. The adopted estimation framework allows for the elegant construction of robust information criteria such as the robust AIC, that is,", "cite_spans": [{"start": 30, "end": 53, "text": "Aeberhard et al. (2019)", "ref_id": "BIBREF0"}, {"start": 114, "end": 136, "text": "Eguchi and Kano (2001)", "ref_id": "BIBREF8"}, {"start": 724, "end": 747, "text": "Aeberhard et al. (2019)", "ref_id": "BIBREF0"}], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "where edf denotes the effective degrees of freedom which is given by the trace of a matrix that depends on components of the asymptotic variance-covariance matrix of\u03b4 (Aeberhard et al., 2019) .", "cite_spans": [{"start": 167, "end": 191, "text": "(Aeberhard et al., 2019)", "ref_id": "BIBREF0"}], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "In order to estimate the model's coefficients, we have extended the efficient and stable trust region algorithm proposed by Marra and Radice (2019) to our context. One of the many advantages of such an algorithm is that it does not require the orthogonality of the distributional parameters (in this case, \u03be and \u03c3). The implementation of the trust region approach required the analytical score and Hessian of the model's log-likelihood which were derived and are reported in Supplementary Section A.", "cite_spans": [], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "Although robust models for extremes have been developed in the literature (see, e.g., Dupuis and Field, 1998; Dupuis and Victoria-Feser, 2006; Dell'Aquila and Embrechts, 2006) , we would like to stress that, to the best of our knowledge, there are no alternative robust regression models for extreme distributions, nor respective software implementations, of the type discussed in this paper. While the construction and estimation of the proposed model rely on the infrastructure and modelling framework of GJRM, extending the software to accommodate the developments needed to address the challenges of our case study required a great deal of work. Supplementary Section B provides details on the usage of function gamlss() from the GJRM R package.", "cite_spans": [{"start": 86, "end": 109, "text": "Dupuis and Field, 1998;", "ref_id": "BIBREF6"}, {"start": 110, "end": 142, "text": "Dupuis and Victoria-Feser, 2006;", "ref_id": "BIBREF7"}, {"start": 143, "end": 175, "text": "Dell'Aquila and Embrechts, 2006)", "ref_id": "BIBREF5"}], "ref_spans": [], "section": "Covariate Effects and Parameter Estimation"}, {"text": "Flu is contagious and it can spread by airborne respiratory droplets, saliva or skin-to-skin contact and by touching a contaminated surface. In Switzerland, a sentinel surveillance system and a mandatory reporting system are used to register flu data. Flu monitoring in hospitalized patients has also been in a testing phase since 2018. From a health care managerial point of view, the number of negative cases among tested patients showing flu-like symptoms is as important as the number of positive cases. An extreme number of positive cases may indicate an epidemic of such a viral infection. An extreme number of negatives can instead indicate management inefficiency and hence excessive financial costs as well as congestion in the hospital units that are involved in diagnostics and pretreatment. The contagion aspect of hospitalized patients also needs to be taken into account in the bed organization of the hospital.", "cite_spans": [], "ref_spans": [], "section": "Modelling Flu Extremes"}, {"text": "As shown in Figures 1, 2 and 3 , the annual calendar variable does not seem to provide important insights into managing and/or preventing congestion due to a flu epidemic. Based on the literature on flu transmission, we use meteorological variables for modelling the extremes of: positive flu cases, negative cases (visiting the hospital for a flu check) and the odds of positives. The meteorological variables are represented by L 3 X t = X t\u22123 , where L is the usual lag operator and X t can be each of the variables in Table 1 . For each meteorological factor, we consider the respective L 3 X t value, because, for flu, the incubation time is usually between 24 and 48 hours, and sometimes 72 hours. When discussing the models used for the analyses, extension L3 at the end of each covariate's name refers to L 3 X t values. As for the flu data, the meteorological variables were measured in Lausanne (Switzerland) from July 1, 2016 to June 21, 2019 and are available at https://gate.meteoswiss.ch/idaweb/. Figure 4 shows a correlation plot between the meteorological variables, highlighting, as expected, that humidity and radiation are highly and negatively correlated, whereas radiation and minimum temperature are positively correlated. Recall that the aim is to quantify the effect of meteorological factors on the extremes of positive, negative, and the odds of positive cases. For these responses, we specify three different models (estimated using the approach described in Section 2.2) based on the D-GPD for the two discrete responses and on the GPD for the odds of positive extremes. The models robustness tuning constants c were set to 6.1, 6.7 and 2.6, respectively, to achieve a level of down-weighting of 95%. Since the odds of positive cases is a continuous variable, we employed the mean residual life plot, based on (3), to choose the threshold defining the tail of the underlying distribution. Figure 5 shows such a plot when using all the odds data (upper panel) and without 1% of the largest values (lower panel). Looking at the upper panel, it is difficult to decide the threshold value: the mean excess curve exhibits very little linear stability and the confidence bounds become increasingly wide. In this case we choose 0.05, the value for which the mean excess tends to increase in a roughly linear manner. The lower panel, which excludes potential outliers, confirms the adequacy of the chosen threshold value. It is interesting to note that, in agreement with the analysis of Ne\u0161lehov\u00e1 et al. (2006) for mean excess plots in the presence of contaminated data, the results shown in Figure  5 support the presence of contamination due to outlying observations. More precisely, the different nature of the largest values makes the mean excess curve of the upper panel difficult to interpret. Forward variable selection (based on the RAIC defined in Equation (8)) was performed for the three models. We checked for linear and non-linear covariate effects; as mentioned in Section 2.2, linear specifications were found to be adequate for the modelling purposes of our dataset.", "cite_spans": [{"start": 2508, "end": 2531, "text": "Ne\u0161lehov\u00e1 et al. (2006)", "ref_id": "BIBREF17"}], "ref_spans": [{"start": 12, "end": 30, "text": "Figures 1, 2 and 3", "ref_id": "FIGREF1"}, {"start": 522, "end": 529, "text": "Table 1", "ref_id": null}, {"start": 1011, "end": 1019, "text": "Figure 4", "ref_id": "FIGREF7"}, {"start": 1917, "end": 1925, "text": "Figure 5", "ref_id": "FIGREF8"}, {"start": 2613, "end": 2622, "text": "Figure  5", "ref_id": "FIGREF8"}], "section": "Modelling Flu Extremes"}, {"text": "For all responses, a constant model was selected for the shape parameter \u03be. This is not surprising, first, because this parameter is difficult to estimate (Hosking and Wallis, 1987) , and, second, because it concerns the tail behavior of the underlying process, a characteristic that is not likely to vary with meteorological factors. The estimated shape parameters related to the two discrete variables (positive and negative) are close to zero, meaning an underlying light tail that in fact many common discrete distributions, including geometric, Poisson and negative binomial distributions have (Hitz et al., 2017) . The estimated shape parameter for the odds of positive has a negative sign, which makes sense as one can expect this odd to be bounded above. As for the scale parameter \u03c3, we found significant and linear effects for some meteorological variables. Below we present the results for each response variable.", "cite_spans": [{"start": 155, "end": 181, "text": "(Hosking and Wallis, 1987)", "ref_id": "BIBREF13"}, {"start": 599, "end": 618, "text": "(Hitz et al., 2017)", "ref_id": null}], "ref_spans": [], "section": "Modelling Flu Extremes"}, {"text": "In this case, the final fitted D-GPD model is based on the following equations and estimates: \u03be =\u03b1 0 , with\u03b1 0 = \u22121.974e-06 (and standard error of 3.719e-01) and", "cite_spans": [], "ref_spans": [], "section": "Number of positive cases"}, {"text": "log(\u03c3) =\u03b2 0 +\u03b2 1 MintempL3 +\u03b2 2 RadiationL3 +\u03b2 3 PrecipitationL3.", "cite_spans": [], "ref_spans": [], "section": "Number of positive cases"}, {"text": "The estimated coefficients are reported in Table 2 and their effects graphically shown in Figure S1 in Supplementary Section C. -0.009 0.004 -2.11 0.035 * Signif. codes: 0 < p-value < 1e \u22123 : * * * , p-value < 0.01 : * * , p-value < 0.05 : *", "cite_spans": [], "ref_spans": [{"start": 43, "end": 50, "text": "Table 2", "ref_id": "TABREF2"}, {"start": 90, "end": 99, "text": "Figure S1", "ref_id": "FIGREF1"}], "section": "Number of positive cases"}, {"text": "The resulting estimated value for \u03be is very close to zero, implying a probability mass function that may belong to the discrete maximum domain of attraction with \u03be = 0 (Hitz et al., 2017) . The equation for the scale parameter \u03c3 explains both the variable's variance and mean. For the latter, for GPD and therefore also for D-GPD, recall that the mean excess depends on the scale parameter as shown in Equation (3). A broad interpretation of the results is that the warmer and nicer the weather, the lower the number of extreme positive cases, variability and mean. Interestingly, radiation seems to better explain the response than humidity does, which is the factor ommonly used to explain flu spread (Lowen and Steel, 2014) . As highlighted by Figure 4 , radiation and precipitation provide complementary proxies of humidity.", "cite_spans": [{"start": 168, "end": 187, "text": "(Hitz et al., 2017)", "ref_id": null}, {"start": 703, "end": 726, "text": "(Lowen and Steel, 2014)", "ref_id": "BIBREF14"}], "ref_spans": [{"start": 747, "end": 755, "text": "Figure 4", "ref_id": "FIGREF7"}], "section": "Number of positive cases"}, {"text": "The final fitted D-GPD model is based on the following equations and estimates: \u03be =\u03b1 0 , with\u03b1 0 = 4.505e-05 (1.142e-01) and log(\u03c3) =\u03b2 0 +\u03b2 1 RadiationL3 +\u03b2 2 PrecipitationL3.", "cite_spans": [], "ref_spans": [], "section": "Number of negative test results"}, {"text": "The estimated coefficients are reported in Table 3 and their effects shown in Figure S2 in Supplementary Section C. -0.010 0.005 -2.01 0.045 * Signif. codes: 0 < p-value < 1e \u22123 : * * * , p-value < 0.01 : * * , p-value < 0.05 : * As compared to the previous model, minimum temperature does not seem to explain the variability and mean of the number of negative extremes. This may be due to the fact that cold weather activates the virus which in turn leads to more positive cases. Both the effects of radiation and precipitation are less important than those found when modelling positive cases. This may be explained by the fact that better meteorological conditions (warmer months and sun) simply decrease the number of test cases. For positive cases, favorable meteorological conditions also decrease the probability of catching the flu during the autumn/winter time. In other words, the evidence suggests that radiation and precipitation, which commonly affect the positive and negative cases, mostly influence the total number of tests that are carried out. During warmer months, summer or when the weather is good during winter time, individuals tend not to go the hospital. The analysis suggests that minimum temperature influences only the spread of flu.", "cite_spans": [], "ref_spans": [{"start": 43, "end": 50, "text": "Table 3", "ref_id": "TABREF3"}, {"start": 78, "end": 87, "text": "Figure S2", "ref_id": "FIGREF4"}], "section": "Number of negative test results"}, {"text": "The final fitted GPD model is based on the following equations and estimates: log(\u03be + 0.5) =\u03b1 0 , with\u03b1 0 = \u22123.293(0.671) and log(\u03c3) =\u03b2 0 +\u03b2 1 MintempL3.", "cite_spans": [], "ref_spans": [], "section": "Odds of positive cases"}, {"text": "The estimated coefficient for MintempL3 is reported in Table 4 and its effect displayed in Figure S3 in Supplementary Section C. -0.098 0.009 -11.17 0.000 *** Signif. codes: 0 < p-value < 1e \u22123 : * * * , p-value < 0.01 : * * , p-value < 0.05 : * In this case the resulting estimated value of \u03be is negative, implying that the underlying distribution is bounded above, that is, the ratio cannot reach extremely large values. Unsurprisingly the extremes of the odds positive do not depend on meteorological factors other than those explaining positive and negative extreme cases. However, this was not obvious because the threshold choice for the odds positive was not given by the threshold for the positive and negative cases. In this model, only minimum temperature influences the response. All in all, among the different meteorological factors observed, humidity, wind and pressure do not exhibit an effect as compared to radiation, precipitation and minimum temperature; the latter being more responsible for the epidemiological aspect of the analysis.", "cite_spans": [], "ref_spans": [{"start": 55, "end": 62, "text": "Table 4", "ref_id": "TABREF4"}, {"start": 91, "end": 100, "text": "Figure S3", "ref_id": "FIGREF6"}], "section": "Odds of positive cases"}, {"text": "From a risk management point of view, a quantity of high interest is the CaRe defined in Equation (4) for GPD, and in Equation(6) for D-GPD. These values constitute important risk measures for the hospital. Intervals are also crucial as they provide information about the estimates' uncertainty.", "cite_spans": [], "ref_spans": [], "section": "Hospital congestion"}, {"text": "For the positive cases, the p%-CaRe corresponds to the regime of congestion. Figures  6, 7 and 8 show some p%-CaRe estimated curves and respective intervals obtained via posterior simulation, based on different values of the meteorological factors. For instance, the bottom panel of Figure 6 corresponds to the 0.86%-CaRe, that is the number of positive cases that can be exceeded one time over a time horizon of 7 days. This point estimate decreases from 18, for a minimum temperature of -10 degC, to 11, for 0 degC. For a horizon of 7 days, the bottom left panel of Figure 7 shows that the number of positive cases that can be exceeded once a week decreases from 16, in the case of no sun, to 3, when radiation is at its highest value. This evidence should, however, be interpreted bearing in mind the widths of the intervals which are large. qqq qq qqq qqq qq qqq qqq qqqq qqq qqqq qqq qqqq qqqq qqqqq qqqq qqqqq qqqqqq qqqqq qqqqqqq qqqqqq qqqqqqqq qqqqqqqqq qqqq Supplementary Figures S4 and S5 show the CaRe estimated values with their simulated intervals as a function of meteorological predictors, for different time horizons for negative cases. These values convey information on the risk of inefficiency in the flu testing process, revealed by a very high number of negative cases. The risk of inefficiency considerably decreases both in sunny and raining periods. The top panel of Figure S5 shows the estimated number of negative cases that can be exceeded once a month in terms of amount of precipitation. For a 30-day horizon, CaRe goes from 50, in the scenario of no rain, to 30 when it rains.", "cite_spans": [], "ref_spans": [{"start": 77, "end": 96, "text": "Figures  6, 7 and 8", "ref_id": null}, {"start": 283, "end": 291, "text": "Figure 6", "ref_id": null}, {"start": 568, "end": 576, "text": "Figure 7", "ref_id": null}, {"start": 982, "end": 999, "text": "Figures S4 and S5", "ref_id": "FIGREF7"}, {"start": 1392, "end": 1401, "text": "Figure S5", "ref_id": "FIGREF8"}], "section": "Hospital congestion"}, {"text": "Large estimated p%-CaRe values for the odds positives, as shown in Figure S6 with their simulated intervals, correspond to the epidemic regime. Note that the intervals are thinner as compared to those obtained for the discrete responses, but the values themselves are smaller (between 0 and 1).", "cite_spans": [], "ref_spans": [{"start": 67, "end": 76, "text": "Figure S6", "ref_id": "FIGREF29"}], "section": "Hospital congestion"}, {"text": "The hospital flu testing process depends on managerial and/or decision making instances and may lead to outlying records; our robust methodology is capable of detecting these abnormal values. Figures 9, 10 and 11 show the robustness weight w = \u03c1 c (see Section 2.2) for each observation. These are obtained as a by product of the parameter estimation process. The size of the circles is proportional to (1 \u2212 w). These weights can be used to identify outliers: the lower the weight, the more likely the observation is to be outlying. We identify the points with the smallest weights, accompanied by their date of occurrence, from the figures. The observations with the smallest weights are not systematically those with large observed values, and, conversely, the largest observations are not systematically considered outliers. This can be seen in particular for the odds of positive cases.", "cite_spans": [], "ref_spans": [{"start": 192, "end": 212, "text": "Figures 9, 10 and 11", "ref_id": "FIGREF1"}], "section": "Outliers detection"}, {"text": "Dates such as 03/01/2017 and 02/01/2018 (which are after the Christmas break) are typically regarded as special days in the flu recording process. Days in February 2019 such as 24/02/2019 and 26/02/2019 in Figure 9 relate to positive cases and correspond to school holidays. At school, children are super-spreaders. This is not the case during holidays when children are with their families. This and the fact that people are less tested during holidays contribute to a significant slow-down of the flu epidemic. q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq q q q q qqq q q q qq q qq qq q qq q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qqq qq qq qq q q q q qq q q q q q q qq q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q ", "cite_spans": [], "ref_spans": [{"start": 206, "end": 214, "text": "Figure 9", "ref_id": "FIGREF12"}], "section": "Outliers detection"}, {"text": "To assess the empirical properties of our proposal in finite samples, we designed a simulation study inspired by our data analysis in Section 3. We will look at the quality of the estimated parameters and CaRe obtained using the proposed approach, both under the assumed (D-GPD or GPD) model and under contamination (i.e., in the presence of observations that deviate from the assumed model).", "cite_spans": [], "ref_spans": [], "section": "Simulation Study"}, {"text": "For D-GPD responses, we generated \"clean\" datasets from the model", "cite_spans": [], "ref_spans": [], "section": "D-GPD"}, {"text": "where the covariates distributions were chosen to mimic the behavior of MintempL3, RadiationL3 and PrecipitationL3 in the application. More precisely, we simulated the covariates as follows: x 1 \u223c N (2.3, 14) , x 2 \u223c \u0393(1.55, 0.02) and x 3 \u223c lognormal(0.71, 3.12).", "cite_spans": [{"start": 199, "end": 208, "text": "(2.3, 14)", "ref_id": null}], "ref_spans": [], "section": "D-GPD"}, {"text": "These were kept fixed throughout the simulation replicates. The parameters, inspired by our case study, were set to \u03b1 = 0.01 (hence \u03be = 10 \u22124 ), and \u03b2 = (2, \u22120.05, \u22120.005, \u22120.01) T . Contaminated datasets were obtained by randomly setting 5% of the response values to the maximum value observed in the sample. Again, this was inspired by the empirical application.", "cite_spans": [], "ref_spans": [], "section": "D-GPD"}, {"text": "The sample size was set to n = 250 (hence consistent with our application) and the number of replications to 500. We fitted models based on the robust and classical maximum likelihood estimators. For the robust approach, we chose c = 5.8 to achieve a downweighting of 0.95. (9). In each panel, the left boxplots refer to the clean data setting, and the right ones to the contaminated data setting. Figure 12 shows the centered estimated parameter estimates for model (9) . By looking at the left boxplots of each panel, corresponding to the clean data setting, we see that both boxplots are centered around zero suggesting unbiased estimation of the model parameters. We also see that the variability of the robust estimator's estimates are slightly larger than the variability of those obtained using its classical counterpart; this is expected because of the loss of efficiency of the robust estimator with respect to maximum likelihood. The story is different when looking at the right boxplots of each panel, corresponding to the contaminated data. All in all, the robust estimator performs much better than the classical one. For all the components of \u03b2, except \u03b2 2 , the robust estimator shows no bias. This is not the case for the classical estimator, which is influenced by the outliers, sometimes heavily, notably for \u03b2 0 and \u03b2 3 . Surprisingly, the robust estimator shows some bias for \u03b2 2 , but its magnitude is small. Also note that contamination affects the variability of the classical estimator, which is larger than that of the robust estimator for all the components of \u03b2. The estimation of \u03b1 0 under contamination seems more difficult. Both estimators show bias, even though that bias is much smaller for the robust estimator. It is worth recalling that a robust estimator guarantees that the bias under contamination does not explode, but it does not guarantee that it will vanish. Had we increased the amount of contamination or its strength, we would have expected the bias of the classical estimator to explode, but not that of the robust approach. Figure 13 : CaRe estimates for h = 7 for four values of x 1 : its minimum value (first row), its average (second row), its third quartile (third row) and its maximum (fourth row). The other covariates are fixed at their mean values. The true population value is identified by a darker bar. The first two columns correspond to the clean data setting, whereas the last two columns correspond to the contaminated data setting. Figure 13 reports the estimated CaRe for h = 7 as a function of x 1 , with x 2 and x 3 fixed at their mean values. CaRe is a discrete positive value (with relatively few different values in our simulation setting) and we depict it using barplots (histograms) for four representative values across the range of x 1 : its minimum (first row), its average (second row), its third quartile (third row) and its maximum (fourth row). In each panel, the true population value is identified by the dark bar. The comparison of the first two columns confirms that the robust and classical estimators perform equally well and their estimates either match the population value or are just off by one unit. Looking at the results under contamination and comparing the last two columns of the figure, we observed that the robust estimator performs much better than the classical one in that it identifies the true population value more often (roughly 95% of the times, except for min(x 1 ) where this is about 80%). In contrast, the classical CaRe estimator shows large variability and misses the population target quite often. The quality of the CaRe estimates is not uniform across the range of x 1 , with lower values of the covariate being more challenging.", "cite_spans": [{"start": 467, "end": 470, "text": "(9)", "ref_id": null}], "ref_spans": [{"start": 398, "end": 407, "text": "Figure 12", "ref_id": "FIGREF1"}, {"start": 2071, "end": 2080, "text": "Figure 13", "ref_id": "FIGREF1"}, {"start": 2495, "end": 2504, "text": "Figure 13", "ref_id": "FIGREF1"}], "section": "D-GPD"}, {"text": "We provide in the supplementary material similar figures for all the other combinations of horizons h and covariates; the conclusions do not change. Moreover, as expected, we observe that the performance of both estimators worsen as h increases, and that the CaRe seems to be difficult to estimate for low values of x 3 .", "cite_spans": [], "ref_spans": [], "section": "D-GPD"}, {"text": "To sum up, our simulation study demonstrates that our distributional regression approach is effective in estimating models with D-GPD responses, and that the robust version of the estimator can successfully cope with contaminated data.", "cite_spans": [], "ref_spans": [], "section": "D-GPD"}, {"text": "In this case, we generated data using the model log(\u03be + 0.5) = \u03b1 0 and log(\u03c3) = \u03b2 0 + \u03b2 1 x 1 ,", "cite_spans": [], "ref_spans": [], "section": "GPD"}, {"text": "where x 1 \u223c N (2.3, 14) , which reproduces what we see in our application for MintempL3. We consider \u03b1 = \u22122 (hence \u03be = \u22120.36) and \u03b2 = (\u22121.3, \u22120.1) T . Contaminated datasets were obtained by randomly setting 5% of the response values to the maximum value observed in the sample. The sample size was set to n = 250 and the number of replications to 500. Here as well, we fitted models based on the robust and classical maximum likelihood estimators, and for the robust approach, we chose c = 2.3 to achieve a downweighting of 0.95. The analysis of the boxplots of the centered parameter estimates for model (10) conveys the same conclusions as for the case of D-GPD: the robust estimator performs as well as its classical counterpart when using clean data, and outperforms the classical estimator under contamination. Furthermore, it is known that the GPD is difficult to fit and our findings suggest that our robust approach has a stabilizing property even for clean data where it corrects what seems to be a finite sample bias of the maximum likelihood estimator when estimating \u03b1 0 . It has been previously observed in the literature that robust estimators converge faster than their classical counterparts to their asymptotic distribution. Figure 15 shows functional boxplots (Sun and Genton, 2011) for the CaRe estimates as a function of x 1 . The solid red line is the median curve and the envelope represents the 50% deepest, or most central, curves, much like the interquartile range in a regular boxplot. The black dashed line is the true population CaRe. The first two rows of the panels refer to the clean data setting, whereas the last two rows to the contaminated data setting. Figure 15 : Functional boxplots of CaRe estimates as a function of x 1 for h = 30 (first column), h = 14 (second column) and h = 7 (third column). The solid red line is the median curve and the envelope represents the 50% deepest, or most central, observations. The black dashed line is the true population CaRe. The first two rows of panels are for the clean data setting, the last two rows are for the contaminated data setting.", "cite_spans": [{"start": 14, "end": 23, "text": "(2.3, 14)", "ref_id": null}, {"start": 1278, "end": 1300, "text": "(Sun and Genton, 2011)", "ref_id": "BIBREF20"}], "ref_spans": [{"start": 1242, "end": 1251, "text": "Figure 15", "ref_id": "FIGREF1"}, {"start": 1689, "end": 1698, "text": "Figure 15", "ref_id": "FIGREF1"}], "section": "GPD"}, {"text": "From the two top rows, we observe that for clean data both the classical and robust estimates are aligned with the population values. When the data are contaminated (third and fourth rows of panels) the classical estimator completely misses the target by overestimating the CaRe, whereas the robust estimator continues to perform well. The wider pink envelopes also suggest that the classical estimator has larger variability than the robust one under contamination. The unsatisfactory behavior of the classical estimator worsens with an increasing h, as one would expect.", "cite_spans": [], "ref_spans": [], "section": "GPD"}, {"text": "In summary, once again, we observe that our distributional regression approach works well in estimating models with GPD responses, with the robust version being rather stable under contamination.", "cite_spans": [], "ref_spans": [], "section": "GPD"}, {"text": "Seasonal epidemics may lead to hospitals congestion. In this paper, we use extreme value theory to study the occurrence of large numbers of flu cases in a hospital. To this end, we developed and implemented in GJRM a robust regression-type methodology that allows for non-identically distributed discrete and continuous extremes, and that deals with outlying data. The response variables of interest (the positive and negative cases together with the odds of positives) are statistically explained by meteorological variables. Although the models selected for this case study are based on parametric covariate effects, our software implementation allows for very general non-parametric functional forms, which would most likely be required for larger datasets.", "cite_spans": [], "ref_spans": [], "section": "Conclusion"}, {"text": "Taking the point of view of the hospital, which needs to manage admission capacities, we introduced the notion of charge-at-risk whose estimation, based on meteorological factors, can serve as a quantitative tool to alert the hospital and allow time to prepare for a possible congestion. The introduced approach could be applied to several types of seasonal virus data such as those deriving from the new virus SARS-CoV-2. ", "cite_spans": [], "ref_spans": [], "section": "Conclusion"}, {"text": "This section provides the analytical score and Hessian components of the model's loglikelihood, for the GPD and D-GPD distributions. We also report the expectations and variances for the two distributions, and for the D-GPD we explain how variates are simulated.", "cite_spans": [], "ref_spans": [], "section": "A Analytical Derivatives"}, {"text": "If Y follows a GPD distribution with shape parameter \u03be and scale parameter \u03c3, then its cumulative distribution function is F (\u03c3,\u03be) (y) = 1 \u2212 G (\u03c3,\u03be) (y) (with G (\u03c3,\u03be) (y) given in (2)) which is defined for \u03c3 > 0 and for {y : y > 0 and 1 + \u03bey \u03c3 > 0}. Then the probability density function is", "cite_spans": [], "ref_spans": [], "section": "A.1 GPD"}, {"text": ".", "cite_spans": [], "ref_spans": [], "section": "A.1 GPD"}, {"text": "The expectation of Y is E(Y ) = \u03c3 1\u2212\u03be and the variance is V ar(Y ) = \u03c3 2 (1+\u03be) 2 (1\u22122\u03be) .", "cite_spans": [], "ref_spans": [], "section": "A.1 GPD"}, {"text": "Having observed y = {y 1 , y 2 , \u00b7 \u00b7 \u00b7 , y n } as independent realizations of Y the log-likelihood is", "cite_spans": [], "ref_spans": [], "section": "A.1 GPD"}, {"text": "log 1 + \u03bey i \u03c3 .", "cite_spans": [], "ref_spans": [], "section": "A.1 GPD"}, {"text": "The first and second derivatives with respect to \u03be and \u03c3 are", "cite_spans": [], "ref_spans": [], "section": "A.1 GPD"}, {"text": "If Y follows a D-GPD distribution with shape parameter \u03be and scale parameter \u03c3 then the probability mass function of Y = r, where r \u2208 N 0 = {0, 1, 2, ...} is, using Equation (5),", "cite_spans": [], "ref_spans": [], "section": "A.2 D-GDP"}, {"text": "which is defined for \u03c3 > 0 and for {r : 1 + \u03ber \u03c3 > 0 and 1 + \u03be(r+1) \u03c3 > 0}.", "cite_spans": [], "ref_spans": [], "section": "A.2 D-GDP"}, {"text": "The mean and variance have to be calculated numerically. Specifically,", "cite_spans": [], "ref_spans": [], "section": "A.2 D-GDP"}, {"text": "Having observed y = {y 1 , y 2 , . . . , y n } as independent realizations of Y , the log-likelihood is", "cite_spans": [], "ref_spans": [], "section": "A.2 D-GDP"}, {"text": "The first and second derivatives with respect to \u03be and \u03c3 are", "cite_spans": [], "ref_spans": [], "section": "A.2 D-GDP"}, {"text": "the elements of which are", "cite_spans": [], "ref_spans": [], "section": "A.2 D-GDP"}, {"text": "In this section, we illustrate the usage of the GJRM package (Marra and Radice, 2020) to fit the extreme value models introduced in this article. The examples below are based on artificial data sets.", "cite_spans": [{"start": 61, "end": 85, "text": "(Marra and Radice, 2020)", "ref_id": "BIBREF16"}], "ref_spans": [], "section": "B R code"}, {"text": "n.size <-250 x1 <-rnorm(n.size) x2 <-rnorm(n.size) x3 <-rnorm(n.size) XX <-data.frame(x1 = x1, x2 = x2, x3 = x3) Xmat <-model.matrix(~x1 + x2 + x3) Figure S5 : Negative cases: estimated CaRe for h = 30, 14, 7 days (panels from top to bottom) with respect to lagged precipitation. The bars correspond to 95% intervals. The other covariates are fixed to their mean values. q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq qq qq qq qq qq qq qq qq qq qq qq qq qq qqq qqq qqq qqq qqq qqqq qqqq qqqq qqq 0.5 1.0 1.5 \u221210 \u22125 0 5 10 15", "cite_spans": [], "ref_spans": [{"start": 148, "end": 157, "text": "Figure S5", "ref_id": "FIGREF8"}], "section": "library(GJRM)"}, {"text": "CaRe_30 days q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq qq qq qq qq qq qq qq qq qq qq qq qq qq qqq qqq qqq qqq qqq qqqq qqqq qqqq CaRe_14 days q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q qq qq qq qq qq qq qq qq qq qq qq qq qq qq qqq qqq qqq qqq qqq qqqq qqqq qqqq qq Figure S7 : CaRe estimates for h = 7 for four values of x 2 : its minimum value (first row), its average (second row), its third quartile (third row) and its maximum (fourth row). The other covariates are fixed at their mean values. The true population value is identified by a darker bar. The first two columns correspond to the clean data setting, whereas the last two columns correspond to the contaminated data setting. Figure S8 : CaRe estimates for h = 7 for four values of x 3 : its minimum value (first row), its average (second row), its third quartile (third row) and its maximum (fourth row). The other covariates are fixed at their mean values. The true population value is identified by a darker bar. The first two columns correspond to the clean data setting, whereas the last two columns correspond to the contaminated data setting. Figure S9 : CaRe estimates for h = 14 for four values of x 1 : its minimum value (first row), its average (second row), its third quartile (third row) and its maximum (fourth row). The other covariates are fixed at their mean values. The true population value is identified by a darker bar. The first two columns correspond to the clean data setting, whereas the last two columns correspond to the contaminated data setting. Figure S10 : CaRe estimates for h = 14 for four values of x 2 : its minimum value (first row), its average (second row), its third quartile (third row) and its maximum (fourth row). The other covariates are fixed at their mean values. The true population value is identified by a darker bar. The first two columns correspond to the clean data setting, whereas the last two columns correspond to the contaminated data setting. Figure S11 : CaRe estimates for h = 14 for four values of x 3 : its minimum value (first row), its average (second row), its third quartile (third row) and its maximum (fourth row). The other covariates are fixed at their mean values. The true population value is identified by a darker bar. The first two columns correspond to the clean data setting, whereas the last two columns correspond to the contaminated data setting. Figure S12 : CaRe estimates for h = 30 for four values of x 1 : its minimum value (first row), its average (second row), its third quartile (third row) and its maximum (fourth row). The other covariates are fixed at their mean values. The true population value is identified by a darker bar. The first two columns correspond to the clean data setting, whereas the last two columns correspond to the contaminated data setting. Figure S13 : CaRe estimates for h = 30 for four values of x 2 : its minimum value (first row), its average (second row), its third quartile (third row) and its maximum (fourth row). The other covariates are fixed at their mean values. The true population value is identified by a darker bar. The first two columns correspond to the clean data setting, whereas the last two columns correspond to the contaminated data setting. Figure S14 : CaRe estimates for h = 30 for four values of x 3 : its minimum value (first row), its average (second row), its third quartile (third row) and its maximum (fourth row). The other covariates are fixed at their mean values. The true population value is identified by a darker bar. The first two columns correspond to the clean data setting, whereas the last two columns correspond to the contaminated data setting.", "cite_spans": [], "ref_spans": [{"start": 359, "end": 368, "text": "Figure S7", "ref_id": null}, {"start": 783, "end": 792, "text": "Figure S8", "ref_id": null}, {"start": 1207, "end": 1216, "text": "Figure S9", "ref_id": "FIGREF12"}, {"start": 1632, "end": 1642, "text": "Figure S10", "ref_id": "FIGREF1"}, {"start": 2058, "end": 2068, "text": "Figure S11", "ref_id": "FIGREF1"}, {"start": 2484, "end": 2494, "text": "Figure S12", "ref_id": "FIGREF1"}, {"start": 2910, "end": 2920, "text": "Figure S13", "ref_id": "FIGREF1"}, {"start": 3336, "end": 3346, "text": "Figure S14", "ref_id": "FIGREF1"}], "section": "library(GJRM)"}], "bib_entries": {"BIBREF0": {"ref_id": "b0", "title": "Robust fitting for generalized additive models for location, scale and shape", "authors": [{"first": "W", "middle": ["H"], "last": "Aeberhard", "suffix": ""}, {"first": "E", "middle": [], "last": "Cantoni", "suffix": ""}, {"first": "G", "middle": [], "last": "Marra", "suffix": ""}, {"first": "R", "middle": [], "last": "Radice", "suffix": ""}], "year": 2019, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"arXiv": ["arXiv:1911.05125"]}}, "BIBREF1": {"ref_id": "b1", "title": "Residual life time at great age. The Annals of Probability", "authors": [{"first": "A", "middle": ["A"], "last": "Balkema", "suffix": ""}, {"first": "L", "middle": [], "last": "De Haan", "suffix": ""}], "year": 1974, "venue": "", "volume": "", "issn": "", "pages": "792--804", "other_ids": {}}, "BIBREF2": {"ref_id": "b2", "title": "Generalized additive modelling of sample extremes", "authors": [{"first": "V", "middle": [], "last": "Chavez-Demoulin", "suffix": ""}, {"first": "A", "middle": ["C"], "last": "Davison", "suffix": ""}], "year": 2005, "venue": "Journal of the Royal Statistical Society: Series C (Applied Statistics)", "volume": "54", "issn": "", "pages": "207--222", "other_ids": {}}, "BIBREF3": {"ref_id": "b3", "title": "The impact of weather on influenza and pneumonia mortality in new york city, 1975-2002: A retrospective study", "authors": [{"first": "R", "middle": ["E"], "last": "Davis", "suffix": ""}, {"first": "C", "middle": ["E"], "last": "Rossier", "suffix": ""}, {"first": "K", "middle": ["B"], "last": "Enfield", "suffix": ""}], "year": 2012, "venue": "Plos one", "volume": "", "issn": "", "pages": "", "other_ids": {"DOI": ["10.1371/journal.pone.0034091"]}}, "BIBREF4": {"ref_id": "b4", "title": "Models for exceedances over high thresholds (with discussion)", "authors": [{"first": "A", "middle": ["C"], "last": "Davison", "suffix": ""}, {"first": "R", "middle": ["L"], "last": "Smith", "suffix": ""}], "year": 1990, "venue": "Journal of the Royal Statistical Society. Series B", "volume": "52", "issn": "", "pages": "393--442", "other_ids": {}}, "BIBREF5": {"ref_id": "b5", "title": "Extremes and robustness: a contradiction? Fin Mkts Portfolio Mgmt", "authors": [{"first": "R", "middle": [], "last": "Dell&apos;aquila", "suffix": ""}, {"first": "P", "middle": [], "last": "Embrechts", "suffix": ""}], "year": 2006, "venue": "", "volume": "20", "issn": "", "pages": "103--118", "other_ids": {}}, "BIBREF6": {"ref_id": "b6", "title": "Robust estimation of extremes", "authors": [{"first": "D", "middle": [], "last": "Dupuis", "suffix": ""}, {"first": "C", "middle": [], "last": "Field", "suffix": ""}], "year": 1998, "venue": "Canadian Journal of Statistics", "volume": "26", "issn": "", "pages": "199--215", "other_ids": {}}, "BIBREF7": {"ref_id": "b7", "title": "A robust prediction error criterion for pareto modeling of upper tails", "authors": [{"first": "D", "middle": [], "last": "Dupuis", "suffix": ""}, {"first": "M", "middle": ["P"], "last": "Victoria-Feser", "suffix": ""}], "year": 2006, "venue": "Canadian Journal of Statistics", "volume": "34", "issn": "", "pages": "639--358", "other_ids": {}}, "BIBREF8": {"ref_id": "b8", "title": "Robustifing Maximum Likelihood Estimation by Psidivergence", "authors": [{"first": "S", "middle": [], "last": "Eguchi", "suffix": ""}, {"first": "Y", "middle": [], "last": "Kano", "suffix": ""}], "year": 2001, "venue": "Research Memorandum 802. Institute of Statistical Mathematics (ISM)", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF10": {"ref_id": "b10", "title": "The influence of meteorology on the spread of influenza: Survival analysis of an equine influenza (a/h3n8) outbreak. Plos one", "authors": [{"first": "S", "middle": ["M"], "last": "Firestone", "suffix": ""}, {"first": "N", "middle": [], "last": "Cogger", "suffix": ""}, {"first": "M", "middle": ["P"], "last": "Ward", "suffix": ""}, {"first": "J", "middle": ["A L M L"], "last": "Toribio", "suffix": ""}, {"first": "B", "middle": ["J"], "last": "Moloney", "suffix": ""}, {"first": "N", "middle": ["K"], "last": "Dhand", "suffix": ""}], "year": 2012, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"DOI": ["10.1371/journal.pone.0035284"]}}, "BIBREF11": {"ref_id": "b11", "title": "Generalized Additive Models", "authors": [{"first": "T", "middle": ["J"], "last": "Hastie", "suffix": ""}, {"first": "R", "middle": ["J"], "last": "Tibshirani", "suffix": ""}], "year": 1990, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF13": {"ref_id": "b13", "title": "Parameter and quantile estimation for the generalized pareto distribution", "authors": [{"first": "J", "middle": [], "last": "Hosking", "suffix": ""}, {"first": "J", "middle": [], "last": "Wallis", "suffix": ""}], "year": 1987, "venue": "Technometrics", "volume": "29", "issn": "", "pages": "339--349", "other_ids": {}}, "BIBREF14": {"ref_id": "b14", "title": "Roles of humidity and temperature in shaping influenza seasonality", "authors": [{"first": "A", "middle": ["C"], "last": "Lowen", "suffix": ""}, {"first": "J", "middle": [], "last": "Steel", "suffix": ""}], "year": 2014, "venue": "J Virol", "volume": "88", "issn": "", "pages": "7692--7695", "other_ids": {"DOI": ["10.1128/JVI.03544-13"]}}, "BIBREF15": {"ref_id": "b15", "title": "Copula link-based additive models for right-censored event time data", "authors": [{"first": "G", "middle": [], "last": "Marra", "suffix": ""}, {"first": "R", "middle": [], "last": "Radice", "suffix": ""}], "year": 2019, "venue": "Journal of the American Statistical Association", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF16": {"ref_id": "b16", "title": "GJRM: Generalised Joint Regression Modelling", "authors": [{"first": "G", "middle": [], "last": "Marra", "suffix": ""}, {"first": "R", "middle": [], "last": "Radice", "suffix": ""}], "year": 2020, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF17": {"ref_id": "b17", "title": "Infinite-mean models and the lda for operational risk", "authors": [{"first": "J", "middle": [], "last": "Ne\u0161lehov\u00e1", "suffix": ""}, {"first": "P", "middle": [], "last": "Embrechts", "suffix": ""}, {"first": "V", "middle": [], "last": "Chavez-Demoulin", "suffix": ""}], "year": 2006, "venue": "Journal of Operational Risk", "volume": "1", "issn": "", "pages": "3--25", "other_ids": {}}, "BIBREF18": {"ref_id": "b18", "title": "Generalized additive models for location, scale and shape (with discussion)", "authors": [{"first": "R", "middle": ["A"], "last": "Rigby", "suffix": ""}, {"first": "D", "middle": ["M"], "last": "Stasinopoulos", "suffix": ""}], "year": 2005, "venue": "Applied Statistics", "volume": "54", "issn": "", "pages": "507--554", "other_ids": {}}, "BIBREF19": {"ref_id": "b19", "title": "Quantifying the role of weather on seasonal influenza", "authors": [{"first": "M", "middle": [], "last": "Roussel", "suffix": ""}, {"first": "D", "middle": [], "last": "Pontier", "suffix": ""}, {"first": "J", "middle": ["M"], "last": "Cohen", "suffix": ""}, {"first": "B", "middle": [], "last": "Lina", "suffix": ""}, {"first": "D", "middle": [], "last": "Fouchet", "suffix": ""}], "year": 2016, "venue": "BMC Public Health", "volume": "16", "issn": "", "pages": "", "other_ids": {}}, "BIBREF20": {"ref_id": "b20", "title": "Functional boxplots", "authors": [{"first": "Y", "middle": [], "last": "Sun", "suffix": ""}, {"first": "M", "middle": ["G"], "last": "Genton", "suffix": ""}], "year": 2011, "venue": "Journal of Computational and Graphical Statistics", "volume": "20", "issn": "", "pages": "316--334", "other_ids": {}}, "BIBREF21": {"ref_id": "b21", "title": "Climate change and influenza: the likelihood of early and severe influenza seasons following warmer than average winters", "authors": [{"first": "S", "middle": [], "last": "Towers", "suffix": ""}, {"first": "G", "middle": [], "last": "Chowell", "suffix": ""}, {"first": "R", "middle": [], "last": "Hameed", "suffix": ""}, {"first": "M", "middle": [], "last": "Jastrebski", "suffix": ""}, {"first": "M", "middle": [], "last": "Khan", "suffix": ""}, {"first": "J", "middle": [], "last": "Meeks", "suffix": ""}, {"first": "A", "middle": [], "last": "Mubayi", "suffix": ""}, {"first": "G", "middle": [], "last": "Harris", "suffix": ""}], "year": 2013, "venue": "PLoS Currents", "volume": "", "issn": "", "pages": "", "other_ids": {"DOI": ["10.1371/currents.flu.3679b56a3a5313dc7c043fb944c6f138"]}}, "BIBREF22": {"ref_id": "b22", "title": "Generalized Additive Models: An Introduction with R. 2 ed", "authors": [{"first": "S", "middle": ["N"], "last": "Wood", "suffix": ""}], "year": 2017, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF23": {"ref_id": "b23", "title": "Vector generalized linear and additive extreme value models", "authors": [{"first": "T", "middle": ["W"], "last": "Yee", "suffix": ""}, {"first": "A", "middle": ["G"], "last": "Stephenson", "suffix": ""}], "year": 2007, "venue": "", "volume": "9", "issn": "", "pages": "1--19", "other_ids": {}}, "BIBREF26": {"ref_id": "b26", "title": "DGPD.CaRe30.robust <-pred.gp(DGPD.robust, p = 0.97, newdata = newx3, n.sim = 250", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF27": {"ref_id": "b27", "title": "GPD.eta1 <-matrix", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF28": {"ref_id": "b28", "title": "beta yy <-r.resp(margin = \"GPII\", n.size, eta1 = GPD.eta1, eta2 = GPD.eta2) GPD.data <-data.frame(y = yy", "authors": [{"first": "*", "middle": [], "last": "Gpd.Eta2 &lt;-Xmat%", "suffix": ""}, {"first": "", "middle": [], "last": "%gpd", "suffix": ""}], "year": null, "venue": "X = XX) form.GPD <-list", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF29": {"ref_id": "b29", "title": "classical <-gamlss(form.GPD, margin = \"GPII\", data = GPD.data) conv.check(GPD.classical) post.check(GPD.classical) summary(GPD.classical) plot(GPD.classical, eq = 2, all.terms = TRUE", "authors": [{"first": "", "middle": [], "last": "Gpd", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF30": {"ref_id": "b30", "title": "# CaRe (and CIs) computation as a function of x3", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF31": {"ref_id": "b31", "title": "# (The other covariates are fixed to their mean values)", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF32": {"ref_id": "b32", "title": "97) for horizon h = (7, 14, 30) days #####################################################################", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF33": {"ref_id": "b33", "title": "classical <-pred.gp(GPD.classical, p = 0.93, newdata = newx3, n.sim = 250", "authors": [{"first": "", "middle": [], "last": "Gpd.Care14", "suffix": ""}], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF34": {"ref_id": "b34", "title": "GPD.CaRe30.classical <-pred.gp(GPD.classical, p = 0.97, newdata = newx3, n.sim = 250, prob.-rob.int(GPD.classical, rc = GPD.rob.rc, var.range = c", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "1--5", "other_ids": {}}, "BIBREF35": {"ref_id": "b35", "title": "GPD.robust <-gamlss(form.GPD, margin = \"GPII\", robust = TRUE, rc = GPD.rob.rc, lB = lB, uB = uB", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF36": {"ref_id": "b36", "title": "# check tuning constant, m1 should be around", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF37": {"ref_id": "b37", "title": "# If not, refit with another rc value rob.const(GPD.robust)$m1 summary(GPD.robust) plot(GPD.robust, eq = 2, all.terms = TRUE", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF38": {"ref_id": "b38", "title": "GPD.rAIC <-rIC(GPD.robust)$rAIC # CaRe (and CIs) computation as a function of x3", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF39": {"ref_id": "b39", "title": "# (The other covariates are fixed to their mean values)", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF40": {"ref_id": "b40", "title": "97) for horizon h = (7, 14, 30) days #####################################################################", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF41": {"ref_id": "b41", "title": "GPD.CaRe7.robust <-pred.gp(GPD.robust, p = 0", "authors": [], "year": null, "venue": "", "volume": "86", "issn": "", "pages": "", "other_ids": {}}, "BIBREF42": {"ref_id": "b42", "title": "GPD.CaRe14.robust <-pred.gp(GPD.robust, p = 0.93, newdata = newx3", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF43": {"ref_id": "b43", "title": "GPD.CaRe30.robust <-pred.gp(GPD.robust, p = 0.97, newdata = newx3", "authors": [], "year": null, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}}, "ref_entries": {"FIGREF1": {"text": "Daily number of flu positive cases tested patients from 01/07/2016 to 21/06/2019. The red line shows the threshold defining exceedances.", "latex": null, "type": "figure"}, "FIGREF4": {"text": "Daily umber of negatively flu tested patients from 01/07/2016 to 21/06/2019. The red line shows the threshold defining exceedances.", "latex": null, "type": "figure"}, "FIGREF5": {"text": "shows the number of positive cases for the three years considered in this study.", "latex": null, "type": "figure"}, "FIGREF6": {"text": "Daily odds of positive tested cases from 01/07/2016 to 21/06/2019. The red line shows the threshold defining exceedances.", "latex": null, "type": "figure"}, "FIGREF7": {"text": "Correlation between meteorological covariates.", "latex": null, "type": "figure"}, "FIGREF8": {"text": "Mean residual life plots for the odds of positive cases.", "latex": null, "type": "figure"}, "FIGREF9": {"text": "Positive cases: estimated CaRe for h = 30, 14, 7 days (panels from top to bottom, respectively) with respect to lagged minimum temperature. The bars correspond to 95% intervals. The other covariates are fixed to their mean values.qqq qqq qqqq qqqq qqqq qqqqq qqqqq qqqqq qqqqq qqqqqq qqqqqqq qqqqqqq qqqqqqqqq qqqqqqqqq Positive cases: estimated CaRe for h = 30, 14, 7 days (panels from top to bottom) with respect to lagged radiation. The bars correspond to 95% intervals. The other covariates are fixed to their mean values. Positive cases: estimated CaRe for h = 30, 14, 7 days (panels from top to bottom) with respect to lagged precipitation. The bars correspond to 95% intervals. The other covariates are fixed to their mean values.", "latex": null, "type": "figure"}, "FIGREF12": {"text": "Robustness weights from the model fitted to positive cases.", "latex": null, "type": "figure"}, "FIGREF14": {"text": "Robustness weights from the model fitted to negative cases.", "latex": null, "type": "figure"}, "FIGREF18": {"text": "Robustness weights from the model fitted to odds of positive cases. The star (*) at the top of the graph indicates that an observation (odds = 3.95 on 08/11/2017 and robustness weight = 0.93) has not been represented.", "latex": null, "type": "figure"}, "FIGREF19": {"text": "Boxplots of the centered parameter estimates for model", "latex": null, "type": "figure"}, "FIGREF21": {"text": "Boxplots of the centered parameter estimates of model (10). In each panel, the left boxplots are for the clean data setting, and the right boxplots for the contaminated data setting.", "latex": null, "type": "figure"}, "FIGREF23": {"text": "eta1 <-matrix(rep(DGPD.alpha,n.size), ncol = 1) DGPD.eta2 <-Xmat%*%DGPD.beta yy <-r.resp(margin = \"DGPII\", n.size, eta1 = DGPD.eta1, eta2 = DGPD.eta2) DGPD.data <-data.frame(y = yy, X = XX) form.DGPD <-list(y~1,~x1 + x2 + x3) # Classical fit ############################################################ DGPD.classical <-gamlss(form.DGPD, margin = \"DGPII\", data = DGPD.data) conv.check(DGPD.classical) post.check(DGPD.classical) summary(DGPD.classical) plot(DGPD.classical, eq = 2, all.terms = TRUE, pages = 1) DGPD.AIC <-AIC(DGPD.classical) # CaRe (and CIs) computation as a function of x3 (grid on its range) # (The other covariates are fixed to their mean values) # p = c(0.86, 0.93, 0.97) for horizon h = (7, 14, 30) days ##################################################################### newx3 <-data.frame(x1 = rep(mean(x1), length=100), x2 = rep(mean(x2), length = 100), x3 = seq(min(x3), max(x3), length.out = 100)) CaRe7.classical <-pred.gp(DGPD.classical, p=0.86, newdata = newx3, n.sim = 250, prob.lev = 0.05) CaRe14.classical <-pred.gp(DGPD.classical, p = 0.93, newdata = newx3, n.sim = 250, prob.lev = 0.05) CaRe30.classical <-pred.gp(DGPD.classical, p = 0.97,newdata = newx3, n.sim = 250, prob.lev = 0.05) # point estimates CaRe7.classical$qp # threshold u to be added, if necessary # Interval estimates CaRe7.classical$CIqp # Robust fit ####################################################### DGPD.rob.rc <-5.7 DGPD.robust <-gamlss(form.DGPD, margin = \"DGPII\", robust = TRUE, rc = DGPD.rob.rc, data = DGPD.data) conv.check(DGPD.robust) # check tuning constant, m1 should be around, e.g., 0.95 # If not, refit with another rc value rob.const(DGPD.robust)$m1 summary(DGPD.robust) plot(DGPD.robust, eq = 2, all.terms = TRUE, pages = 1) DGPD.rAIC <-rIC(DGPD.robust)$rAIC # CaRe (and CIs) computation as a function of x3 (grid on its range) # (The other covariates are fixed to their mean values) # p = c(0.86, 0.93, 0.97) for horizon h = (7, 14, 30Covariate effects on the scale parameter \u03c3 of the D-GPD for positive cases, and 95% intervals.", "latex": null, "type": "figure"}, "FIGREF24": {"text": "Covariate effects on the scale parameter \u03c3 of the D-GPD for negative cases, and 95% intervals.", "latex": null, "type": "figure"}, "FIGREF25": {"text": "Covariate effect on the scale parameter \u03c3 of the GPD for odds of positive cases, and 95% intervals.", "latex": null, "type": "figure"}, "FIGREF26": {"text": "Negative cases: estimated CaRe for h = 30, 14, 7 days (panels from top to bottom) with respect to lagged radiation. The bars correspond to 95% intervals. The other covariates are fixed to their mean values.", "latex": null, "type": "figure"}, "FIGREF29": {"text": "Odds of positive cases: estimated CaRe for h = 30, 14, 7 days (panels from top to bottom) with respect to lagged minimum temperature. The bars correspond to 95% intervals.", "latex": null, "type": "figure"}, "TABREF2": {"text": "Estimated coefficients for the final D-GPD model fitted to positive cases.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>log(\u03c3\u0302) </td><td>Estimate </td><td>Std. Error </td><td>Z- value </td><td>P-value </td><td>Signif\n</td></tr><tr><td>Intercept </td><td>2.037 </td><td>0.138 </td><td>14.79 </td><td>0.000 </td><td>***\n</td></tr><tr><td>MintempL3 </td><td>-0.054 </td><td>0.021 </td><td>-2.54 </td><td>0.011 </td><td>*\n</td></tr><tr><td>RadiationL3 </td><td>-0.005 </td><td>0.001 </td><td>-3.62 </td><td>0.000 </td><td>***\n</td></tr><tr><td>PrecipitationL3 </td><td>-0.009 </td><td>0.004 </td><td>-2.11 </td><td>0.035 </td><td>*\n</td></tr></table></body></html>"}, "TABREF3": {"text": "Estimated coefficients for the final D-GPD model fitted to negative cases.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>log(\u03c3\u0302) </td><td>Estimate </td><td>Std. Error </td><td>Z- value </td><td>P-value </td><td>Signif\n</td></tr><tr><td>Intercept </td><td>2.483 </td><td>0.151 </td><td>16.43 </td><td>0.000 </td><td>***\n</td></tr><tr><td>RadiationL3 </td><td>-0.003 </td><td>0.001 </td><td>-2.15 </td><td>0.031 </td><td>*\n</td></tr><tr><td>PrecipitationL3 Signif. codes: </td><td>-0.010 0 &lt; p-value &lt; </td><td>0.005 1e\u22123 : \u2217 \u2217 \u2217, p-value </td><td>-2.01 &lt; </td><td>0.045 0.01 : \u2217\u2217, p-value </td><td>*\n&lt; 0.05 : \u2217\n</td></tr></table></body></html>"}, "TABREF4": {"text": "Estimated coefficients for the final GPD model fitted to the odds positive cases.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>log(\u03c3\u0302) </td><td>Estimate </td><td>Std. Error </td><td>Z- value </td><td>P-value </td><td>Signif\n</td></tr><tr><td>Intercept </td><td>-1.272 </td><td>0.051 </td><td>-25.03 </td><td>0.000 </td><td>***\n</td></tr><tr><td>MintempL3 </td><td>-0.098 </td><td>0.009 </td><td>-11.17 </td><td>0.000 </td><td>***\n</td></tr></table></body></html>"}, "TABREF5": {"text": "Modelling the Extremes of Seasonal Viruses and HospitalCongestion: The Example of Flu in a Swiss Hospital by Setareh Ranjbar, Eva Cantoni, Val\u00e9rie Chavez-Demoulin, Giampiero Marra, Rosalba Radice, Katia Jaton-Ogay", "latex": null, "type": "table"}, "TABREF6": {"text": "Table 1. For each meteorological factor, we consider the respective L 3 X t value, because, for flu, the incubation time is usually between 24 and 48 hours, and sometimes 72 hours. When discussing the models used for the analyses, extension L3 at the end of each covariate's name refers to L 3 X t values.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>Name </td><td>Definition </td><td>Unit\n</td></tr><tr><td>Mintemp </td><td>daily minimum temperature at 2m above ground level </td><td>oC\n</td></tr><tr><td>Radiation </td><td>daily mean radiation </td><td>W/m2\n</td></tr><tr><td>Humidity </td><td>daily mean relative air humidity at 2 m from the ground </td><td>%\n</td></tr><tr><td>Wind </td><td>daily maximum wind (integration 1 s) </td><td>m/s\n</td></tr><tr><td>Precipitation </td><td>mm\n</td></tr><tr><td>Pressure </td><td>daily sum of precipitation daily mean atmospheric pressure with (QNH) </td><td>hPa\n</td></tr></table></body></html>"}}, "back_matter": [{"text": "The simulations were performed at the University of Geneva using the Baobab cluster. The research was partially funded by the Swiss National Science Foundation SNF (first and third authors).", "cite_spans": [], "ref_spans": [], "section": "Acknowledgments"}]}