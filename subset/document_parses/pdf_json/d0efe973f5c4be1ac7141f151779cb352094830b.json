{
    "paper_id": "d0efe973f5c4be1ac7141f151779cb352094830b",
    "metadata": {
        "title": "Adjusting ROC Curve for Covariates with AROC R Package",
        "authors": [
            {
                "first": "Francisco",
                "middle": [],
                "last": "Machado E Costa",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Minho",
                    "location": {
                        "addrLine": "Campus de Gualtar",
                        "settlement": "Braga",
                        "country": "Portugal"
                    }
                },
                "email": "frmachadoecosta@gmail.com"
            },
            {
                "first": "B",
                "middle": [],
                "last": "",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Ana",
                "middle": [
                    "Cristina"
                ],
                "last": "Braga",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Minho",
                    "location": {
                        "addrLine": "Campus de Azur\u00e9m",
                        "settlement": "Guimar\u00e3es",
                        "country": "Portugal"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "The ability of a medical test to differentiate between diseased and non-diseased states is of vital importance and must be screened by statistical analysis for reliability and improvement. The receiver operating characteristic (ROC) curve remains a popular method of marker analysis, disease screening and diagnosis. Covariates in this field related to the subject's characteristics are incorporated in the analysis to avoid bias. The covariate adjusted ROC (AROC) curve was proposed as a method of incorporation. The AROC R-package was recently released and brings various methods of estimation based on multiple authors work.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "The aim of this study was to explore the AROC package functionality and usability using real data noting its possible limitations. The main methods of the package were capable of incorporating different and multiple variables, both categorical and continuous, in the AROC curve estimation. When tested for the same data, AROC curves are generated with no statistical differences, regardless of method.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "The package offers a variety of methods to estimate the AROC curve complemented with predictive checks and pooled ROC estimation. The package offers a way to conduct a more thorough ROC and AROC analysis, making it available for any R user.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Medical tests meant for use in routine practice must be rigorously scrutinized for their accuracy with statistical analysis before approval.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Differentiating between healthy and diseased populations or, more broadly, control and cases is the fundamental property of any test and of fundamental importance in clinical practice. The receiver operating characteristic (ROC) curve is the most popular statistical tool when dichotomizing test results, particularly with a degree of subjectivity, such as medical imaging [11] and is used broadly in biomedical informatics research to evaluate classification and prediction models for decision support, diagnosis, and prognosis [8] .",
            "cite_spans": [
                {
                    "start": 373,
                    "end": 377,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 529,
                    "end": 532,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The ROC curve is defined as a plot of True Positive Fraction (T P F ), or sensitivity, and False Positive Fraction (F P F ), 1-specificity, pairs obtained by varying threshold c. Defining Y D and YD as continuous variables for diseased and non-diseased groups respectively with cumulative distribution functions F D and FD, we assume all test outcomes greater than c belong to the diseased group, with c \u2208 IR. Subsequently, each given c will determine TPF, T P F (c) = P r(Y D \u2265 c) = 1 \u2212 F D (c) and similarly FPF, F P F (c) = P r(YD \u2265 c) = 1 \u2212 FD(c).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The ROC curve is then defined as all TPF-FPF pairs, ROC(\u00b7) = {(F P F (c), T P F (c)), c \u2208 IR} [13] . By converting F P F at threshold c to t, such as, t = F P F (c) = 1 \u2212 FD(c), the ROC curve is defined as {(t, ROC(t)) : t \u2208 [0, 1]} [16] , where",
            "cite_spans": [
                {
                    "start": 94,
                    "end": 98,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 233,
                    "end": 237,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Clinical risk index for babies (CRIB) is a risk assessment tool used in neonatal intensive care units (NICUs) for infants born with less than 31 week gestation or 1500 g and lower birth weight [10, 12] . Along with the Score for Neonatal Acute Physiology (SNAP), these scoring systems and their updates have served as prediction tools more accurate to the previous weight or gestational age univariate predictors.",
            "cite_spans": [
                {
                    "start": 193,
                    "end": 197,
                    "text": "[10,",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 198,
                    "end": 201,
                    "text": "12]",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "CRIB score uses six different variables obtained routinely during the first 12 hours of life, namely, birthweight, gestational age, the presence of congenital malformation (excluding inevitably lethal congenital malformations) and indices of physiological status [1] resulting in a score between 0 and 24.",
            "cite_spans": [
                {
                    "start": 263,
                    "end": 266,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Matching sensitivity and specificity, defining an acceptable trade-off between the two to better characterize test results is, while not its only application, the main focus of ROC curve studies, and CRIB scores have been explored in this regard [1, 2] . However in any diagnostics test a number of factors such as the disease characteristics and specimen features, might affect the marker and its accuracy. In statistics these unaccounted variables are labeled covariates. Incorporating covariate information in ROC analysis is imperative, otherwise biased or oversimplified conclusions might be made about the tests accuracy [7] .",
            "cite_spans": [
                {
                    "start": 246,
                    "end": 249,
                    "text": "[1,",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 250,
                    "end": 252,
                    "text": "2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 627,
                    "end": 630,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In recent years several different mathematical approaches have been introduced to better equate covariates in ROC curve methodology.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "By denoting X D and XD as diseased and non-diseased vector of covariates of interest and a covariate value x, the covariate-specific ROC curve is built as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The covariate specific ROC curve builds different curves and displays a different test accuracy for each value of x that, while helpful in understanding optimal and sub optimal populations for the test, lacks a global measurement for the covariate effect. The covariate adjusted ROC curve, AROC, was proposed to mend this issue [7] , defined as,",
            "cite_spans": [
                {
                    "start": 328,
                    "end": 331,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "where,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "the cumulative distribution function of X D . Therefore the AROC is a weighted average of covariate specific ROC curves according to the distribution of the covariates in the diseased group [16] . Janes and Pepe [7] also demonstrated that the AROC curve can also be expressed as",
            "cite_spans": [
                {
                    "start": 190,
                    "end": 194,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 212,
                    "end": 215,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "proving that the AROC summarizes the covariate-specific performance of the test.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The AROC R-package developed by Rodriguez-Alvarez and Inacio de Carvalho [16] implements different methods of computing covariate information in ROC curve construction and two additional methods of calculating marginal/ polled ROC curve. This package has additional value considering the lag on tool development on this sub-field. This article will explore these different methods on a theoretical and practical basis using CRIB scores of a neonatal database from the Portuguese National Registry on low weight newborns between 2010 and 2012.",
            "cite_spans": [
                {
                    "start": 73,
                    "end": 77,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The aim of this study is to explore the AROC package functionality and usability using real data noting its possible limitations and generating preliminary findings on CRIB data that will be explored in the future.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Methodology"
        },
        {
            "text": "As mentioned the dataset used is part of the Portuguese National Registry on low weight newborns between 2010 and 2012 and was made available for research purposes. The original data included possible confounding observations such as repeated id's and twins that were removed to ensure no unaccounted for variables.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Dataset"
        },
        {
            "text": "After ensuring all id's were unique these were promptly removed along with any possible identifiable features to abide by EU anonymity and data protection standards. A random sample of 50% was taken resulting in a dataset with 1093 unique observations and 17 columns including gestational time in weeks, the mothers age, biological sex of the infant, CRIB score, survival and other possibly relevant covariates and used for the remainder of the study.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Dataset"
        },
        {
            "text": "For replication purposes all relevant data was shared to Mendeley Data and is available at data.mendeley.com/datasets/jsmgcmfmdx [9] .",
            "cite_spans": [
                {
                    "start": 129,
                    "end": 132,
                    "text": "[9]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Dataset"
        },
        {
            "text": "The AROC package for covariate adjusted Receiver Operating Characteristic curve inference offers a comprehensive guide of use present in the CRAN repository. In the remainder of this section we will replicate the examples provided in the documentation with the CRIB dataset, compare the different methods and explore some of the theoretical details of each method.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "AROC Package Method Exploration"
        },
        {
            "text": "We begin by importing the dataset, setting a seed for replication purposes and constructing the specnaomit() function to remove NAs on columns under analysis, this is a necessary step since the methods are not built to handle NA values. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "AROC Package Method Exploration"
        },
        {
            "text": "where",
            "cite_spans": [],
            "ref_spans": [],
            "section": "AROC Package Method Exploration"
        },
        {
            "text": ", a placement value of the test outcome in the diseased population or the standardization of Y D to the conditional distribution of YD making the AROC a cumulative distribution function of U D . This method first models the conditional distribution of test outcomes in the nondiseased group, FD using a B-splines dependent Dirichlet process mixture of Normals model followed by modeling U D and it's cumulative distribution using a non parametric regression model through Bayesian bootstrap [16] . For this demonstration we attempt to see the relation between the CRIB score and the sex of the baby, a categorical variable, that could indicate a possible bias on estimating survivability based on sex in the score system. To use this method the only mandatory arguments are formula.healthy, an R formula object to define the relation between variables, in this case the 'crib' and 'sex', group, that defines the result column, in this case if the infant survived, tag.healthy, what identifies the healthy i.e. survival population in the group/result column and data, the dataset being used. Further customization is possible with the Bayesian parameters however this will not be explored, the only extra arguments were meant to reduce the default run time. The plot functionality allows us to see the computed curve ( Fig. 2A ) that follow a simplistic visual however the saved object preserves the curve points that allow for any plot customization R programmers use.",
            "cite_spans": [
                {
                    "start": 491,
                    "end": 495,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [
                {
                    "start": 1318,
                    "end": 1325,
                    "text": "Fig. 2A",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "AROC Package Method Exploration"
        },
        {
            "text": "Semiparametric Bayesian. The AROC.bsp method is very similar to the previous, non parametric method, in both construction and theory, where this models FD using a normal linear regression, making it a counterpart to Janes and Pepe [7] frequentist model and its AROC package method -AROC.sp [14] . The object generated by this method can, again, be plotted (Fig. 2B ) similarly to the previous method Semiparametric Frequentist. This semiparametric frequencist method arguments and construction are fairly similar to the previous methods but, as previously hinted, uses a semiparametric location regression model for YD to estimate FD and estimates outer probability empirically [6, 14] making it less computationally heavy, i.e. faster in comparison. Another advantage is being able to provide direct insight on covariate influence over the test/marker with the fit model's parameters to the crib and sex example we've seen previously. In this instance, calling the summary() function on the fit.h element give us an extensive look at test statistics.",
            "cite_spans": [
                {
                    "start": 231,
                    "end": 234,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 290,
                    "end": 294,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 678,
                    "end": 681,
                    "text": "[6,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 682,
                    "end": 685,
                    "text": "14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [
                {
                    "start": 356,
                    "end": 364,
                    "text": "(Fig. 2B",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "AROC Package Method Exploration"
        },
        {
            "text": "Nonparametric Kernel. The AROC.kernel, an earlier proposed model by Rodriguez-Alvarez et al. [15] is, as the name implies, a kernel based method. Test outcomes for the non-diseased group are modeled with a location-scale regression model where both regression and variance functions are estimated using Nadaraa-Watson local estimators that in turn are used to compute standardised residuals to model U D and estimate the AROC curve, AROC(t) [14] [15] [16] .",
            "cite_spans": [
                {
                    "start": 93,
                    "end": 97,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 441,
                    "end": 445,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 446,
                    "end": 450,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 451,
                    "end": 455,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "AROC Package Method Exploration"
        },
        {
            "text": "The package author notes that, for now, this method, unlike the previous, can only handle a single continuous covariate, for this reason the sex variable is unsuitable for testing and is replaced by the age of the mother, age mother to analyze this covariates influence in the CRIB score system and its outcome. Additionally AROC.sp is used to offer additional information. Note that for the AROC.kernel, not just the default arguments are different from the remaining methods but also that it was necessary to shorten the bootstrap resample process (B) from its default 1000 value, this is due to the execution time of this method being the longest of all the AROC-package functions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "AROC Package Method Exploration"
        },
        {
            "text": "All previous methods are meant to construct and analyze the AROC curve and the behavior of the incorporated covariates, for the remainder of this section the methods focus on posterior predictive checks and pooled ROC estimation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Posterior Predictive Checks (PPC)."
        },
        {
            "text": "Both predictive.checks.AROC.bnp and predictive.checks.AROC.bsp are implementations of PPCs on their respective Bayesian based method. The premise behind PPCs is evaluating the generated model on how well it is able to generate data similar to the data observed [3] utilizing in this case the B-splines dependent Dirichlet process and Bayesian normal linear regression model for the AROC.bnp and AROC.bsp objects respectively [14] . To exemplify these methods we use the previously generated objects. While the mandatory argument is solely the AROC object, the devnew was changed from the default TRUE argument to display all depicted graphics on the same device. These graphics are histograms of the desired test statistics, by default minimum, maximum, median and skewness and Kernel density estimates showing diagnostic test outcome in the nondiseased group as well.",
            "cite_spans": [
                {
                    "start": 261,
                    "end": 264,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 425,
                    "end": 429,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Posterior Predictive Checks (PPC)."
        },
        {
            "text": "Pooled ROC. The package also provides two methods of polled ROC estimation, pooledROC.emp an implementation of empirical estimation proposed by Hsieh and Turnbull [5, 14] and pooledROC.BB for Bayesian bootstrap estimation proposed by Gu et al. [4, 14] . Both methods are similar to construct and have a similar output structure, mandatory arguments identify diseased and non-diseased groups in the test or marker column which can be achieved with a straightforward indexing in R. ",
            "cite_spans": [
                {
                    "start": 163,
                    "end": 166,
                    "text": "[5,",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 167,
                    "end": 170,
                    "text": "14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 244,
                    "end": 247,
                    "text": "[4,",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 248,
                    "end": 251,
                    "text": "14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Posterior Predictive Checks (PPC)."
        },
        {
            "text": "All methods allowed for a visualization of their output with the standard plot() function, albeit a simple one, that allows for further customization if necessary. The summary() output for AROC methods all follow a similar template, reporting the requested command with its respective arguments and the AAUC of the resulting AROC curve. While this command offers no additional information for the AROC objects when compared to the plot(), that also displays the AAUC, the semiparametric frequentist method generates a specific element, fit.h that can be accessed and provides a direct statistical summary on the effect of the covariate to the curve and the fitted regression model (Fig. 1).   Fig. 1 . The fit.h summary() output for semiparametric frequentist adjustment of sex to the CRIB score.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 681,
                    "end": 699,
                    "text": "(Fig. 1).   Fig. 1",
                    "ref_id": null
                }
            ],
            "section": "Results"
        },
        {
            "text": "Methods used to adjust the sex covariate to the CRIB ROC curve all displayed AAUC intervals -available through both the plot() and summary() functions, and curves that overlap each other, inferring no statistical differences between them, an expected yet important attribute, making all methods viable for use in this instance despite a seemingly slight overestimation by the bayesian nonparametric method that holds no statistical relevance. These three curves can be seen in Fig. 2 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 477,
                    "end": 483,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Results"
        },
        {
            "text": "The kernel and semiparametric frequentist method shared the same similarities between them when adjusting for the mother's age in the CRIB ROC score, showing both overlapping AAUCs and curves that infer no statistical difference despite the low bootstrap resamples used in the kernel method in the interest of time. Both curves can be seen in Fig. 3 . Having established that all AROC adjustment methods display statistically similar curves what follows is to establish the same result for the unadjusted curve methods and then to compare the two. Both bayesian and empirical pooled ROC functions, seen in Fig. 4 displayed similar results just as the adjusted methods, a direct comparison between the two is displayed in Fig. 5C . A comparison between adjusted and unadjusted ROC curves for both the sex of the infant and mother's age can be seen in Fig. 5 A and B respectively. While the AAUC statistics in Fig. 2 through Fig. 4 show a clear overlap between their respective adjustments and the pooled ROC curve and Fig. 5 show several intersections between the curves themselves, an additional source of information on the covariates' influence on their tests is present in the extended summary statistics of the AROC.sp where p-value = 0.798 and p-value = 0.9721 is displayed for biological sex and mother's age respectively a figure well above the 0.05 required to entail any influence over the test for these covariates. Comparison between AROC adjustment methods for mother's age and empirical pooled ROC curve. C) Visual Comparison between pooled ROC estimation methods",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 343,
                    "end": 349,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF6"
                },
                {
                    "start": 606,
                    "end": 612,
                    "text": "Fig. 4",
                    "ref_id": "FIGREF7"
                },
                {
                    "start": 721,
                    "end": 728,
                    "text": "Fig. 5C",
                    "ref_id": "FIGREF8"
                },
                {
                    "start": 850,
                    "end": 856,
                    "text": "Fig. 5",
                    "ref_id": "FIGREF8"
                },
                {
                    "start": 908,
                    "end": 914,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF5"
                },
                {
                    "start": 923,
                    "end": 929,
                    "text": "Fig. 4",
                    "ref_id": "FIGREF7"
                },
                {
                    "start": 1017,
                    "end": 1023,
                    "text": "Fig. 5",
                    "ref_id": "FIGREF8"
                }
            ],
            "section": "Results"
        },
        {
            "text": "All AROC estimation methods with the exception of AROC.kernel were capable of handling a categorical covariate rather than the standard continuous covariate. The visualization of the curves Fig. 2 through 5 provide insight on the behavior of the test and its associated covariate.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 190,
                    "end": 196,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Discussion"
        },
        {
            "text": "In efficiency, AROC.sp was the faster and most informative of the methods providing not only a visual representation of the AROC curve, but also descriptive test statistics inferring no statistical relevance to biological sex in the CRIB score that will be explored in the future.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Posterior predictive checks (PPCs) for non parametric bayesian method and for semiparametric bayesian method offer insight on their respective methods behavior and reliability that can lead to the choice of the most reliable method between the two despite, as mentioned, in this case, no real difference being found between methods.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Pooled ROC methods deliver curves with small differences on AUC values due to the nature of their estimators however from AUC alone we can observe the AUC confidence intervals intercepting showing both methods deliver a statistical equivalent curve allowing analysts to choose a preferred method. We can expand this reasoning and see same applies to the all AROC curves further substantiating the AROC.sp statistics.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "CRIB scores and biological sex show no clear relation for all methods tested, these findings while preliminary and supported by previous research results, [10, 17] are in stark contrast with criticism to the scoring system that lead to the creation of the CRIB II [12] . This data will be further explored to analyze the confounding effect, if any, of this covariate.",
            "cite_spans": [
                {
                    "start": 155,
                    "end": 159,
                    "text": "[10,",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 160,
                    "end": 163,
                    "text": "17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 264,
                    "end": 268,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "The AROC package grants multiple methods of analysis and estimation of the AROC curve complemented with predictive checks and pooled ROC estimation. With the exception of the kernel based method, AROC.kernel, all AROC estimation methods have proven able to handle both categorical and continuous covariates and are even able to handle several sets of covariates of different natures. All methods generate AROC curves with no statistical differences, passing the choice of which method would be more suitable for the analysis directly to the analyst.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion"
        },
        {
            "text": "The reliability of this package will allow further research for possible covariates confounding CRIB score.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion"
        },
        {
            "text": "Overall the package finally brings to the R library a way to conduct a more thorough ROC and AROC analysis making it available for any R user.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "CRIB score, birth weight and gestational age in neonatal mortality risk evaluation",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "S J D"
                    ],
                    "last": "Brito",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Matsuo",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "R C"
                    ],
                    "last": "Gonzalez",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "B R"
                    ],
                    "last": "De Carvalho",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [
                        "S L"
                    ],
                    "last": "Ferrari",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Revista de sa\u00fade p\u00fablica",
            "volume": "37",
            "issn": "5",
            "pages": "597--602",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Clinical risk index for babies (CRIB II) scoring system in prediction of mortality in premature babies",
            "authors": [
                {
                    "first": "Z",
                    "middle": [
                        "M"
                    ],
                    "last": "Ezz-Eldin",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [
                        "A"
                    ],
                    "last": "Hamid",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "R"
                    ],
                    "last": "Labib Youssef",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "E D"
                    ],
                    "last": "Nabil",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "J. Clin. Diagnostic Res",
            "volume": "9",
            "issn": "6",
            "pages": "8--11",
            "other_ids": {
                "DOI": [
                    "10.7860/JCDR/2015/12248.6012"
                ]
            }
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Visualization in Bayesian workflow",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Gabry",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Simpson",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Vehtari",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Betancourt",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Gelman",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "J. Royal Stat. Soc. Ser. A: Stat. Soc",
            "volume": "182",
            "issn": "2",
            "pages": "389--402",
            "other_ids": {
                "DOI": [
                    "10.1111/rssa.12378"
                ]
            }
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Bayesian bootstrap estimation of ROC curve",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Gu",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Ghosal",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Roy",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Stat. Med",
            "volume": "27",
            "issn": "26",
            "pages": "5407--5420",
            "other_ids": {
                "DOI": [
                    "http:/doi.wiley.com/10.1002/sim.3366"
                ]
            }
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Nonparametric and semiparametric estimation of the receiver operating characteristic curve",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Hsieh",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "W"
                    ],
                    "last": "Turnbull",
                    "suffix": ""
                }
            ],
            "year": 1996,
            "venue": "Ann. Statist",
            "volume": "24",
            "issn": "1",
            "pages": "25--40",
            "other_ids": {
                "DOI": [
                    "10.1214/aos/1033066197"
                ]
            }
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Adjusting for covariates in studies of diagnostic, screening, or prognostic markers: an old concept in a new setting",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Janes",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "S"
                    ],
                    "last": "Pepe",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Am. J. Epidemiol",
            "volume": "168",
            "issn": "1",
            "pages": "89--97",
            "other_ids": {
                "DOI": [
                    "10.1093/aje/kwn099"
                ]
            }
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Adjusting for covariate effects on classification accuracy using the covariate-adjusted receiver operating characteristic curve",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Janes",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "S"
                    ],
                    "last": "Pepe",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Biometrika",
            "volume": "96",
            "issn": "2",
            "pages": "371--382",
            "other_ids": {
                "DOI": [
                    "10.1093/biomet/asp002"
                ]
            }
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "The use of receiver operating characteristic curves in biomedical informatics",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "A"
                    ],
                    "last": "Lasko",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "G"
                    ],
                    "last": "Bhagwat",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [
                        "H"
                    ],
                    "last": "Zou",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Ohno-Machado",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "",
            "volume": "38",
            "issn": "",
            "pages": "404--415",
            "other_ids": {
                "DOI": [
                    "10.1016/j.jbi.2005.02.008"
                ]
            }
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "CRIB conditional on gender: nonparametric ROC curve",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "F"
                    ],
                    "last": "Mour\u00e3o",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "C"
                    ],
                    "last": "Braga",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [
                        "N"
                    ],
                    "last": "Oliveira",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Int. J. Health Care Quality Assurance",
            "volume": "27",
            "issn": "8",
            "pages": "656--663",
            "other_ids": {
                "DOI": [
                    "10.1108/IJHCQA-04-2013-0047"
                ]
            }
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Receiver operating characteristic (ROC) curve: practical review for radiologists",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "H"
                    ],
                    "last": "Park",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Goo",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "H"
                    ],
                    "last": "Jo",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Korean J. Radiol",
            "volume": "5",
            "issn": "1",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.3348/kjr.2004.5.1.11"
                ]
            }
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "UK neonatal staffing study collaborative: CRIB II : an update of the clinical risk index for babies score For personal use. Only reproduce with permission from The Lancet Publishing Group",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Parry",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Tucker",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "O"
                    ],
                    "last": "Tarnow-Mordi",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Lancet",
            "volume": "361",
            "issn": "",
            "pages": "1789--1791",
            "other_ids": {
                "DOI": [
                    "10.1016/S0140-6736(03)13397-1"
                ]
            }
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "The Statistical Evaluation of Medical Tests for Classification and Prediction",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "S"
                    ],
                    "last": "Pepe",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "AROC: Covariate-Adjusted Receiver Operating Characteristic Curve Inference",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "X"
                    ],
                    "last": "Rodriguez-Alvarez",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Inacio De Carvalho",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "ROC curve and covariates: extending induced methodology to the non-parametric framework",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "X"
                    ],
                    "last": "Rodr\u00edguez-\u00c1lvarez",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Roca-Pardi\u00f1as",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Cadarso-Su\u00e1rez",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Stat. Comput",
            "volume": "21",
            "issn": "4",
            "pages": "483--499",
            "other_ids": {
                "DOI": [
                    "10.1007/s11222-010-9184-1"
                ]
            }
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Bootstrap-based procedures for inference in nonparametric receiver-operating characteristic curve regression analysis",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "X"
                    ],
                    "last": "Rodr\u00edguez-\u00c1lvarez",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Roca-Pardi\u00f1as",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Cadarso-Su\u00e1rez",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [
                        "G"
                    ],
                    "last": "Tahoces",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Stat. Methods Med. Res",
            "volume": "27",
            "issn": "3",
            "pages": "740--764",
            "other_ids": {
                "DOI": [
                    "10.1177/0962280217742542"
                ]
            }
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Assessing mortality risk in very low birth weight infants",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Terzic",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Helji\u0107",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Medicinski arhiv",
            "volume": "66",
            "issn": "",
            "pages": "76--85",
            "other_ids": {
                "DOI": [
                    "10.5455/medarh.2012.66.76-79"
                ]
            }
        }
    },
    "ref_entries": {
        "FIGREF5": {
            "text": "AROC curve of CRIB score adjusted for the infants sex. A) AROC estimation with the nonparametric bayesian method. B) AROC estimation with the semiparametric bayesian method. C) AROC estimation with the semiparametric bayesian frequentist method.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "AROC curve of CRIB score adjusted for the mother's age. A) AROC estimation with the kernel based method. B) AROC estimation with the semiparametric bayesian frequentist.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "Pooled ROC curves for CRIB score. A) Bayesian bootstrap. B) Empirical estimation.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "Visual comparison between ROC and AROC curves. A) Comparison between AROC adjustment methods for biological sex and empirical pooled ROC curve. B)",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "Nonparametric Bayesian. The AROC.bnp function estimates the AROC curve using the Bayesian nonparametric method. Working with Eq. 5 we say,",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "Acknowledgements. This work has been supported by FCT -Funda\u00e7\u00e3o para a Ci\u00eancia e Tecnologia within the R&D Units Project Scope: UIDB/00319/2020.The authors express their gratitude to the Portuguese National Registry for supplying the dataset used in this study.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "acknowledgement"
        }
    ]
}