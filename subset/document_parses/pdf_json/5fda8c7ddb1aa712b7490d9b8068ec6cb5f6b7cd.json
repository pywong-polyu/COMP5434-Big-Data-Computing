{
    "paper_id": "5fda8c7ddb1aa712b7490d9b8068ec6cb5f6b7cd",
    "metadata": {
        "title": "A spectral adjustment for spatial confounding",
        "authors": [
            {
                "first": "Yawen",
                "middle": [],
                "last": "Guan",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Nebraska -Lincoln",
                    "location": {}
                },
                "email": ""
            },
            {
                "first": "Garritt",
                "middle": [
                    "L"
                ],
                "last": "Page",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Brigham Young University",
                    "location": {}
                },
                "email": ""
            },
            {
                "first": "Brian",
                "middle": [
                    "J"
                ],
                "last": "Reich",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "North Carolina State University",
                    "location": {}
                },
                "email": ""
            },
            {
                "first": "Massimo",
                "middle": [],
                "last": "Ventrucci",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Bologna",
                    "location": {}
                },
                "email": ""
            },
            {
                "first": "Shu",
                "middle": [],
                "last": "Yang",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "North Carolina State University",
                    "location": {}
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "Adjusting for an unmeasured confounder is generally an intractable problem, but in the spatial setting it may be possible under certain conditions. In this paper, we derive necessary conditions on the coherence between the treatment variable of interest and the unmeasured confounder that ensure the causal effect of the treatment is estimable. We specify our model and assumptions in the spectral domain to allow for different degrees of confounding at different spatial resolutions. The key assumption that ensures identifiability is that confounding present at global scales dissipates at local scales. We show that this assumption in the spectral domain is equivalent to adjusting for global-scale confounding in the spatial domain by adding a spatially smoothed version of the treatment variable to the mean of the response variable. Within this general framework, we propose a sequence of confounder adjustment methods that range from parametric adjustments based on the Mat\u00e9rn coherence function to more robust semiparametric methods that use smoothing splines. These ideas are applied to areal and geostatistical data for both simulated and real datasets.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "A fundamental task in environmental and epidemiological applications is to use spatially-correlated observational data to estimate the effect of a treatment variable on a response variable. A key assumption needed to endow an analysis with a causal interpretation is that all relevant confounding variables have been included in the statistical model. This no-missing-confounders assumption is generally impossible to verify, but in the spatial setting it may be possible to remove the effects of unmeasured confounding variables that are smooth spatial functions by including spatially-correlated random effects in the model. It is known that regressions with and without spatial random effects can give dramatically different results (Reich et al., 2006; Paciorek, 2010; Hodges and Reich, 2010; Page et al., 2017; Khan and Calder, 2020) , a phenomena known as spatial confounding. However, it remains unclear how to specify assumptions and methods that lead to a valid causal interpretation in the presence of an unmeasured spatial confounding variable. In this paper, we propose new methods to adjust for missing spatial confounding variables using spectral methods.",
            "cite_spans": [
                {
                    "start": 736,
                    "end": 756,
                    "text": "(Reich et al., 2006;",
                    "ref_id": "BIBREF28"
                },
                {
                    "start": 757,
                    "end": 772,
                    "text": "Paciorek, 2010;",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 773,
                    "end": 796,
                    "text": "Hodges and Reich, 2010;",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 797,
                    "end": 815,
                    "text": "Page et al., 2017;",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 816,
                    "end": 838,
                    "text": "Khan and Calder, 2020)",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "One explanation of the differences between regression models that do and do not include a spatial random effect is that the treatment variable is collinear with an unmeasured spatial confounding variable. To account for spatial confounding, Reich et al. (2006) , Hughes and Haran (2013) and Prates et al. (2019) restrict the residual process to be orthogonal to the treatment process (an approach referred to as restricted spatial regression, RSR). However, RSR makes strong assumptions and can perform poorly when the model is misspecified (Hanks et al., 2015) . Indeed, in recent work, Khan and Calder (2020) showed that the variants of RSR often times are inferior to regression models that completely ignore spatial dependence when coefficient estimation is of interest. Therefore, proper adjustment for spatial confounding continues to be an important and open problem as evidenced by the many contexts in which it is being addressed (Hefley et al. 2017; Pereira et al. 2020; Azevedo et al. 2020; Nobre et al. 2020) .",
            "cite_spans": [
                {
                    "start": 241,
                    "end": 260,
                    "text": "Reich et al. (2006)",
                    "ref_id": "BIBREF28"
                },
                {
                    "start": 263,
                    "end": 286,
                    "text": "Hughes and Haran (2013)",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 291,
                    "end": 311,
                    "text": "Prates et al. (2019)",
                    "ref_id": "BIBREF24"
                },
                {
                    "start": 541,
                    "end": 561,
                    "text": "(Hanks et al., 2015)",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 588,
                    "end": 610,
                    "text": "Khan and Calder (2020)",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 939,
                    "end": 959,
                    "text": "(Hefley et al. 2017;",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 960,
                    "end": 980,
                    "text": "Pereira et al. 2020;",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 981,
                    "end": 1001,
                    "text": "Azevedo et al. 2020;",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 1002,
                    "end": 1020,
                    "text": "Nobre et al. 2020)",
                    "ref_id": "BIBREF18"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Alternatives to RSR have appeared in the literature. For example, Dupont et al. (2020) use a two-stage thin plate spline model for covariate and unmeasured spatial confounder. Alternatively, Thaden and Kneib (2018) and Schnell and Papadogeorgou (2019) propose jointly modeling the spatial structure in response and covariate. The former carries this out through a structural equation model while the later uses a Gaussian Markov random field construction. Both these methods have connections with causal inference (see Reich et al. 2020 for a recent review of spatial causal inference). In the spatial causal effect setting, Osama et al. (2019) permit the spatial causal effect to vary across space. In general, adjusting for a missing confounding variable is impossible without further information or assumptions, leading to a variety of approaches and increased attention dedicated to this problem.",
            "cite_spans": [
                {
                    "start": 66,
                    "end": 86,
                    "text": "Dupont et al. (2020)",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 191,
                    "end": 214,
                    "text": "Thaden and Kneib (2018)",
                    "ref_id": "BIBREF36"
                },
                {
                    "start": 219,
                    "end": 251,
                    "text": "Schnell and Papadogeorgou (2019)",
                    "ref_id": "BIBREF32"
                },
                {
                    "start": 519,
                    "end": 536,
                    "text": "Reich et al. 2020",
                    "ref_id": "BIBREF29"
                },
                {
                    "start": 625,
                    "end": 644,
                    "text": "Osama et al. (2019)",
                    "ref_id": "BIBREF19"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "We propose to couch spatial regression with missing confounding variables in the spectral domain.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Following Paciorek (2010) and Keller and Szpiro (2020) , we focus on the spatial scales of the treatment and missing confounder variable. We posit a joint model for these variables in the spectral domain (as in Reich et al., 2014 , for a prediction problem) and study their coherence, i.e., their correlation at different spatial scales. (As an aside, Stokes and Purdon (2017) and Faes et al. (2019) consider a frequency-domain measure of causality from a temporal perspective, although their resulting estimators are quite different than those proposed here.) The resulting causal effect estimate reveals that the optimal confounder adjustment is a function of the coherence function. We then show that the optimal confounder adjustment is not estimable without further assumptions, and so we assume that the coherence dissipates at high frequencies, i.e., that there are no unmeasured confounder variables when considering only local spatial variation. We show this assumption in the spectral domain implies that the model in the spatial domain should include a spatiallysmoothed version of the treatment variable as a covariate to adjust for global-scale spatial confounding. We then develop parametric and nonparametic methods to approximate the optimal confounding adjustment and causal effect while accounting for uncertainty in this approximation. We consider both areal and pointreferenced data for Gaussian and non-Gaussian responses.",
            "cite_spans": [
                {
                    "start": 10,
                    "end": 25,
                    "text": "Paciorek (2010)",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 30,
                    "end": 54,
                    "text": "Keller and Szpiro (2020)",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 211,
                    "end": 229,
                    "text": "Reich et al., 2014",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 352,
                    "end": 376,
                    "text": "Stokes and Purdon (2017)",
                    "ref_id": "BIBREF35"
                },
                {
                    "start": 381,
                    "end": 399,
                    "text": "Faes et al. (2019)",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In this section, we develop a framework for spatial causal inference for data observed over a continuous spatial domain, and study the identifiability of the causal effect under different confounding scenarios. Let X(s) and Z(s) be the observed treatment and confounder processes respectively at the spatial location s \u2208 D \u2282 R 2 and let vectors X = (X 1 , . . . , X n ) T and Z = (Z 1 , . . . , Z n ) T be the process evaluated at the set of locations S = {s 1 , . . . , s n } \u2208 D, where X i = X(s i ) and Z i = Z(s i ). For simplicity we consider only a single treatment and confounding variable, but the results extend to the multivariate setting (see Supplemental Section 1).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Continuous-space modeling framework"
        },
        {
            "text": "Following the commonly used spatial regression model, we assume a linear addictive relationship for the response Y = (Y 1 , . . . , Y n ) T ,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Continuous-space modeling framework"
        },
        {
            "text": "where \u03b5 = (\u03b5 1 , ..., \u03b5 n ) T and \u03b5 i iid \u223c Normal(0, \u03c3 2 ). The regression coefficient \u03b2 x has a causal interpretation under the potential outcomes framework and the stable-unit-treatment-value, consistency, and conditionaltreatment-ignorability assumptions (Supplemental Section 2). If we observe the confounder Z, then identification and estimation of \u03b2 x is straightforward using multiple linear regression. However, we assume that Z is an unmeasured confounder, making \u03b2 x not identifiable in general. We propose to exploit the spatial structure of Z to mitigate the effects of the unobserved confounder. In Section 2.1 we propose assumptions in the spectral domain that identify the causal effect in the presence of an unmeasured spatial confounder.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Continuous-space modeling framework"
        },
        {
            "text": "We model the dependence between X(s) and Z(s) using their spectral representations. This allows for different dependence at different spatial scales as each frequency corresponds to a spatial scale, with low frequency corresponding to large spatial scale phenomenon and vise versa. We assume both processes X(s) and Z(s) have mean zero and are stationary, and thus have spectral representations",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spectral representation of confounding and identification"
        },
        {
            "text": "where \u03c9 \u2208 R 2 is a frequency. The spectral processes X (\u03c9) and Z(\u03c9) are Gaussian with E{X (\u03c9)} = E{Z(\u03c9)} = 0 and are independent across frequencies, so that for any \u03c9 = \u03c9 , Cov{X (\u03c9), X (\u03c9 )} = Cov{Z(\u03c9), Z(\u03c9 )} = Cov{X (\u03c9), Z(\u03c9 )} = 0. At the same frequency, the covariance of the joint spectral process has the form",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spectral representation of confounding and identification"
        },
        {
            "text": "where \u03c3 2 x and \u03c3 2 z are variance parameters, f x (\u03c9) > 0 and f z (\u03c9) > 0 are spectral densities that determine the marginal spatial correlation of X(s) and Z(s), respectively, and the cross-spectral density f xz (\u03c9) determines the dependence between the spectral processes at different frequencies.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spectral representation of confounding and identification"
        },
        {
            "text": "Normalizing the cross-spectral density by each marginal standard deviation, we can derive the coherence function which determines the correlations between the two spectral processes at different frequencies,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spectral representation of confounding and identification"
        },
        {
            "text": "The parameter \u03c1 is a scalar that controls the overall strength of cross-correlation. The coherence function is useful to describe the relationships between processes (Kleiber, 2017) .",
            "cite_spans": [
                {
                    "start": 166,
                    "end": 181,
                    "text": "(Kleiber, 2017)",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "Spectral representation of confounding and identification"
        },
        {
            "text": "Returning to the response model (1), we let Y (s) = exp(i\u03c9 T s)Y(\u03c9)d\u03c9 be the spectral representation of the response. The conditional distribution of Y(\u03c9) given X (\u03c9), marginalizing over Z(\u03c9) is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spectral representation of confounding and identification"
        },
        {
            "text": "is a result of attributing the effect of the unmeasured confounder on the response to the treatment variable, potentially inducing bias in estimating \u03b2 x .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spectral representation of confounding and identification"
        },
        {
            "text": "Therefore, the causal effect \u03b2 x is identified only if the projection operator \u03b1(\u03c9) can be assumed to be known or estimated for some prespecified \u03c9. Of course, \u03b1(\u03c9) is generally not known and cannot be estimated without further assumptions because Z(s), and therefore Z(\u03c9), is not observed. We consider two approaches for identification: unconfoundedness at high frequencies so that high-frequency terms identify the causal effect (Section 2.1.1) or a parsimonious and parametric model with constraints on the parameters to ensure identification (Section 2.1.2).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spectral representation of confounding and identification"
        },
        {
            "text": "If we assume that \u03b1(\u03c9) \u2192 0 for large ||\u03c9|| then E{Y(\u03c9)|X (\u03c9)} \u2248 \u03b2 x X (\u03c9) and thus \u03b2 x is identified. The assumption that \u03b1(\u03c9) \u2192 0 for large ||\u03c9|| implies that the cross-spectral density decreases to zero faster than the spectral density of X, implying a decrease in confounding in higher frequency or local variations. High frequency terms provide the most reliable information about the causal effect because they correlate local changes in the treatment with local changes in the response. An extreme case of local information about the causal effect is the difference in the response for two nearby sites with different treatment levels. This local difference eliminates problems caused by omitted variables that vary smoothly over space. Of course, this cannot completely rule out missing confounding variables that co-vary with both the treatment and the response at high frequencies, but it does lessen the likelihood of spurious confounding effects.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Unconfoundedness at high-frequencies"
        },
        {
            "text": "The coherence in (3) simplifies to the constant function \u03b3(\u03c9) = \u03c1C \u2208 (\u22121, 1) if we assume f xz (\u03c9) = C f x (\u03c9)f z (\u03c9) for a constant C. Generalizing the use of a term from Gneiting et al. (2010) , we refer to this as the parsimonious coherence model. This imposes the assumption that the correlation between the treatment and missing confounder is frequency-invariant, and this greatly simplifies estimation because the model involves only two spectral densities that can be estimated using the marginal spatial covariances of the response and treatment variables, as described below. The expression in (4) simplifies under the parsimonious model to",
            "cite_spans": [
                {
                    "start": 172,
                    "end": 194,
                    "text": "Gneiting et al. (2010)",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Parsimonious coherence model"
        },
        {
            "text": "Clearly \u03b2 z and \u03c3 z cannot be individually identified as only their product appears in (5), so we set \u03b2 z = 1.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Parsimonious coherence model"
        },
        {
            "text": "Given this restriction and the assumption that f x (\u03c9) = f z (\u03c9) for some \u03c9, Supplemental Section 3 shows that the remaining parameters \u03b2 x , \u03c1C, \u03c3 x and \u03c3 z and functions f x and f z are all identified.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Parsimonious coherence model"
        },
        {
            "text": "Returning to the spatial domain, the response process can be written as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spatial representation of confounding and identification"
        },
        {
            "text": "and \u03b4(s) is a mean-zero Gaussian process with spectral density \u03c4 2 (\u03c9)+\u03c3 2 independent of X(s) and\u1e90(s). If \u03b1(\u03c9) were known, then\u1e90(s) would be an appropriate adjustment to the mean to account for the unmeasured confounder.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spatial representation of confounding and identification"
        },
        {
            "text": "The function \u03b1(\u03c9) acts as a smoothing operator. The oracle (i.e., if \u03b1(\u03c9) is known) confounder adjustment has the form\u1e90(s) = K(s \u2212 s )X(s )ds , where the kernel function K(s \u2212 s ) is the inverse Fourier transform of \u03b1(\u03c9) (Supplemental Section 4). Thus the oracle confounder adjustment is conveniently expressed as a kernel-smoothed function of the covariate of interest. It is also straightforward to show that for any n locations S,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spatial representation of confounding and identification"
        },
        {
            "text": "x serves as a smoothing operator on X. This representation is convenient for estimation and to determine the strength of confounding dependence between X and Z.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spatial representation of confounding and identification"
        },
        {
            "text": "Including\u1e90 as a covariate in (6) effectively removes effects of the large-scale spatial trends in X so that the estimate of \u03b2 x is largely determined by high-frequency terms. This expression also lays bare the importance of assuming that \u03b1(\u03c9) converges to zero for large frequencies or that X and Z have different spectral densities. If restrictions are not placed on \u03b1(\u03c9), then it may be that \u03a3 zx = \u03a3 x and thus\u1e90 = X, giving the non-identifiable model Y = \u03b2 0 1 + \u03b2 x X + \u03b2 z X + \u03b4.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Spatial representation of confounding and identification"
        },
        {
            "text": "Below we define two approaches for modeling \u03b1(\u03c9): a parametric model induced by a bivariate Mat\u00e9rn covariance function for X(s) and Z(s) (Section 3.1), and a semi-parametric model using a spectral mixture prior for \u03b1(\u03c9) (Section 3.2).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Continuous-space estimation strategies"
        },
        {
            "text": "The bivariate Mat\u00e9rn model (Gneiting et al., 2010; Apanasovich et al., 2012) is a flexible parametric model for the spectral densities f x , f z and f xz . The Mat\u00e9rn spectral density function for a process in two dimensions is m(\u03c9; \u03bd, \u03c6) = \u03bd\u03c6 \u22122\u03bd \u03c6 \u22122 + ||\u03c9|| 2 \u2212(\u03bd+1) . The spectral density is defined by the smoothess parameter \u03bd > 0 and the spatial range \u03c6 > 0. The bivariate Mat\u00e9rn may have different parameters for each process, f j (\u03c9) = m(\u03c9; \u03bd j , \u03c6 j ), for j \u2208 {x, z, xz}, although constraints on the range and smoothness parameters are needed to ensure that the coherence is positive definite for all \u03c9 (Gneiting et al., 2010; Apanasovich et al., 2012) .",
            "cite_spans": [
                {
                    "start": 27,
                    "end": 50,
                    "text": "(Gneiting et al., 2010;",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 51,
                    "end": 76,
                    "text": "Apanasovich et al., 2012)",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 614,
                    "end": 637,
                    "text": "(Gneiting et al., 2010;",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 638,
                    "end": 663,
                    "text": "Apanasovich et al., 2012)",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "The bivariate Mat\u00e9rn model"
        },
        {
            "text": "With this modeling assumption, the projection operator has the form The covariate process X(s) is generated from a Mat\u00e9rn process with range \u03c6 x = 1 and smoothness \u03bd x = 1 on a 50 \u00d7 50 grid with grid spacing one, and the plots below give the confounder adjustment\u1e90(s) for range \u03c6 xz = \u03c6 x and smoothness \u03bd xz = c\u03bd x for c \u2208 {1, 3, 5} (\u1e90(s) = X(s) for c = 1).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The bivariate Mat\u00e9rn model"
        },
        {
            "text": "Therefore, if the cross-spectral density decays faster than the covariate spectral density then the confounding adjustment is small for high frequencies. This expression simplifies further if we assume a common range",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The bivariate Mat\u00e9rn model"
        },
        {
            "text": "In this case, we have unconfoundedness at high frequencies, \u03b1(\u03c9) \u2192 0, if and only if \u03bd xz > \u03bd x , i.e., the cross-covariance is smoother than the covariate covariance. On the other hand, if we assume a common smoothness \u03bd j = \u03bd for j \u2208 {x, z, xz}, then \u03b1(\u03c9) \u2192 \u03c6x \u03c6xz 2\u03bd and confounding persists at high frequencies, regardless of the range parameters. Therefore, a common range parameterization allows us to identify the causal effect by reducing high-resolution confounding while a common smoothness parameterization will not. For simplicity, we will assume a common range in the remainder of this section. Figure 1 with c = 1, in which case we have\u1e90 = X and thus a completely confounded model. In the cases with c > 1 the confounder adjustment Z is a smoothed version of X. Therefore, including\u1e90 as a covariate in the model removes large-scale trends in X to adjust for confounding at low-frequencies.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 608,
                    "end": 616,
                    "text": "Figure 1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "The bivariate Mat\u00e9rn model"
        },
        {
            "text": "The unmeasured confounder cannot be observed, making it difficult to estimate all the parameters in the bivariate Mat\u00e9rn model. Therefore, additional constraints are required for estimation of the parameters.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The bivariate Mat\u00e9rn model"
        },
        {
            "text": "Assuming \u03b2 z = 1 and a common range parameter, sufficient conditions (Supplemental Section 5) for identifiability of the remaining parameters {\u03b2 x , \u03c1, \u03bd x , \u03bd z , \u03bd xz , \u03c3 x , \u03c3 z } are a large cross-smoothness parameter",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The bivariate Mat\u00e9rn model"
        },
        {
            "text": "The common range model simplifies further under the parsimonious model in (5) with C = (\u03bdx+\u03bdz)/2 \u221a \u03bdx\u03bdz , |\u03c1| < \u221a \u03bdx\u03bdz (\u03bdx+\u03bdz)/2 , and f xz (\u03c9) = m(\u03c9; (\u03bd x + \u03bd z )/2, \u03c6). This is the parsimonious Mat\u00e9rn model of Gneiting et al. (2010) , i.e., the cross smoothness equals the average of the marginal smoothness parameters, \u03bd xz = (\u03bd x + \u03bd z )/2. Under this model the confounder adjustment becomes",
            "cite_spans": [
                {
                    "start": 212,
                    "end": 234,
                    "text": "Gneiting et al. (2010)",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "The bivariate Mat\u00e9rn model"
        },
        {
            "text": "and thus \u03b1(\u03c9) \u2192 0 if and only if \u03bd z > \u03bd x , i.e., the missing confounder is smoother than the treatment. On the other hand, if \u03bd z < \u03bd x then \u03b1(\u03c9) \u2192 \u221e, which is clearly undesirable.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The bivariate Mat\u00e9rn model"
        },
        {
            "text": "Rather than indirectly modeling the projection operator \u03b1(\u03c9) via a model for the cross-covariance function, in this section we directly model \u03b1(\u03c9) using a flexible mixture model. We use a linear combination of B-splines as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric model"
        },
        {
            "text": "where \u03c9 = ||\u03c9||, B l (\u03c9) are B-spline basis functions, b l are the associate coefficients and s = max {ds 1 , ds 2 } for grid spacing (ds 1 , ds 2 ). A uniform sequence of knots {\u03c9 * 1 , ..., \u03c9 * L } are placed to cover the interval [0, \u03c0/ s ], such that 0 \u2208 (\u03c9 * 1 , \u03c9 * 2 ) and \u03c0/ s \u2208 (\u03c9 * L\u22121 , \u03c9 * L ). The interval upper bound \u03c0/ s is the largest spectrum that can be observed from uniformly spaced data due to aliasing (Fuentes and Reich, 2010) . We have restricted the projection operator to be isotropic by letting \u03c9 = ||\u03c9||, but this can be relaxed by using bivariate spline functions. Other mixture priors (Reich and Fuentes, 2012; Jang et al., 2017; Chen et al., 2018) can also be used for modeling the projection operator",
            "cite_spans": [
                {
                    "start": 425,
                    "end": 450,
                    "text": "(Fuentes and Reich, 2010)",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 616,
                    "end": 641,
                    "text": "(Reich and Fuentes, 2012;",
                    "ref_id": "BIBREF27"
                },
                {
                    "start": 642,
                    "end": 660,
                    "text": "Jang et al., 2017;",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 661,
                    "end": 679,
                    "text": "Chen et al., 2018)",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "Semi-parametric model"
        },
        {
            "text": "The B-spline mixture model for \u03b1(\u03c9) does not have a closed-form inverse Fourier transformation. We approximate the kernel-smoothed function K(s \u2212 s ) with a finite sum at a set of equally spaced frequencies",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric model"
        },
        {
            "text": ". , \u03c9 f m with spacing F and \u03c9 f m = \u03c0/ s following Qadir and Sun (2020)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric model"
        },
        {
            "text": "is a Bessel function of the first kind of order \u03ba (Watson, 1995) . This approximation allows us to directly compute confounder adjustment in the spatial domain, which would otherwise require Fourier transform of data to perform analysis in the spectral domain. The confounder adjustment is then given b\u0177",
            "cite_spans": [
                {
                    "start": 50,
                    "end": 64,
                    "text": "(Watson, 1995)",
                    "ref_id": "BIBREF37"
                }
            ],
            "ref_spans": [],
            "section": "Semi-parametric model"
        },
        {
            "text": "When X(s) is observed on a grid, the integral can be approximated",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric model"
        },
        {
            "text": "For non-gridded data, the covariate can be interpolated to a grid and this discrete approximation to the grid can be applied. The confounder adjustment covariates\u1e90 l (s) are precomputed to reduce computation during model fitting. We then fit spatial model",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric model"
        },
        {
            "text": "where \u03b2 z = 1 for identification and \u03b4(s) is modeled as a Gaussian process. The coefficients (b 1 , ..., b L ) T are given intrinsic autoregressive priors with full conditional distributions",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric model"
        },
        {
            "text": "The concepts developed in Sections 2 and 3 for the continuous spatial domain naturally extend to the discrete case with the spatial domain comprised of n regions. For region i, let Y i , X i and Z i be the response, treatment and confounding variables, respectively, and Y = (Y 1 , ..., Y n ) T , X = (X 1 , ..., X n ) T and Z = (Z 1 , ..., Z n ) T . Assuming Z is known and the same causal assumptions as in Section 2, the structural model",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete-space methodology"
        },
        {
            "text": "permits a causal intepretation of \u03b2 x . If we observe the confounder Z, then estimation of the causal effect \u03b2 x is straightforward using multiple linear regression. However, we assume that Z is an unmeasured confounder.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete-space methodology"
        },
        {
            "text": "Since we do not observe Z, we assume that it follows a spatial model. In the discrete case, dependence between the regions is often described by a region adjacency structure. Let a ij = 1 if regions i and j are adjacent and 0 otherwise, and m i be the number of regions adjacent to region i. A common model based on this adjacency structure is the conditionally autoregressive (CAR) model (Gelfand et al., 2010) using the Leroux parameterization (Leroux et al., 2000) . For an arbitrary vector z = (z 1 , ..., z n ) T , the CAR model is",
            "cite_spans": [
                {
                    "start": 389,
                    "end": 411,
                    "text": "(Gelfand et al., 2010)",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 446,
                    "end": 467,
                    "text": "(Leroux et al., 2000)",
                    "ref_id": "BIBREF17"
                }
            ],
            "ref_spans": [],
            "section": "A spectral model for confounding"
        },
        {
            "text": "where \u00b5 = (\u00b5 1 , ..., \u00b5 n ) T is the mean vector, \u03c3 2 z determines the overall variance, \u03bb z \u2208 [0, 1] controls the strength of spatial dependence (larger \u03bb z gives stronger dependence) and R is an n \u00d7 n matrix with (i, j) off-diagonal element \u2212a ij and i th diagonal element m i . We denote this model as z \u223c CAR(\u00b5, \u03c3 2 z , \u03bb z ). An advantage of the Leroux parameterization is that the spatial covariance can be written as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A spectral model for confounding"
        },
        {
            "text": "where the spectral decomposition of R is R = \u0393W\u0393 T for orthonormal eigenvector matrix \u0393 and diagonal eigenvalue matrix W with k th diagonal element \u03c9 k \u2265 0, ordered so that \u03c9 1 \u2264 ... \u2264 \u03c9 n . Assuming all variables have the same adjacency structure R, this allows us to project the model into the spectral domain using graph Fourier transform (Sandryhaila and Moura, 2013) ,",
            "cite_spans": [
                {
                    "start": 342,
                    "end": 371,
                    "text": "(Sandryhaila and Moura, 2013)",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [],
            "section": "A spectral model for confounding"
        },
        {
            "text": "This transformation decorrelates the model and gives",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A spectral model for confounding"
        },
        {
            "text": "where M k is the sum of the k th column of \u0393 and (X * k , Z * k ) are independent across k. To exploit this decorrelation property of the graph Fourier transform, we conduct all analyses of Gaussian data for discrete spatial domain in the spectral scale.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A spectral model for confounding"
        },
        {
            "text": "Comparing the discrete and continuous cases, the eigenvalue \u03c9 k is analogous to frequency, \u03c9. Terms with small \u03c9 k have large variance and measure large-scale trends in the data. For example, it can be shown that if the n locations form a connected graph, then \u03c9 1 = 0 and Y * 1 is proportional to the mean of Y. In contrast, terms with large \u03c9 k have small variance and represent small-scale features. Using this analogy, in the remainder of this section we extend two of the continuous-domain methods of Section 3 to the discrete case.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A spectral model for confounding"
        },
        {
            "text": "As in Section 2, we assume a joint model for X * and Z * . We assume the pairs (X * k , Z * k ) are independent across k, and Gaussian with mean zero and covariance",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "where \u03c3 2 x and \u03c3 2 z are variance parameters, f x (\u03c9 k ) > 0 and f z (\u03c9 k ) > 0 are variance functions that determine the covariance of X and Z, respectively, and scalar \u03c1 and function f xz (\u03c9 k ) determine the dependence between X and Z. For the Leroux CAR model we have f j (\u03c9 k ) = 1/(1 \u2212 \u03bb j + \u03bb j \u03c9 k ) for j \u2208 {x, z} so that the marginal distributions are X \u223c CAR(0, \u03c3 2",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "x , \u03bb x ) and Z \u223c CAR(0, \u03c3 2 z , \u03bb z ). One possible parametric cross-covariance model is f xz (\u03c9) = 1/(1 \u2212 \u03bb xz + \u03bb xz \u03c9). As with the bivariate Mat\u00e9rn, the f xz has the same functional form as f x and f z . Constraints are required to ensure the covariance in (15) is positive definite, i.e., that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "for all w \u2208 {\u03c9 1 , ..., \u03c9 n }. Necessary conditions for (16) to hold for all w \u2265 0 are",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "but these conditions are not sufficient and not even necessary when considering only w \u2208 {\u03c9 1 , ..., \u03c9 n }.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "Assuming the covariance parameters give a valid covariance, then marginalizing over Z * k and setting \u03b2 z = 1 (as in Section 2) for identification gives",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "\u03c3x\u03bbxz as \u03c9 \u2192 \u221e and thus the high-resolution confounding effect is smallest when \u03bb x is smaller than \u03bb xz .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "The parsimonious cross-covariance model is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "With this simplification, any \u03c1 \u2208 (\u22121, 1) and \u03bb x , \u03bb z \u2208 (0, 1) give a valid covariance and the terms in (17) ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "The expression for \u03b1(\u03c9 k ) shows that when the missing confounder is smoother than the treatment (\u03bb z > \u03bb x ) there is less counfounding for high-resolution terms. However, unlike the parsimonious Mat\u00e9rn model for the continuous-space, the missing confounder need not be smoother than the treatment for identifiability, because for any \u03bb z and \u03bb x , the casual effect can be identified as long as \u03bb x = \u03bb z as shown in Supplemental Section 6.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "In the spatial domain, the parsimonious model is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "where V \u223c CAR{0, \u03c3 2 z (1 \u2212 \u03c1 2 ), \u03bb z } and A is diagonal with k th diagonal element \u03b1(\u03c9 k ). The term \u0393A\u0393 T X adjusts for missing spatial confounders and the term V captures spatial variation that is independent of X. In this case with \u03bb z > \u03bb x , the confounder adjustment \u0393A\u0393 T X smooths X by first projecting into the spectral domain by multiplying by \u0393 T , then dampening the high-frequency terms with large \u03c9 and thus small \u03b1(\u03c9) by multiplying by A, and finally projecting back in the spatial domain by multiplying by \u0393.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bivariate CAR model"
        },
        {
            "text": "Mirroring Section 3.2, rather than specify a parametric joint model for (X * k , Z * k ), we directly specify a flexible model for the confounder adjustment, \u03b1(\u03c9). The joint model is specified first with the conditional",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "In the spatial domain, this implies that Z|X \u223c CAR(\u0393A\u0393 T X, \u03c3 z , \u03bb z ), where A is diagonal with diagonal elements {\u03b1(\u03c9 1 ), ..., \u03b1(\u03c9 n )}. Therefore, with any valid marginal distribution of X, the joint model of X and Z is well defined. However, since X is observed we do not need a model for its marginal distribution.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "Marginalizing over the unknown Z * gives",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "where \u03b2(\u03c9 k ) = \u03b2 x + \u03b1(\u03c9 k ). Following Section 3.2, we assume that \u03b1(\u03c9 n ) = 0 so that X * n and Z * n are uncorrelated for the highest-frequency term. This implies that \u03b2(\u03c9 n ) = \u03b2 x and E(Y * n ) = \u03b2 0 M n + \u03b2 x X n , and thus the final term supplies unbiased information about the true causal effect \u03b2 x . Of course, a single unbiased term is insufficient for estimation, and so we further assume that \u03b1(\u03c9) varies smoothly over \u03c9 to permit semi-parametric estimation of \u03b2 x . We fit the model (19) with a covariate effect that is allowed to vary with k to separate associations at different spatial resolutions. Although other smoothing techniques are possible, the frequency-specific coefficients are smoothed using the basis expansion",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "where B l (\u03c9) are B-spline basis functions and the b l are the associated coefficients. Under the assumption that \u03b1(\u03c9 n ) = 0, we use the posterior distribution of \u03b2(\u03c9 n ) to summarize the causal effect \u03b2 x .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "In the spatial domain, the semi-parametric CAR model can be written as (10),",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "with V \u223c CAR(0, \u03c3 2 z , \u03bb z ),\u1e90 l = \u0393B l \u0393 T X, B l is the diagonal matrix with spline basis functions, {B l (\u03c9 1 ), ..., B l (\u03c9 n )}, on the diagonal and the regression coefficient are modelled as described below (9). The constructed covari-ates\u1e90 l can be precomputed prior to estimation, and thus computation resembles a standard spatial analysis with L known covariates. As above, under the assumption of no confounding for large \u03c9, we use the posterior of \u03b2 x = L l=1 B l (\u03c9 n )b l to summarize the causal effect.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "Many of the methods proposed for continuous and discrete domains can be applied to non-Gaussian data using the generalized linear mixed modeling framework. Let g{E(Y i |X i , Z i )} = \u03b8 i = \u03b2 x X i + Z i for link function g. Our general approach is to build a joint model for (X i , Z i ), and then compute the conditional distribution of \u03b8 = (\u03b8 1 , ..., \u03b8 n ) T given X. Using the notation in (6), the conditional distribution is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized linear mixed spatial models"
        },
        {
            "text": "For example, the bivariate Mat\u00e9rn could then be fit by estimating the Mat\u00e9rn correlation parameters in\u1e90 and \u03a3 j for j \u2208 {x, z, xz}. The semi-parametric model in Section 3.2 can be fit by assigning \u03b8 a Gaussian process prior with Mat\u00e9rn covariance function and mean function E(\u03b8",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized linear mixed spatial models"
        },
        {
            "text": "The general bivariate CAR model in Section 4.2 gives",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized linear mixed spatial models"
        },
        {
            "text": "where A and T are diagonal with k th diagonal elements \u03b1(\u03c9 k ) and \u03c4 2 (\u03c9 k ), respectively, given below (17).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized linear mixed spatial models"
        },
        {
            "text": "under the parsimonious CAR model. If we assume the semi-parametric model in Section 4.3, and thus \u03b2 x X + \u0393A\u0393 T X = L l=1\u1e90 l b l , then the spatial random effects distribution is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "This reduces to"
        },
        {
            "text": "Unlike for Gaussian data, the MCMC cannot proceed in the spectral domain and matrix multiplication \u0393A\u0393 T X = \u0393AX * is required when updating the parameters in \u03b1(\u03c9 k ). For the semi-parametric model much of the computational burden can be shouldered outside the MCMC loop by precomputing matrices as \u0393A\u0393 T X = L l=1X l b l whereX l = \u0393B l \u0393 T X and B l is the diagonal matrix with spline basis functions, {B l (\u03c9 1 ), ..., B l (\u03c9 n )}, on the diagonal. After this computation, the method can be fit using standard software for spatial generalized linear models such as INLA or OpenBUGS, and the posterior of \u03b2 x = L l=1 B l (\u03c9 n )b l summarizes the causal effect. As a concrete example for the discrete domain, in Section 7.2 we consider two applications that require fitting Poisson and Negative-Binomial regression models.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "This reduces to"
        },
        {
            "text": "In this section, we illustrate the proposed methods using simulated data. The objectives are to illustrate the adverse effects of spatial confounding for standard methods, and to compare parametric and nonparametric alternatives under a range of true coherence functions in terms of bias and coverage of 95% intervals for the causal effect. We begin with the simpler discrete case in Section 6.1 and then proceed to the continuous case in Section 6.2.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Simulation study"
        },
        {
            "text": "Data are generated at n spatial locations s 1 , ..., s n arranged as the 40 \u00d7 40 square grid with grid spacing one.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete-space"
        },
        {
            "text": "The CAR model uses rook neighborhood structure so that A ij = 1 if and only if ||s i \u2212 s j || = 1. Rather than simulating data directly from our spectral model, we generate data as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete-space"
        },
        {
            "text": "Z|X \u223c CAR \u03b2 xz WX, \u03c3 2 z , \u03bb Y|X, Z \u223c Normal \u03b2 x X + \u03b2 z Z, \u03c3 2 I n where W is the kernel smoothing matrix with bandwidth \u03c6, i.e., the matrix with (i, j) element W ij = w ij /( n l=1 w il ) and log(w ij ) = \u2212(||s i \u2212 s j ||/\u03c6) 2 . Including the kernel-smoothed X in the mean of Z induces low-resolution dependence between X and Z while ensuring that Z is a smoother process than X.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete-space"
        },
        {
            "text": "In all cases we take \u03c3 2 x = 1.7, \u03c3 2 z = 1, \u03bb = 0.95, \u03b2 x = \u03b2 z = 0.5 and \u03c3 2 = 0.25 2 , and we vary the importance of the strength of dependence between X and Z via \u03b2 xz \u2208 {0, 1, 2}, and the kernel bandwidth \u03c6 \u2208 {1, 2}. For each combination of these parameters we generate 500 datasets. A representative dataset for each simulation scenario is plotted in Supplementary Section 7. Figure 2 plots the induced correlations in the spectral domain for each scenario with \u03b2 xz > 0, which is proportional to \u03b1(\u03c9 k ). The correlation is non-zero for only low-frequency terms with small \u03c9 k when the bandwidth is \u03c6 = 2, but correlation spills over to high-frequency terms with large \u03c9 k when \u03c6 = 1, especially when \u03b2 xz = 2. Therefore, the assumption of no confounding at high frequencies is questionable Figure 2 : Correlations in the spectral domain for the simulation study: Cor(X * k , Z * k ) by the associated eigenvalue \u03c9 k for different kernel bandwidth (\u03c6) and strength of exposure/confounder dependence (\u03b2 xz ); in these four designs defined by the real-space average (over locations) Cor(X i , Z i ) are 0.62 when \u03c6 = 1 and \u03b2 xz = 1, 0.80 when \u03c6 = 1 and \u03b2 xz = 2, 0.46 when \u03c6 = 3 and \u03b2 xz = 1, and 0.63 when \u03c6 = 3 and \u03b2 xz = 2. ",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 382,
                    "end": 390,
                    "text": "Figure 2",
                    "ref_id": null
                },
                {
                    "start": 798,
                    "end": 806,
                    "text": "Figure 2",
                    "ref_id": null
                }
            ],
            "section": "Discrete-space"
        },
        {
            "text": "when \u03c6 = 1, and these scenarios are used to examine sensitivity to this key assumption. Also, these datagenerating scenarios violate the parsimonious assumption that the correlation is constant across frequency, and so they illustrate the effects of mispecifying the parametric model.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete-space"
        },
        {
            "text": "For each simulated dataset, we fit the standard method with \u03b2 k = \u03b2 x for all k (\"Standard\"), the parsimonious bivariate CAR (\"Parametric\") model and the semi-parametric model with \u03b2 k varying across k using a B-spline basis expansion. We compare two priors for \u03c3 2 b , the variance of the coefficient process \u03b2 k . The penalized complexity prior (\"Semi -PCP\") shrinks the process towards the constant function \u03b2 k = \u03b2 x to avoid overfitting; the second prior for the variance induces a Uniform(0,1) prior on the proportion of overall model variance explained by variation in \u03b2 k (\"Semi-R 2 \") to balance all levels of spatial confounding. The prior distributions for all models are given in Supplemental Section 8. We fit the semi-parametric models for all L \u2208 {1, 5, 10, 20, 30, 40} and select the number of basis functions using DIC (Spiegelhalter et al., 2002) . All methods are fit using MCMC with 25,000 iterations and the first 5,000 discarded as burn-in. Table 1 compares methods in terms of root mean squared error, bias, average (over datasets) posterior standard deviation and empirical coverage of 95% intervals for \u03b2 x and Figure 3 summarizes the sampling distribution of \u03b2 k across k for all methods and scenarios. The standard method performs well in the first scenario with no unmeasured confounder (\u03b2 xz = 0), but in all other scenarios the standard method is biased and has coverage at or near zero. The standard method allows for spatially-dependent residuals, but this does not eliminate spatial confounding bias. Since the standard model assumes X and Z are independent and X is included in the model, when X and Z are highly correlated all spatial variability is attributed to the treatment effect leading to bias and small posterior standard deviation.",
            "cite_spans": [
                {
                    "start": 836,
                    "end": 864,
                    "text": "(Spiegelhalter et al., 2002)",
                    "ref_id": "BIBREF34"
                }
            ],
            "ref_spans": [
                {
                    "start": 963,
                    "end": 970,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 1136,
                    "end": 1144,
                    "text": "Figure 3",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Discrete-space"
        },
        {
            "text": "The parametric model performs well in cases 1, 4 and 5 where there is no confounding at high frequencies. In fact, the parametric model is nearly identical to the standard model in the first case with no spatial confounding, suggesting that little is lost by allowing for a parametric confounding adjustment when it is not needed. However, the parametric model gives bias and low coverage in the cases with \u03c6 = 1 and thus the form of spatial confounding does not match the parametric CAR model. The estimated \u03b2 k curves in Figure 3 show that the parametric form of the \u03b2 k model cannot match the slow decline in the true correlation of Figure 2 when \u03c6 = 1.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 523,
                    "end": 531,
                    "text": "Figure 3",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 636,
                    "end": 644,
                    "text": "Figure 2",
                    "ref_id": null
                }
            ],
            "section": "Discrete-space"
        },
        {
            "text": "The semi-parametric methods have low bias and coverage near the nominal level for all five cases.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete-space"
        },
        {
            "text": "However, the posterior standard deviation is always larger for the semi-parametric models than the standard or parametric models. Therefore, in these cases, the semi-parametric method is robust but conservative for estimating a casual effect in the presence of spatial confounding. Surprisingly, the semi-parametric methods are insensitive to the choice of prior. Despite the PCP and R 2 prior having very different motivations, the results are similar under both priors, likely because DIC often selects a small number of a basis functions which negates the influence of the prior for \u03c3 2 b .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete-space"
        },
        {
            "text": "Data in the continuous space are generated similarly to the discrete case in (22). The data are simulated for n = 529 spatial locations on a square 23 \u00d7 23 grid covering the unit square as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Continuous-space"
        },
        {
            "text": "where \u03a3 j is the n \u00d7 n Mat\u00e9rn correlation matrix defined by parameters \u03c6 j and \u03bd j , and W is the kernel smoothing matrix with bandwidth \u03c6 as in (22). In all cases we take \u03c3 2 x = \u03c3 2 z = 1, spatial range parameters \u03c6 x = \u03c6 z = 0.1, \u03bd x = \u03bd z = 0.5, \u03b2 x = \u03b2 z = 1 and \u03c3 2 = 0.25 2 , and we vary \u03b2 xz \u2208 {0, 1, 2}, and the kernel bandwidth \u03c6 \u2208 {1/15, 2/15}. For each combination of these parameters we generate 100 datasets. For each Table 1 : Discrete-space simulation study results: The standard method with constant effect across frequency and the proposed spectral method are evaluated in terms of their estimate of \u03b2 x using root mean squared error (\"RMSE\"), bias (\"Bias\"), average posterior standard deviation (\"SD\") and coverage of 95% posterior intervals (\"Cov\") for data generated with dependence between exposure and confounder controlled by \u03b2 xz and kernel bandwidth \u03c6. Standard errors are in parentheses and all results are multiplied by 100. Table 2 : Continuous-space simulation study results: All methods are evaluated in terms of their estimate of \u03b2 x using root mean squared error (\"RMSE\"), bias (\"Bias\"), average posterior standard deviation (\"SD\") and coverage of 95% posterior intervals (\"Cov\") for data generated with dependence between exposure and confounder controlled by \u03b2 xz and kernel bandwidth \u03c6. All results are multiplied by 100. ",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 432,
                    "end": 439,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 953,
                    "end": 960,
                    "text": "Table 2",
                    "ref_id": "TABREF0"
                }
            ],
            "section": "Continuous-space"
        },
        {
            "text": "We illustrate the methods by reanalyzing two publicly-available spatial datasets. In Section 7.1, we analyze the well known lip cancer data from Scotland and we find different effects of the explanatory variable of interest, i.e. percentage of workforce in agriculture, fishing and forestry, for different spatial resolutions. In Section 7.2, we fit a model for COVID-19 mortality in the US and we find a consistent effect of air pollution exposure across resolutions. All model fits in this section were carried out using the eCAR package found in R which was created to fit the discrete space methods described in Sections 4 and 5.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Real data examples"
        },
        {
            "text": "We first consider the well known lip cancer data. These data are available in the CARBayesdata package in R and are displayed in Figure 4 . The data cover n = 56 districts in Scotland. The three variables recorded for district i are the number of recorded lip cancer cases, Y i , the expected number of lip cancer cases computed using indirect standardisation based on Scotland-wide disease rates, E i , and the percentage of the district's workforce employed in agriculture, fishing and forestry, X i .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 129,
                    "end": 137,
                    "text": "Figure 4",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Analysis of the Scottish lip cancer data"
        },
        {
            "text": "where \u03b8 i is the log relative risk in district i. As described in Section 5 we model the log relative risks \u03b8 = (\u03b8 1 , ..., \u03b8 n ) T as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "We fit the spatial Poisson regression model"
        },
        {
            "text": "where A is diagonal with k th diagonal element \u03b1(\u03c9 k ). Since the spatial domain is discrete, we fit the spectral models described in Section 4 and studied in Section 6.1. The parametric method is fit using the same priors as those detailed in the simulation study of Section 6.1 and by collecting 20,000 MCMC iterates after discarding the first 5,000 as burn-in. For the semi-parametric model we employ INLA (Rue et al., 2009 ) and use the PC prior with L = 10 basis functions, chosen via DIC; results are stable for L = {10, 20, 30, 40, 50}. We also fit two standard non-spectral methods where \u03b2 k is constant over \u03c9 k , a",
            "cite_spans": [
                {
                    "start": 409,
                    "end": 426,
                    "text": "(Rue et al., 2009",
                    "ref_id": "BIBREF30"
                }
            ],
            "ref_spans": [],
            "section": "We fit the spatial Poisson regression model"
        },
        {
            "text": "Poisson regression with percent of workforce in AFF as covariate (\"standard non-spatial\") and a Poisson regression that includes CAR random effects (\"standard spatial\"). 7.2 Analysis of COVID-19 mortality and PM 2.5 exposure Wu et al. (2020) noticed that many of the pre-existing conditions that increase the mortality risk of COVID-19 are connected with long-term exposure to air pollution. Thus, they conducted a study and found that an increase of 1 \u00b5g/m 3 in ambient fine particulate matter (PM 2.5 ) is associated with a 15% increase in the COVID-19 mortality rate. To further illustrate our proposed methods, we analyze the data collected by Wu et al. (2020) in an attempt to estimate the causal effect of PM 2.5 on COVID-19 mortality using spatial methods.",
            "cite_spans": [
                {
                    "start": 225,
                    "end": 241,
                    "text": "Wu et al. (2020)",
                    "ref_id": "BIBREF38"
                },
                {
                    "start": 648,
                    "end": 664,
                    "text": "Wu et al. (2020)",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [],
            "section": "We fit the spatial Poisson regression model"
        },
        {
            "text": "The response variable is the cumulative COVID-19 mortality counts through May 12, 2020 for US counties. County-level exposure to PM 2.5 was calculated by averaging results from an established exposure prediction model for years 2000-2016 (see Wu et al. 2020 for more details). Eight counties and twelve Figure 5 : Effect of percent of workforce in AFF on lip cancer in Scotland: Posterior mean (solid lines) and 95% credible interval (dashed lines) of the effect exp(\u03b2 k ) plotted against eigenvalue \u03c9 k for spectral parametric, spectral semi-parametric (with L = 10) and standard models; we consider two standard models, a Poisson regression on the percent of workforce in AFF (Standard non-spatial) and a Poisson regression with residuals modelled as CAR Leroux (Standard spatial). Virginia cities were missing from the database so we imputed their values using neighborhood means with neighbors defined by counties that share a boundary. This resulted in mortality counts and PM 2.5 measures for n = 3109 counties ( Figure 6 ). The long-term average PM 2.5 is the highest in the Eastern US and California, while the mortality response is the highest in the New York, Los Angeles and Seattle areas. The average PM 2.5 rate is a smoother spatial process than mortality, likely because the PM 2.5 exposure estimates are generated from predictive models. In addition to PM 2.5 exposure, 20 additional potential confounding variables (e.g., the percentage of the population at least 65 years old) are included in our modeling (see Wu et al. 2020 for the complete set of potential confounding covariates).",
            "cite_spans": [
                {
                    "start": 243,
                    "end": 257,
                    "text": "Wu et al. 2020",
                    "ref_id": "BIBREF38"
                },
                {
                    "start": 1529,
                    "end": 1543,
                    "text": "Wu et al. 2020",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [
                {
                    "start": 303,
                    "end": 311,
                    "text": "Figure 5",
                    "ref_id": "FIGREF6"
                },
                {
                    "start": 1019,
                    "end": 1027,
                    "text": "Figure 6",
                    "ref_id": "FIGREF8"
                }
            ],
            "section": "We fit the spatial Poisson regression model"
        },
        {
            "text": "For county i, denote Y i as the number of deaths attributed to COVID-19, E i as the population, X i as the average PM 2.5 and C i as the vector of 20 known confounding variables. Similar to Wu et al. (2020) , we",
            "cite_spans": [
                {
                    "start": 190,
                    "end": 206,
                    "text": "Wu et al. (2020)",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [],
            "section": "We fit the spatial Poisson regression model"
        },
        {
            "text": "where r i is the size parameter (i.e., the number of successful trials) and p i the probability of success in each trial. Under this model the",
            "cite_spans": [],
            "ref_spans": [],
            "section": "We fit the spatial Poisson regression model"
        },
        {
            "text": "We parameterize the model in terms of \u03bb i and the over-dispersion parameter r i . The over-dispersion parameters have priors log(r i ) \u223c N (0, 10) and the mean is linked to the linear predictor as log(\u03bb i ) = log(E i ) + \u03b8 i where \u03b8 i = \u03b2 x X i + Z i + C i \u03b2 c and the offset term E i is the county population and \u03b2 c is a vector of regression coefficients associated with the confounding variables. Log(deaths/population) Following Section 5, the linear predictor \u03b8 becomes",
            "cite_spans": [],
            "ref_spans": [],
            "section": "We fit the spatial Poisson regression model"
        },
        {
            "text": "where C is a design matrix that includes an intercept term. We fit this model using the parametric and semiparametric approaches detailed in Sections 4.2 and 4.3. We briefly comment that the Negative-Binomial modeling choice was motivated by our desire to mimic, as much as possible, the analysis found in Wu et al. (2020) . However, we also considered a Binomial and Poisson model and inferences were relatively unchanged.",
            "cite_spans": [
                {
                    "start": 306,
                    "end": 322,
                    "text": "Wu et al. (2020)",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [],
            "section": "We fit the spatial Poisson regression model"
        },
        {
            "text": "For the parametric model the prior distributions used in the simulation are employed. It took approximately 3 hours to collect 20,000 MCMC iterates after discarding the first 5,000 as burn-in. For the semiparametric model we adopt the PC prior method described in Section 6.1 and use INLA (Rue et al., 2009) to fit the model, which took approximately 5 minutes to run. We also fit a variant of the model employed in Wu et al. (2020) that we refer to as the \"standard model\", i.e., a Negative-Binomial regression with all control variables and a county random effects modeled using the CAR model. Following Wu et al. (2020) , two separate analysis using all n = 3109 counties and n = 1977 counties that reported at least 10 confirmed COVID-19 deaths were conducted; this was done to account for the fact that the size of an outbreak in a given county may be positively associated both to COVID-19 mortality rate and to PM2.5, thus introducing confounding bias. Figure 7a displays model fits using the full dataset while Figure 7b displays results when using the reduced data. The estimated increase in COVID-19 mortality rate, associated to an increase of 1\u00b5g/m 3 of PM 2.5 , under the standard model is 13% (95% CI: 1.05, 1.21) and 11% (95% CI: 1.03, 1.19) in the full and reduced analyses, respectively. The posterior mean estimates from the parametric and semi-parametric spectral models generally agree with the standard approach, but the posterior standard deviation is higher for the spectral methods. In this analysis, the spectral methods support the standard spatial model and serve as a check of sensitivity to adjustments for missing confounding variables.",
            "cite_spans": [
                {
                    "start": 289,
                    "end": 307,
                    "text": "(Rue et al., 2009)",
                    "ref_id": "BIBREF30"
                },
                {
                    "start": 416,
                    "end": 432,
                    "text": "Wu et al. (2020)",
                    "ref_id": "BIBREF38"
                },
                {
                    "start": 606,
                    "end": 622,
                    "text": "Wu et al. (2020)",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [
                {
                    "start": 1019,
                    "end": 1028,
                    "text": "Figure 7b",
                    "ref_id": null
                }
            ],
            "section": "We fit the spatial Poisson regression model"
        },
        {
            "text": "In this paper, we propose new spectral methods to adjust for unmeasured spatial confounding variables. We model the coherence of the treatment and unmeasured confounding variables as a function of the spatial Figure 7 : Results from the parametric and semi-parametric approaches applied to the COVID-19 death counts reported up through May 12, 2020: The posterior mean and 95% credible interval of the mortality rate ratio associated to an increase of 1\u00b5g/m 3 of PM 2.5 , exp(\u03b2 k ), are plotted against \u03c9 k for the semi-parametric fitted in INLA and the parametric model using MCMC. Column (a) are fits based on all n = 3109 counties and column (b) are fits based on the n = 1977 counties that reported at least 10 confirmed COVID-19 deaths. The fit from the standard approach refers to a regression model including all confounders and spatially structured random effects following a CAR model. We compare parametric and semi-parametric approaches throughout the paper, but we recommend gravitating towards the semi-parametric approach. The assumptions that permit estimating the causal effect differ for the parametric and semi-parametric approaches. The parametric/parsimonious model depends on scale-invariant coherence between the regression coefficient and the unmeasured confounder, while the semi-parametric model depends on the assumption that their coherence tends to zero for large frequencies.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 209,
                    "end": 217,
                    "text": "Figure 7",
                    "ref_id": null
                }
            ],
            "section": "Discussion"
        },
        {
            "text": "While neither of these assumptions are empirically verifiable, we believe the later assumption is easier to understand and justify in practice. In addition to this conceptual difference, the semi-parametric methods are easier to implement computationally. Because the semi-parametric confounding adjustment takes the form of a linear combination of constructed covariates, it is straightforward to pass these constructed variables into standard spatial computing packages at a trivial computational cost.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "A spectral adjustment for spatial confounding In the spatial domain, let X 0 (s) = Z(s) be the unmeasured confounder and X 1 (s), ..., X p (s) be the p observed covariates. Given the confounder, the model is Y (s) = \u03b2 0 + p j=0 \u03b2 j X j (s) + \u03b5(s). For frequency \u03c9, let X 0 (\u03c9) = Z(\u03c9) be the Fourier transform of the unmeasured confounder and X 1 (\u03c9), ..., X p (\u03c9) be the the Fourier transforms of the measured covariates. In the spectral domain the joint model in (2) is extended to Cov{X j (\u03c9), X k (\u03c9)} = \u2126 jk \u03c3 j \u03c3 k f jk (\u03c9) where \u2126 = {\u2126 jk } is a (p + 1) \u00d7 (p + 1) correlation matrix, \u03c3 j > 0 are standard deviation parameters and f jk (\u03c9) = f kj (\u03c9) are spectral densities. The multivaritate extension of the parsimonious model in Section 2.1 sets f jk (\u03c9) = f j (\u03c9)f k (\u03c9). This is clearly a valid model because the (p + 1) \u00d7 (p + 1) covariance of X 0 (\u03c9), ...,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Blocking \u2126 to have first row column (1, \u2126 T zx ) and bottom right p \u00d7 p matrix \u2126 x and marginalizing over X 0 (\u03c9) = Z(\u03c9) gives",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "q j X j (\u03c9), (q 1 , ..., q p ) = \u2126 T zx \u2126 \u22121 x and q 0 = \u2126 zz \u2212 \u2126 T zx \u2126 \u22121",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "x \u2126 zx . In the spatial domain this the causal adjustment for covariate j becomes\u1e90 j = w j C 0j C \u22121 jj X j where C jk = Cov(X j , X k ) is defined by the Mat\u00e9rn covariance parameters. The spatial model is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "where V is a mean-zero Gaussian process with variance \u03c3 2 z q o and Mat\u00e9rn correlation with smoothness \u03b7 z and range \u03c6 and \u03b5(s) iid \u223c Normal(0, \u03c3 2 ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Extending the semi-parametric model in Section 3.2 to have multiple covariates is straightforward because the method is defined via the conditional distribution of the missing confounder given the covariates, rather than the joint distribution of the confounder and the covariates. We regress the confounder onto the p covariates using the additive model",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric continuous-space model"
        },
        {
            "text": "In this spatial domain this gives",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric continuous-space model"
        },
        {
            "text": "where \u03b4(s) is modeled as a Gaussian process and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric continuous-space model"
        },
        {
            "text": "As in the univariate case, \u03b2 j can be interpreted as the causal effect under the assumption that \u03b1 j (\u03c9) \u2192 0.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric continuous-space model"
        },
        {
            "text": "In the discrete domain with multiple predictors, the oracle model is Y \u223c Normal(\u03b2 0 1 + p j=1 \u03b2 j X j + Z, \u03c3 2 I n ). Assuming marginal distribution X j \u223c CAR(0, \u03c3 2 j , \u03bb j ) and Z \u223c CAR(0, \u03c3 2 z , \u03bb z ), parsimonious joint distributions in Section 4.2 and following the ideas above in the extension of the parsimonious Mat\u00e9rn to the case of multiple predictors, the marginal distribution of Y over Z is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Parsimonious CAR model"
        },
        {
            "text": "where A j is diagonal with k th diagonal element \u03b1 j (\u03c9 k ) = w j \u03c3z \u03c3 j 1\u2212\u03bb j +\u03bb j \u03c9 k 1\u2212\u03bbz+\u03bbz\u03c9 k and V \u223c CAR(0, q 0 \u03c3 2 z , \u03bb z ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Parsimonious CAR model"
        },
        {
            "text": "Extending the semi-parametric model in Section 4.3 to the multivariate case follows the same steps as the semi-parametric model for continuous space above. In the spectral domain with Z * = \u0393Z and X * j = \u0393X j , a natural extension to the semi-parametric CAR model for the missing confounder is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "Defining \u03b2 j (\u03c9) = \u03b2 j + \u03b1 j (\u03c9) = L l=1 B l (\u03c9)b jl , gives the spatial model",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "where V \u223c CAR(0, \u03c3 2 z , \u03bb z ). Under the assumption that \u03b1 j (\u03c9 n ) = 0, we summarize the causal effect of the j th covariate using the posterior of \u03b2 j = L l=1 B l (\u03c9 n )b jl .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "2 Spatial Causal framework",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "Extending the notation in Section 2 of the main document and following the potential outcomes framework, we define Y i (x i ) to be the potential outcome at location s i if the treatment at s i is x i . Similarly, define Y(x) = {Y 1 (x 1 ), . . . , Y n (x n )} T as the vector of potential outcomes at S if treatment x = (x 1 , ..., x n ) T were received. For the potential outcomes to be well defined, we make the stable-unit-treatment-value assumption (SUTVA, Rubin (1980) ), which states that there is no interference between units and there is a single version of each treatment level. In the spatial context, the no interference assumption implies that treatment applied at one location does not affect the outcome at other locations.",
            "cite_spans": [
                {
                    "start": 454,
                    "end": 474,
                    "text": "(SUTVA, Rubin (1980)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "Following the commonly used spatial regression model in the spatial statistics literature, we assume a linear additive structural model for the potential outcomes,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "where \u03b5 = (\u03b5 1 , ..., \u03b5 n ) T and \u03b5 i iid \u223c Normal(0, \u03c3 2 ). The structural coefficient \u03b2 x determines the causal relationship of the potential outcome and the treatment, and it is assumed to be spatially invariant. In this model, we do not specify the interaction of treatment and covariates, and therefore \u03b2 x is both the marginal and conditional causal effect of treatment. Our objective is to estimate \u03b2 x .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "To connect the observed and potential outcomes, we also make the consistency assumption that the observed outcomes are exactly the potential outcomes for the observed level of treatment",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "For the identifiability of \u03b2 x , we also make the conditional treatment ignorability assumption that X\u22a5Y(x) | Z for all x. The latter assumption holds if all factors that are associated with both the treatment and outcome variables are accounted for in Z. With these assumptions, the parameter \u03b2 x in the regression model",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "has a causal interpretation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "If we observe the confounder Z, then identification and estimation of \u03b2 x is straightforward using multiple linear regression. However, we assume that Z is an unmeasured confounder. In the presence of an unmeasured confounder, \u03b2 x is not identifiable in general. Therefore, we propose to exploit the spatial structure of Z to mitigate the effects of this unknown confounder. Although Z confounds the causal relationship of X and Y in the spatial domain, in Section 2.1 we propose assumptions in the spectral domain that identify the causal effect in the presence of an unmeasured spatial confounder.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-parametric CAR model"
        },
        {
            "text": "The joint model",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "The parameters \u03b8 are identified if and only if \u00b5 y (\u03c9; \u03b8 (1) ) = \u00b5 y (\u03c9; \u03b8 (2) ), \u03c4 2 y (\u03c9; \u03b8 (1) ) = \u03c4 2 y (\u03c9; \u03b8 (1) ) and \u03c4 2 x (\u03c9; \u03b8 (1) ) = \u03c4 2 x (\u03c9; \u03b8 (1) ) for all \u03c9 implies that \u03b8 (1) = \u03b8 (2) . First assume that \u03c4 2",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "x (\u03c9; \u03b8 (1) ) = \u03c4 2 x (\u03c9; \u03b8 (2) ) for all \u03c9. Since \u03c4 2 x (\u03c9; \u03b8)d\u03c9 = \u03c3 2 x , we must have \u03c3",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "(1)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "x .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "This clearly implies that F",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "(1) x = F",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "(2)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "x , and thus the parameters in the marginal distribution of X are identified. Applying similar arguments to the \u03c4 2 y (\u03c9; \u03b8) shows that \u03c4 2 y (\u03c9; \u03b8 (1) ) = \u03c4 2 y (\u03c9; \u03b8 (2) ) for all \u03c9 implies that F",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "(1)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "The remaining parameters are identified by \u00b5 y (\u03c9; \u03b8). If we assume \u00b5 y (\u03c9; \u03b8 (1) ) = \u00b5 y (\u03c9; \u03b8 (2) ) for all \u03c9 and apply previous identifiability results that show F (1)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification under the parsimonious model"
        },
        {
            "text": "We derive the oracle confounder adjustment for a given projection operator \u03b1(\u03c9). If the inverse Fourier transform of \u03b1(\u03c9) has a closed-form denoted by K(s \u2212 s ), then",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Oracle confounder adjustment"
        },
        {
            "text": "exp(i\u03c9 T (s \u2212 s ))\u03b1(\u03c9)d\u03c9 X(s )ds = 1 (2\u03c0) d R 2 K(s \u2212 s )X(s )ds .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Oracle confounder adjustment"
        },
        {
            "text": "The parameters that define the marginal distribution of X, \u03c3 x , \u03bd x and \u03c6, are identified following the arguments in Supplemental Section 3. Therefore, we assume they are fixed and known in this section. For the bivariate Mat\u00e9rn model, define E{Y(\u03c9)|X (\u03c9)} = \u00b5(\u03c9; \u03b8) and V{Y(\u03c9)|X (\u03c9)} = \u03c4 2 (\u03c9; \u03b8), where \u03b8 = {\u03b2 x , \u03c1, \u03bd z , \u03bd xz , \u03c3 z } are the remaining unknown parameters. Defining \u03b4 = (1 + \u03c6 2 ||\u03c9|| 2 ) \u22121 , the mean and variance are \u00b5(\u03c9; \u03b8) = \u03b2 x + \u03c1 \u03c3 z \u03bd xz \u03c3 x \u03bd x \u03b4 \u03bdxz\u2212\u03bdx X (\u03c9) \u03c4 2 (\u03c9; \u03b8) = \u03c3 2 z \u03bd z \u03c6 2 \u03b4 \u03bdz+1 1 \u2212 \u03c1 2 \u03bd 2 xz \u03bd x \u03bd z \u03b4 2\u03bdxz\u2212\u03bdx\u2212\u03bdz . For the Gaussian responses in the simulation study, the variances in the standard and parametric models are parameterized as \u03c3 2 z = \u03c4 2 r and \u03c3 2 = \u03c4 2 (1 \u2212 r) and the priors are \u03b2 0 , \u03b2 x \u223c Normal(0, 100), \u03c4 2 \u223c InvGamma(0.1, 0.1) and r, \u03bb z \u223c Uniform(0, 1). For the parsimonious bivariate CAR model we fix \u03c3 x = 1 and select priors \u03bb x \u223c Uniform(0, \u03bb z ) and \u03c1 \u223c Uniform(\u22121, 1).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Parameter identification for the bivariate Mat\u00e9rn model"
        },
        {
            "text": "In the parsimonious bivariate CAR model we used the following priors for the variance components \u03c3 2 \u223c Gamma(1, 1), \u03c3 2",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Parameter identification for the bivariate Mat\u00e9rn model"
        },
        {
            "text": "x \u223c InvGamma(1, 1), and \u03c4 = \u03c3 2 z (1 \u2212 \u03c1 2 ) \u223c Gamma(1, 1) where both the Gamma and Inverse Gamma distributions are parameterized using shape and rate. For spatial dependence parameters we used \u03bb z \u223c Uniform(0, 1) and \u03bb x \u223c Uniform(0, \u03bb z ) (although we also ran simulation with \u03bb x \u223c Uniform(0, 1) and results where similar). Finally for the regression type parameters we use \u03b2 x \u223c N (0, 100) and \u03c8 = \u03c1 \u03c3z \u03c3x \u223c N (0, 100). To improve mixing (\u03b2, \u03c8) were updated in a blocked Gibbs step. Apart from \u03c3 2",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Parameter identification for the bivariate Mat\u00e9rn model"
        },
        {
            "text": "x , all other parameters were updated with a random walk Metropolis step using a Gaussian distribution to generate candidate values.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Parameter identification for the bivariate Mat\u00e9rn model"
        },
        {
            "text": "For the semi-parametric models with L > 1 we use the CAR prior for b given in Section 3.2 with either a penalized complexity prior (PCP; Simpson et al., 2017) or R 2 prior (Zhang et al., 2020) for \u03c3 2 b , as described below. The semi-parametric CAR model in Section 4.3 is Y|V \u223c Normal(\u03b2 0 + \u03b2 x X +Zb + V, \u03c3 2 I n ).",
            "cite_spans": [
                {
                    "start": 137,
                    "end": 158,
                    "text": "Simpson et al., 2017)",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 172,
                    "end": 192,
                    "text": "(Zhang et al., 2020)",
                    "ref_id": "BIBREF39"
                }
            ],
            "ref_spans": [],
            "section": "Parameter identification for the bivariate Mat\u00e9rn model"
        },
        {
            "text": "To set priors, we parameterize the covariance parameters as \u03c3 2 z = \u03c4 2 c(\u03bb z )r and \u03c3 2 = \u03c4 2 (1 \u2212 r) for c(\u03bb z ) = n/ n k=1 f z (\u03c9 k ) and r \u2208 (0, 1). Under this parameterization, the total (over space) error variance is Trace{Cov(V) + \u03c3 2 I n } = \u03c4 2 nr + \u03c4 2 n(1 \u2212 r) = \u03c4 2 n, and thus \u03c4 2 controls the overall variance and r is the proportion of variance attributed to the spatial component of the error. Also, assume the prior for the adjustment coefficients b is normal with mean zero and precision \u03c3 \u22122 b \u2126, where \u2126 has diagonal elements N l and (j, l) off-diagonal element \u2212I(|j \u2212 l| = 1). The first is the penalized complexity prior (PCP; Simpson et al., 2017) on the standard deviation \u03c3 b , i.e. \u03c3 b \u223c Exponential(\u03be) with scale parameter \u03be = \u2212 log(0.01)0.31/U , with U = 0.5; this choice sets the marginal standard deviation for b approximately equal to 0.5, following the rule of thumb proposed by Simpson et al. (2017) . The PCP shrinks the model to the simpler base model without a confounder adjustment. The second is based on the R2D2 prior of Zhang et al. (2020) . The variance is written \u03c3 2 b = \u03c4 2 \u03c3 2 R where the prior density for \u03c3 2 whereR x is the correlation matrix for X computed from the Mat\u00e9rn correlation function with plug-in values of\u03c6 x ,\u03bd x , and R zx is the cross-correlation matrix between Z and X determined by parameters \u03bd xz and the common range \u03c6 =\u03c6 x . To reduce computation cost\u03a3 \u22121 x X can be pre-computed to avoid repetitive evaluation of matrix inversion inside the MCMC algorithm. We specify a joint prior for the spatial parameters \u03c1, \u03bd z and \u03bd xz , with \u03c0(\u03c1, \u03bd z , \u03bd xz ) = \u03c0 1 (\u03c1|\u03bd z , \u03bd xz )\u03c0 2 (\u03bd z |\u03bd xz )\u03c0 3 (\u03bd xz ) where \u03c0 1 \u223c Unif(-\u221a \u03bd x \u03bd z /\u03bd xz , \u221a \u03bd x \u03bd z /\u03bd xz ), \u03c0 2 \u223c Unif(0,2\u03bd xz \u2212 \u03bd x ) and \u03c0 3 is a half Cauchy distribution with mean \u03bd x and variance 1000. This specification will ensure that all parameter constrains are met. To complete specification of the hierarchical model, we use an exponential distribution with rate parameter 1 for the sum of variances \u03c3 2 z + \u03c3 2 , a uniform prior for the signal to noise ratio \u03c3 2 z \u03c3 2 z +\u03c3 2 , and a normal prior with mean 0 and variance 100 for the causal effect \u03b2 x . The model is fit using Metropolis-Hastings within Gibbs algorithm with a block update for the spatial parameters.",
            "cite_spans": [
                {
                    "start": 649,
                    "end": 670,
                    "text": "Simpson et al., 2017)",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 911,
                    "end": 932,
                    "text": "Simpson et al. (2017)",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 1061,
                    "end": 1080,
                    "text": "Zhang et al. (2020)",
                    "ref_id": "BIBREF39"
                }
            ],
            "ref_spans": [],
            "section": "Parameter identification for the bivariate Mat\u00e9rn model"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "A valid Mat\u00e9rn class of cross-covariance functions for multivariate random fields with any number of components",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "V"
                    ],
                    "last": "Apanasovich",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "G"
                    ],
                    "last": "Genton",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Sun",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Journal of the American Statistical Association",
            "volume": "107",
            "issn": "",
            "pages": "180--193",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Alleviating spatial confounding in spatial frailty models",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "R M"
                    ],
                    "last": "Azevedo",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "O"
                    ],
                    "last": "Prates",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Bandyopadhyay",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2008.06911"
                ]
            }
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Spectral mixture kernels with time and phase delay dependencies",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Groot",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [],
                    "last": "Marchiori",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1808.00560"
                ]
            }
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Spatial+: a novel approach to spatial confounding",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Dupont",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "N"
                    ],
                    "last": "Wood",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Augustin",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2009.09420"
                ]
            }
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "A new frequency domain measure of causality based on partial spectral decomposition of autoregressive processes and its application to cardiovascular interactions*",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Faes",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Krohova",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Pernice",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Busacca",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Javorka",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "41st Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC)",
            "volume": "",
            "issn": "",
            "pages": "4258--4261",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Spectral domain. Handbook of Spatial Statistics",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Fuentes",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Reich",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "57--77",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Handbook of Spatial Statistics",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "E"
                    ],
                    "last": "Gelfand",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Diggle",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Guttorp",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Fuentes",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Mat\u00e9rn cross-covariance functions for multivariate random fields",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Gneiting",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [],
                    "last": "Kleiber",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Schlather",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Journal of the American Statistical Association",
            "volume": "105",
            "issn": "",
            "pages": "1167--1177",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "GpGp: Fast Gaussian process computation Using Vecchia's approximation",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Guinness",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Katzfuss",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Restricted spatial regression in practice: geostatistical models, confounding, and robustness under model misspecification",
            "authors": [
                {
                    "first": "E",
                    "middle": [
                        "M"
                    ],
                    "last": "Hanks",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "M"
                    ],
                    "last": "Schliep",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "B"
                    ],
                    "last": "Hooten",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Hoeting",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Environmetrics",
            "volume": "26",
            "issn": "",
            "pages": "243--254",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "The bayesian group lasso for confounded spatial data",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "J"
                    ],
                    "last": "Hefley",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "B"
                    ],
                    "last": "Hooten",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "M"
                    ],
                    "last": "Hanks",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "E"
                    ],
                    "last": "Russell",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "P"
                    ],
                    "last": "Walsh",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Journal of Agricultural, Biological, and Environmental Statistics",
            "volume": "22",
            "issn": "",
            "pages": "42--59",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Adding spatially-correlated errors can mess up the fixed effect you love",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "S"
                    ],
                    "last": "Hodges",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "J"
                    ],
                    "last": "Reich",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "The American Statistician",
            "volume": "64",
            "issn": "",
            "pages": "325--334",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Dimension reduction and alleviation of confounding for spatial generalized linear mixed models",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Hughes",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Haran",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Journal of the Royal Statistical Society: Series B (Statistical Methodology)",
            "volume": "75",
            "issn": "",
            "pages": "139--159",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Scalable levy process priors for spectral kernel learning",
            "authors": [
                {
                    "first": "P",
                    "middle": [
                        "A"
                    ],
                    "last": "Jang",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Loeb",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Davidow",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "G"
                    ],
                    "last": "Wilson",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Advances in Neural Information Processing Systems",
            "volume": "",
            "issn": "",
            "pages": "3940--3949",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Selecting a scale for spatial confounding adjustment",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "P"
                    ],
                    "last": "Keller",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "A"
                    ],
                    "last": "Szpiro",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Journal of the Royal Statistical Society: Series A (Statistics in Society",
            "volume": "183",
            "issn": "",
            "pages": "1121--1143",
            "other_ids": {
                "DOI": [
                    "10.1111/rssa.12556"
                ]
            }
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Restricted spatial regression methods: Implicatios for inference",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Khan",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "A"
                    ],
                    "last": "Calder",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "The Journal of the American Statistical Association",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1080/01621459.2020.1788949"
                ]
            }
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Coherence for multivariate random fields",
            "authors": [
                {
                    "first": "W",
                    "middle": [],
                    "last": "Kleiber",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Statistica Sinica",
            "volume": "",
            "issn": "",
            "pages": "1675--1697",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Estimation of disease rates in small areas: A new mixed model for spatial dependence",
            "authors": [
                {
                    "first": "B",
                    "middle": [
                        "G"
                    ],
                    "last": "Leroux",
                    "suffix": ""
                },
                {
                    "first": "X",
                    "middle": [],
                    "last": "Lei",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Breslow",
                    "suffix": ""
                }
            ],
            "year": 2000,
            "venue": "Statistical Models in Epidemiology, the Environment, and Clinical Trials",
            "volume": "",
            "issn": "",
            "pages": "179--191",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "On the effects of spatial confounding in hierarchical models",
            "authors": [
                {
                    "first": "W",
                    "middle": [
                        "S"
                    ],
                    "last": "Nobre",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "M"
                    ],
                    "last": "Schmidt",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "B"
                    ],
                    "last": "Pereira",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "International Statistical Review",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1111/insr.12407"
                ]
            }
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Inferring heterogeneous causal effects in presence of spatial confounding",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Osama",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Zachariah",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [
                        "B"
                    ],
                    "last": "Sch\u00f6n",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Proceedings of the 36th International Conference on Machine Learning",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "Proceedings of Machine Learning Research",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Chaudhuri",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Salakhutdinov",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "97",
            "issn": "",
            "pages": "4942--4950",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "The importance of scale for spatial-confounding bias and precision of spatial regression estimators",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "J"
                    ],
                    "last": "Paciorek",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Statistical Science",
            "volume": "25",
            "issn": "",
            "pages": "107--125",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Estimation and prediction in the presence of spatial confounding for spatial linear models",
            "authors": [
                {
                    "first": "G",
                    "middle": [
                        "L"
                    ],
                    "last": "Page",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "He",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Sun",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Scandinavian Journal of Statistics",
            "volume": "44",
            "issn": "",
            "pages": "780--797",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Spatial confounding in hurdle multilevel beta models: the case of the brazilian mathematical olympics for public schools",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "B"
                    ],
                    "last": "Pereira",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "S"
                    ],
                    "last": "Nobre",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Silva",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "M"
                    ],
                    "last": "Schmidt",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Journal of the Royal Statistical Society: Series A (Statistics in Society",
            "volume": "183",
            "issn": "",
            "pages": "1051--1073",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Alleviating spatial confounding for areal data problems by displacing the geographical centroids",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "O"
                    ],
                    "last": "Prates",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "M"
                    ],
                    "last": "Assun\u00e7\u00e3o",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "C"
                    ],
                    "last": "Rodrigues",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Bayesian Anal",
            "volume": "14",
            "issn": "",
            "pages": "623--647",
            "other_ids": {
                "DOI": [
                    "10.1214/18-BA1123"
                ]
            }
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "Semiparametric estimation of cross-covariance functions for multivariate random fields",
            "authors": [
                {
                    "first": "G",
                    "middle": [
                        "A"
                    ],
                    "last": "Qadir",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Sun",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Biometrics",
            "volume": "",
            "issn": "",
            "pages": "1--14",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "A spectral method for spatial downscaling",
            "authors": [
                {
                    "first": "B",
                    "middle": [
                        "J"
                    ],
                    "last": "Reich",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "H"
                    ],
                    "last": "Chang",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [
                        "M"
                    ],
                    "last": "Foley",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Biometrics",
            "volume": "70",
            "issn": "",
            "pages": "932--942",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "Nonparametric bayesian models for a spatial covariance",
            "authors": [
                {
                    "first": "B",
                    "middle": [
                        "J"
                    ],
                    "last": "Reich",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Fuentes",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Statistical methodology",
            "volume": "9",
            "issn": "",
            "pages": "265--274",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Effects of residual smoothing on the posterior of the fixed effects in disease-mapping models",
            "authors": [
                {
                    "first": "B",
                    "middle": [
                        "J"
                    ],
                    "last": "Reich",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "S"
                    ],
                    "last": "Hodges",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Zadnik",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Biometrics",
            "volume": "62",
            "issn": "",
            "pages": "1197--1206",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "A review of spatial causal inference methods for environmental and epidemiological applications",
            "authors": [
                {
                    "first": "B",
                    "middle": [
                        "J"
                    ],
                    "last": "Reich",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Yang",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Guan",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "B"
                    ],
                    "last": "Giffin",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "J"
                    ],
                    "last": "Miller",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "G"
                    ],
                    "last": "Rappold",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2007.02714"
                ]
            }
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Rue",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Martino",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Chopin",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Journal of the Royal Statistical Society: Series b (Statistical Methodology)",
            "volume": "71",
            "issn": "",
            "pages": "319--392",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "Discrete signal processing on graphs: Graph fourier transform",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Sandryhaila",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "M F"
                    ],
                    "last": "Moura",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "2013 IEEE International Conference on Acoustics, Speech and Signal Processing",
            "volume": "",
            "issn": "",
            "pages": "6167--6170",
            "other_ids": {}
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "Mitigating unobserved spatial confounding when estimating the effect of supermarket access on cardiovascular disease deaths",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Schnell",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Papadogeorgou",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1907.12150"
                ]
            }
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "Penalising model component complexity: A principled, practical approach to constructing priors",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Simpson",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Rue",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Riebler",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [
                        "G"
                    ],
                    "last": "Martins",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "H"
                    ],
                    "last": "S\u00f8rbye",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Statistical Science",
            "volume": "32",
            "issn": "",
            "pages": "1--28",
            "other_ids": {
                "DOI": [
                    "10.1214/16-STS576"
                ]
            }
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "Bayesian measures of model complexity and fit",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "J"
                    ],
                    "last": "Spiegelhalter",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "G"
                    ],
                    "last": "Best",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "P"
                    ],
                    "last": "Carlin",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Van Der Linde",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "Journal of the Royal Statistical Society: Series B (Statistical Methodology)",
            "volume": "64",
            "issn": "",
            "pages": "583--639",
            "other_ids": {}
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "A study of problems encountered in Granger causality analysis from a neuroscience perspective",
            "authors": [
                {
                    "first": "P",
                    "middle": [
                        "A"
                    ],
                    "last": "Stokes",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [
                        "L"
                    ],
                    "last": "Purdon",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Proceedings of the National Academy of Sciences",
            "volume": "114",
            "issn": "",
            "pages": "7063--7072",
            "other_ids": {}
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "Structural equation models for dealing with spatial confounding",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Thaden",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Kneib",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "The American Statistician",
            "volume": "72",
            "issn": "",
            "pages": "239--252",
            "other_ids": {}
        },
        "BIBREF37": {
            "ref_id": "b37",
            "title": "A treatise on the theory of Bessel functions",
            "authors": [
                {
                    "first": "G",
                    "middle": [
                        "N"
                    ],
                    "last": "Watson",
                    "suffix": ""
                }
            ],
            "year": 1995,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF38": {
            "ref_id": "b38",
            "title": "Air pollution and covid-19 mortality in the united states: Strengths and limitations of an ecological regression analysis",
            "authors": [
                {
                    "first": "X",
                    "middle": [],
                    "last": "Wu",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "C"
                    ],
                    "last": "Nethery",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "M"
                    ],
                    "last": "Sabath",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Braun",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Dominici",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Science Advances",
            "volume": "6",
            "issn": "",
            "pages": "1--6",
            "other_ids": {}
        },
        "BIBREF39": {
            "ref_id": "b39",
            "title": "Bayesian regression using a prior on the model fit: The r2-d2 shrinkage prior",
            "authors": [
                {
                    "first": "Y",
                    "middle": [
                        "D"
                    ],
                    "last": "Zhang",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "P"
                    ],
                    "last": "Naughton",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "D"
                    ],
                    "last": "Bondell",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "J"
                    ],
                    "last": "Reich",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Journal of the American Statistical Association",
            "volume": "",
            "issn": "",
            "pages": "1--37",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Example confounder adjustment for the bivariate Mat\u00e9rn:",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "illustrates the confounder adjustment\u1e90 in (6) for the bivariate Mat\u00e9rn model with a common range and different smoothness \u03bd zx = c\u03bd x for increasing values of c. Increasing c implies increasing decay rates of \u03b1(\u03c9). The original simulated X is plotted in the left panel of",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Performance in the spectral domain for the discrete simulation study: Median (solid) and 95% confidence interval (dashed) for the sampling distribution of \u03b2 k by eigenvalue d k for the standard (red), semi-parametric model with PC prior (green) and parametric bivariate CAR model (blue) for data generated with dependence between exposure and confounder controlled by \u03b2 xz and kernel bandwidth \u03c6. The black lines are the true value \u03b2 x",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "we fit four models: The standard Mat\u00e9rn model (\"Standard\") in Section 3.1 with \u03c1 = 0 and thus no confounding adjustment, the bivariate Mat\u00e9rn model (\"Flexible Mat\u00e9rn\") with common range in(7), the parsimonious Mat\u00e9rn model (\"Parsimonious Mat\u00e9rn\") in (8) and the Gaussian mixture model (\"Semiparametric\") in Section 3.2. Prior distributions and computing details are given the Supplementary Sections 8 and 9, respectively.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Lip cancer data: Maps of Scotland district standard mortality ratio and percent of work force in agriculture, fishing, and forestry (AFF).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "plots the posterior of exp(\u03b2 k ) by the eigenvalue \u03c9 k for each model. For the standard methods the posterior mean is positive and the 95% interval excludes 1 indicating significant increase in risk for lip cancer for a unit increase in percent AFF. The spectral methods, which attempt to account for spatial confounding, do not agree with the standard methods: the estimated exp(\u03b2 k ) trends toward 1 for large \u03c9 k meaning that the results of the standard models should be interpreted with caution because the strength of the relationship between these variables is weak at the local (high-resolution) scale. These results are consistent with a missing confounding variable with the same large-scale spatial pattern as lip cancer disease and percentage of workforce in AFF.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "PM 2.5 exposure and COVID-19 mortality by US county:",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "introduce sufficient conditions that ensure the causal effect is identifiable. These ideas are developed for continuous and discrete spatial domains, parametric and semi-parametric frameworks, and Gaussian and non-Gaussian data. Simulation studies confirm that the proposed methods lower bias and provide valid inference if the model assumptions approximately hold, and two applications illustrate the use of the methods in practice.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF10": {
            "text": "Simulated data in discrete space: Realizations from the discrete-space simulation's datagenerating process for different kernel bandwidth (\u03c6) and strength of exposure/confounder dependence (\u03b2 xz ).",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "compares methods using the same metrics as in Section 6.1. The results mirror those in the discrete case. The semi-parametric method maintains nearly the nominal coverage and low bias across all scenarios. The parametric Mat\u00e9rn models have bias and low coverage for the simulation settings where the data are not simulated with a Mat\u00e9rn covariance. The flexible Mat\u00e9rn dramatically reduces RMSE and improves coverage compared to the parsimonious model, but neither is sufficiently flexible for these cases.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "This work was partially supported by the National Institutes of Health (R01ES031651-01, R01ES027892-01) and King Abdullah University of Science and Technology (3800.2).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Acknowledgments"
        },
        {
            "text": "Denote \u03b8 (j) = {\u03b2 (j) x , \u03c1 (j) , \u03bd (j) z , \u03bd (j) xz , \u03c3 (j) z }. The parameters \u03b8 are identified if and only if \u00b5(\u03c9; \u03b8 (1) ) = \u00b5(\u03c9; \u03b8 (2) ) and \u03c4 2 (\u03c9; \u03b8 (1) ) = \u03c4 2 (\u03c9; \u03b8 (1) ) for all \u03c9 implies that \u03b8 (1) = \u03b8 (2) . Now assume that \u00b5(\u03c9; \u03b8 (1) ) = \u00b5(\u03c9; \u03b8 (2) ) and \u03c4 2 (\u03c9; \u03b8 (1) ) = \u03c4 2 (\u03c9; \u03b8 (2) ) for all \u03c9. By assumption, \u03bd xz \u2212 \u03bd x > 0, 2\u03bd xz \u2212 \u03bd x \u2212 \u03bd z > 0 and \u03c1 2 \u03bd 2 xz \u03bdx\u03bdz < 1. Therefore, \u00b5(\u03c9; \u03b8)/X (\u03c9) \u2192 \u03b2 x , and therefore \u03b2 (1)Turning to the variance terms, for large \u03c9 we have \u03c4 2 (\u03c9; \u03b8) \u2248 \u03c3 2 z \u03bd z \u03c6 2 \u03b4 \u03bdz+1 . Therefore \u03bdz , and thus and \u03c3(1)Z from above we have \u03c1 (1) = \u03c1 (2) , and thus \u03b8 1 = \u03b8 2 .",
            "cite_spans": [
                {
                    "start": 18,
                    "end": 21,
                    "text": "(j)",
                    "ref_id": null
                },
                {
                    "start": 36,
                    "end": 39,
                    "text": "(j)",
                    "ref_id": null
                },
                {
                    "start": 46,
                    "end": 49,
                    "text": "(j)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "annex"
        },
        {
            "text": "We aim to establish the that parameters \u03b8 = (\u03b2 x , \u03c3 2 , \u03c1, \u03bb x , \u03bb z , \u03c3 2x , \u03c3 2 z ) found in the joint model for (Y * , X * ) that is partially described in (17) are identifiable. Here we will denote the joint model using p(Y * , X * |\u03b8).As before, to establish identifiability we need to show that p(Y * , X * |\u03b8 (1) ) = p(Y * , X * |\u03b8 (2) ) \u21d4 \u03b8 (1) = \u03b8 (2) .Note that we can express the joint model after setting \u03b2 0 = 0 w.l.o.g. in the following wayHere N n (\u00b7; , m, V ) denotes a n dimensional multivariate density function with mean m and covariance matrix V , and, as before, A is a diagonal matrix whose ith diagonal entry is 1\u2212\u03bbx+\u03bbx\u03c9 i 1\u2212\u03bbz+\u03bbz\u03c9 i . Note that we can establish identifiability by way of the mean structure, covariance structure, or both from the joint model.Since p(X * |\u03b8) is simply a Leroux model and its parameters are known to be identifiable we have that \u03c3 2 x and \u03bb x are both identifiable. Thus, we focus on (\u03b2 x , \u03c3 2 , \u03c1, \u03bb z , \u03c3 2 z ). It is straightforward to see thatwhich implies that \u03c3 2 identifiable.Next since matrix inverse is a bijection we can work with \u03c3 \u22122z . Thus, \u03c4 and \u03bb z are identifiable. In summary, to this point, we have shown that \u03bb x , \u03bb z , \u03c3 2 x , \u03c3 2 and \u03c4 are all identifiable. We now show that \u03b2 x and \u03b7 = \u03c1\u03c3 z are identifiable. Note thatThus, we can focus on \u03b2 x I + \u03b7 \u03c3x A such thatx ) = 0 and (\u03b7 (1) \u2212 \u03b7 (2) ) = 0, establishing the identifiability of \u03b2 x and \u03b7 = \u03c1\u03c3 z . Now since \u03c4 = \u03c3 \u22122 z (1 \u2212 \u03c1 2 ) \u22121 and \u03b7 = \u03c1\u03c3 z , are identifiable, then so to are \u03c1 and \u03c3 2 z where \u03c1 = \u03b7 2 \u03c4 \u22121 +\u03b7 2 and \u03c3 2 z = \u03c4 \u22121 + \u03b7 2 .7 Sample datasets for the simulation study Figure 1 plots a dataset from each simulated scenario in Section 6.1 to illustrate the spatial dependence of each variable and the relationships between variables. R is f (\u03c3 2 R ) \u221d (\u03c3 2 R + 1) \u22122 , which induces a Uniform(0,1) prior on the proportion of variance explained by the confounding adjustment, Trace{Cov(Zb)}/Trace{Cov(Zb) + Cov(V) + \u03c3 2 I} = \u03c3 2 R /(\u03c3 2 R + 1), and in this sense balanced the prior evenly over negligible to complete confounding adjustment. The priors for the remaining parameters are the same for the standard model.Finally, when fitting the semi-parametric CAR model to the lip cancer and covid data in Section 7.1 and 7.2 we exploit the default implementation available in INLA which runs very fast; this is based on the original parameterization of the semi-parametric, i.e. \u03b8|X \u223c CAR \u03b2 0 1 + L l=1\u1e90 l b l , \u03c3 2 z , \u03bb z . Priors are as follows: PCP on \u03c3 2 z , i.e. \u03c3 z \u223c Exponential(\u03be), with scale parameter \u03be = \u2212 log(0.01)0.31; PCP on the variance of the adjustment coefficients b, i.e. \u03c3 b \u223c Exponential(\u03be), with scale parameter \u03be = \u2212 log(0.01)0.31/0.1, and logit(\u03bb z ) \u223c Normal(0, 10).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 1621,
                    "end": 1629,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Parameter identification for the parsimonious CAR model"
        },
        {
            "text": "Estimation for parsimonious Mat\u00e9rn. The estimation of the conditional model in (29) simplifies to the estimation of parameters {\u03b2 x , \u03c3 z , \u03c3, \u03c1, \u03bd z }. Priors similar to the common range Mat\u00e9rn model are assigned for \u03b2 x and \u03c1. We use an exponential prior with rate parameter 1 for the sum \u03c3 2 z (1 \u2212 \u03c1 2 ) + \u03c3 2 , and a uniform prior for the signal ratio \u03c3 2 z (1\u2212\u03c1 2 ) \u03c3 2 z (1\u2212\u03c1 2 )+\u03c3 2 . A joint prior is used for \u03c1, \u03bd z to ensure \u03c1 2 \u2264 \u03bdx\u03bdz (\u03bdx+\u03bdz)/2 \u03c0(\u03c1, \u03bd z ) = \u03c0 1 (\u03c1|\u03bd z )\u03c0 2 (\u03bd z ) where \u03c0 1 \u223c U nif (\u2212 \u221a \u03bdx\u03bdz (\u03bdx+\u03bdz)/2 , \u221a \u03bdx\u03bdz (\u03bdx+\u03bdz)/2 ) and \u03c0 2 is a half Cauchy distribution with mean \u03bd x and variance 1000. 9 Computational details 9.1 Estimation for common range Mat\u00e9rn.To ensure that all parameters are identifiable, we fit the Mat\u00e9rn model of Gneiting et al. (2010) with common range \u03c6 x = \u03c6 z = \u03c6 xz = \u03c6, and additional constraints of \u03bd xz > \u03bd x and 2\u03bd xz \u2265 \u03bd x + \u03bd z . With these constraints, the maximum for the term \u03c1 2 fxz(\u03c9) 2 fx(\u03c9)fz(\u03c9) in (4) is obtained at \u03c9 = 0 with value \u03c1 2 \u03bd 2 xz \u03bdx\u03bdz , hence the Mat\u00e9rn model with the identifiability parameter constraints is valid if |\u03c1| < \u221a \u03bd x \u03bd z /\u03bd xz . We use the R package GpGp (Guinness and Katzfuss, 2020) to estimate \u03c6 x , \u03bd x and \u03c3 2 x by fitting a spatial regression model with Mat\u00e9rn covariance function to the exposure. The estimated values are plugged into the conditional bivariate Mat\u00e9rn model",
            "cite_spans": [
                {
                    "start": 761,
                    "end": 783,
                    "text": "Gneiting et al. (2010)",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Continuous domain"
        }
    ]
}