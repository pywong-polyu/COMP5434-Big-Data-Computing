{"paper_id": "5a3e91be98995a071412763f151d78c3773f7718", "metadata": {"title": "BESTox: A Convolutional Neural Network Regression Model Based on Binary-Encoded SMILES for Acute Oral Toxicity Prediction of Chemical Compounds", "authors": [{"first": "Jiarui", "middle": [], "last": "Chen", "suffix": "", "affiliation": {"laboratory": "", "institution": "Avenida da Universidade", "location": {"settlement": "Taipa, Macau SAR", "country": "China"}}, "email": ""}, {"first": "Hong-Hin", "middle": [], "last": "Cheong", "suffix": "", "affiliation": {"laboratory": "", "institution": "Avenida da Universidade", "location": {"settlement": "Taipa, Macau SAR", "country": "China"}}, "email": ""}, {"first": "Shirley", "middle": [], "last": "Weng", "suffix": "", "affiliation": {"laboratory": "", "institution": "Avenida da Universidade", "location": {"settlement": "Taipa, Macau SAR", "country": "China"}}, "email": "shirleysiu@um.edu.mo"}, {"first": "In", "middle": [], "last": "Siu", "suffix": "", "affiliation": {"laboratory": "", "institution": "Avenida da Universidade", "location": {"settlement": "Taipa, Macau SAR", "country": "China"}}, "email": ""}]}, "abstract": [{"text": "Compound toxicity prediction is a very challenging and critical task in the drug discovery and design field. Traditionally, cell or animal-based experiments are required to confirm the acute oral toxicity of chemical compounds. However, these methods are often restricted by availability of experimental facilities, long experimentation time, and high cost. In this paper, we propose a novel convolutional neural network regression model, named BESTox, to predict the acute oral toxicity (LD50) of chemical compounds. This model learns the compositional and chemical properties of compounds from their two-dimensional binary matrices. Each matrix encodes the occurrences of certain atom types, number of bonded hydrogens, atom charge, valence, ring, degree, aromaticity, chirality, and hybridization along the SMILES string of a given compound. In a benchmark experiment using a dataset of 7413 observations (train/test 5931/1482), BESTox achieved a squared correlation coefficient (R 2 ) of 0.619, root-mean-squared error (RM SE) of 0.603, and mean absolute error (MAE) of 0.433. Despite of the use of a shallow model architecture and simple molecular descriptors, our method performs comparably against two recently published models.", "cite_spans": [], "ref_spans": [], "section": "Abstract"}], "body_text": [{"text": "Measuring the chemical and physiological properties of chemical compounds are fundamental tasks in biomedical research and drug discovery [19] . The basic idea of modern drug design is to search chemical compounds with desired affinity, potency, and efficacy against the biological target that is relevant to the disease of interest. However, not only that there are tens of thousands known chemical compounds existed in nature, but many more artificial chemical compounds are being produced each year [9] . Thus, the modern drug discovery pipeline is focused on narrowing down the scope of the chemical space where good drug candidates are [7, 11] . Potential lead compounds will be subjected to further experimental validation on their pharmacodynamics and pharmacokinetic (PD/PK) properties [2, 14] ; the latter includes absorption, distribution, metabolism, excretion, and toxicity (ADME/T) measurements. Traditionally, chemists and biologists conduct cell-based or animal-based experiments to measure the PD/PK properties of these compounds and their actual biological effects in vivo. However, these experiments are not only high cost in terms of both time and money, the experiments that involve animal testings are increasingly subjected to concerns from ethical perspectives [1] .", "cite_spans": [{"start": 138, "end": 142, "text": "[19]", "ref_id": "BIBREF18"}, {"start": 502, "end": 505, "text": "[9]", "ref_id": "BIBREF8"}, {"start": 641, "end": 644, "text": "[7,", "ref_id": "BIBREF6"}, {"start": 645, "end": 648, "text": "11]", "ref_id": "BIBREF10"}, {"start": 794, "end": 797, "text": "[2,", "ref_id": "BIBREF1"}, {"start": 798, "end": 801, "text": "14]", "ref_id": "BIBREF13"}, {"start": 1284, "end": 1287, "text": "[1]", "ref_id": "BIBREF0"}], "ref_spans": [], "section": "Introduction"}, {"text": "Among all measured properties, toxicity of a compound is the most important one which must be confirmed before approval of the compound for medication purposes [16] . There are different ways to classify the toxicity of a compound. For example, based on systemic toxic effects, the common toxicity types include acute toxicity, sub-chronic toxicity, chronic toxicity, carcinogenicity developmental toxicity and genetic toxicity [22] . On the other hand, based on the toxicity effects area, toxicity can also be classified as hepatotoxicity, ototoxicity, ocular toxicity, etc. [15] . Therefore, there is a great demand for accurate, low-cost and time-saving toxicity prediction methods for different toxicity categories.", "cite_spans": [{"start": 160, "end": 164, "text": "[16]", "ref_id": "BIBREF15"}, {"start": 428, "end": 432, "text": "[22]", "ref_id": "BIBREF21"}, {"start": 576, "end": 580, "text": "[15]", "ref_id": "BIBREF14"}], "ref_spans": [], "section": "Introduction"}, {"text": "Toxicity of a chemical compound is associated with its chemical structure [17] . A good example is the chiral compounds. This kind of compounds and their isomers have highly similar structures but only slight differences in molecular geometry. Their differences cause them to possess different biological properties. For example, the drug Dopa is a compound for treating the Parkinson disease. The d-isomer form of this compound has severe toxicity whereas the l-isomer form does not [12] . Therefore, only its levorotatory form can be used for medical treatments. This property-structure relationship is often described as quantitative structure-activity relationship (QSAR) and have been widely used in the prediction of different properties of compounds [4, 24] . Based on the same idea, toxicities of a compound, being one of the most concerned properties, can be predicted via computational means as a way to select more promising candidates before undertaking further biological experiments.", "cite_spans": [{"start": 74, "end": 78, "text": "[17]", "ref_id": "BIBREF16"}, {"start": 484, "end": 488, "text": "[12]", "ref_id": "BIBREF11"}, {"start": 757, "end": 760, "text": "[4,", "ref_id": "BIBREF3"}, {"start": 761, "end": 764, "text": "24]", "ref_id": "BIBREF23"}], "ref_spans": [], "section": "Introduction"}, {"text": "The Simplified Molecular Input Line Entry System, also called SMILES [20, 21] , is a linear representation of a chemical compound. It is a short ASCII string describing the composition, connectivity, and charges of atoms in a compound. An example is shown in Fig. 1 . The compound is called Morphine; it is originated from the opiate family and is found to exist naturally in many plants and animals. Morphine has been widely used as a medication to relief acute and chronic pain of patients. Nowadays, compounds are usually converted into their SMILES strings for the purpose of easy storage into databases or for other computational processing such as machine learning. Common molecular toolkits such as RDkit [8] and OpenBabel [13] can convert a SMILES string to its 2D and 3D structures, and vice versa. In recent years, machine learning has become the mainstream technique in natural language processing (NLP). Among all machine learning applications for NLP, text classification is the most widely studied. Based on the input text sentences, a machine learning-based NLP model analyzes the organization of words and the types of words in order to categorize the given text. Two pioneering NLP methods are textCNN [6] and ConvNets [26] . The former method introduced a pretrained embedding layer to encode words of input sentences into fixed-size feature vectors with padding. Then, feature vectors of all words were combined to form a sentence matrix that was fed into a standard convolutional neural network (CNN) model. This work was considered a breakthrough at that time and accumulated over 5800 citations since 2014 (as per Google Scholar). Another spotlight paper in NLP for text classification is ConvNets [26] . Instead of analyzing words in a sentence, this model exploited simple one-hot encoding method at the character level for 70 unique characters in sentence analysis. The success of these methods in NLP shed lights to other applications that have only texts as raw data.", "cite_spans": [{"start": 69, "end": 73, "text": "[20,", "ref_id": "BIBREF19"}, {"start": 74, "end": 77, "text": "21]", "ref_id": "BIBREF20"}, {"start": 712, "end": 715, "text": "[8]", "ref_id": "BIBREF7"}, {"start": 730, "end": 734, "text": "[13]", "ref_id": "BIBREF12"}, {"start": 1219, "end": 1222, "text": "[6]", "ref_id": "BIBREF5"}, {"start": 1236, "end": 1240, "text": "[26]", "ref_id": "BIBREF25"}, {"start": 1720, "end": 1724, "text": "[26]", "ref_id": "BIBREF25"}], "ref_spans": [{"start": 259, "end": 265, "text": "Fig. 1", "ref_id": "FIGREF0"}], "section": "Introduction"}, {"text": "Compound toxicity prediction can be considered as a classification problem too. Recently, Hirohara et al. [3] proposed a new CNN model for toxicity classification based on character-level encoding. In this work, each SMILES character is encoded into a 42-dimensional feature vector. The CNN model based on this simple encoding method achieved an area-under-curve (AUC) value of 0.813 for classification of 12 endpoints using the TOX21 dataset [18] . The best AUC score in TOX21 challenge is 0.846 which is achieved by DeepTox [10] . Despite of its higher accuracy, the DeepTox model is extremely complex. It requires heavy feature engineering from a large pool of static and dynamic features derived from the compounds or indirectly via external tools. The classification model is ensemble-based combining deep neural network (DNN) with multiple layers of hidden nodes ranging from 2 10 to 2 14 nodes. The train dataset for this highly complex model was comprised of over 12,000 observations and superior predictive performance was demonstrated.", "cite_spans": [{"start": 106, "end": 109, "text": "[3]", "ref_id": "BIBREF2"}, {"start": 443, "end": 447, "text": "[18]", "ref_id": "BIBREF17"}, {"start": 526, "end": 530, "text": "[10]", "ref_id": "BIBREF9"}], "ref_spans": [], "section": "Introduction"}, {"text": "Besides classification, toxicity prediction can be seen as a regression problem when the compound toxicity level is of concern. Like other QSAR problems, toxicity regression is a highly challenging task due to limited data availability and noisiness of the data. With limited data, the use of simpler model architecture is preferred to avoid the model being badly overfitted. In this work, we have focused on the regression of acute oral toxicity of chemical compounds. Two recent works [5, 23] were found to solve this problem where the maximally achievable R 2 is only 0.629 [5] .", "cite_spans": [{"start": 487, "end": 490, "text": "[5,", "ref_id": "BIBREF4"}, {"start": 491, "end": 494, "text": "23]", "ref_id": "BIBREF22"}, {"start": 577, "end": 580, "text": "[5]", "ref_id": "BIBREF4"}], "ref_spans": [], "section": "Introduction"}, {"text": "In this study, we developed a regression model for acute oral toxicity prediction. The prediction task is to estimate the median lethal dose, LD 50 , of the compound; this is the dose required to kill half the members of the tested population. A small LD 50 value indicates high toxicity level whereas a large LD 50 value indicates low toxicity level of the compound. Based on the LD 50 value, compounds can be categorized into four levels as defined by the United States Environmental Protection Agency (EPA) (see Table 1 ). Category III Slightly toxic and slightly irritating 500 < LD50 \u2264 5000", "cite_spans": [], "ref_spans": [{"start": 515, "end": 522, "text": "Table 1", "ref_id": "TABREF0"}], "section": "Dataset"}, {"text": "Category IV Practically non-toxic and not an irritant 5000 < LD50", "cite_spans": [], "ref_spans": [], "section": "Dataset"}, {"text": "The rat acute oral toxicity dataset used in this study was kindly provided by the author of TopTox [23] . This dataset was also used in the recent study of computational toxicity prediction by Karim et al. [5] . For LD 50 prediction task, the dataset contains 7413 samples; out of which 5931 samples are for training and 1482 samples are for testing. The original train/test split was deliberately made to maintain similar distribution of the train and test datasets to facilitate learning and model validation. It is noteworthy that as the actual LD 50 values were in a wide range (train set: 0.042 mg/kg to 99947.567 mg/kg, test set: 0.020 mg/kg to 114062.725 mg/kg), the LD 50 values were first transformed to mol/kg format, and then scaled logarithmically to \u2212log 10 (LD 50 ). Finally, the processed experimental values range from 0.470 to 7.100 in the train set and 0.291 to 7.207 in the test set.", "cite_spans": [{"start": 99, "end": 103, "text": "[23]", "ref_id": "BIBREF22"}, {"start": 206, "end": 209, "text": "[5]", "ref_id": "BIBREF4"}], "ref_spans": [], "section": "Dataset"}, {"text": "As a SMILES string is not an understandable input format for general machine learning methods, it needs to be converted or encoded into a series of numerical values. Ideally, these values should capture the characteristics of the compound and correlates to the interested observables. The most popular way to encode a SMILE is to use molecular fingerprints such as Molecular Access System (MACCS) and extended connectivity fingerprint (ECFP). However, fingerprint algorithms generate high dimensional and sparse matrices which make learning difficult.", "cite_spans": [], "ref_spans": [], "section": "Binary Encoding Method for SMILES (BES)"}, {"text": "Here, in order to solve the regression task for oral toxicity prediction. Inspired by the work of Hirohara et al. [3] , we proposed the modified Binary Encoding method for SMILES, named BES for short. In BES, each character is encoded by a binary vector of 56 bits. Among them 26 bits are for encoding the SMILES alphabets and symbols by the one-hot encoding approach; 30 bits are for encoding various atomic properties including number of bonded hydrogens, formal charge, valence, ring atom, degree, aromaticity, chirality, and hybridization. The feature types and corresponding size of the feature is listed in Table 2 . As the maximum length of SMILES strings in our dataset is 300, the size of the feature matrix for one SMILES string was defined to be 56 \u00d7 300. For a SMILES string that is shorter than 300 in length, zero padding was applied. Figure 2 illustrates how BES works.", "cite_spans": [{"start": 114, "end": 117, "text": "[3]", "ref_id": "BIBREF2"}], "ref_spans": [{"start": 613, "end": 620, "text": "Table 2", "ref_id": "TABREF1"}, {"start": 849, "end": 857, "text": "Figure 2", "ref_id": null}], "section": "Binary Encoding Method for SMILES (BES)"}, {"text": "Our prediction model is a conventional CNN model with convolutional layers to extract features, pooling layers to reduce dimensionality of the feature matrix and to prevent overfitting, and a multi-layer neural network to correlate features to LD 50 values. To decide the model architecture and to tune hyperparameters of the model, a grid search method was employed. Table 3 shows the hyperparameters and their ranges of values within which the model was optimized. In each grid search process, the model training was run for 500 epochs and the mean-squared error (MSE) loss of the model in 5-fold cross validation was used as a criteria for model selection. The optimal parameters are also presented in Table 3 . The final production model was trained using the optimal parameters and the entire train dataset. The maximum training epoch was 1000; early stop method was used to prevent the problem of overfitting. The architecture of our optimized CNN model is presented in Fig. 3 . The model contains two convolutional layers (Conv) with 512 and 1024 filters respectively. After each convolutional layer is an average pooling layer and a batch normalization layer (BN). Then, a max pooling layer is used before the learned features fed into the fully connected layers (FC). Four FCs containing 2048, 1024, 512, and 256 hidden nodes were found to be the optimal combination for toxicity prediction and the ReLU function is used to generate the prediction output.", "cite_spans": [], "ref_spans": [{"start": 368, "end": 375, "text": "Table 3", "ref_id": "TABREF2"}, {"start": 705, "end": 712, "text": "Table 3", "ref_id": "TABREF2"}, {"start": 976, "end": 982, "text": "Fig. 3", "ref_id": "FIGREF1"}], "section": "Model Architecture"}, {"text": "All implementations were done using Python 3.6.9 with the following libraries: Anaconda 4.7.0, RDKit v2019.09.2.0, Pytorch 1.2.0 and CUDA 10.0. We used GetTotalNumHs, GetFormalCharge, GetChiralTag, GetTotalDegree, IsInRing, GetIsAromatic, GetTotalValence and GetHybridization functions from RDkit to calculate atom properties. Our model was trained and tested in a workstation equipped with two NVIDIA Tesla P100 GPUs.", "cite_spans": [], "ref_spans": [], "section": "Implementation"}, {"text": "Training of the final production model was performed using the optimal parameters obtained from the result of our extensive grid search. Figure 4 shows the evolution of MSE over the number of training cycles. The training stopped at the 900-th epoch with MSE of 0.016. Table 4 shows the performances of our model Table 3 . in the train and test sets. The training performance is excellent which gives R 2 of 0.982 as all the data was used to construct the model. For the test set, the model predicts with R 2 of 0.619, RMSE of 0.603, and MAE of 0.433. Figure 5 shows the scatterplot of BESTox prediction on the test data. We can see that prediction is better for compounds with lower toxicity (lower \u2212log 10 (LD 50 )) and worse for those with higher toxicity. This may be due to fewer data available in the train set for higher toxicity compounds. Thus, we also tested our model on samples with target values less than 3.5 in the test set (1255 samples out of total 1482 samples, the sample coverage is more than 84%). In this case, the performance of our model is improved: RMSE is decreased from 0.603 to 0.516 and MAE is reduced from 0.433 to 0.385. Table 5 . Performance comparison of our model to two existing acute oral toxicity prediction methods: TopTox [23] and DT+SNN [5] . Performance data of these methods were obtained from the original literature. Table 5 presents the comparative performance of BESTox to two existing acute oral toxicity prediction models, the ST-DNN model from TopTox and the DT+SNN model from Karim et al. [5] . Results show that our model is slightly better than ST-DNN with respect to R 2 and MAE. The best performed model is DT+SNN which has a correlation of 0.629; but RMSE and MAE were not provided in the original study.", "cite_spans": [{"start": 1262, "end": 1266, "text": "[23]", "ref_id": "BIBREF22"}, {"start": 1278, "end": 1281, "text": "[5]", "ref_id": "BIBREF4"}, {"start": 1540, "end": 1543, "text": "[5]", "ref_id": "BIBREF4"}], "ref_spans": [{"start": 137, "end": 145, "text": "Figure 4", "ref_id": "FIGREF2"}, {"start": 269, "end": 276, "text": "Table 4", "ref_id": "TABREF3"}, {"start": 313, "end": 320, "text": "Table 3", "ref_id": "TABREF2"}, {"start": 552, "end": 560, "text": "Figure 5", "ref_id": null}, {"start": 1153, "end": 1160, "text": "Table 5", "ref_id": null}, {"start": 1362, "end": 1369, "text": "Table 5", "ref_id": null}], "section": "Results"}, {"text": "The closeness of the performance metrics of BESTox to two existing models suggest that our model performs on par with them. Nevertheless, it should be mentioned that while our model has employed simple features and relatively simple model architecture, ST-DNN and DT+SNN relied on highly engineered input features and complex ensemble-based model architectures. For ST-DNN [23] , they combined 700 element specific topological descriptors (ESTD) and 330 auxiliary descriptors as candidates to generate the feature vectors for prediction (our model uses only 56 features). In addition, their model included ensemble of two different types of classifiers, namely, deep neural network (DNN) and gradient boosted decision tree (GBDT). Combining predictions from several classifiers is an easy way to improve prediction accuracy, however, the complexity introduced into the model makes the already \"black box model\" more difficult to understand. For the recent DT+SNN model [5] , they used decision trees (DT) to select 817 different descriptors generated from the PaDEL tools [25] . Although their shallow neural network (SNN) architecture required short model training time, more time was spent on feature generation and selection. Different combination of features were used depending on the tasks to be predicted, which had high computational cost. Here, BESTox has achieved results comparable to these more complex models with simple binary features and model architecture, showing the power of our method.", "cite_spans": [{"start": 373, "end": 377, "text": "[23]", "ref_id": "BIBREF22"}, {"start": 969, "end": 972, "text": "[5]", "ref_id": "BIBREF4"}, {"start": 1072, "end": 1076, "text": "[25]", "ref_id": "BIBREF24"}], "ref_spans": [], "section": "Results"}, {"text": "In this paper, we present our new method BESTox for acute oral toxicity prediction. Inspired by NLP techniques for text classification, we have designed a simple character-level encoding method for SMILES called the binary-encoded SMILES (BES). We have developed a shallow CNN to learn the BES matrices to predict the LD 50 values of compounds. We trained our model on the rat acute oral toxicity data, tested and compared to two other existing models. Despite the simplicity of our method, BESTox has achieved a good performance with R 2 of 0.619, comparable to the single-task model proposed by TopTox [23] but slightly inferior to the hybrid decision tree and shallow neural network model by Karim et al. [5] .", "cite_spans": [{"start": 604, "end": 608, "text": "[23]", "ref_id": "BIBREF22"}, {"start": 708, "end": 711, "text": "[5]", "ref_id": "BIBREF4"}], "ref_spans": [], "section": "Conclusion"}, {"text": "Future improvement of BESTox will be focused on extending the scope of datasets. As shown in the work of Wu et al. [23] , multitask learning can improve performance of prediction models due to availability of more data on different toxicity effects. The idea of multitask technique is to train a model with multiple training sets; each set corresponds to one toxicity prediction task. Feeding the learners with different toxicity data helps them to learn common latent features of molecules offered by different datasets.", "cite_spans": [{"start": 115, "end": 119, "text": "[23]", "ref_id": "BIBREF22"}], "ref_spans": [], "section": "Conclusion"}], "bib_entries": {"BIBREF0": {"ref_id": "b0", "title": "Recent efforts to elucidate the scientific validity of animalbased drug tests by the pharmaceutical industry, pro-testing lobby groups, and animal welfare organisations", "authors": [{"first": "J", "middle": [], "last": "Bailey", "suffix": ""}, {"first": "M", "middle": [], "last": "Balls", "suffix": ""}], "year": 2019, "venue": "BMC Med. Ethics", "volume": "20", "issn": "", "pages": "", "other_ids": {}}, "BIBREF1": {"ref_id": "b1", "title": "Screening: Methods for Experimentation in Industry, Drug Discovery, and Genetics", "authors": [{"first": "A", "middle": [], "last": "Dean", "suffix": ""}, {"first": "S", "middle": [], "last": "Lewis", "suffix": ""}], "year": 2006, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"DOI": ["10.1007/0-387-28014-6"]}}, "BIBREF2": {"ref_id": "b2", "title": "Convolutional neural network based on SMILES representation of compounds for detecting chemical motif", "authors": [{"first": "M", "middle": [], "last": "Hirohara", "suffix": ""}, {"first": "Y", "middle": [], "last": "Saito", "suffix": ""}, {"first": "Y", "middle": [], "last": "Koda", "suffix": ""}, {"first": "K", "middle": [], "last": "Sato", "suffix": ""}, {"first": "Y", "middle": [], "last": "Sakakibara", "suffix": ""}], "year": 2018, "venue": "BMC Bioinform", "volume": "19", "issn": "", "pages": "", "other_ids": {}}, "BIBREF3": {"ref_id": "b3", "title": "A review on machine learning methods for in silico toxicity prediction", "authors": [{"first": "G", "middle": [], "last": "Idakwo", "suffix": ""}], "year": 2018, "venue": "J. Environ. Sci. Health Part C", "volume": "36", "issn": "4", "pages": "169--191", "other_ids": {}}, "BIBREF4": {"ref_id": "b4", "title": "Efficient toxicity prediction via simple features using shallow neural networks and decision trees", "authors": [{"first": "A", "middle": [], "last": "Karim", "suffix": ""}, {"first": "A", "middle": [], "last": "Mishra", "suffix": ""}, {"first": "M", "middle": ["H"], "last": "Newton", "suffix": ""}, {"first": "A", "middle": [], "last": "Sattar", "suffix": ""}], "year": 2019, "venue": "ACS Omega", "volume": "4", "issn": "1", "pages": "1874--1888", "other_ids": {}}, "BIBREF5": {"ref_id": "b5", "title": "Convolutional neural networks for sentence classification", "authors": [{"first": "Y", "middle": [], "last": "Kim", "suffix": ""}], "year": 2014, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"arXiv": ["arXiv:1408.5882"]}}, "BIBREF6": {"ref_id": "b6", "title": "Virtual Screening for Bioactive Molecules", "authors": [{"first": "H", "middle": [], "last": "Kubinyi", "suffix": ""}, {"first": "R", "middle": [], "last": "Mannhold", "suffix": ""}, {"first": "H", "middle": [], "last": "Timmerman", "suffix": ""}], "year": 2008, "venue": "", "volume": "10", "issn": "", "pages": "", "other_ids": {}}, "BIBREF7": {"ref_id": "b7", "title": "RDkit: open-source cheminformatics", "authors": [{"first": "G", "middle": [], "last": "Landrum", "suffix": ""}], "year": 2006, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF8": {"ref_id": "b8", "title": "Exploration of the chemical space and its three historical regimes", "authors": [{"first": "E", "middle": ["J"], "last": "Llanos", "suffix": ""}, {"first": "W", "middle": [], "last": "Leal", "suffix": ""}, {"first": "D", "middle": ["H"], "last": "Luu", "suffix": ""}, {"first": "J", "middle": [], "last": "Jost", "suffix": ""}, {"first": "P", "middle": ["F"], "last": "Stadler", "suffix": ""}, {"first": "G", "middle": [], "last": "Restrepo", "suffix": ""}], "year": 2019, "venue": "Proc. Natl. Acad. Sci", "volume": "116", "issn": "", "pages": "12660--12665", "other_ids": {}}, "BIBREF9": {"ref_id": "b9", "title": "DeepTox: toxicity prediction using deep learning", "authors": [{"first": "A", "middle": [], "last": "Mayr", "suffix": ""}, {"first": "G", "middle": [], "last": "Klambauer", "suffix": ""}, {"first": "T", "middle": [], "last": "Unterthiner", "suffix": ""}, {"first": "S", "middle": [], "last": "Hochreiter", "suffix": ""}], "year": 2016, "venue": "Front. Environ. Sci", "volume": "3", "issn": "", "pages": "", "other_ids": {}}, "BIBREF10": {"ref_id": "b10", "title": "Virtual screening strategies in drug discovery", "authors": [{"first": "C", "middle": [], "last": "Mcinnes", "suffix": ""}], "year": 2007, "venue": "Curr. Opin. Chem. Biol", "volume": "11", "issn": "5", "pages": "494--502", "other_ids": {}}, "BIBREF11": {"ref_id": "b11", "title": "Chiral drugs: an overview", "authors": [{"first": "L", "middle": ["A"], "last": "Nguyen", "suffix": ""}, {"first": "H", "middle": [], "last": "He", "suffix": ""}, {"first": "C", "middle": [], "last": "Pham-Huy", "suffix": ""}], "year": 2006, "venue": "Int. J. Biomed. Sci. IJBS", "volume": "2", "issn": "2", "pages": "", "other_ids": {}}, "BIBREF12": {"ref_id": "b12", "title": "Open Babel: an open chemical toolbox", "authors": [{"first": "N", "middle": ["M"], "last": "O&apos;boyle", "suffix": ""}, {"first": "M", "middle": [], "last": "Banck", "suffix": ""}, {"first": "C", "middle": ["A"], "last": "James", "suffix": ""}, {"first": "C", "middle": [], "last": "Morley", "suffix": ""}, {"first": "T", "middle": [], "last": "Vandermeersch", "suffix": ""}, {"first": "G", "middle": ["R"], "last": "Hutchison", "suffix": ""}], "year": 2011, "venue": "J. Cheminform", "volume": "3", "issn": "1", "pages": "", "other_ids": {}}, "BIBREF13": {"ref_id": "b13", "title": "Integrating virtual screening in lead discovery", "authors": [{"first": "T", "middle": ["I"], "last": "Oprea", "suffix": ""}, {"first": "H", "middle": [], "last": "Matter", "suffix": ""}], "year": 2004, "venue": "Curr. Opin. Chem. Biol", "volume": "8", "issn": "4", "pages": "349--358", "other_ids": {}}, "BIBREF14": {"ref_id": "b14", "title": "New promising approaches to treatment of chemotherapy-induced toxicities", "authors": [{"first": "J", "middle": ["C F"], "last": "Quintanilha", "suffix": ""}, {"first": "M", "middle": [], "last": "Berlofa", "suffix": ""}], "year": 2017, "venue": "AvidScience Chemother", "volume": "", "issn": "", "pages": "2--52", "other_ids": {}}, "BIBREF15": {"ref_id": "b15", "title": "In silico toxicology: computational methods for the prediction of chemical toxicity", "authors": [{"first": "A", "middle": ["B"], "last": "Raies", "suffix": ""}, {"first": "V", "middle": ["B"], "last": "Bajic", "suffix": ""}], "year": 2016, "venue": "Wiley Interdiscip. Rev. Comput. Mol. Sci", "volume": "6", "issn": "2", "pages": "147--172", "other_ids": {}}, "BIBREF16": {"ref_id": "b16", "title": "Understanding the basics of QSAR for applications in pharmaceutical sciences and risk assessment", "authors": [{"first": "K", "middle": [], "last": "Roy", "suffix": ""}, {"first": "S", "middle": [], "last": "Kar", "suffix": ""}, {"first": "R", "middle": [], "last": "Das", "suffix": ""}], "year": 2015, "venue": "", "volume": "", "issn": "", "pages": "231--289", "other_ids": {}}, "BIBREF17": {"ref_id": "b17", "title": "Improving the human hazard characterization of chemicals: a TOX21 update", "authors": [{"first": "R", "middle": ["R"], "last": "Tice", "suffix": ""}, {"first": "C", "middle": ["P"], "last": "Austin", "suffix": ""}, {"first": "R", "middle": ["J"], "last": "Kavlock", "suffix": ""}, {"first": "J", "middle": ["R"], "last": "Bucher", "suffix": ""}], "year": 2013, "venue": "Environ. Health Perspect", "volume": "121", "issn": "7", "pages": "756--765", "other_ids": {}}, "BIBREF18": {"ref_id": "b18", "title": "Dose Finding in Drug Development", "authors": [{"first": "N", "middle": [], "last": "Ting", "suffix": ""}], "year": 2006, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {"DOI": ["10.1007/0-387-33706-7"]}}, "BIBREF19": {"ref_id": "b19", "title": "SMILES, a chemical language and information system. 1. Introduction to methodology and encoding rules", "authors": [{"first": "D", "middle": [], "last": "Weininger", "suffix": ""}], "year": 1988, "venue": "J. Chem. Inf. Comput. Sci", "volume": "28", "issn": "1", "pages": "31--36", "other_ids": {}}, "BIBREF20": {"ref_id": "b20", "title": "SMILES. 2. Algorithm for generation of unique SMILES notation", "authors": [{"first": "D", "middle": [], "last": "Weininger", "suffix": ""}, {"first": "A", "middle": [], "last": "Weininger", "suffix": ""}, {"first": "J", "middle": ["L"], "last": "Weininger", "suffix": ""}], "year": 1989, "venue": "J. Chem. Inf. Comput. Sci", "volume": "29", "issn": "2", "pages": "97--101", "other_ids": {}}, "BIBREF21": {"ref_id": "b21", "title": "Encyclopedia of Toxicology", "authors": [{"first": "P", "middle": [], "last": "Wexler", "suffix": ""}, {"first": "S", "middle": ["C"], "last": "Gad", "suffix": ""}], "year": 1998, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF22": {"ref_id": "b22", "title": "Quantitative toxicity prediction using topology based multitask deep neural networks", "authors": [{"first": "K", "middle": [], "last": "Wu", "suffix": ""}, {"first": "G", "middle": ["W"], "last": "Wei", "suffix": ""}], "year": 2018, "venue": "J. Chem. Inf. Model", "volume": "58", "issn": "2", "pages": "520--531", "other_ids": {}}, "BIBREF23": {"ref_id": "b23", "title": "Machine learning based toxicity prediction: from chemical structural description to transcriptome analysis", "authors": [{"first": "Y", "middle": [], "last": "Wu", "suffix": ""}, {"first": "G", "middle": [], "last": "Wang", "suffix": ""}], "year": 2018, "venue": "Int. J. Mol. Sci", "volume": "19", "issn": "8", "pages": "", "other_ids": {}}, "BIBREF24": {"ref_id": "b24", "title": "Padel-descriptor: an open source software to calculate molecular descriptors and fingerprints", "authors": [{"first": "C", "middle": ["W"], "last": "Yap", "suffix": ""}], "year": 2011, "venue": "J. Comput. Chem", "volume": "32", "issn": "7", "pages": "1466--1474", "other_ids": {}}, "BIBREF25": {"ref_id": "b25", "title": "Character-level convolutional networks for text classification", "authors": [{"first": "X", "middle": [], "last": "Zhang", "suffix": ""}, {"first": "J", "middle": [], "last": "Zhao", "suffix": ""}, {"first": "Y", "middle": [], "last": "Lecun", "suffix": ""}], "year": 2015, "venue": "Advances in Neural Information Processing Systems", "volume": "", "issn": "", "pages": "649--657", "other_ids": {}}}, "ref_entries": {"FIGREF0": {"text": "The morphine structure and its SMILES representation.", "latex": null, "type": "figure"}, "FIGREF1": {"text": "Proposed CNN architecture for oral toxicity prediction.", "latex": null, "type": "figure"}, "FIGREF2": {"text": "MSE loss of training BESTox model with optimal hyperparameters in", "latex": null, "type": "figure"}, "TABREF0": {"text": "Four categories of compound oral toxicity (mg/kg) defined by the United States Environmental Protection Agency.Category II Moderately toxic and moderately irritating 50 < LD50 \u2264 500", "latex": null, "type": "table"}, "TABREF1": {"text": "The proposed binary encoding scheme called BES. Each SMILES character is encoded into a vector of 56 bits; each value, either a 1 or 0, represents the existence of that feature type and the element that it has.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>Feature type </td><td>Element </td><td>Bit(s)\n</td></tr><tr><td>Symbol in SMILES </td><td>( ) </td><td>2\n</td></tr><tr><td>[ ] </td><td>2\n</td></tr><tr><td>\u00a0</td><td>\u00a0</td><td>1\n</td></tr><tr><td>: </td><td>\u00a0</td><td>1\n</td></tr><tr><td>\u00a0</td><td>= </td><td>1\n</td></tr><tr><td>\u00a0</td><td># </td><td>1\n</td></tr><tr><td>\u00a0</td><td>\\ </td><td>1\n</td></tr><tr><td>\u00a0</td><td>/ </td><td>1\n</td></tr><tr><td>\u00a0</td><td>@ </td><td>1\n</td></tr><tr><td>\u00a0</td><td>+ </td><td>1\n</td></tr><tr><td>Number in SMILES </td><td>\u2212 </td><td>1\n</td></tr><tr><td>Atom charge (2-7) </td><td>6\n</td></tr><tr><td>Ring begin (yes/no) </td><td>1\n</td></tr><tr><td>Atom type </td><td>Ring end (yes/no) </td><td>1\n</td></tr><tr><td>C, H, O, N, others </td><td>5\n</td></tr><tr><td>Others </td><td>Surrounding hydrogen number (0-3) </td><td>4\n</td></tr><tr><td>Atom formal charge (\u22121, 0, 1) </td><td>3\n</td></tr><tr><td>\u00a0</td><td>Valence (1-6) </td><td>6\n</td></tr><tr><td>\u00a0</td><td>Ring atom (yes/no) </td><td>1\n</td></tr><tr><td>\u00a0</td><td>Degree (1-5) </td><td>5\n</td></tr><tr><td>\u00a0</td><td>Aromaticity (yes/no) </td><td>1\n</td></tr><tr><td>\u00a0</td><td>Chirality (R/S/others) </td><td>3\n</td></tr><tr><td>Total </td><td>Type of hybridization </td><td>7\n</td></tr><tr><td>- </td><td>56\n</td></tr></table></body></html>"}, "TABREF2": {"text": "Tuning options and optimal values for hyperparameters.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>Hyperparameter </td><td>Candidate value </td><td>Optimal value\n</td></tr><tr><td>Number of filter (Conv 1) </td><td>256-1024 </td><td>512\n</td></tr><tr><td>Number of filter (Conv 2) </td><td>256-1024 </td><td>1024\n</td></tr><tr><td>Activation function (Conv) </td><td>ReLU, Sigmoid </td><td>ReLU\n</td></tr><tr><td>Activation function (FC) </td><td>ReLU, Sigmoid </td><td>ReLU\n</td></tr><tr><td>Batch size </td><td>16, 32, 64, 128 </td><td>32\n</td></tr><tr><td>Batch normalization (BN) </td><td>Yes, No </td><td>Yes\n</td></tr><tr><td>Dropout </td><td>Yes, No </td><td>No\n</td></tr><tr><td>Optimizer </td><td>\u00a0</td><td>Adam\n</td></tr><tr><td>Adam, SGD </td><td>\u00a0</td></tr><tr><td>Learning rate </td><td>0.1, 0.01, 0.001 </td><td>0.01\n</td></tr><tr><td>Max epoch </td><td>500,1000,1500 </td><td>1000\n</td></tr></table></body></html>"}, "TABREF3": {"text": "Predictive performances of BESTox in the train and test datasets. R 2 is the squared Pearson correlation coefficient, RMSE is root-mean-squared error and MAE is mean absolute error.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>Performance </td><td>Dataset </td><td>Size </td><td>R2 </td><td>RMSE </td><td>MAE\n</td></tr><tr><td>Training </td><td>Train set </td><td>5931 </td><td>0.982 </td><td>0.126 </td><td>0.084\n</td></tr><tr><td>Testing </td><td>Test set </td><td>1482 </td><td>0.619 </td><td>0.603 </td><td>0.433\n</td></tr></table></body></html>"}, "TABREF4": {"text": "Table 1. Four categories of compound oral toxicity (mg/kg) defined by the United States Environmental Protection Agency.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>Category </td><td>Description </td><td>Range\n</td></tr><tr><td>Category I </td><td>Highly toxic and severely irritating </td><td>LD50 \u2264 50\n</td></tr><tr><td>Category II </td><td>Moderately toxic and moderately irritating </td><td>50 &lt; LD50 \u2264 500\n</td></tr><tr><td>Category III </td><td>Slightly toxic and slightly irritating </td><td>500 &lt; LD50 \u2264 5000\n</td></tr><tr><td>Category IV </td><td>Practically non-toxic and not an irritant </td><td>5000 &lt; LD50\n</td></tr></table></body></html>"}, "TABREF5": {"text": "Table 5. Performance comparison of our model to two existing acute oral toxicity prediction methods: TopTox [ 23 ] and DT+SNN [ 5 ]. Performance data of these methods were obtained from the original literature.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>Model </td><td>R2 </td><td>RMSE </td><td>MAE </td><td>Ref.\n</td></tr><tr><td>ST-DNN (TopTox) </td><td>0.614 </td><td>0.601 </td><td>0.436 </td><td>[23]\n</td></tr><tr><td>DT+SNN </td><td>0.629 </td><td>- </td><td>- </td><td>[5]\n</td></tr><tr><td>BESTox </td><td>0.619 </td><td>0.603 </td><td>0.433 </td><td>This study\n</td></tr></table></body></html>"}}, "back_matter": [{"text": "Acknowledgments. This work was supported by University of Macau (Grant no. MYRG2017-00146-FST).", "cite_spans": [], "ref_spans": [], "section": "acknowledgement"}]}