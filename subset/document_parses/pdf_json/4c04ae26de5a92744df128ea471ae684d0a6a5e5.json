{
    "paper_id": "4c04ae26de5a92744df128ea471ae684d0a6a5e5",
    "metadata": {
        "title": "Petabase-scale sequence alignment catalyses viral discovery",
        "authors": [
            {
                "first": "Robert",
                "middle": [
                    "C"
                ],
                "last": "Edgar",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Jeff",
                "middle": [],
                "last": "Taylor",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Tomer",
                "middle": [],
                "last": "Altman",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Heidelberg Institute for Theoretical Studies",
                    "location": {
                        "settlement": "Heidelberg",
                        "country": "Germany"
                    }
                },
                "email": ""
            },
            {
                "first": "Pierre",
                "middle": [],
                "last": "Barbera",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Dmitry",
                "middle": [],
                "last": "Meleshko",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "St. Petersburg State University",
                    "location": {
                        "settlement": "St. Petersburg",
                        "country": "Russia"
                    }
                },
                "email": ""
            },
            {
                "first": "Victor",
                "middle": [],
                "last": "Lin",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Dan",
                "middle": [],
                "last": "Lohr",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Gherman",
                "middle": [],
                "last": "Novakovsky",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of British Columbia. Vancouver",
                    "location": {
                        "region": "BC",
                        "country": "Canada"
                    }
                },
                "email": ""
            },
            {
                "first": "Basem",
                "middle": [],
                "last": "Al-Shayeb",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of California",
                    "location": {
                        "settlement": "Berkeley"
                    }
                },
                "email": ""
            },
            {
                "first": "Jillian",
                "middle": [
                    "F"
                ],
                "last": "Banfield",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of California",
                    "location": {
                        "settlement": "Berkeley"
                    }
                },
                "email": ""
            },
            {
                "first": "Anton",
                "middle": [],
                "last": "Korobeynikov",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "St. Petersburg State University",
                    "location": {
                        "settlement": "St. Petersburg",
                        "country": "Russia"
                    }
                },
                "email": ""
            },
            {
                "first": "Rayan",
                "middle": [],
                "last": "Chikhi",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "CNRS",
                    "location": {
                        "settlement": "Paris",
                        "country": "France"
                    }
                },
                "email": ""
            },
            {
                "first": "Artem",
                "middle": [],
                "last": "Babaian",
                "suffix": "",
                "affiliation": {},
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "Public sequence data represents a major opportunity for viral discovery, but its exploration has been inhibited by a lack of efficient methods for searching this corpus, which is currently at the petabase scale and growing exponentially. To address the ongoing pandemic caused by Severe Acute Respiratory Syndrome Coronavirus 2 and expand the known sequence diversity of viruses, we aligned pangenomes for coronaviruses (CoV) and other viral families to 5.6 petabases of public sequencing data from 3.8 million biologically diverse samples. To implement this strategy, we developed a cloud computing architecture, Serratus, tailored for ultra-high throughput sequence alignment at the petabase scale. From this search, we identified and assembled thousands of CoV and CoV-like genomes and genome fragments ranging from known strains to putatively novel genera. We generalise this strategy to other viral families, identifying several novel deltaviruses and huge bacteriophages. To catalyse a new era of viral discovery we made millions of viral alignments and family identifications freely available to the research community. Expanding the known diversity and zoonotic reservoirs of CoV and other emerging pathogens can accelerate vaccine and therapeutic developments for the current pandemic, and help us anticipate and mitigate future ones.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Viral zoonotic disease has had a major impact on human health over the past century despite dramatic advances in medical science, notably by the Spanish Flu, AIDS, SARS, Ebola and COVID-19 pandemics. There are an estimated 320,000 mammalian viruses [1] from which emerging infectious diseases in humans may arise [2] . Uncovering this viral biodiversity is a prerequisite for predicting and preventing future epidemics and is therefore the focus of consortia such as USAID PREDICT [3] and the Global Virome Project [4] as well as hundreds of government and academic research projects worldwide.",
            "cite_spans": [
                {
                    "start": 249,
                    "end": 252,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 313,
                    "end": 316,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 481,
                    "end": 484,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 515,
                    "end": 518,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "These efforts can be aided through re-analysis of petabases of high-throughput sequencing data available in public databases such as the Sequence Read Archive (SRA) [5] . This data spans millions of ecologically diverse biological samples, many of which capture viral transcripts that may be incidental to the goals of the original studies [6] . To expand the known repertoire of viruses and catalyse global virus discovery, in particular for Coronaviridae (CoV) family, we developed the Serratus cloud computing architecture for ultra-high throughput sequence alignment.",
            "cite_spans": [
                {
                    "start": 165,
                    "end": 168,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 340,
                    "end": 343,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "From a screen of 3.8 million libraries comprising 5.6 petabases of sequencing reads, we report 11,120 assemblies, including sequences from 13 previously uncharacterised or unavailable CoV or CoV-like operational taxonomic units (OTUs), defined by clustering amino sequences of the RNA dependent RNA polymerase (RdRp) gene at 97% identity. To demonstrate the broader utility of our approach, we also report six novel deltaviruses related to the human pathogen Hepatitis \u03b4 Virus (HDV), and expand the described members of the recently characterised family of huge bacteriophages (phages).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Viral discovery is a first step in preparing for the next pandemic. Sequencing reads for thousands of uncharacterised viruses already exist and require careful curation. To accelerate this process, we established a freely available and explorable resource of all vertebrate viral alignment data generated by Serratus at https://serratus.io. This work lays the foundation for years of future research by enabling the exploration of viruses which have been captured by more than a decade of high-throughput sequencing studies.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Serratus is a freely available, open-source cloud-computing platform designed to enable petabase-scale sequence alignment against a set of references. Using Serratus, we aligned in excess of one million short-read sequencing datasets per day for under 1 US cent per dataset (Extended Figure 1 ). This was achieved by leveraging commercially available computing infrastructure to employ up to 22,250 virtual CPUs simultaneously (see Methods).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 284,
                    "end": 292,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Petabase-scale alignment enables coronavirus discovery"
        },
        {
            "text": "We aligned 3,837,755 public RNA-seq, meta-genome, meta-virome and meta-transcriptome datasets (termed a sequencing run [5] ) against a collection of viral family pangenomes comprising all GenBank CoV records clustered at 99% identity plus all non-retroviral RefSeq records for vertebrate viruses (see Methods and Extended Table 1 ). To uncover more divergent viruses, we re-analysed 370,014 runs in a translated nucleotide search against a query comprising panproteomes for CoV and other families. We performed de novo assembly on 52,772 runs potentially containing CoV sequencing reads by combining 37,131 SRA accessions identified by the Serratus search with 18,584 identified by an ongoing cataloguing initiative of the SRA called STAT [5] . 11,120 of the resulting assemblies contained putative CoV contigs, of which 4,179 aligned to CoV RdRp (Extended Table 2 ). Of these, we identified 13 OTUs from a total of 129, i.e. not represented by Coronaviridae in GenBank (Figure 1a and Extended Figure 2 ). The protein domains of these OTU are consistent with a CoV or CoV-like genome organisation (Extended Figure 3) .",
            "cite_spans": [
                {
                    "start": 119,
                    "end": 122,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 739,
                    "end": 742,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [
                {
                    "start": 322,
                    "end": 329,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 857,
                    "end": 864,
                    "text": "Table 2",
                    "ref_id": null
                },
                {
                    "start": 970,
                    "end": 980,
                    "text": "(Figure 1a",
                    "ref_id": null
                },
                {
                    "start": 994,
                    "end": 1002,
                    "text": "Figure 2",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 1107,
                    "end": 1116,
                    "text": "Figure 3)",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Petabase-scale alignment enables coronavirus discovery"
        },
        {
            "text": "Three of the novel CoV OTUs fell within the Alphacoronavirus (\u03b1CoV) genus. The first (exemplar run: ERR2756788) was from two Desmodus rotundus bat metagenomes yielding 29.1 and 25.4 kb CoV contigs respectively in the Nyctacovirus subgenus. These CoV were noted by the data-collectors, [7] , but the sequences were not public and thus novel to our analysis. The second OTU (SRR9643845) was from a Pipistrellus pipistrellus bat metagenome collected in 2016 in China. Finally, from five libraries (ERR2744266) generated for a study on the metagenomic effects of the burying beetle Nicrophorus vespilloides on a mouse carcass, we assembled a Luchacovirus related to the rodent Lucheng Rn rat coronavirus (83% genome nucleotide identity to NC 032730.1).",
            "cite_spans": [
                {
                    "start": 285,
                    "end": 288,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Petabase-scale alignment enables coronavirus discovery"
        },
        {
            "text": "From a rodent virome study which identified several novel CoV [8] , a sample from an unknown species contained a \u03b2CoV Embecovirus (SRR5447167), with the closest matching genome matching an unclassified \u03b2CoV from Vietnam (77.52% to MH687971). Finally, the \u03b4CoV OTU (SRR5447167) appears to be from a currently unpublished avian virome study in China.",
            "cite_spans": [
                {
                    "start": 62,
                    "end": 65,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Petabase-scale alignment enables coronavirus discovery"
        },
        {
            "text": "We designated the eight remaining OTUs as group E, noting that all were found in samples from non-mammal aquatic vertebrates falling outside of \u03b4CoV in the tree (Extended Figure 2) . A sister taxon to Coronaviridae Figure 1 : Expanded characterisation of CoV and related OTUs a Radial cladogram derived from maximum likelihood tree of CoV and related OTUs. Inset is a phylogram of the same tree annotated with CoV genera (Greek letters) and group E CoV-like nidoviruses. OTUs were generated by clustering the RdRp gene at 97% identity. Diversity within each such 97% OTU was characterised by counting the number of 99% identity OTUs it contained. An OTU (97% or 99%) was considered to be known if it contained a GenBank sequence, otherwise to be a novel OTU discovered by Serratus. Hosts were considered novel if the source organism annotated by the SRA belonged to a species not annotated as a host in any GenBank record, noting that the annotated source may differ from the viral host (e.g., faecal contamination in a plant sample). Hosts are classified as Primates, Fowl (Galliformes), Bats (Chiroptera, Aquatic (Amphibia and Osteichthyes), or Other. b Length distribution for assemblies of SRA datasets classified as likely CoV-positive, showing a peak around the typical CoV genome length 30knt. c Triangular matrix showing median RdRp sequence identities between selected nidovirales and group E viruses. d Phylogram of group E CoV-like nidoviruses. was recently proposed [9] following the characterisation of a corona-like virus, Microhyla alphaletovirus 1 (MLeV), in the frog Microhyla fissipes, and soon after a related Pacific salmon nidovirus (PsNV) was described in the endangered Oncorhynchus tshawytscha [10] . Two of our OTUs were in these host species and the described viruses proved to be near-perfect matches. We expand this recently characterised group with six additional members, five similar to PsNV in; Takifugu pardalis (fugu fish; TparNV), Syngnathus typhle (broad-nosed pipefish; StypNV), Hippocampus kuda (seahorse; HkudNV) [11] , Puntigrus tetrazona (tiger barb; PtetNV), Ambystoma mexicanum (axolotl; AmexNV), and a more distant member in Caretta caretta (loggerhead sea turtle; CcarNV).",
            "cite_spans": [
                {
                    "start": 1478,
                    "end": 1481,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 1718,
                    "end": 1722,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 2052,
                    "end": 2056,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [
                {
                    "start": 171,
                    "end": 180,
                    "text": "Figure 2)",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 215,
                    "end": 223,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Petabase-scale alignment enables coronavirus discovery"
        },
        {
            "text": "Notably, the Ambystoma mexicanum (Axolotl) nidovirus (AmexNV) was assembled in 18 runs, 11 of which yielded 19 kb contigs. Easing the criteria of requiring an RdRp match, 28/44 (63.6%) of the runs from the associated studies were AmexNV positive. Gene structure of the AmexNV and related contigs suggests that there is genomic segmentation within this clade (Extended Figure 3) , with a homologous assembly gap is present in the published PsNV genome [10] . These contigs were obtained from experimental animals from two different research groups [12] [13] [14] , the common factor is the animal stock centre used by these studies which is therefore likely to be the source of the virus. Axolotl are critically endangered in the wild; determining the distribution and pathophysiology of AmexNV in these animals can assist with conservation efforts.",
            "cite_spans": [
                {
                    "start": 451,
                    "end": 455,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 547,
                    "end": 551,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 552,
                    "end": 556,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 557,
                    "end": 561,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [
                {
                    "start": 368,
                    "end": 377,
                    "text": "Figure 3)",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Petabase-scale alignment enables coronavirus discovery"
        },
        {
            "text": "Infectious agents are the leading cause of pyrexia of unknown origin (PUO) in children and immunocompromised adults [15] . In addition to identifying genetic diversity within CoV, we cross-referenced CoV+ library meta-data to identify possible zoonoses and infer vectors of transmission. Discordant libraries, one in which a CoV is identified and the viral expected host does not match the sequencing library source taxa, were rare, accounting for only 0.92% of cases (Extended Table 2e ).",
            "cite_spans": [
                {
                    "start": 116,
                    "end": 120,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                }
            ],
            "ref_spans": [
                {
                    "start": 478,
                    "end": 486,
                    "text": "Table 2e",
                    "ref_id": null
                }
            ],
            "section": "Petabase-scale alignment enables coronavirus discovery"
        },
        {
            "text": "In a 2010 virome sequencing study [16] of children with febrile illness, we identified sequencing runs from two children, one febrile (id:9007) and one afebrile (id:9090) with reads mapping to the (\u03b2CoV), Murine Hepatitis Virus (MHV). We assembled a complete 31.3 kb MHV genome from each replicate taken from the febrile child and a partial genome from the afebrile child. MHV can infect human cells in vitro [17] , but may be rare in humans, highlighting how rapid and unbiased meta-genomic sequence analysis can not only resolve the etiology of a sub-set of PUO, centralisation of these data (stripped of human-identifying reads) also serves as a public-health surveillance system for zoonosis.",
            "cite_spans": [
                {
                    "start": 34,
                    "end": 38,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 409,
                    "end": 413,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "Petabase-scale alignment enables coronavirus discovery"
        },
        {
            "text": "An important consideration for these analyses is that the nucleic acid reads do not prove viral infection has occurred in the nominal host species. For example, we identified four libraries in which a porcine or avian coronavirus was found in plant samples. A more likely explanation than cross-kingdom CoV transmission is that CoV was present in faeces/fertiliser originating from a mammalian or avian host.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Petabase-scale alignment enables coronavirus discovery"
        },
        {
            "text": "Coronaviridae is a well-characterised family ( Figure 2 and Extended Figure 4 ), yet our re-analysis of the SRA yielded eleven novel or under-reported OTUs. There are at least 4,497 more high-confidence (score \u226580) and diverged (\u226490% identity) virus-containing datasets. In particular Picornaviridae and Reoviridae are enriched and numerous within this category ( Figure 2 ). Serratus exploration of under-characterised viruses can potentially fill these gaps in our knowledge.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 47,
                    "end": 55,
                    "text": "Figure 2",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 69,
                    "end": 77,
                    "text": "Figure 4",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 364,
                    "end": 372,
                    "text": "Figure 2",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Petabase-scale alignment enables coronavirus discovery"
        },
        {
            "text": "The global mortality from viral hepatitis exceeds that of HIV/AIDS, tuberculosis or malaria, due to acute and chronic liver cirrhosis and subsequent hepatocellular carcinoma [18] . Hepatitis delta virus (HDV) is a small ( 1.7 knt) RNA satellite virus infecting hepatocytes. Alone, HDV is unable to produce infectious viral particles, as it requires the envelope protein from its helper virus, Hepatitis B (HBV) [19] . HDV infection aggravates liver cirrhosis caused by HBV and worsens clinical outcomes [20] .",
            "cite_spans": [
                {
                    "start": 174,
                    "end": 178,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 411,
                    "end": 415,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 503,
                    "end": 507,
                    "text": "[20]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Expanding the boundaries of known viral biodiversity"
        },
        {
            "text": "Prior to 2018, HDV was the sole known member of its genus; ten members have since been characterised [21-25]. We identified an additional six deltaviruses ( Figure 3a ) and assembled complete circular genomes for five (Extended Figure 6 ). The evolutionary histories of these deltaviruses are explored further in a companion manuscript [24] . One of these novel deltaviruses, MmonDV, was identified in Marmota monax (Eastern woodchuck), a model organism used over the last three decades for the study of viral-induced hepatitis and hepatocellular carcinoma following Woodchuck Hepatitis Virus (WHV) infection, a hepadnavirus similar to HBV [26].",
            "cite_spans": [
                {
                    "start": 336,
                    "end": 340,
                    "text": "[24]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 157,
                    "end": 166,
                    "text": "Figure 3a",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 228,
                    "end": 236,
                    "text": "Figure 6",
                    "ref_id": null
                }
            ],
            "section": "Expanding the boundaries of known viral biodiversity"
        },
        {
            "text": "From a 2015 study of 24 woodchucks born in captivity and experimentally infected with WHV [30], liver biopsy RNA-seq from four (16.7%) animals contained >5 MmonDV-mapping reads in at least one time-point of the 26 week study (Figure 3c ). Woodchuck Hepatitis Virus can support replication of human HDV, it is in fact a model for HDV pathogenesis [31, 32], so it is probable that WHV is also the helper virus for MmonDV. Inter-animal variation of WHV-induced liver cirrhosis can be substantial [30] and cryptic MmonDV infection may have be underlying some of this variability from the past three decades of research using this model system, which warrants further investigation. To explore the utility of broad-scale read archive searches for microbiome research, we sought to locate phages whose genomes encode proteins related to the terminases and major capsid proteins from recently reported huge phages [33] . To focus on phages whose genomes are substantially larger than normal (the average size is 52 kbp [33]), we prioritised assembled sequences of \u2265140 kbp (Figure 4a ). Assembly of 287 high-scoring runs returned 252 terminase-containing long contigs, primarily from cats, dogs, cattle and whales. The phylogenetic analysis of these sequences resolves new groups of phages with large genomes, some of which are comprised only of sequences only from one animal genus. However, in a few cases we identified closely related phages in different animal orders, including one case where related phages were found in a human from Bangladesh (ERR866585) and groups of cats (PRJEB9357) and dogs (PRJEB34360) from England, sampled 5 years apart. This result parallels the finding of 545 kbp Lak phage genomes in pigs, baboons and humans [34] . These newly recovered sequences substantially expand the previously defined clades and reveal members of these clades in new habitats ( Figure 4b ). Overall, these findings amplify that phages with large genomes are prevalent in human and animal microbiomes.",
            "cite_spans": [
                {
                    "start": 493,
                    "end": 497,
                    "text": "[30]",
                    "ref_id": null
                },
                {
                    "start": 907,
                    "end": 911,
                    "text": "[33]",
                    "ref_id": null
                },
                {
                    "start": 1737,
                    "end": 1741,
                    "text": "[34]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 225,
                    "end": 235,
                    "text": "(Figure 3c",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 1066,
                    "end": 1076,
                    "text": "(Figure 4a",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1880,
                    "end": 1889,
                    "text": "Figure 4b",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Expanding the boundaries of known viral biodiversity"
        },
        {
            "text": "Since the completion of the initial draft of the human genome, the cost of DNA sequencing has outpaced Moore's Law with a corresponding increase in the sizes of sequence databases [35] . Serratus offers researchers access to over a decade of data collected by the global research community in a rapid and a cost-effective manner. While our first priority was viral discovery in the context of an ongoing global health crisis, we believe that Serratus and further extensions of petabase scale metagenomics will shape a new era in computational biology, and enable radically new approaches to gene discovery, pathogen surveillance, pangenomic evolutionary analysis amongst other applications.",
            "cite_spans": [
                {
                    "start": 180,
                    "end": 184,
                    "text": "[35]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Rapid translation of large datasets, such as those generated by Serratus, into meaningful biomedical advances requires concerted collaboration between specialists [36] and underscores a greater need for prompt, free and unrestricted data sharing in the community, not only of raw data (reads) but also of analyses such as assemblies and annotations. To facilitate such progress, we established a data warehouse of the 5.7 terabytes of viral alignments containing known, and yet to be characterized, viral species, each requiring domain expertise for curation. These data can be explored via a graphical web interface at https://serratus.io or programatically through the R package tantalus (https://github.com/serratus-bio/tantalus) which interfaces to a PostgreSQL-server hosting high-level data summaries.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Computational biology is outpacing the rate at which classical isolation-or culture-based validation can be performed. Reverse genetics and synthetic nucleic acids offer a path to biological validation when virions are unavailable, such as those predicted from sequence alone [37, 38] . Innovative fields such as high-throughput functional viromics [39] leverage these broad and rapidly growing collections of viral sequences, and can inform evidence-based policies responding to emerging pandemics [40, 41] .",
            "cite_spans": [
                {
                    "start": 276,
                    "end": 280,
                    "text": "[37,",
                    "ref_id": null
                },
                {
                    "start": 281,
                    "end": 284,
                    "text": "38]",
                    "ref_id": null
                },
                {
                    "start": 499,
                    "end": 503,
                    "text": "[40,",
                    "ref_id": null
                },
                {
                    "start": 504,
                    "end": 507,
                    "text": "41]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Human population growth and encroachment on animal habitats is bringing more species into proximity, leading to increased zoonosis [2] and accelerating the Anthropocene mass extinction [42, 43] . While the availability of computation and data analysis is increasing, the opportunity to capture the rich genetic diversity of endangered species and their associated microorganism biodiversity is not. The need to invest in field studies for the collection and curation of rare and biologically diverse samples has never been as pressing as it is today. If not for the conservation of endangered species, then to conserve our own. Figure 1 ).",
            "cite_spans": [
                {
                    "start": 131,
                    "end": 134,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 185,
                    "end": 189,
                    "text": "[42,",
                    "ref_id": null
                },
                {
                    "start": 190,
                    "end": 193,
                    "text": "43]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 628,
                    "end": 636,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Discussion"
        },
        {
            "text": "The processing of each sequencing library is split into three modules dl (download), align, and merge. The dl module acquires compressed data (.sra format) via prefetch, from the AWS S3 mirror of the SRA, decompresses to FASTQ, and splits the data into fq-blocks of 1 million reads or read-pairs into a temporary S3 cache bucket. To mitigate excessive disk usage caused by a few large datasets, a limit of 100 million reads per dataset was imposed.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computing cluster architecture"
        },
        {
            "text": "The align module reads individual fq-blocks and aligns to an indexed database of user-provided query sequences using either bowtie2 ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computing cluster architecture"
        },
        {
            "text": "Each component is launched from a separate AWS autoscaling group with its own launch template, allowing the user to tailor instance requirements per task. This enabled us to minimise the use of costly block storage during compute-bound tasks such as alignment. We used the following Spot instance types; dl: 250GB SSD block storage, 8vCPUs, 32GB RAM (r5.xlarge) 1300 instances; align: 10GB SSD block storage, 8vCPUs, 8GB RAM (c5.xlarge) 4,300 instances; merge: 150GB SSD block storage, 4vCPUs, 4GB RAM (c5.large) 60 instances. Users should note that it may be necessary to submit a service ticket to access more than the default 20 EC2 instance limit.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computing resource allocation"
        },
        {
            "text": "EC2 instances have higher network bandwidth (up to 1.25 GB/s) than block storage bandwidth (250 MB/s). To exploit this, we used S3 buckets as a data buffering and streaming system and to transfer data between instances following methods developed in a previous cloud architecture (https://github.com/FredHutch/sra-pipeline). This, combined with splitting of FASTQ files into individual blocks, effectively eliminated file input/output (i/o) as a bottleneck, since the available i/o is multiplied per running instance (conceptually analogous to a RAID0 configuration).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computing resource allocation"
        },
        {
            "text": "Using S3 as a buffer also allowed us to decouple the input and output of each module S3 storage is cheap enough that in the event of unexpected issues (e.g., exceeding EC2 quotas) we could resolve problems and resume processing. For example, shutting done the align modules to hotfix a genome indexing problem without having to re-run the dl modules.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computing resource allocation"
        },
        {
            "text": "The Serratus scheduler node controls the number of desired instances to be created for each component of the workflow, based on the available work queue. We implemented a pull-based work queue. Upon boot-up each instance launches a number of worker threads equal to the number of CPU available. Each worker independently manages itself via a boot script, and query the scheduler for available tasks. Upon completion of the task, the worker updates the scheduler of the result: success, or fail, and queries for a new task. Under ideal conditions, this allows for a response time in the hundreds of milliseconds, worst case, keeping cluster throughput high. Each task typically lasts several minutes.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Work queue and scheduling"
        },
        {
            "text": "The scheduler itself was implemented using Postgres (for persistence and concurrency) and Flask (to pool connections and translate REST queries into SQL). The Flask layer allowed us to scale the cluster past the number of simultaneous sessions manageable by a single Postgres instance. The work queue can also be managed manually by the user, to perform operations such as re-attempt downloading of an SRA accession upon a failure or to pause an operation while debugging.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Work queue and scheduling"
        },
        {
            "text": "The system is designed to be fully self-scaling. An \"autoscaling controller\" was implemented which scales-in or scales-out the desired number of instances per task every five minutes based on the work queue. As a backstop, when all workers on an instance fail to receive work instructions from the scheduler, the instance is shut-down. Finally a \"job cleaner\" component checks the active jobs against currently running instances. If an instance has disappear due to SPOT termination or manual shutdown, it resets the job allowing it to be processed up by the next available instance.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Work queue and scheduling"
        },
        {
            "text": "To monitor cluster performance in real-time, we used Prometheus and node exporter to retrieve CPU, disk, memory, and networking statistics from each instance, postgres exporter to expose performance information about the work queue, and Python exporter to export information from the Flask server. This allowed us to identify and diagnose performance problems within minutes to avoid costly overruns.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Work queue and scheduling"
        },
        {
            "text": "We define a viral pangenome as the entire collection of reference sequences belonging to a taxonomic viral family, which may contain both full-length genomes and sequence fragments such as those based on RdRp amplicon sequencing.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generating viral summary reports"
        },
        {
            "text": "We developed a Summarizer module written in Python to provide a compact, human-and machine-readable synopsis of the alignments generated for each SRA dataset. The method was implemented in serratus summarizer.py for nucleotide alignment and serratus psummarizer.py for amino acid alignments. Reports generated by the Summarizer are text files with three sections described in detail online (https://github.com/ababaian/serratus/ wiki/.summary-Reports). In brief, each contains a header section with alignment meta-data and one-line summaries for each virus family pangenome, reference sequence and gene respectively, with gene summaries provided for protein alignments only.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generating viral summary reports"
        },
        {
            "text": "For each summary line we include descriptive statistics gathered from the alignment data such as the number of aligned reads, estimated read depth, mean alignment identity, and coverage, i.e. the distribution of reads across each reference sequence or pangenome. Coverage is measured by dividing a reference sequence into 25 equal bins and depicted as an ASCII text string of 25 symbols, one per bin; for example oaooomoUU:oWWUUWOWamWAAUW. Each symbol represents log 2 (n + 1) where n is the number of reads aligned to a bin in this order: .:uwaomUWAOM^. Thus, ' ' indicates no reads, '.' exactly one read, ':' two reads, 'u' 3-4 reads, 'w' 5-7 reads and so on; '^' represents > 2 13 = 8, 192 reads in the bin. For a pangenome, alignments to its reference sequences are projected onto a corresponding set of 25 bins. For a complete genome, the projected pangenome bin number 1, 2, . . . , 25 is the same as the reference sequence bin number. For a fragment, a bin is projected onto the pangenome bin implied by the alignment of the fragment to a complete genome. For example, if the start of a fragment aligns half way into a complete genome, bin 1 of the fragment is projected to bin 25 2 = 12 of the pangenome. The introduction of pangenome bins was motivated by the observation that bowtie2 selects an alignment at random when there are two or more top-scoring alignments, which tends to distribute coverage over several reference sequences when a single viral genome is present in the reads. Coverage of a single reference genome may therefore be fragmented, and binning to a pangenome better assesses coverage over a putative viral genome in the reads while retaining pangenome sequence diversity for detection.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generating viral summary reports"
        },
        {
            "text": "The Summarizer implements a binary classifier predicting the presence or absence of each virus family in the query. For a given family F , the classifier reports a score in the range [0,100] with the goal of assigning a high score to a dataset if it contains F and a low score if it does not. Setting a threshold on the score divides datasets into disjoint subsets representing predicted positive and negative detections of family F . The choice of threshold implies a trade-off between false positives and false negatives. Sorting by decreasing score ranks datasets in decreasing order of confidence that F is present in the reads.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification of viral families within a sequencing dataset"
        },
        {
            "text": "Naively, a natural measure of the presence of a virus family is the number of alignments to its reference sequences. However, alignments may be induced by non-homologous sequence similarity, for example low-complexity sequence. The score for a family was therefore designed to reflect the overall coverage of a pangenome because coverage across all or most of a pangenome is more likely to reflect true homology, i.e. the presence of a related virus. Ideally, coverage would be measured individually for each base in the reference sequence, but this could add undesirable overhead in compute time and memory for a process which is executed in the Linux alignment pipe (FASTQ decompression \u2192 aligner \u2192 Summarizer \u2192 alignment file compression). Coverage was therefore measured by binning as described above, which can be implemented with minimal overhead.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification of viral families within a sequencing dataset"
        },
        {
            "text": "A virus that is present in the reads with coverage too low to enable an assembly may have less practical value than an assembled genome. Also, genomes with lower identity to previously known sequences will tend to contain more novel biological information than genomes with high identity and will tend to have fewer alignments highly diverged segments. With these considerations in mind, the classifier was designed to give higher scores when coverage is high, read depth is high, and/or identity is low. This was accomplished as follows. Let H be the number of bins with at least 8 alignments to F , and L be the number of bins with from 1 to 7 alignments. Let S be the mean alignment percentage identity, and define the identity weight w = ( S 100 ) \u22123 , which is designed to give higher weight to lower identities, noting that w is close to one when identity is close to 100% and increases rapidly at lower identities. The classification score for family F is calculated as Z F = max(w(4H + L)), 100). By construction, Z F has a maximum of 100 when coverage is consistently high across a pangenome, and is also high when identity is low and coverage is moderate, which may reflect high read depth but many false negative alignments due to low identity. Thus, Z F is greater than zero when there is at least one alignment to F and assigns higher scores to SRA datasets which are more likely to support successful assembly of a virus belonging to F . )\" (date accessed: May 17th 2020). Retroviruses (n = 80) were excluded as preliminary testing yielded excessive numbers of alignments to transcribed endogenous retroviruses. Each sequence was annotated with its taxonomic family according to its RefSeq record; those for which no family was assigned by RefSeq (n = 81) were designated as \"unknown\".",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification of viral families within a sequencing dataset"
        },
        {
            "text": "The collection of these pangenomes was termed cov3m, and was the sequence reference used for this study.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification of viral families within a sequencing dataset"
        },
        {
            "text": "The protein search query was composed of the following sequences: (i) CoV proteins (method described under ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Amino acid search panproteome"
        },
        {
            "text": "To run Serratus, a target list of SRA run accessions is required. For this work, we designed target lists broadly classified as human, mouse, mammal, vertebrate, invertebrate, bat (including genome sequencing libraries), virome and metagenome (Extended Table 1c ). Each list contained accessions of RNA-seq, meta-genomic, and metatranscriptome runs for these organisms; some run accessions appeared in more than one list. Prior to each Serratus run, the lists were depleted for accessions already analyzed. Re-processing of a failed dataset was attempted at least twice. In total we were able to generate alignments to the query pangenomes for 3,837,755/4,059,695 (94.5%) of the targeted SRA accessions.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 253,
                    "end": 261,
                    "text": "Table 1c",
                    "ref_id": null
                }
            ],
            "section": "SRA search space"
        },
        {
            "text": "We implemented an on-going, multi-tiered release policy for code and data generated by this study, as follows. All code, electronic notebooks and raw data is immediately available at https://github.com/ababaian/serratus and on the s3://serratus-public/ bucket, respectively. Upon completion of a project milestone, a structured data-release is issued containing raw data into our viral data warehouse s3://lovelywater/. For example, at the time of writing the .bam alignment files from 3.84 million SRA runs are stored in s3://lovelywater/bam/X.bam;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "User interfaces for the Serratus databases"
        },
        {
            "text": ".summary files are s3://lovelywater/summary/X.summary, where X is a SRA run accession. These structured releases enable downstream and third-party programmatic access to the data. Summary files for every searched SRA dataset are parsed into a PostgreSQL relational database which can be queried remotely via an AWS Relational Database (RDS) server. This enables users and programs to perform complex operations such as retrieving summaries and meta-data for all SRA runs matching a given reference sequence with above a given classifier score threshold. For example, all records containing at least 20 aligned reads to Hepatitis Delta Virus (NC 001653.2) and the associated host taxonomy for the corresponding SRA datasets.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "User interfaces for the Serratus databases"
        },
        {
            "text": "For users unfamiliar with SQL queries we developed Tantalus (https://github.com/serratus-bio/tantalus, an R programming-language package which directly interfaces the Serratus RDS server to retrieve summary information as data-frames. Tantalus also offers functions to explore and visualize the data. Finally, the Serratus data can be explored via a graphical web interface by accession, virus, or viral family at https:/serratus.io. The website uses javascript to access the RDS server and create a graphical report with an overview of viral families found in each SRA accession matching a user query.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "User interfaces for the Serratus databases"
        },
        {
            "text": "All four data access interfaces are under ongoing development, receiving community feedback via their respective GitHub issue trackers to facilitate the translation of this data collection into an effective viral discovery resource. Documentation for data access methods is available at https://serratus.io/access 1.4 Viral assembly and annotation 1.4.1 coronaSPAdes RNA viral genome assembly faces several distinct challenges stemming from technical and biological bias in sequencing data. During library preparation, reverse transcription introduces 5 end coverage bias, and GC-content skew and secondary structures lead to unequal PCR amplification [48] . Technical bias is confounded by biological complexity such as intra-sample sequence variation due to transcript isoforms, as found in CoV [49] and/or to presence of multiple strains.",
            "cite_spans": [
                {
                    "start": 652,
                    "end": 656,
                    "text": "[48]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "User interfaces for the Serratus databases"
        },
        {
            "text": "To address the assembly challenges specific to RNA viruses, we developed coronaSPAdes, described in detail in a companion manuscript [50] . In brief, rnaviralSPAdes and the more specialized variant, coronaSPAdes, combines algorithms and methods from several previous approaches based on metaSPAdes [51], rnaSPAdes [52] and metaviralSPAdes [53] with a HMMPathExtension step. coronaSPAdes constructs an assembly graph from a RNA-sequencing dataset (transcriptome, meta-transcriptome, and meta-virome are supported), removing expected sequencing artifacts such as low-complexity (poly-A / poly-T) tips, edges, single-strand chimeric loops or doublestrand hairpins [52] and subspecies-bases variation [53] .",
            "cite_spans": [
                {
                    "start": 133,
                    "end": 137,
                    "text": "[50]",
                    "ref_id": null
                },
                {
                    "start": 697,
                    "end": 701,
                    "text": "[53]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "User interfaces for the Serratus databases"
        },
        {
            "text": "To deal with possible misassemblies and high-covered sequencing artifacts, a secondary HMMPathExtension step is performed to leverage orthogonal information about the expected viral genome. Protein domains are identified on all assembly graphs using a set of viral hidden Markov models (HMMs), and similar to biosyntheticSPAdes [54], HMMPathExtension attempts to find paths on the assembly graph which pass through significant HMM matches in order.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "User interfaces for the Serratus databases"
        },
        {
            "text": "coronaSPAdes is bundled with the Pfam SARS-CoV-2 set of HMMs [55], although these may be substituted by the user. This latter feature of coronaSPAdes was utilized for HDV assembly, where the HMM model of HDAg, the Hepatitis Delta Antigen, was used instead of Pfam SARS-CoV-2 set. Note that despite the name, these HMMs are quite general, modeling domains found in all coronavirus genera in addition to RdRp, which is found in many RNA virus families. Hits from these HMMs cover most bases in most known coronaviruse genomes, enabling the recovery of strain mixtures and splice variants.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "User interfaces for the Serratus databases"
        },
        {
            "text": "Accurate annotation of CoV genomes is challenging due to ribosomal frameshifts and polyproteins which are cleaved into maturation proteins [56] , and thus previously-annotated viral genomes offer a guide to accurate gene-calls and protein functional predictions. However, while many of the viral genomes we were likely to recover would be similar to previously-annotated genomes in Refseq or GenBank, we anticipated that many of the genomes would be taxonomically distant from any available reference. To address these constraints, we developed an annotation pipeline called DARTH [57] 1 which leverages both reference-based and ab initio annotation approaches.",
            "cite_spans": [
                {
                    "start": 139,
                    "end": 143,
                    "text": "[56]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Annotation of CoV assemblies"
        },
        {
            "text": "In brief, DARTH consists of the following phases: canonicalize the ordering and orientation of assembly contigs using conserved domain alignments, perform reference-based annotation of the contigs, annotate RNA secondary structure, ab intio gene-calling, generate files for aiding assembly and annotation diagnostics, and generate a master annotation file. It is important to put the contigs in the \"expected\" orientation and ordering to facilitate comparative analysis of synteny and as a requirement for genome deposition. To perform this canonicalization, DARTH generates the six-frame translation of the contigs using the transeq [58] and uses HMMER3 [59] to search the translations for Pfam domain models specific to CoV [60] . DARTH compares the Pfam accessions from the HMMER alignment to the NCBI SARS-CoV-2 reference genome (NCBI Nucleotide accession NC 045512.2) to determine the correct ordering and orientation, and produces an updated assembly FASTA file. DARTH performs reference-based annotation using VADR [61] , which provides a set of genome models for all CoV RefSeq genomes [62] . VADR provides annotations of gene coordinates, polyprotein cleavage sites, and functional annotation of all proteins. DARTH supplements the VADR annotation by using Infernal [63] to scan the contigs against the SARS-CoV-2 Rfam release [64] which provides updated models of CoV 5 and 3 untranslated regions (UTRs) along with stem-loop structures associated with programmed ribosomal frame-shifts. While VADR provides reference-based gene-calling, DARTH also provides ab initio gene-calling by using FragGeneScan [65] , a frameshift-aware gene caller. DARTH also generates auxiliary files which are useful for assembly quality and annotation diagnostics, such as indexed BAM files created with SAMtools [66] representing self-alignment of the trimmed reads to the canonicalized assembly using bowtie2 [44], and variant-calls using bcftools from SAMtools. DARTH generates these files so that the can be easily loaded into a genome browser such as JBrowse [67] or IGV [68] . As the final step DARTH generates a single Generic Feature Format (GFF) 3.0 file [69] containing combined set of annotation information described above, ready for use in a genome browser, or for submitting the annotation and sequence to a genome repository.",
            "cite_spans": [
                {
                    "start": 726,
                    "end": 730,
                    "text": "[60]",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 1022,
                    "end": 1026,
                    "text": "[61]",
                    "ref_id": "BIBREF20"
                },
                {
                    "start": 1094,
                    "end": 1098,
                    "text": "[62]",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 1275,
                    "end": 1279,
                    "text": "[63]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 1336,
                    "end": 1340,
                    "text": "[64]",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 1612,
                    "end": 1616,
                    "text": "[65]",
                    "ref_id": "BIBREF24"
                },
                {
                    "start": 1802,
                    "end": 1806,
                    "text": "[66]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 2053,
                    "end": 2057,
                    "text": "[67]",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 2065,
                    "end": 2069,
                    "text": "[68]",
                    "ref_id": "BIBREF27"
                },
                {
                    "start": 2153,
                    "end": 2157,
                    "text": "[69]",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [],
            "section": "Annotation of CoV assemblies"
        },
        {
            "text": "The Serratus searches described above identified 37,131 libraries (14,304 by nucleotide and 23,898 by amino acid) as potentially positive for CoV (score \u226520 and \u226510 reads). To supplement this search we also employed a recently developed index of the SRA called STAT [5] with which identified an additional 18,584 SRA datasets not in the defined SRA search space. The STAT BigQuery was WHERE tax id=11118 AND total count >1\" accessed on June 24th 2020.",
            "cite_spans": [
                {
                    "start": 266,
                    "end": 269,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "Deploying the assembly and annotation workflow"
        },
        {
            "text": "We used AWS Batch to launch thousands of assemblies of NCBI accessions simultaneously. The workflow consists of four standard parts: a job queue, a job definition, a compute environment, and finally, the jobs themselves. A CloudFormation template 2 was created for building all parts of the cloud infrastructure from the command line.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Deploying the assembly and annotation workflow"
        },
        {
            "text": "The job definition specifies a Docker image, and asks for 8 virtual CPUs (vCPUs, corresponding to threads) and 60 GB of memory per job, corresponding to a reasonable allocation for coronaSPAdes. The compute environment is the most involved component. We set it to run jobs on cost-effective Spot instances (optimal setting) with an additional cost-optimization strategy (SPOT CAPACITY OPTIMIZED setting), and allowing up to 40,000 vCPUs total. In addition, the compute environment specifies a launch template which, on each instance, i) automatically mounts an exclusive 1 TB EBS volume, allowing sufficient disk space for several concurrent assemblies, and ii) downloads the 5.4 GB CheckV database, to avoid bloating the Docker image.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Deploying the assembly and annotation workflow"
        },
        {
            "text": "The peak AWS usage of our Batch infrastructure was 28,000 vCPUs, performing 3,500 assemblies simultaneously. A total of 46,861 accessions out of 55,715 were assembled in a single day. They were then analysed by two methods to detect putative CoV contigs. The first method is CheckV, followed selecting contigs associated to known CoV genomes. The second method is a custom script 3 that parses coronaSPAdes BGC candidates and keeps contigs containing CoV domain(s). For each accession, we kept the set of contigs obtained by the first method (CheckV) if it is non-empty, and otherwise we kept the set of contigs from the second method (BGC). A majority (76%) of the assemblies were discarded for one of the following reasons: i) no CoV contigs were found by either filtering method, ii) reads were too short to be assembled, iii) Batch job or SRA download failed, or iv) coronaSPAdes ran out of memory. A total of 11,120 assemblies were considered for further analysis.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Deploying the assembly and annotation workflow"
        },
        {
            "text": "With RNA-seq metagenomic reads, the number of reads per base may be highly variable at different locations in a viral genome. Regions of high coverage may be adjacent to regions with low coverage or no reads, causing breaks between contigs. Thus, a given base in a contig may have only one or very few reads as evidence, and as a consequence the reliability of base calls may be low in some regions of the assembly which could degrade inference of biological variations between genomes. The assemblers used in this work do not provide a per-base quality score, and to address this issue we used two complementary approaches: (1) reporting contig average coverage as a proxy for quality, and (2) self-aligning reads to the assembly sequence and calling variants to enable facile visual inspection of per-base coverage levels and significant variants in genome browsers (see Section 1.4.2).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Per-base quality assessment of assembly contigs"
        },
        {
            "text": "We developed a module, SerraTax, to predict taxonomy for CoV genomes and assemblies (https://github. com/ababaian/serratus/tree/master/containers/serratax). SerraTax was designed with the following requirements in mind: provide taxonomy predictions for fragmented and partial assemblies in addition to complete genomes; report best-estimate predictions balancing over-classification and under-classification (too many and too few ranks, respectively); and assign an NCBI Taxonomy Database [70] identifier (TaxID).",
            "cite_spans": [
                {
                    "start": 489,
                    "end": 493,
                    "text": "[70]",
                    "ref_id": "BIBREF29"
                }
            ],
            "ref_spans": [],
            "section": "Taxonomy prediction for coronavirus genomes"
        },
        {
            "text": "Assigning a best-fit TaxID was not supported by any previously published taxonomy prediction software to the best of our knowledge; this requires assignment to intermediate ranks such as sub-genus and ranks below species (commonly called strains, but these ranks are not named in the Taxonomy database), and to unclassified taxa, e.g. TaxID 2724161, unclassified Buldecovirus, in cases where the genome is predicted to fall inside a named clade but outside all named taxa within that clade.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Taxonomy prediction for coronavirus genomes"
        },
        {
            "text": "SerraTax uses a reference database containing domain sequences with TaxIDs. This database was constructed as follows. Records annoated as CoV were downloaded from UniProt [71] , and chain sequences were extracted. Each chain name, e.g. Helicase, was considered to be a separate domain. ",
            "cite_spans": [
                {
                    "start": 171,
                    "end": 175,
                    "text": "[71]",
                    "ref_id": "BIBREF30"
                }
            ],
            "ref_spans": [],
            "section": "Taxonomy prediction for coronavirus genomes"
        },
        {
            "text": "To generate an alternate taxonomic annotation of an assembled genome, we created a pipeline based on phylogenetic placement, SerraPlace.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Taxonomic assignment by phylogenetic placement"
        },
        {
            "text": "To perform phylogenetic placement, a reference phylogenetic tree is required. To this end, we collected 823 reference amino acid RdRp sequences, spanning all Coronaviridae. To this set we added an outgroup RdRp sequence from the Torovirus family (NC 007447). We clustered the sequences to 99% identity using USEARCH ([46] , UCLUST algorithm, v11.0.667), resulting in 546 centroid sequences. Subsequently we performed multiple sequence alignment on the clustered sequences using MUSCLE ( [72] , v3.8.31). We then performed maximum likelihood tree inference using RAxML-NG ( [73] , PROTGTR+FO+G4, v0.9.0), resulting in our reference tree.",
            "cite_spans": [
                {
                    "start": 316,
                    "end": 321,
                    "text": "([46]",
                    "ref_id": null
                },
                {
                    "start": 487,
                    "end": 491,
                    "text": "[72]",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 573,
                    "end": 577,
                    "text": "[73]",
                    "ref_id": "BIBREF32"
                }
            ],
            "ref_spans": [],
            "section": "Taxonomic assignment by phylogenetic placement"
        },
        {
            "text": "To apply SerraPlace to a given genome, we first use HMMER ([59], v3.3) to generate a reference HMM, based on the reference alignment. We then split each contig into ORFs using esl-translate, and use hmmsearch (p-value cutoff 0.01) to identify those query ORFs that align with sufficient quality to the previously generated reference HMM. All ORFs that pass this test are considered valid input sequences for phylogenetic placement. Subsequently, we use EPA-ng ( [74] , v0.3.7) to place each sequence on the RdRp reference tree. This produces a set of likely placement locations on the tree, with an associated likelihood weight. We then use Gappa ( [75] , v0.6.1) to assign taxonomic information to each query, using the taxonomic information for the reference sequences. Gappa assigns taxonomy by first labelling the interior nodes of the reference tree by a consensus of the taxonomic labels of all descendant leaves of that node. If 66% of leaves share the same taxonomic label up to some level, then the internal node is assigned that label. Then, the likelihood weight associated with each sequence is assigned to the labels of internal nodes of the reference tree, according to where the query was placed.",
            "cite_spans": [
                {
                    "start": 462,
                    "end": 466,
                    "text": "[74]",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 649,
                    "end": 653,
                    "text": "[75]",
                    "ref_id": "BIBREF34"
                }
            ],
            "ref_spans": [],
            "section": "Taxonomic assignment by phylogenetic placement"
        },
        {
            "text": "From this result, we select that taxonomic label that accumulated the highest total likelihood weight as the taxonomic label of a sequence. Note that multiple ORFs of the same genome may result in a taxonomic label, in which case, we select the longest sequence as the source of the taxonomic assignment of the genome.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Taxonomic assignment by phylogenetic placement"
        },
        {
            "text": "We performed phylogenetic inferences using a custom snakemake pipeline (available at https://github.com/ lczech/nidhoggr), using ParGenes ( [76] , v1.1.2). ParGenes is a treesearch orchestrator, build on top of ModelTest-NG [77] and RAxMLNG, enabling higher levels of parallelisation for a given tree search.",
            "cite_spans": [
                {
                    "start": 140,
                    "end": 144,
                    "text": "[76]",
                    "ref_id": "BIBREF35"
                },
                {
                    "start": 224,
                    "end": 228,
                    "text": "[77]",
                    "ref_id": "BIBREF36"
                }
            ],
            "ref_spans": [],
            "section": "Phylogenetic inference"
        },
        {
            "text": "To infer the maximum likelihood phylogenetic tree displayed in Extended Figure 2 , we performed a tree search comprising 100 distinct starting trees (50 random, 50 parsimony), as well as 1000 bootstrap searches. We used ModelTestNG to automatically select the best evolutionary model, which in this case was LG+IU+G4m. The pipeline also automatically produces versions of the best maximum likelihood tree annotated with Felsenstein's Bootstrap ( [78] ) support values, and Transfer Bootstrap Expectation ([79]) values, the latter of which was used in Extended Figure 2 .",
            "cite_spans": [
                {
                    "start": 446,
                    "end": 450,
                    "text": "[78]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 72,
                    "end": 80,
                    "text": "Figure 2",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 560,
                    "end": 568,
                    "text": "Figure 2",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Phylogenetic inference"
        },
        {
            "text": "Archival copies of all code generated for this study is available at https://github.com/serratus-bio. Electronic notebooks for experiments are available at https://github.com/ababaian/serratus. Access to all data generated in this study can be accessed at https://serratus.io/access. Assembled genomes contigs for this study are available at https://serratus.io/access pending deposition into public repositories.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data availability"
        },
        {
            "text": "Extended Table 1 : SRA run queries and search nucleotide accessions. Queries and accessions from this study. a SRA queries to retrieve collections of datasets. b Nucleotide accessions compiled into the cov3ma reference query and c the sequence masked applied to those sequences.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 9,
                    "end": 16,
                    "text": "Table 1",
                    "ref_id": null
                }
            ],
            "section": "Data availability"
        },
        {
            "text": "Extended Table 2 : Assembled Coronaviridae in the SRA. a Run accessions, assembly statistics and select meta-data for the 11,120 runs for which Coronaviridae, or Coronaviridae-like sequences were assembled. b Assignment of assembled runs to operational taxonomic units (OTUs) based on 97% identity of the RNA dependent RNA polymerase (RdRp) domain. c Assignment of GenBank records to RdRp OTUs. d Assignment of expected viral host for GenBank records. e Taxonomic source for RdRp containing assemblies. f Supporting data for Figure  1 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 9,
                    "end": 16,
                    "text": "Table 2",
                    "ref_id": null
                },
                {
                    "start": 525,
                    "end": 534,
                    "text": "Figure  1",
                    "ref_id": null
                }
            ],
            "section": "Data availability"
        },
        {
            "text": "Extended Figure 1 : Overview of the Serratus architecture. a Schematic and data workflow (b) as described in the methods for aligning to the viral pangenome (c). d A nucleotide alignment completion rate for Serratus shows stable and linear performance to complete 1.29 million SRA accessions in a 24-hour period. e Cost breakdown for this run. Compute costs between modules are an approximate comparison of CPU requirements of each step. The total average cost per completed SRA accession was $0.0062 US dollars or $0.1892 US dollars per terabase processed.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 9,
                    "end": 17,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Extended Tables"
        },
        {
            "text": "Extended Figure 5 : Distribution of DNA and Other viral families in the SRA The total number of datasets matching each DNA or other viral pangenome, binned by the average nucleotide identity and colored by score (see methods). An interactive and queryable version of this plot is available at https://serratus.io/family. Figure 7 : Deltavirus ribozymes evolutionary history a Multiple sequence alignment of the genomic and anti-genomic deltavirus ribozymes based on MUSCLE [72] and refined manually based on secondary structure. The shortening of the J1/2 loop and presence of the LG loop is specific to and conserved within the genomic ribozyme. Consensus secondary structure of the b genomic and c anti-genomic ribozymes. d Maximum-likelihood tree based on concatenated ribozyme sequences supports the topology of the \u03b4Ag amino-acid tree (Figure 3) ",
            "cite_spans": [
                {
                    "start": 473,
                    "end": 477,
                    "text": "[72]",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [
                {
                    "start": 9,
                    "end": 17,
                    "text": "Figure 5",
                    "ref_id": null
                },
                {
                    "start": 321,
                    "end": 329,
                    "text": "Figure 7",
                    "ref_id": null
                },
                {
                    "start": 840,
                    "end": 850,
                    "text": "(Figure 3)",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Extended Tables"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "A Strategy To Estimate Unknown Viral Diversity in Mammals",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "J"
                    ],
                    "last": "Anthony",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Global trends in emerging infectious diseases. eng",
            "authors": [
                {
                    "first": "K",
                    "middle": [
                        "E"
                    ],
                    "last": "Jones",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Nature",
            "volume": "451",
            "issn": "",
            "pages": "1476--4687",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Global shifts in mammalian population trends reveal key predictors of virus spillover risk",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "K"
                    ],
                    "last": "Johnson",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Proceedings of the Royal Society B: Biological Sciences",
            "volume": "287",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1098/rspb.2019.2736"
                ]
            }
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "The Global Virome Project. en",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Carroll",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Science",
            "volume": "359",
            "issn": "",
            "pages": "1095--9203",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "The Sequence Read Archive",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Leinonen",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Sugawara",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Shumway",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Nucleic Acids Research",
            "volume": "39",
            "issn": "",
            "pages": "",
            "other_ids": {
                "PMCID": [
                    "PMC3013647"
                ]
            }
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "The sensitivity of massively parallel sequencing for detecting candidate infectious agents associated with human tissue. eng",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "A"
                    ],
                    "last": "Moore",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "PloS One",
            "volume": "6",
            "issn": "",
            "pages": "1932--6203",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Demographic and environmental drivers of metagenomic viral diversity in vampire bats. en",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "M"
                    ],
                    "last": "Bergner",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Molecular Ecology",
            "volume": "29",
            "issn": "",
            "pages": "1365--294",
            "other_ids": {
                "DOI": [
                    "10.1111/mec.15250"
                ]
            }
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Comparative analysis of rodent and small mammal viromes to better understand the wildlife origin of emerging infectious diseases",
            "authors": [
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Wu",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "6",
            "issn": "",
            "pages": "2049--2618",
            "other_ids": {
                "DOI": [
                    "10.1186/s40168-018-0554-9"
                ]
            }
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Description and initial characterization of metatranscriptomic nidovirus-like genomes from the proposed new family Abyssoviridae, and from a sister group to the Coronavirinae, the proposed genus Alphaletovirus",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Bukhari",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Virology",
            "volume": "524",
            "issn": "",
            "pages": "42--6822",
            "other_ids": {
                "PMCID": [
                    "PMC7112036"
                ]
            }
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Endangered wild salmon infected by newly discovered viruses",
            "authors": [
                {
                    "first": "G",
                    "middle": [
                        "J"
                    ],
                    "last": "Mordecai",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "2050--084",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Comparative population genomics in animals uncovers the determinants of genetic diversity. en",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Romiguier",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Nature",
            "volume": "515",
            "issn": "",
            "pages": "1476--4687",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Blastemal progenitors modulate immune signaling during early limb regeneration",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "L"
                    ],
                    "last": "Tsai",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Baselga-Garriga",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "A"
                    ],
                    "last": "Melton",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "1477--9129",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Midkine is a dual regulator of wound epidermis development and inflammation during the initiation of limb regeneration",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "L"
                    ],
                    "last": "Tsai",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Baselga-Garriga",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "A"
                    ],
                    "last": "Melton",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "J.) e50765. issn",
            "volume": "",
            "issn": "9",
            "pages": "2050--084",
            "other_ids": {
                "DOI": [
                    "10.7554/eLife.50765"
                ]
            }
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "AP-1 cFos/JunB /miR-200a regulate the pro-regenerative glial cell response during axolotl spinal cord regeneration. en",
            "authors": [
                {
                    "first": "K",
                    "middle": [
                        "Z"
                    ],
                    "last": "Sabin",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Jiang",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "D"
                    ],
                    "last": "Gearhart",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Stewart",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Echeverri",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Communications Biology",
            "volume": "2",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Pyrexia of unknown origin",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Fernandez",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "J"
                    ],
                    "last": "Beeching",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Clinical Medicine",
            "volume": "18",
            "issn": "",
            "pages": "1470--2118",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Sequence Analysis of the Human Virome in Febrile and Afebrile Children",
            "authors": [
                {
                    "first": "K",
                    "middle": [
                        "M"
                    ],
                    "last": "Wylie",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [
                        "A"
                    ],
                    "last": "Mihindukulasuriya",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [],
                    "last": "Sodergren",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "M"
                    ],
                    "last": "Weinstock",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "A"
                    ],
                    "last": "Storch",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "PLoS ONE",
            "volume": "7",
            "issn": "",
            "pages": "1932--6203",
            "other_ids": {
                "PMCID": [
                    "PMC3374612"
                ]
            }
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Mouse hepatitis virus strain JHM infects a human hepatocellular carcinoma cell line. eng",
            "authors": [
                {
                    "first": "P",
                    "middle": [
                        "J"
                    ],
                    "last": "Koetters",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Hassanieh",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "A"
                    ],
                    "last": "Stohlman",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Gallagher",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "M"
                    ],
                    "last": "Lai",
                    "suffix": ""
                }
            ],
            "year": 1999,
            "venue": "Virology",
            "volume": "264",
            "issn": "",
            "pages": "42--6822",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "The global burden of viral hepatitis from 1990 to 2013: findings from the Global Burden of Disease Study",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "D"
                    ],
                    "last": "Stanaway",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "English. The Lancet",
            "volume": "388",
            "issn": "16",
            "pages": "1474--547",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "Infection by Hepatitis Delta Virus. en",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Taylor",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Viruses",
            "volume": "12",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Pfam SARS-CoV-2 special update (part 2) en. Library Catalog: xfam.wordpress.com",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "P"
                    ],
                    "last": "Team",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "VADR: validation and annotation of virus sequence submissions to GenBank",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "A"
                    ],
                    "last": "Sch\u00e4ffer",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "BMC Bioinformatics",
            "volume": "21",
            "issn": "",
            "pages": "1471--2105",
            "other_ids": {
                "DOI": [
                    "10.1186/s12859-020-3537-3"
                ]
            }
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Coronavirus annotation using VADR en. Library Catalog: github",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Nawrocki",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Infernal 1.1: 100-fold faster RNA homology searches",
            "authors": [
                {
                    "first": "E",
                    "middle": [
                        "P"
                    ],
                    "last": "Nawrocki",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "R"
                    ],
                    "last": "Eddy",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Bioinformatics",
            "volume": "29",
            "issn": "",
            "pages": "1367--4803",
            "other_ids": {
                "PMCID": [
                    "PMC3810854"
                ]
            }
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Rfam Coronavirus Special Release en. Library Catalog: xfam.wordpress.com",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "R"
                    ],
                    "last": "Team",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "FragGeneScan: predicting genes in short and error-prone reads. en",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Rho",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Tang",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Ye",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Nucleic Acids Research",
            "volume": "38",
            "issn": "",
            "pages": "305--1048",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "The Sequence Alignment/Map format and SAMtools. eng",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Bioinformatics",
            "volume": "25",
            "issn": "",
            "pages": "1367--4811",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "JBrowse: a dynamic web platform for genome visualization and analysis. eng",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Buels",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Genome Biology",
            "volume": "17",
            "issn": "",
            "pages": "1474--760",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "Publisher: American Association for Cancer Research Section: Focus on Computer Resources",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "T"
                    ],
                    "last": "Robinson",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Thorvaldsd\u00f3ttir",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "M"
                    ],
                    "last": "Wenger",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Zehir",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "P"
                    ],
                    "last": "Mesirov",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Cancer Research",
            "volume": "77",
            "issn": "",
            "pages": "1538--7445",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "The Sequence Ontology: a tool for the unification of genome annotations",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Eilbeck",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Genome Biology",
            "volume": "6",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1186/gb-2005-6-5-r44"
                ]
            }
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "The NCBI Taxonomy database",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Federhen",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Nucleic Acids Research",
            "volume": "40",
            "issn": "",
            "pages": "305--1048",
            "other_ids": {
                "DOI": [
                    "10.1093/nar/gkr1178"
                ]
            }
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "UniProt: a worldwide hub of protein knowledge",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "U"
                    ],
                    "last": "Consortium",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Nucleic Acids Research",
            "volume": "47",
            "issn": "",
            "pages": "305--1048",
            "other_ids": {
                "DOI": [
                    "10.1093/nar/gky1049"
                ]
            }
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "MUSCLE: multiple sequence alignment with high accuracy and high throughput",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "C"
                    ],
                    "last": "Edgar",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Nucleic Acids Research",
            "volume": "32",
            "issn": "",
            "pages": "305--1048",
            "other_ids": {
                "DOI": [
                    "10.1093/nar/gkh340"
                ]
            }
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "RAxML-NG: a fast, scalable and userfriendly tool for maximum likelihood phylogenetic inference. en",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "M"
                    ],
                    "last": "Kozlov",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Darriba",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Flouri",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Morel",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Stamatakis",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Bioinformatics",
            "volume": "35",
            "issn": "",
            "pages": "1367--4803",
            "other_ids": {}
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "EPA-ng: Massively Parallel Evolutionary Placement of Genetic Sequences. en",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Barbera",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Systematic Biology",
            "volume": "68",
            "issn": "",
            "pages": "1063--5157",
            "other_ids": {}
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "Genesis and Gappa: processing, analyzing and visualizing phylogenetic (placement) data",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Czech",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Barbera",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Stamatakis",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Bioinformatics",
            "volume": "",
            "issn": "",
            "pages": "1367--4803",
            "other_ids": {
                "DOI": [
                    "10.1093/bioinformatics/btaa070/5722201"
                ]
            }
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "ParGenes: a tool for massively parallel model selection and phylogenetic tree inference on thousands of genes. en",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Morel",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "M"
                    ],
                    "last": "Kozlov",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Stamatakis",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Bioinformatics",
            "volume": "35",
            "issn": "",
            "pages": "1367--4803",
            "other_ids": {}
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "ModelTest-NG: A New and Scalable Tool for the Selection of DNA and Protein Evolutionary Models. en",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Darriba",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Molecular Biology and Evolution",
            "volume": "37",
            "issn": "",
            "pages": "737--4038",
            "other_ids": {}
        },
        "BIBREF38": {
            "ref_id": "b38",
            "title": "Tobaniviridae (T), and Roniviridae (R). b Distribution of pair-wise sequence identities for RdRp sequences within and between distinct taxa at species, subgenus and genus rank, respectively. c Distribution of pair-wise RdRp identities for Coronaviridae genera",
            "authors": [],
            "year": null,
            "venue": "Phylogenetic relationships of Coronaviridae and related OTUs. a Maximum likelihood",
            "volume": "2",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF39": {
            "ref_id": "b39",
            "title": "Hidden Markov Model (HMM) protein domain matches from the RdRp containing contigs or reference sequences for 47 exemplar operational taxonomic units (OTUs) grouped by genus",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF40": {
            "ref_id": "b40",
            "title": "Extended Figure 6: Newly characterised Deltavirus genomes Genome structure and organisation of the five Deltaviruses (PmacDV SRR7910143; MmonDV SRR2136906; OvirDV SRR4256033; TgutDV SRR5001850; and IchiDV SRR8954566) and one Deltavirus-like (BglaDVL SRR8242383; for which we could not identify a ribozyme sequence) sequence identified in our study. Each circular RNA virus shows characteristic rod-like genome folding and low free-energy (\u03b4G), similar to a Hepatitis Delta Virus positive control, and two ribozymes and",
            "authors": [],
            "year": null,
            "venue": "Distribution of RNA viral families in the SRA The total number of datasets matching each RNA viral pangenome, binned by the average nucleotide identity taken from the alignment CIGAR string",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Estimated assemblable RNA virome across the SRA Per-family distribution of the 31,074 highconfidence matches (score \u226580, indicating the presence of a virus with a high probability of being assembled) in the 3.84 million SRA datasets searched by Serratus. Colour from yellow=100% to purple=75% indicates percentage nucleotide identity, with area proportional to count. Picornaviridae and Reoviridae are enriched for high-confidence, low-identity viruses relative to other RNA viruses. See ExtendedFigure 4for a detailed breakdown of RNA-viruses and ExtendedFigure 5for DNA-viruses.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Novel deltaviruses a Maximum-likelihood phylogenetic tree of mammalian deltaviruses (DV) derived from a delta-antigen protein alignment; bootstrap values are shown at selected nodes. Labels are MmonDV: Marmota monax Deltavirus; DrDV: Desmodus Rotundus Deltavirus-A and B; RDeV: Spiny rat Deltavirus; OvirDV: Odocoileus virginianus Deltavirus [27]; PmacDV: Peropteryx macrotis Deltavirus; HDV: Hepatitis Deltavirus clades; and three unplaced non-mammalian DV identified in this study; TgutDV: Taeniopygia guttata Deltavirus [28]; BglaDV: Benthosema glaciale Deltavirus; IchiDV: Indirana chiravasi Deltavirus. See Extended Figure 7 for supporting ribozyme phylogeny. b Genome structure for MmonDV and other novel DV (Extended Figure 6) containing; a negative-sense delta-antigen (\u03b4Ag) open reading frame; two ribozymes; and characteristic rod-like folding, where each connecting line shows the predicted base-pairing within the single stranded RNA genome, coloured by confidence (p-num)[29]. The . c MmonDV was identified in reads from a study using RNA-seq to determine the effect of interferon-\u03b1 treatment on animals infected with Woodchuck Hepatitis Virus (WHV)[30]. MmonDV reads were present in samples from four separate animals, all co-infected with WHV, with viral expression measured in reads per kilobase million (RPKM).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Phylogenetic analysis using the terminase protein of newly recovered and previously reported phages. a Tree showing phage clade expansion through the addition of new sequences. Black dots indicate branches with bootstrap values >90. Outer ring indicates genome or genome fragment length: gray are sequences from [33] and reference sequences, shadings indicate previously defined clades of phages with very large genomes (200 -735 kbp). The Kabirphages (light purple) are shown in expanded view in b The expansion of the Kabirphage clade by newly recovered sequences from different animal types (colored dots). Red branches are public data recovered by Serratus, black branches indicate the genomes with terminase sequences that were a included in the phage panproteome.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "(v2.3.4.1, --very-sensitive-local) [44] for nucleotide search, or diamond (v0.9.31, --unal 0 -k 1 -b 0.35) [45] for translated-protein search. Finally, the merge module concatenates the aligned blocks into a single output file (.bam for nucleotide, or .pro for protein) and generates alignment statistics with a Python script (see Summarizer below).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "SerraTax); (ii) all CDS annotated from RefSeqs in the nucleotide query; (iii) deltavirus antigen proteins from accessions NC 001653, M21012, X60193, L22063, AF018077, AJ584848, AJ584847, AJ584844, AJ584849, MT649207, MT649208, MT649206, NC 040845, NC 040729, MN031240, MN031239, MK962760, and MK962759 (iv) large terminase (TerL), viral DNA-packaging protein and major capsid protein (MCP) for the huge phage clades reported in [Al-Shayeb & Sachdeva et al 2020 TODO citation].",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "Palom, A. et al. Long-term clinical outcomes in patients with chronic hepatitis delta: the role of persistent viraemia. eng. Alimentary Pharmacology & Therapeutics 51, 158-166. issn: 1365-2036 (2020). 21. Szirovicza, L. et al. Snake Deltavirus Utilizes Envelope Proteins of Different Viruses To Generate Infectious Particles. eng. mBio 11. issn: 2150-7511 (2020). 22. Wille, M. et al. A Divergent Hepatitis D-Like Agent in Birds. Viruses 10. issn: 1999-4915. https://www. 27. Seabury, C. M. et al. Genome-wide polymorphism and comparative analyses in the white-tailed deer (Odocoileus virginianus): a model for conservation genomics. eng. PloS One 6, e15811. issn: 1932-6203 (Jan. 2011). 28. Newhouse, D. J., Hofmeister, E. K. & Balakrishnan, C. N. Transcriptional response to West Nile virus infection in the zebra finch (Taeniopygia guttata). eng. Royal Society Open Science 4, 170296. issn: 2054-5703 (June 2017). 29. Zuker, M. Mfold web server for nucleic acid folding and hybridization prediction. en. Nucleic Acids Research 31, 3406-3415. issn: 0305-1048. https://academic.oup.com/nar/article/31/13/3406/2904217 (2020) (July 2003). 30. Fletcher, S. P. et al. Intrahepatic Transcriptional Signature Associated with Response to Interferon-\u03b1 Treatment in the Woodchuck Model of Chronic Hepatitis B. en. PLOS Pathogens 11, e1005103. issn: 1553-7374. https://journals.plos.org/plospathogens/article?id=10.1371/journal.ppat.1005103 (2020) (Sept. 2015). 31. Negro, F. et al. Hepatitis delta virus (HDV) and woodchuck hepatitis virus (WHV) nucleic acids in tissues of HDV-infected chronic WHV carrier woodchucks. eng. Journal of Virology 63, 1612-1618. issn: 0022-538X (Apr. 1989). 32. Aldabe, R., Su\u00e1rez-Amar\u00e1n, L., Usai, C. & Gonz\u00e1lez-Aseguinolaza, G. Animal Models of Chronic Hepatitis Delta Virus Infection Host-Virus Immunologic Interactions. Pathogens 4, 46-65. issn: 2076-0817. https : //www.ncbi.nlm.nih.gov/pmc/articles/PMC4384072/ (2020) (Feb. 2015). 33. Al-Shayeb, B. et al. Clades of huge phages from across Earth's ecosystems. en. Nature 578, 425-431. issn: 1476-4687. https://www.nature.com/articles/s41586-020-2007-4 (2020) (Feb. 2020). 34. Devoto, A. E. et al. Megaphages infect Prevotella and variants are widespread in gut microbiomes. en. Nature Microbiology 4, 693-700. issn: 2058-5276. https://www.nature.com/articles/s41564-018-0338-9 (2020) (Apr. 2019). 35. The Cost of Sequencing a Human Genome en. https://www.genome.gov/about-genomics/fact-sheets/ Sequencing-Human-Genome-cost (2020). 36. Milham, M. P. et al. Assessment of the impact of shared brain imaging data on the scientific literature. en. Nature Communications 9, 1-7. issn: 2041-1723. https://www.nature.com/articles/s41467-018-04976-1 (2020) (July 2018). 37. Lee, Y. N. & Bieniasz, P. D. Reconstitution of an infectious human endogenous retrovirus. eng. PLoS pathogens 3, e10. issn: 1553-7374 (Jan. 2007). 38. Becker, M. M. et al. Synthetic recombinant bat SARS-like coronavirus is infectious in cultured cells and in mice. eng. Proceedings of the National Academy of Sciences of the United States of America 105, 19944-19949. issn: 1091-6490 (Dec. 2008). 39. Letko, M., Seifert, S. N., Olival, K. J., Plowright, R. K. & Munster, V. J. Bat-borne virus diversity, spillover and emergence. en. Nature Reviews Microbiology 18, 461-471. issn: 1740-1534. https://www.nature.com/ articles/s41579-020-0394-z (2020) (Aug. 2020). 40. Letko, M., Marzi, A. & Munster, V. Functional assessment of cell entry and receptor usage for SARS-CoV-2 and other lineage B betacoronaviruses. en. Nature Microbiology 5, 562-569. issn: 2058-5276. https://www. nature.com/articles/s41564-020-0688-y (2020) (Apr. 2020). 41. Damas, J. et al. Broad Host Range of SARS-CoV-2 Predicted by Comparative and Structural Analysis of ACE2 in Vertebrates. bioRxiv. https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7263403/ (2020) (Apr. 2020). 42. D\u00edaz, S. et al. Pervasive human-driven decline of life on Earth points to the need for transformative change. eng. Science (New York, N.Y.) 366. issn: 1095-9203 (2019). 43. Chase, J. M., Blowes, S. A., Knight, T. M., Gerstner, K. & May, F. Ecosystem decay exacerbates biodiversity loss with habitat loss. en. Nature, 1-6. issn: 1476-4687. https://www.nature.com/articles/s41586Langmead, B. & Salzberg, S. L. Fast gapped-read alignment with Bowtie 2. en. Nature Methods 9, 357-359. issn: 1548-7105. https://www.nature.com/articles/nmeth.1923 (2020) (Apr. 2012). 45. Buchfink, B., Xie, C. & Huson, D. H. Fast and sensitive protein alignment using DIAMOND. en. Nature Methods 12, 59-60. issn: 1548-7105. https://www.nature.com/articles/nmeth.3176 (2020) (Jan. 2015). 46. Edgar, R. C. Search and clustering orders of magnitude faster than BLAST. Bioinformatics 26, 2460-2461. issn: 1367-4803. eprint: https : / / academic . oup . com / bioinformatics / article -pdf / 26 / 19 / 2460 / 16896486/btq461.pdf. https://doi.org/10.1093/bioinformatics/btq461 (Aug. 2010). 47. Morgulis, A., Gertz, E. M., Sch\u00e4ffer, A. A. & Agarwala, R. A fast and symmetric DUST implementation to mask low-complexity DNA sequences. eng. Journal of Computational Biology: A Journal of Computational Molecular Cell Biology 13, 1028-1040. issn: 1066-5277 (June 2006). 48. Hunt, M. et al. IVA: accurate de novo assembly of RNA virus genomes. Bioinformatics 31, 2374-2376. issn: 1367-4803. https://doi.org/10.1093/bioinformatics/btv120 (Feb. 2015). Bushmanova, E., Antipov, D., Lapidus, A. & Prjibelski, A. D. rnaSPAdes: a de novo transcriptome assembler and its application to RNA-Seq data. GigaScience 8. giz100. issn: 2047-217X. https://doi.org/10.1093/ gigascience/giz100 (Sept. 2019). 53. Antipov, D., Raiko, M., Lapidus, A. & Pevzner, P. A. MetaviralSPAdes: assembly of viruses from metagenomic data. Bioinformatics. btaa490. Rice, P., Longden, I. & Bleasby, A. EMBOSS: The European Molecular Biology Open Software Suite.",
            "latex": null,
            "type": "table"
        },
        "TABREF1": {
            "text": "Serratus (https://github.com/ababaian/serratus) is an open-source tool designed for ultra-high throughput sequence alignment against a query sequence or pangenome (Extended",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "Organism:exp]\" (date accessed: June 1st 2020). Sequences <200 nt were excluded as well as sequences identified to contain non-CoV contaminants during preliminary testing (such as plasmid DNA or ribosomal RNA fragments). Remaining sequences were clustered at 99% identity with UCLUST [46] and masked by Dustmasker [47] with --window 30 and --window 64. The final query contained 10,101 CoV sequences (accessions in Extended Table 1a, masked coordinates in Extended Table 1b). For all other vertebrate viral family pangenomes, RefSeq sequences (n = 2,849) were downloaded from the NCBI Nucleotide server with the query \"Viruses[Organism] AND srcdb refseq[PROP] NOT wgs[PROP] NOT cellular organisms[ORGN] NOT AC 000001:AC 999999[PACC] AND (\"vhost human\"[Filter] AND \"vhost vertebrates\"[Filter]",
            "latex": null,
            "type": "table"
        },
        "TABREF3": {
            "text": "Chains were aligned to all complete coronavirus genomes in GenBank using UBLAST [46] to expand the repertoire of domain sequences. The reference sequences were clustered using UCLUST [46] at 97% sequence identity to reduce redundancy. For a given query genome, open reading frames (ORFs) are extracted using the EMBOSS getorf software [58]. ORFs are aligned to the domain references and the top 16 reference sequences for each domain are combined with the best-matching query ORF. For each domain, a multiple alignment of the top 16 matches plus query ORF is constructed on the fly by MUSCLE[72] and a neighbour-joining tree is inferred from the alignment, also using MUSCLE. Finally, a consensus prediction is derived from the placement of the ORF in the domain trees. Thus, the presence of a single domain in the assembly suffices to enable a prediction; if more domains are present they are combined into a consensus.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "The Serratus project is an initiative of the hackseqRNA genomics hackathon (https://www.hackseq.com). We would like to thank the many contributors for code snippets and bioinformatic discussion; E. Erhan, J. Chu, I. Birol, K. Wellman, C. Xu, M. Huss, K. Ha, E. Nawrocki, R. McLaughlin, C. Morgan-Lang, C. Blumberg, and the J. Brister lab. A. Rodrigues, S. McMillan, V. Wu, C. Kennet, K. Chao, and N. Pereyaslavsky for AWS support. We would also like to thank the J. Joy lab, G. Mordecai, J. Taylor, S. Roux, L. Bergner, R. Orton, and D. Streicker for virology discussions. We are grateful to the entire team managing the NCBI SRA. TA is grateful for the Advanced Research Computing resource at the University of British Columbia. PB was financially supported by the Klaus Tschira Foundation, RC by ANR Transipedia and Inception grants (PIA/ANR-16-CONV-0005, ANR-18-CE45-0020), AK and DM were supported by the Russian Science Foundation (grant 19-14-00172) and computation was carried out in part by Resource Centre \"Computer Centre of SPbU\". AK and DM are grateful to Saint Petersburg State University for the overall support of this work (project id: 51555639). Project support and computing resources were kindly provided by the University of British Columbia Community Health and Wellbeing Cloud Innovation Centre, powered by AWS. And special thanks to our patient and understanding partners.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Acknowledgments"
        },
        {
            "text": "AB conceived and led the study. AB and JT designed and implemented the Serratus architecture. AB and RCE constructed the viral pangenomes and panproteomes. RCE developed the SerraTax and Summarizer modules. PB developed the SerraPlace tree placement and taxonomy prediction code and calculated maximum likelihood trees. TA developed the DARTH annotation pipeline and submitted the annotated genomes to ENA. DM and AK developed the coronaSPAdes assembler. RC implemented the assembly pipeline, and deployed the assembly and annotation pipeline. AB, VL, and DL designed and developed https://serratus.io and the SQL server. AB and GN developed the Tantalus R package. AB, RCE, TA, PB, DM, AK, and RC analysed the coronavirus and deltavirus data. BAS and JB designed the phage panproteome, assembled phage genomes, and conducted phylogenetic analyses. All authors contributed to data interpretation and writing the manuscript.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Author Contributions"
        },
        {
            "text": "Correspondence should be addressed to AB.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Correspondence"
        },
        {
            "text": "Does not apply.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Reporting Summary"
        }
    ]
}