{
    "paper_id": "d8476b8bb403b595bf1e84ab315ce92192412b90",
    "metadata": {
        "title": "Fast custom wavelet analysis technique for single molecule detection and identification",
        "authors": [
            {
                "first": "Vahid",
                "middle": [],
                "last": "Ganjalizadeh",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of California",
                    "location": {
                        "addrLine": "1156 High Street",
                        "postCode": "95064",
                        "settlement": "Santa Cruz, Santa Cruz",
                        "region": "CA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Gopikrishnan",
                "middle": [
                    "G"
                ],
                "last": "Meena",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of California",
                    "location": {
                        "addrLine": "1156 High Street",
                        "postCode": "95064",
                        "settlement": "Santa Cruz, Santa Cruz",
                        "region": "CA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Thomas",
                "middle": [
                    "A"
                ],
                "last": "Wall",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Brigham Young University",
                    "location": {
                        "postCode": "84602",
                        "settlement": "Provo",
                        "region": "UT",
                        "country": "USA. \u2709"
                    }
                },
                "email": ""
            },
            {
                "first": "Matthew",
                "middle": [
                    "A"
                ],
                "last": "Stott",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Brigham Young University",
                    "location": {
                        "postCode": "84602",
                        "settlement": "Provo",
                        "region": "UT",
                        "country": "USA. \u2709"
                    }
                },
                "email": ""
            },
            {
                "first": "Aaron",
                "middle": [
                    "R"
                ],
                "last": "Hawkins",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Brigham Young University",
                    "location": {
                        "postCode": "84602",
                        "settlement": "Provo",
                        "region": "UT",
                        "country": "USA. \u2709"
                    }
                },
                "email": ""
            },
            {
                "first": "Holger",
                "middle": [],
                "last": "Schmidt",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of California",
                    "location": {
                        "addrLine": "1156 High Street",
                        "postCode": "95064",
                        "settlement": "Santa Cruz, Santa Cruz",
                        "region": "CA",
                        "country": "USA"
                    }
                },
                "email": "hschmidt@soe.ucsc.edu"
            }
        ]
    },
    "abstract": [
        {
            "text": "Many sensors operate by detecting and identifying individual events in a time-dependent signal which is challenging if signals are weak and background noise is present. We introduce a powerful, fast, and robust signal analysis technique based on a massively parallel continuous wavelet transform (CWT) algorithm. The superiority of this approach is demonstrated with fluorescence signals from a chip-based, optofluidic single particle sensor. The technique is more accurate than simple peak-finding algorithms and several orders of magnitude faster than existing CWT methods, allowing for real-time data analysis during sensing for the first time. Performance is further increased by applying a custom wavelet to multi-peak signals as demonstrated using amplification-free detection of single bacterial DNAs. A 4x increase in detection rate, a 6x improved error rate, and the ability for extraction of experimental parameters are demonstrated. This cluster-based CWT analysis will enable high-performance, real-time sensing when signal-to-noise is hardware limited, for instance with low-cost sensors in point of care environments.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "T he detection and identification of events in a time series is the basis of countless sensors across all fields of science and engineering. This task can often entail dealing with lowquality signals, often in the presence of considerable background noise, making it difficult to rely on simple thresholding algorithms where a signal above a set value is used to detect and classify an event. This can be addressed by improving the sensing instrument itself, but this approach is at odds with minimizing cost and complexity. An attractive alternative, therefore, is to extract the most information from the available time-domain signals by optimizing their analysis using appropriate signal processing techniques.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Among the many different sensor types that produce timedependent signals, optical sensors are particularly representative examples. They are ubiquitous and play an ever-increasing role in biomedical applications such as molecular diagnostics, cell analysis, health and wellness monitoring, and more 1, 2 . They are incredibly diverse, relying on many different phenomena for signal generation such as fluorescence, scattering, absorption, or resonance shifts [3] [4] [5] [6] . Many of these sensors generate, a timedependent sequence of individual events that arise from the detection of individual targets, such as cells, biomolecules, or reporter particles, that are moving or being scanned over. This scenario has significantly grown in importance recently as biosensor sensitivity has been improved with optofluidic techniques all the way to detection of single molecular biomarkers, ushering in the era of digital counting of different target types with a universal detection device. Examples include chip-scale flow cytometers 7 , DNA sequencing with zero-mode waveguides 8 , and direct detection of single viruses and nucleic acids using liquidcore waveguides 9, 10 . Optofluidic waveguide devices have recently received significant attention due to their capability of amplification-free detection of single biomarkers such as nucleic acids and proteins 9,11,12 . These and other optical lab-on-chip approaches have opened the door to the development of compact tests for infectious disease diagnosis in the field and at the point of care, capabilities that are urgently needed as the global SARS-CoV-2 pandemic has resoundingly shown. Point-of-care devices, however, impose severe demands on the biosensor as they need to be inexpensive, compact, and robust. Therefore, they represent a particularly good example of the need to optimize signal processing techniques to deal with sub-optimal data. In addition, it is desirable to carry out this analysis in real-time which adds further demands on the signal processing algorithm. Unlike recent studies involving supervised machine-learning techniques for event detection and classification [13] [14] [15] , we employ an unsupervised early event detection approach for immediate identification of events.",
            "cite_spans": [
                {
                    "start": 299,
                    "end": 301,
                    "text": "1,",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 459,
                    "end": 462,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 463,
                    "end": 466,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 467,
                    "end": 470,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 471,
                    "end": 474,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 1167,
                    "end": 1169,
                    "text": "9,",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 1362,
                    "end": 1371,
                    "text": "9,11,12 .",
                    "ref_id": null
                },
                {
                    "start": 2148,
                    "end": 2152,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 2153,
                    "end": 2157,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 2158,
                    "end": 2162,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                }
            ],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Here, we introduce a flexible signal processing algorithm for unsupervised detection and identification of single-particle signals. It is based on highly parallel, multi-scale continuous wavelet transform (CWT) analysis and meets the challenges for point-ofcare sensors described above, specifically speed, accuracy, and sensitivity to low signal levels. The high accuracy, linear (O(N)) complexity, and high speed of the proposed algorithm are ideally suited for real-time event detection applications. We demonstrate the capabilities of this Parallel Cluster Wavelet Analysis (PCWA) algorithm for both single-and multi-spot excitation signals and validate it with a demonstration of single bacterial DNA detection on an optofluidic waveguide chip. For single-peak signals, an increase in speed by orders of magnitude over common CWT methods is shown. For the first time, this allows for real-time operation of the sensor which is a critical advance towards use in the field and at the point of care. Equally strong performance for other sensor types is also shown in the Supplementary Material with the example of an electrical single-molecule nanopore sensor. For multi-peak signals, custom-designed wavelets are introduced that enable an over 4x increase in single-molecule detection rate and 6x reduction in errors compared to previously used techniques for periodic signals. In addition, this PCWA method allows for real-time extraction of additional experimental parameters such as the flow velocity of the sample liquid and its dynamic evolution. Finally, the multi-scale is suitable for further expansion by exploiting supervised machine-learning techniques toward extremely accurate multiplex detection.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Single-particle fluorescence detection. We emphasize that the technique to be introduced below can be applied to any timedependent signal, irrespective of its nature (optical, electrical, etc.), transduction mechanism, or the device platform on which it is created. However, we have found that it is particularly attractive for a liquid-core waveguide optofluidic platform on which multiplexed detection of single nucleic acids, proteins, and viral particles have been demonstrated at clinically relevant concentration levels 9, 12, 16 . The devices are based on intersecting solid-and hollow-core antiresonant reflecting optical waveguides (ARROW) built with a foundry compatible fabrication process 17 . Figure 1a shows a schematic view of the experimental setup used in this study. The device under test consists of a 5 \u03bcm \u00d7 12 \u03bcm microchannel terminated by fluidic reservoirs through which the target particles are driven by applied pressure. These are optically excited by orthogonally intersecting solid-core waveguides into which light from an external laser source is coupled as shown. The chip layout features two excitation options: single-spot via a single-mode (SM) waveguide or multi-spot excitation (MSE) with a multi-mode interference (MMI) waveguide. These different excitation patterns are visualized by the colored patterns in the top-down SEM image of the excitation region when the channel was filled with quantum dots in DI water (Fig. 1b) . This high concentration solution creates a static image of the excitation patterns through which a single target particle move in an actual experiment. Single-spot excitation can be used for ultrasensitive singleplex detection as demonstrated by amplification-free detection of Ebola virus RNA 9 . MMI waveguides, on the other hand, create spectrally and spatially varying excitation patterns which has been successfully used for multiplexed single virus and antigen detection 12, 18, 19 . Figure 1c shows two examples of the signals for single-spot and multi-spot excitation generated by SM and MMI waveguides. They are produced by fluorescent nanobeads and labeled bacterial DNAs (Klebsiella pneumoniae carbapenemase), respectively. Clearly, the spatial excitation patterns are replicated in the time-domain signal and can encode additional information for each event. When the multi-spot signal is analyzed by a shiftmultiply algorithm (see below), a 50,000x SNR enhancement was demonstrated 20 . These signals need to be detected and identified, which is challenging when the background is high or the signal level is low if the target is not bright or fluorescence collection is reduced depending on the particle's position in the channel 21 . Therefore, an efficient, powerful, and accurate signal analysis method is needed.",
            "cite_spans": [
                {
                    "start": 526,
                    "end": 528,
                    "text": "9,",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 529,
                    "end": 532,
                    "text": "12,",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 1940,
                    "end": 1943,
                    "text": "12,",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 1944,
                    "end": 1947,
                    "text": "18,",
                    "ref_id": "BIBREF17"
                }
            ],
            "ref_spans": [
                {
                    "start": 706,
                    "end": 715,
                    "text": "Figure 1a",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 1451,
                    "end": 1460,
                    "text": "(Fig. 1b)",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 1953,
                    "end": 1962,
                    "text": "Figure 1c",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Results"
        },
        {
            "text": "Wavelet analysis for time-dependent signals. Wavelet analysis is a well-established technique that has been successfully applied to a broad spectrum of applications, including but not limited to denoising, baseline removal, and spike detection in noisy signals (23) (24) (25) (26) (27) . Among wavelet transform families, both continuous wavelet transform (CWT) and discrete wavelet transform (DWT) have successfully been used in multi-scale peak and event detection. DWT efficiently decomposes a sampled signal into nonoverlapping sub-bands of frequencies. DWT is generally fast and efficient but lacks a sufficiently high resolution of scale/frequency. CWT, on the other hand, provides high scale/frequency resolution which is one of the key pieces of information used in time-frequency analysis. CWT is based on comparing the signal f(t) to a temporal pattern of finite duration-the mother wavelet \u03c8(t) -and identifying occurrences of the mother wavelet pattern as real events. Mathematically, this is implemented by the CWT function described by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "where s > 0 is a scaling factor that effectively stretches or compresses the wavelet pattern in time. C(t, s) is, therefore, the correlation of the real signal with a scaled and dilated basis function which can be visualized in a 2D map of similarity coefficients of the signal f with \u03c8 at time t and scale s. Local maxima in the 2D map indicate the presence of a particular pattern (similar to the mother wavelet) and by the use of the scaling factor, we look for this pattern at a broad range of scales. This turns out to be the ideal unsupervised method to match patterns as the ones shown in Fig. 1c without any extra training steps (collecting and labeling training dataset). We note that the convolution calculation at each scale can be done independently for CWT whereas in DWT higher level coefficients depend on the lower level's values. The multi-scale nature of CWT analysis in the (t,s) plane is particularly advantageous because events are commonly found at various s values which can provide an additional source of information. In our optofluidic devices, for example, particles flow at different speeds and create fluorescence signals of different temporal widths \u0394t. It is, therefore, convenient to relabel the scaling parameter s as \u0394t to extract meaningful information for events which can, in turn, be easily converted into the velocity of flowing particles due to the direct correspondence with the known spatial excitation patterns. This is a key advantage over DWT, whose limited number of scale levels is not sufficient to extract the continuous distribution of the velocity of flowing particles. Consequently, CWT seems ideally suited for analyzing singlepeak signals such as in Fig. 1c . Indeed, the technique has been used in numerous applications such as mass spectroscopy 22 , powder x-ray diffraction 23 , seizure detection from EEG signal 24, 25 , radar target detection 26 and trend detection, and estimation in hydrology and climate research 27 . However, a major challenge lies in dealing with large amounts of data in a fast and memory-efficient way as well as with more complex signal shapes such as the multi-peak signal of Fig. 1c . We introduce a fast CWT event detection algorithm, that addresses these problems, using the example of single-peak detection.",
            "cite_spans": [
                {
                    "start": 1870,
                    "end": 1873,
                    "text": "24,",
                    "ref_id": "BIBREF23"
                }
            ],
            "ref_spans": [
                {
                    "start": 596,
                    "end": 603,
                    "text": "Fig. 1c",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 1704,
                    "end": 1711,
                    "text": "Fig. 1c",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 2161,
                    "end": 2168,
                    "text": "Fig. 1c",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Results"
        },
        {
            "text": "Parallel cluster wavelet analysis (PCWA) for single-peak detection. Figure 2a shows a typical time-dependent signal for single-particle detection with the optofluidic chip of Fig. 1 used with the single-mode waveguide for excitation. A solution containing 0.1 pM of 200 nm polystyrene beads (Fluospheres\u2122) were pulled through the analyte channel by connecting a vacuum line to the outlet reservoir. The photon events corresponding to the fluorescence emission from the beads were collected off the chip in 10 \u03bcs bins for further analysis and, therefore, large amounts of data points are acquired rapidly. The two-second long trace displayed in Fig. 2a contains 200,000 points, and a 5 min acquisition time produces over 30 million points. Each spike corresponds to a single nanobead. The signal height and width vary due to different particle positions in the fluidic channel 21 and fluctuations in flow speed, respectively.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 68,
                    "end": 77,
                    "text": "Figure 2a",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 175,
                    "end": 181,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 644,
                    "end": 651,
                    "text": "Fig. 2a",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Results"
        },
        {
            "text": "The most straightforward way to detect the particles is to define a threshold of photon counts above the background and to count each crossing of this threshold as a particle 9 . While this works reasonably well, CWT analysis offers significant advantages in terms of accuracy, robustness, and information content.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "The 2D CWT transform of the fluorescence trace according to Eq. (1) was computed using a Ricker wavelet (also known as Mexican hat wavelet) and is displayed as a color map in Fig. 2b . Fluorescence signals in the real-time trace are now represented as bright streaks, and the \u0394t locations with the largest CWT coefficient correspond to the actual events and are highlighted with white boxes. The challenge lies in carrying out this assignment correctly and efficiently. To illustrate how this can be accomplished with a new, cluster-based algorithm, we take a look at a zoomed-in segment where a few events are displayed both in real-time (Fig. 2c) and in the C(t, \u0394t) plane (Fig. 2d) . First, local maxima (black dots in Fig. 2d ) in the CWT map are identified at each scale (\u0394t value) with a conventional peakfinding (with a user-defined threshold) process. Previously developed CWT algorithms now select the correct points using a ridge-line approach starting from the maxima at the largest \u0394t value 22, 28 . In the most direct approach 22 , ridges of connected points are developed sequentially by identifying maxima in the adjacent \u0394t row that are within a predefined distance in the CWT map. Once a ridge is formed, the time location of the filtered ridges with an SNR value above a threshold is identified as the event location. Since the algorithm is serial in nature (top to bottom), it is computationally intensive and slow. It is also not accurate to locate event locations. A refined version of this method proceeds in the same way 28 , but uses additional ridges that are calculated from zero crossings and local minima in the CWT map for better identification and extraction of additional information (peak width). Due to the additional information used, this method is more accurate than the direct ridge analysis, but it is also even more memory intensive.",
            "cite_spans": [
                {
                    "start": 1003,
                    "end": 1006,
                    "text": "22,",
                    "ref_id": "BIBREF21"
                }
            ],
            "ref_spans": [
                {
                    "start": 175,
                    "end": 182,
                    "text": "Fig. 2b",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 639,
                    "end": 648,
                    "text": "(Fig. 2c)",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 675,
                    "end": 684,
                    "text": "(Fig. 2d)",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 722,
                    "end": 729,
                    "text": "Fig. 2d",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Results"
        },
        {
            "text": "In order to enable real-time CWT analysis, we introduce a highly tunable, faster, and more memory-efficient algorithm based on cluster analysis. The flowchart for this process called Parallel Cluster Wavelet Analysis (PCWA) is depicted in Fig. 2f . In contrast to previous algorithms, we first define macro clusters (\u039cC) of CWT maxima that are separated by gaps along the t-axis by more than a predefined value. We then examine all clusters in parallel by calculating the distance values around the local maximum with the largest C(t, \u0394t) value which is the most likely candidate for an event. This, too, is done in a parallel, vectorized fashion, making the algorithm both efficient and fast. The overlap OL with other maxima within the cluster is determined from",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 239,
                    "end": 246,
                    "text": "Fig. 2f",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Results"
        },
        {
            "text": "where r is the radius of the ellipses in Fig. 2d , d is the Euclidean distance, w and h are adjustable spreading parameters that define the refinement sensitivity in time and scale, respectively. N represents the number of peaks in a multi-peak signal (here equal to one). The addition of normalized CWT coefficient weights into (r i + r 0 ) 2 helps detect weak events near strong ones. We then look for overlapping ellipses. If the number of points connected to the original largest maximum (centroid) is higher than a user-defined number, it is taken as a micro cluster (\u03bcC) in which the actual event is immediately identified. The unconnected points form a new, smaller macro cluster where a new centroid is picked. The analysis repeats until no more clusters can be formed with a minimal, user-defined number of candidate points. Figure 2b showed the detection of fluorescent nanobeads using this PCWA algorithm and suggests high accuracy. Indeed, when compared to a conventional amplitude-based peak finder, 5.7% more events were detected. In addition, the particles' velocity is also extracted from the scale values which correspond to the temporal widths of the fluorescence peaks. This is discussed in more detail in the next section, but the analysis for these singlepeak signals is also provided in the supplementary information ( Supplementary Fig. S1 ). Figure 2g compares the run time of the PCWA algorithm with the ridge-based CWT methods as a function of both the number of data points in the signal trace and the actual run time of the experiment. The comparison was done by running implementations of the algorithms in Python with 100 logarithmic scale values on a single desktop computer (Intel \u00ae Core\u2122 i9-900 CPU with 32 GB of RAM). We find that our method has O(N) complexity, where N is the number of data points. Consequently, it is orders of magnitude faster than other techniques and, most notably, our clustered CWT analysis is always faster than the experiment itself (dotted line), e.g., 40 s of analysis for a 42 s trace, while other methods always take orders of magnitude longer than the experiment and quickly become impractical. Consequently, PCWA enables real-time analysis of time-dependent particle sensors. This is the first principal result of this work.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 41,
                    "end": 48,
                    "text": "Fig. 2d",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 834,
                    "end": 843,
                    "text": "Figure 2b",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1341,
                    "end": 1362,
                    "text": "Supplementary Fig. S1",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 1366,
                    "end": 1375,
                    "text": "Figure 2g",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Results"
        },
        {
            "text": "We note again that the PCWA method is widely applicable to other sensor types. The example of single DNA detection with nanopore electrical sensor chips is presented in the supplementary information and confirms the performance improvements described in Fig. 2 . Another important question concerns the accuracy of the PCWA method which can be assessed with the help of a receiver operating characteristic (ROC) curve that considers both true and false-positive events. In order to carry out a ROC curve analysis, a dataset with known positive events is required. We used a set of 75 mass spectrometry traces from a simulated protein spectra dataset 29 and found that our algorithms slightly outperforms other CWT techniques. Details are provided in the supplementary information (see Supplementary Fig. S3 ). This shows that our cluster CWT algorithm is fast, efficient, accurate, and can be applied to a diverse range of sensor types.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 254,
                    "end": 260,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 785,
                    "end": 806,
                    "text": "Supplementary Fig. S3",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Results"
        },
        {
            "text": "Clustered CWT analysis of multi-peak signals. Multi-peak signals offer significant advantages for practical sensing applications. By introducing redundancy and patterning to the signal, more reliable identification of events from a noisy background that resembles single peaks becomes possible. Multi-peak signals also enable multiplex detection if different targets produce different signal patterns which is particularly desirable for biomedical applications. In practice, this often involves the use of spatial excitation patterns using masks 30 or waveguides 20,31 that result in a corresponding time modulation of the signal created by a particle that passes by such a pattern. These can then be analyzed using Fourier transform analysis, shift-multiply algorithms (see below) 20 , or matched filters. For example, signal-to-noise ratio (SNR) enhancement via multi-spot excitation implemented with Y-splitters and multi-mode interference (MMI) waveguides has shown up to 50,000x SNR improvement 20, 31 .",
            "cite_spans": [
                {
                    "start": 1000,
                    "end": 1003,
                    "text": "20,",
                    "ref_id": "BIBREF19"
                }
            ],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "Improved signal analysis with spatially patterned excitation has been demonstrated in various implementations [32] [33] [34] . To demonstrate the benefits of the PCWA approach in this context, we analyze signals from multi-spot excitation of individual fluorescently tagged plasmid molecules corresponding to the Klebsiella pneumonia carbapenemase (KPC) bacterial species. The multispot excitation pattern is generated by a multi-mode-interference (MMI) waveguide 18, 35 . In this experiment, a HeNe laser source was fiber-coupled into the MMI waveguide (see Fig. 1a ) while the rest of the setup was identical to the one used in the single-peak detection experiment. Figure 3a shows an example of a multipeak signal from a single DNA molecule that consists of seven peaks in response to the MMI waveguide excitation pattern generated at 633 nm. Also shown is the Fourier transform of this signal which shows a strong peak at 4.5 kHz that arises from the uniform spacing \u0394t of the seven signal peaks. In addition, the second harmonic at 9 kHz and strong content at very low frequencies are visible. In the past, such multi-peak signals have been detected and classified (by peak number) for multiplex detection using a shift-multiply algorithm 20,31,34 with good results. This benchmark algorithm is briefly reviewed in Fig. 3b . It is based on recursively (N-1 times) shifting a selected multipeak event by \u0394t (the uniform spacing between N adjacent peaks) and multiplying all shifted signals with each other. The resulting product is large for a correct signal and very small for incorrect peak numbers or temporal spacing, resulting in significant SNR improvement compared to purely threshold-based counting 20, 31 .",
            "cite_spans": [
                {
                    "start": 110,
                    "end": 114,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 115,
                    "end": 119,
                    "text": "[33]",
                    "ref_id": "BIBREF32"
                },
                {
                    "start": 120,
                    "end": 124,
                    "text": "[34]",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 464,
                    "end": 467,
                    "text": "18,",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 1711,
                    "end": 1714,
                    "text": "20,",
                    "ref_id": "BIBREF19"
                }
            ],
            "ref_spans": [
                {
                    "start": 559,
                    "end": 566,
                    "text": "Fig. 1a",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 668,
                    "end": 677,
                    "text": "Figure 3a",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 1320,
                    "end": 1327,
                    "text": "Fig. 3b",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Results"
        },
        {
            "text": "We now demonstrate dramatic improvements using PCWA with custom-designed wavelets. First, we choose another mother wavelet that is commonly used in CWT data analysis. The Morlet wavelet (Fig. 3c, top left) contains frequency information embedded by enveloping a sinusoidal (real Morlet) or exponential (complex Morlet) function with a Gabor window (Gaussian function). The frequency spectrum (FFT) of the Morlet wavelet (Fig. 3c, top right) correctly reproduces the main feature of the fluorescence signal (the first harmonic) but does not show the finer features of its spectral content at higher and lower frequencies.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 186,
                    "end": 205,
                    "text": "(Fig. 3c, top left)",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 420,
                    "end": 440,
                    "text": "(Fig. 3c, top right)",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Results"
        },
        {
            "text": "Figure 3c (bottom) shows the CWT map when the Morlet wavelet is applied to the signal of Fig. 3a . Multiple red spots with large CWT coefficients are seen at times where the Morlet wavelet peaks line up with the peaks in the fluorescence signal. This indicates that particles can indeed be detected, but with some temporal uncertainty for the event as highlighted by the white boxes on the time and scale axes.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 89,
                    "end": 96,
                    "text": "Fig. 3a",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Results"
        },
        {
            "text": "An even better strategy is to construct a mother wavelet that is custom-designed for the signal pattern to be detected, here the 7-peak MMI signal of Fig. 3a . To this end, we define a Multi-Spot Gaussian (MSG) wavelet as seen in Fig. 3d (top, left) . It is constructed by the sum of N Gaussians separated by \u0394t and surrounded by two negative skewed peaks and mathematically described by",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 150,
                    "end": 157,
                    "text": "Fig. 3a",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 230,
                    "end": 249,
                    "text": "Fig. 3d (top, left)",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Results"
        },
        {
            "text": "here, the \u03c3 + parameter for positive peaks is fitted to those measured from multi-peak signals normalized to \u0394t. a and \u03c3 \u2212 are calculated according to positive peaks to achieve optimal compactness and sensitivity. For higher sensitivity of the wavelet to N, the maxima (m 0 ) of the skewed Gaussian functions at both ends are placed at \u0394t from the first and last positive peaks. The negative side peaks of the wavelet ensure that the zero mean condition applies 36 , and the wavelet is scaled for a square norm of one. The parameters of the skewed Gaussian functions are explained in the supplementary material. The Fourier transform of the MSG wavelet is shown in Fig. 3d  (top, right) and shows excellent qualitative agreement with the FFT of the multi-peak signal from the KPC target. Figure 3d (bottom) shows the CWT map obtained with the custom MSG mother wavelet in Eq. (3). It shows a single dominant bright spot (black box) that demonstrates clear particle detection and excellent localization on both the time and \u0394t axes (white boxes), corresponding to precise determination of the particle detection event and its velocity.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 665,
                    "end": 686,
                    "text": "Fig. 3d  (top, right)",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 788,
                    "end": 797,
                    "text": "Figure 3d",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Results"
        },
        {
            "text": "We then applied the PCWA method with the MSG mother wavelet to a full, 20-min-long experimental trace of fluorescently tagged DNA molecules detection. Figure 4a shows a snapshot of this trace with clean identification of seven molecules, each producing a seven-peak signal. The CWT map (Fig. 4b) shows clean identification of these signals and also illustrates the variation in \u0394t due to the different velocities of the molecules. Note that the gaps in the time axis of Fig. 4a , b were added solely to enable visualization of multiple plasmid detection events, which are very sparse at low concentrations.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 151,
                    "end": 160,
                    "text": "Figure 4a",
                    "ref_id": "FIGREF4"
                },
                {
                    "start": 286,
                    "end": 295,
                    "text": "(Fig. 4b)",
                    "ref_id": "FIGREF4"
                },
                {
                    "start": 470,
                    "end": 477,
                    "text": "Fig. 4a",
                    "ref_id": "FIGREF4"
                }
            ],
            "section": "Results"
        },
        {
            "text": "We note that conventional ridge-based CWT methods cannot be applied to multi-peak signals. This is illustrated in Fig. 4c where the local maxima (equivalent to Fig. 2c ) around a single seven-peak event are shown. Clearly, this single event results in multiple maxima at each \u0394t level, creating multiple ridges. Consequently, ridge-based identification would detect multiple events and fails. In contrast, our PCWA algorithm recognizes all of these points in a single step as connected to the largest maximum in the group. As a result, the event forms a single micro cluster that is quickly identified correctly. Like in the case of single-peak signals, the analysis time remains shorter than the run time of the experiment. The unique ability of the PCWA algorithm to both detect and identify multi-peak signals using custom wavelets represents the second principal result of this manuscript.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 114,
                    "end": 121,
                    "text": "Fig. 4c",
                    "ref_id": "FIGREF4"
                },
                {
                    "start": 160,
                    "end": 167,
                    "text": "Fig. 2c",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Results"
        },
        {
            "text": "In order to compare the performance of the three analysis approaches (Shift-Multiply, PCWA (Morlet), and PCWA (MSG), we evaluated both the measured single-molecule detection rates and their accuracy. Here, accuracy was defined by the algorithms' ability to identify the correct peak number (here: seven) of a detected event. This is meaningful because multiplexing with MMI waveguides can be implemented by simultaneously generating signals with different peak numbers using the spectral and/or spatial dependence of the MMI pattern 18, 35 . Therefore, the three methods were applied to each event with three different peak numbers (6, 7, 8) . For example, C(u,s) was determined with three different MSG wavelets and the coefficient with the highest value was chosen for each event. For each method, a series of threshold values were scanned to find the optimal compromise between accuracy and detection rate. The results of this comparison are presented in Table 1 and clearly show that PCWA analysis with the custom MSG mother wavelet offers by far the best performance with over 4x more identified events and 6x fewer errors than the shift-multiply algorithm.",
            "cite_spans": [
                {
                    "start": 533,
                    "end": 536,
                    "text": "18,",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 632,
                    "end": 635,
                    "text": "(6,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 636,
                    "end": 638,
                    "text": "7,",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [
                {
                    "start": 958,
                    "end": 965,
                    "text": "Table 1",
                    "ref_id": "TABREF3"
                }
            ],
            "section": "Results"
        },
        {
            "text": "In order to verify the superiority of PCWA over Shift-Multiply and MSG over Morlet wavelet, we did additional analysis done a simulated multi-peak signal ( Supplementary Fig. S4 ) with a known ground truth events list. The results (see Supplementary  Fig. S5 and Table S1 ) show a close match with the real-world results shown in Table 1 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 156,
                    "end": 177,
                    "text": "Supplementary Fig. S4",
                    "ref_id": "FIGREF4"
                },
                {
                    "start": 236,
                    "end": 258,
                    "text": "Supplementary  Fig. S5",
                    "ref_id": null
                },
                {
                    "start": 263,
                    "end": 271,
                    "text": "Table S1",
                    "ref_id": "TABREF3"
                },
                {
                    "start": 330,
                    "end": 337,
                    "text": "Table 1",
                    "ref_id": "TABREF3"
                }
            ],
            "section": "Results"
        },
        {
            "text": "Finally, we demonstrate the ability of the PCWA method to instantly extract additional valuable information from the sensor data. Because the optical excitation patterns are generated by lithographically defined waveguides according to the MMI principle, they have a well-defined physical spacing. Therefore, the \u0394t value of an event identified in the CWT map, which represents the temporal spacing between peaks in the fluorescence signal, can directly be converted into a flow velocity for the particle. This is visualized in Fig. 4b by the velocity axis on the right.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 528,
                    "end": 535,
                    "text": "Fig. 4b",
                    "ref_id": "FIGREF4"
                }
            ],
            "section": "Results"
        },
        {
            "text": "In Fig. 4d , the intensity and \u0394t (velocity) of all 300 detected DNA molecules are visualized in a 2D histogram to provide joint information analysis. The events are distributed in a pattern that is determined by the waveguide mode patterns and the (parabolic) velocity profile in the microchannel. The predicted distribution of the majority of events for the chip under consideration is shown as a white line and matches the data well. A few noise peaks incorrectly identified by the CWT algorithm as fluorescent particles lie outside the white dashed ellipse and can now be rejected based on the additional velocity information. Figure 4e shows the dynamics of speed and intensity of particles inside the fluidic channel over the course of the experiment. Good agreement of velocity fluctuations and detection rate is observed. Real-time analysis can be easily implemented by running the event detection algorithm on a sliding window of the buffered signal during data acquisition.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 3,
                    "end": 10,
                    "text": "Fig. 4d",
                    "ref_id": "FIGREF4"
                },
                {
                    "start": 631,
                    "end": 640,
                    "text": "Figure 4e",
                    "ref_id": "FIGREF4"
                }
            ],
            "section": "Results"
        },
        {
            "text": "Such real-time statistics can help monitor proper experimental operation, e.g., maintaining constant vacuum pressure.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "We have introduced a Parallel Cluster Wavelet Analysis (PCWA) algorithm that operates in a highly parallel fashion, enabling fast, accurate, memory-efficient detection, and identification of events in real-time. The algorithm's characteristics are ideal for singleparticle sensors that produce large amounts of data, possibly over long periods of time. The PCWA principle was validated on a diverse range of data sets, in particular, a chip-based, optical single biomolecule detection assay that is compatible with diagnostic applications and settings with low signal-to-noise conditions such as point-of-care use. Fluorescence signals from single particles were rapidly and fully analyzed via a single transform operation which also enabled the determination of the velocity and intensity of the individual molecules. The use of multi-peak signals with a customized mother wavelet outperforms other established detection methods. This combination is especially attractive for multiplex detection where different classes of targets generate signals with a different number of peaks. In the future, the technique can be further expanded to dynamically (on-thefly) adapt the shape of the multi-peak mother wavelets to the patterns generated by a particular sensor to further improve the performance. This flexibility would be ideal for point-of-care devices because it further alleviates the demands on the tolerances and cost associated with the device fabrication process to produce identical excitation patterns. Moreover, the algorithm can also be applied to automated dataset collection and labeling for supervised machine-learning tasks applications.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Optofluidic chip fabrication. Optofluidic chips were fabricated by depositing alternating layers of high (Ta 2 O 5 ) and low (SiO 2 ) refractive index on top of an <100> oriented silicon substrate, forming the ARROW layer to guide the light in solid core and a liquid core. Waveguides were then built on top of the ARROW layer stack using low-stress PECVD and a sacrificial layer process 17 implementation uses a dual-oxide buried ARROW design with optimized lateral confinement and performance 37 Sample preparation. The KPC sample used in the multi-peak signal experiment was prepared by mixing a 1 \u03bcM concentration of cell-permeant SYTO 62 redfluorescent nucleic acid stain (Thermo Fisher Scientific) with a KPC plasmid sample prior to detection. SYTO 62 dyes fluoresce when bound to DNA, making it possible to detect and count individual nucleic acids without amplification 11 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Methods"
        },
        {
            "text": "Experimental setup. A single-molecule detection setup was built to excite fluorescent-tagged target particles and collect and record the emission from targets. A solid-state diode neodymium-doped yttrium aluminum garnet; Nd:Y 3 Al 5 O 12 (SSD Nd:YAG) laser (Shanghai Dream Laser Technology Co.) and a HeNe laser (Melles Griot) working at 556 and 633 nm, respectively, were coupled into a singlemode fiber using a 60x microscope objective lens (Newport). The single-mode fiber was then butt-coupled into the optofluidic chip. The fluorescence emission from tagged particles was coupled into the liquid-core ARROW waveguide and then guided off the chip via a solid-core waveguide. These photons were collected by a 60x microscope objective lens (Newport), passed through a penta-bandpass optical filter (FF01-440/521/607/694/809-25, Semrock) to remove excitation light, and detected by an avalanche photodiode (APD, Excelitas). Single-photon events were recorded with a photon-counting card (Picoquant, TimeHarp 260 Nano) into a desktop PC for further analysis.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Methods"
        },
        {
            "text": "The raw fluorescence data are available under restricted access for data privacy reason. Access can be obtained by a reasonable request from the corresponding author.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data availability"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Optical biosensors: an exhaustive and comprehensive review",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Analyst",
            "volume": "145",
            "issn": "",
            "pages": "1605--1628",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Optical biosensors",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Estrela",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Damborsk\u00fd",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "\u0160vitel",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Katrl\u00edk",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Essays Biochem",
            "volume": "60",
            "issn": "",
            "pages": "91--100",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Microfluidic system for detection of viral RNA in blood using a barcode fluorescence reporter and a photocleavable capture probe",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Du",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Anal. Chem",
            "volume": "89",
            "issn": "",
            "pages": "12433--12440",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "On-chip surface-enhanced Raman scattering detection using integrated liquid-core waveguides",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Measor",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Appl. Phys. Lett",
            "volume": "90",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Gold nanoparticle amplified optical microfiber evanescent wave absorption biosensor for cancer biomarker detection in serum",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Talanta",
            "volume": "120",
            "issn": "",
            "pages": "419--424",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Protein detection by optical shift of a resonant microcavity",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Vollmer",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "Appl. Phys. Lett",
            "volume": "80",
            "issn": "",
            "pages": "4057--4059",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Point-of-Care Diagnostics on a Chip",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Kiesel",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Zero-mode waveguides for single-molecule analysis at high concentrations",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "J"
                    ],
                    "last": "Levene",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Science",
            "volume": "299",
            "issn": "",
            "pages": "682--686",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Optofluidic analysis system for amplification-free, direct detection of Ebola infection",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Cai",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Sci. Rep",
            "volume": "5",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Optofluidic detection of Zika nucleic acid and protein biomarkers using multimode interference multiplexing",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Stambaugh",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Biomed. Opt. Express",
            "volume": "9",
            "issn": "",
            "pages": "3725--3730",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "3\u00d7 multiplexed detection of antibiotic resistant plasmids with single molecule sensitivity",
            "authors": [
                {
                    "first": "G",
                    "middle": [
                        "G"
                    ],
                    "last": "Meena",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Lab. Chip",
            "volume": "20",
            "issn": "",
            "pages": "3763--3771",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Optofluidic amplification-free multiplex detection of viral hemorrhagic fevers",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "M"
                    ],
                    "last": "Stambaugh",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "IEEE J. Sel. Top. Quant. Electron",
            "volume": "27",
            "issn": "",
            "pages": "1--6",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Rapid detection of microbiota cell type diversity using machine-learned classification of flow cytometry data",
            "authors": [
                {
                    "first": "B",
                    "middle": [
                        "D"
                    ],
                    "last": "\u00d6zel Duygan",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Hadadi",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "F"
                    ],
                    "last": "Babu",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Seyfried",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Van Der Meer",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Commun. Biol",
            "volume": "3",
            "issn": "",
            "pages": "1--13",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Real-time image processing for microscopy-based label-free imaging flow cytometry in a microfluidic chip",
            "authors": [
                {
                    "first": "Y",
                    "middle": [
                        "J"
                    ],
                    "last": "Heo",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Lee",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Kang",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Lee",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "K"
                    ],
                    "last": "Chung",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Sci. Rep",
            "volume": "7",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "LSTM-based ECG classification for continuous monitoring on personal wearable devices",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Saadatnejad",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Oveisi",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Hashemi",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "IEEE J. Biomed. Health Inf",
            "volume": "24",
            "issn": "",
            "pages": "515--523",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Single-virus analysis through chip-based optical detection",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Schmidt",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "R"
                    ],
                    "last": "Hawkins",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Bioanalysis",
            "volume": "8",
            "issn": "",
            "pages": "867--870",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Hollow-core waveguides and 2-D waveguide arrays for integrated optics of gases and liquids",
            "authors": [
                {
                    "first": "",
                    "middle": [],
                    "last": "Schmidt",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "IEEE J. Sel. Top. Quant. Electron",
            "volume": "11",
            "issn": "",
            "pages": "519--527",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Optofluidic wavelength division multiplexing for single-virus detection",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Ozcelik",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Proc. Natl Acad. Sci. USA",
            "volume": "112",
            "issn": "",
            "pages": "12933--12937",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "Multi-channel velocity multiplexing of single virus detection on an optofluidic chip",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Black",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Ganjalizadeh",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "W"
                    ],
                    "last": "Parks",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Schmidt",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Opt. Lett",
            "volume": "43",
            "issn": "",
            "pages": "4425--4428",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Signal-to-noise enhancement in optical detection of single viruses with multispot excitation",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Ozcelik",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "IEEE J. Sel. Top. Quant. Electron",
            "volume": "22",
            "issn": "",
            "pages": "6--11",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "Electro-optical detection of single \u03bb-DNA",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Chem. Commun",
            "volume": "51",
            "issn": "",
            "pages": "2084--2087",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Improved peak detection in mass spectrum by incorporating continuous wavelet transform-based pattern matching",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Du",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "A"
                    ],
                    "last": "Kibbe",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "M"
                    ],
                    "last": "Lin",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Bioinformatics",
            "volume": "22",
            "issn": "",
            "pages": "2059--2065",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "A wavelet transform algorithm for peak detection and application to powder x-ray diffraction data",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Gregoire",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Dale",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "B"
                    ],
                    "last": "Van Dover",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Rev. Sci. Instrum",
            "volume": "82",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Wavelet-based EEG processing for computer-aided seizure detection and epilepsy diagnosis",
            "authors": [
                {
                    "first": "O",
                    "middle": [],
                    "last": "Faust",
                    "suffix": ""
                },
                {
                    "first": "U",
                    "middle": [
                        "R"
                    ],
                    "last": "Acharya",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Adeli",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Adeli",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Seizure",
            "volume": "26",
            "issn": "",
            "pages": "56--64",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Detecting epileptic seizures in long-term human EEG: a new approach to automatic online and real-time detection and classification of polymorphic seizure patterns",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Meier",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Dittrich",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Schulze-Bonhage",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Aertsen",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "J. Clin. Neurophysiol",
            "volume": "25",
            "issn": "",
            "pages": "119--131",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "Low SNR radar signal detection using the continuous wavelet transform (CWT) and a Morlet wavelet",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "E"
                    ],
                    "last": "Ball",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Tolley",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "IEEE Radar Conference",
            "volume": "1",
            "issn": "6",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "Development of a new method of wavelet aided trend detection and estimation",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Adamowski",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Prokoph",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Adamowski",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Hydrol. Process",
            "volume": "23",
            "issn": "",
            "pages": "2686--2696",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "Multiscale peak detection in wavelet space",
            "authors": [
                {
                    "first": "Z.-M",
                    "middle": [],
                    "last": "Zhang",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Analyst",
            "volume": "140",
            "issn": "",
            "pages": "7955--7964",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Feature extraction and quantification for mass spectrometry in biomedical applications using the mean spectrum",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "S"
                    ],
                    "last": "Morris",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [
                        "R"
                    ],
                    "last": "Coombes",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Koomen",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [
                        "A"
                    ],
                    "last": "Baggerly",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Kobayashi",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Bioinforma. Oxf. Engl",
            "volume": "21",
            "issn": "",
            "pages": "1764--1775",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "Spatially modulated fluorescence emission from moving particles",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Kiesel",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Bassler",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Beck",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Johnson",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Appl. Phys. Lett",
            "volume": "94",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "Scalable spatial-spectral multiplexing of single-virus detection using multimode interference waveguides",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Ozcelik",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Sci. Rep",
            "volume": "7",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "Time encoded multicolor fluorescence detection in a microfluidic flow cytometer",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Martini",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Lab. Chip",
            "volume": "12",
            "issn": "",
            "pages": "5057--5062",
            "other_ids": {}
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "Processing gain and noise in multi-electrode impedance cytometers: comprehensive electrical design methodology and characterization",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Xie",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Sens. Actuators B Chem",
            "volume": "241",
            "issn": "",
            "pages": "672--680",
            "other_ids": {}
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "High-sensitivity cytometric detection using fluidic-photonic integrated circuits with array waveguides",
            "authors": [
                {
                    "first": "V",
                    "middle": [],
                    "last": "Lien",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Kai",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Berdichevsky",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [
                        "O"
                    ],
                    "last": "Yu-Hwa",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "IEEE J. Sel. Top. Quant. Electron",
            "volume": "11",
            "issn": "",
            "pages": "827--834",
            "other_ids": {}
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "Optical multi-mode interference devices based on self-imaging: principles and applications",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "B"
                    ],
                    "last": "Soldano",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "C"
                    ],
                    "last": "Pennings",
                    "suffix": ""
                }
            ],
            "year": 1995,
            "venue": "J. Light. Technol",
            "volume": "13",
            "issn": "",
            "pages": "615--627",
            "other_ids": {}
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "Tour of Signal Processing",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Mallat",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Wavelet",
                    "suffix": ""
                }
            ],
            "year": 1999,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "Optofluidic lab-on-a-chip fluorescence sensor using integrated buried ARROW (bARROW) waveguides. Micromachines",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Wall",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "8",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF37": {
            "ref_id": "b37",
            "title": "Fast custom wavelet analysis technique for single molecule detection and identification",
            "authors": [
                {
                    "first": "V",
                    "middle": [],
                    "last": "Ganjalizadeh",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Schmidt",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.5281/zenodo.5794624"
                ]
            }
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Optofluidic single-particle detection platform. a Schematic of the experimental setup with a photo of comparison of fabricated ARROW chip with a nickel coin. The chip layout offers two options: single-peak or multipeak fluorescence signals by coupling optical fiber into single-mode or multi-mode interference (MMI) waveguides, respectively. b Microscope image of detection region excited at 556 nm in the single-mode waveguide and 633 nm in the MMI waveguide which generates seven distinct spots in the analyte channel (analyte channel contains quantum dot-DI water solution for visualization of the excitation patterns as indicated by the red and green overlay colors). An example of target particles flowing across the MMI pattern and creating an intensity-modulated temporal signal in the collection waveguide is shown. c Examples of generated fluorescence signals: Single-peak signal is taken from fluorescent nanobeads and the multi-peak signal is generated by a single fluorescently tagged nucleic acid from a Klebsiella pneumoniae carbapenemase (KPC) bacterium. Areas under curves are shaded with the same color used in the overlay for visualization purposes. | (2022) 13:1035 | https://doi.org/10.1038/s41467-022-28703-z | www.nature.com/naturecommunications",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Parallel cluster wavelet analysis (PCWA) for single-peak analysis. a Cropped window of fluorescence signal taken from 200 nm fluorescent beads excited by single-mode (SM) waveguide (inset: Ricker wavelet used with PCWA algorithm). b CWT coefficients in time-\u0394t space (where a scaled and dilated version of the mother wavelet is convolved with raw data) with square markers indicating selected local maxima points found by the PCWA event detector algorithm. c Zoomed-in window of three events with circle markers showing the adjusted location of peaks. d CWT map of (c) including local maxima points (black dots). The clustering algorithm utilizes Euclidean distance and adjusted ellipses around each local maximum to search for links. The overlap of an ellipse with the centroid point defines a link. e Macro and micro clusters (\u039cC and \u03bcC): local maxima are first grouped into \u039cC highlighted by blue circles by simplified 1D overlap calculation. The clustering algorithm finds \u03bcC for each \u039cC in parallel. A \u03bcC is a star graph containing a minimum of links with the largest CWT coefficient maximum as the centroid (red-filled circles). f Flowchart of the clustering algorithm. g Run time comparison of clustering algorithm with established CWT peak finders, showing orders of magnitude faster speed and run times below the real-time limit (gray dashed line).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Multi-peak detection methods. a Time and frequency domain representation of a fluorescence signal taken from single K. pneumoniae Carbapenemase DNA molecules excited by seven excitation spots from the multi-mode interference (MMI) waveguide. Arrows in FFT indicate the first and second harmonic of the time trace. b Shift-multiply algorithm previously used to find and classify multi-peak signals. c Time and frequency information of Morlet wavelet with single component aligned to the first harmonic of multi-peak signal. 2D map of positive CWT coefficients with white boxes indicating approximate certainty of time and scale localization. d Multi-spot Gaussian (MSG) wavelet designed to match the multi-peak signal as well as the full frequency spectrum; CWT coefficients map shows precise event localization. | (2022) 13:1035 | https://doi.org/10.1038/s41467-022-28703-z | www.nature.com/naturecommunications",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "Multi-peak analysis. a Concatenated 10 ms cuts of detected single KPC molecules in a 9 s window. Inset is the multi-spot Gaussian (MSG) wavelet used to analyze the trace. b Corresponding time-\u0394t CWT scalogram with white squares showing detected multi-peak events across a range of \u0394t values. c Local maxima for a single example event render conventional ridge-line methods impractical. d Scatter plot for particle intensity and speed, showing a cluster in the predicted region (white line); dashed line: confidence region for event identification as DNA molecules. e Time-varying information of events during the measurement for dynamic determination of the flow characteristics. Intensity and velocity plots are the average value for events within a bin from the histogram plot. Error bars represent standard deviation.",
            "latex": null,
            "type": "figure"
        },
        "TABREF2": {
            "text": ". The present",
            "latex": null,
            "type": "table"
        },
        "TABREF3": {
            "text": "Performance comparison for single-molecule KPC analysis using different algorithms. NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-022-28703-z ARTICLE NATURE COMMUNICATIONS | (2022) 13:1035 | https://doi.org/10.1038/s41467-022-28703-z | www.nature.com/naturecommunications",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "The source code of the proposed PCWA algorithm with example scripts are available at https://github.com/vganjali/PCWA 38 ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Code availability"
        },
        {
            "text": "Supplementary information The online version contains supplementary material available at https://doi.org/10.1038/s41467-022-28703-z.Correspondence and requests for materials should be addressed to Holger Schmidt.Peer review information Nature Communications thanks Enis Cetin and the anonymous reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.Reprints and permission information is available at http://www.nature.com/reprintsPublisher's note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/ licenses/by/4.0/.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Additional information"
        }
    ]
}