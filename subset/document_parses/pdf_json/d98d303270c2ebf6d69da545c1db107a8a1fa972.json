{
    "paper_id": "d98d303270c2ebf6d69da545c1db107a8a1fa972",
    "metadata": {
        "title": "Enabling Manual Intervention for Otherwise Automated Registration of Large Image Series",
        "authors": [
            {
                "first": "Roman",
                "middle": [],
                "last": "Grothausmann",
                "suffix": "",
                "affiliation": {},
                "email": "grothausmann.roman@mh-hannover.de"
            },
            {
                "first": "D\u017eenan",
                "middle": [],
                "last": "Zuki\u0107",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Kitware, Inc",
                    "location": {
                        "settlement": "Carrboro",
                        "region": "NC",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Matt",
                "middle": [],
                "last": "Mccormick",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Kitware, Inc",
                    "location": {
                        "settlement": "Carrboro",
                        "region": "NC",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Christian",
                "middle": [],
                "last": "M\u00fchlfeld",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Lars",
                "middle": [],
                "last": "Knudsen",
                "suffix": "",
                "affiliation": {},
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "Aligning thousands of images from serial imaging techniques can be a cumbersome task. Methods ([2, 11, 21]) and programs for automation exist (e.g. [1, 4, 10] ) but often need case-specific tuning of many meta-parameters (e.g. mask, pyramid-scales, denoise, transformtype, method/metric, optimizer and its parameters). Other programs, that apparently only depend on a few parameter often just hide many of the remaining ones (initialized with default values), often cannot handle challenging cases satisfactorily.",
            "cite_spans": [
                {
                    "start": 148,
                    "end": 151,
                    "text": "[1,",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 152,
                    "end": 154,
                    "text": "4,",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 155,
                    "end": 158,
                    "text": "10]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Instead of spending much time on the search for suitable metaparameters that yield a usable result for the complete image series, the described approach allows to intervene by manually aligning problematic image pairs. The manually found transform is then used by the automatic alignment as an initial transformation that is then optimized as in the pure automatic case. Therefore the manual alignment does not have to be very precise. This way the worst case time consumption is limited and can be estimated (manual alignment of the whole series) in contrast to tuning of meta-parameters of pure auto-alignment of complete series which can hardly be guessed.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "The general approach to reconstruct 3D by 2D serial sections (also termed array tomography) is long known and can be applied with various imaging techniques [2, 7, 22, 30] . This method has the common drawback that the images of the serial sections need to be aligned to the image of the adjacent slice. While this can be done manually with various programs (e.g. midas of IMOD, Fiji/ImageJ, VV, Gimp, PhotoShop), this can be very tedious labour. Although visual inspection seems easy, it often is hard to decide which transform is the \"best\", one reason being the fact that adjacent images in general contain similar but not equal content due to the structure change in the 3rd dimension. This becomes of particular importance when employing registration allowing local deformations, because the natural 3D structure change is not meant to be corrected by local deformation.",
            "cite_spans": [
                {
                    "start": 157,
                    "end": 160,
                    "text": "[2,",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 161,
                    "end": 163,
                    "text": "7,",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 164,
                    "end": 167,
                    "text": "22,",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 168,
                    "end": 171,
                    "text": "30]",
                    "ref_id": "BIBREF29"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Therefore, various procedures for digital automatic alignment have been investigated, which in general are based on finding a transformation that optimizes a metric (a well defined quantification in contrast to visually \"best\"). Many types of transformations, metrics and optimizers have been developed of which specific ones need to be chosen depending on the given data and desired results. Apart from the parameters of the transformation that get optimized during the processing, parameters of the chosen optimizer, metric and general ones such as denoising, size/shape of a mask and pyramid resolutions need to be set before the processing can start [4, 10, 32] . These parameters are referred to as meta-parameters and need to be tuned with expert knowledge in order to get an acceptable results for as many consecutive images as possible. The more serial sections the image series contains, the more difficult and time consuming this task can become. Experience shows, that for a series of a few hundred up to a few thousand realistic (i.e. non-ideal) images, the finding of suitable meta-parameters can take a few weeks, without a guarantee to succeed at all.",
            "cite_spans": [
                {
                    "start": 654,
                    "end": 657,
                    "text": "[4,",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 658,
                    "end": 661,
                    "text": "10,",
                    "ref_id": null
                },
                {
                    "start": 662,
                    "end": 665,
                    "text": "32]",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In order to have a better guarantee to succeed in practice, the procedure described in this paper limits the time consumption to that needed for a pure manual alignment of the whole series, while trying to use automation as much as possible.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "First Elastix [10] , later SimpleElastix [16] was chosen as the framework that provides the means for automated registration. In general other implementation could be chosen, however Elastix (based on ITK [8] ) already accepts initial transformations. Even if an initial transformation is provided by manual alignment, it can still enter the automatic optimization and therefore get improved quantitatively as in the default case of pure automated optimization. In other words, if the automated optimization gets trapped in a local optimum i.e. fails to find the global optimum, a manual initial transform provides a different start point for the optimization such that the global optimum is reached.",
            "cite_spans": [
                {
                    "start": 14,
                    "end": 18,
                    "text": "[10]",
                    "ref_id": null
                },
                {
                    "start": 41,
                    "end": 45,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 205,
                    "end": 208,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Method"
        },
        {
            "text": "The work presented here is based on three distinct pieces of software:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Method"
        },
        {
            "text": "1. The Python-implemented registration program recRegStack.py which employs SimpleElastix. 1 2. Extra programs and commands needed to convert gigapixel slice scans from a Carl Zeiss slide scanner (in CZI fromat) to an image series usable by recRegStack.py.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Method"
        },
        {
            "text": "A build and invocation system to apply these to a full-size image series, with adjustments needed for the specific data at hand, using gnuplot [31] and GNU Parallel [29] . 2",
            "cite_spans": [
                {
                    "start": 143,
                    "end": 147,
                    "text": "[31]",
                    "ref_id": null
                },
                {
                    "start": 165,
                    "end": 169,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [],
            "section": "3."
        },
        {
            "text": "Schematic flow graph to visualize the dependencies involved in the iterative process. Images are represented by squares, text-files by ovals. The parameters used by default (dfl. PF, dPF) during the registration (reg.) need to be tuned for the integral image series (2D series) in order to reduce the need for manual interactions. The first image at the start is copied unchanged. The last aligned image (ali. Img) is used as fixed image (fix. Img, fI) for registering the next image from the series (mov. Img, mI). In the case that the default parameters do not yield an acceptable result for an individual image pair, it is possible to supply a manual initial transform (man. iT, mIT) and/or provide individual registration parameters (idv. PF, iPF). Tuning the default parameters (dPF) is the most difficult (time consuming, red) task, adjusting some individual parameters less problematic (iPF, yellow) while creating a manual initial transform (mIT, green) with e.g. midas is easiest. In case some images need to be re-scanned (due to scanartefacts, defocus, etc), the transform parameter files (tra. PF, tPF) can be used to register the new image exactly the same way (reprod.) or the registration process can be re-initiated to make use of the improved image quality.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fig. 1. Processing dependencies"
        },
        {
            "text": "recRegStack.py takes an Elastix/ITK parameter file (containing the definition of various meta-parameters) into account, which allows changing the default values used by SimpleElastix. The last transformed image is used to register the following one, see Fig. 1 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 254,
                    "end": 260,
                    "text": "Fig. 1",
                    "ref_id": null
                }
            ],
            "section": "Fig. 1. Processing dependencies"
        },
        {
            "text": "For the proof of principle, midas of the IMOD package [19] was chosen for manual alignment due to its superior precision and interaction possibilities. Manually created initial transform files (mITs, Fig. 1 ) will then be taken into account by recRegStack.py when continuing the automated alignment. In addition, it is possible to adjust the meta-parameters for individual image pairs (iPF, Fig. 1 ) in case the mIT together with the global defaults (dPF, Fig. 1) do not lead to a satisfactory result. 3 This can happen for example if the fixed image (fI) and the moving image (mI) come from different section bands, possibly differing significantly in focus quality.",
            "cite_spans": [
                {
                    "start": 54,
                    "end": 58,
                    "text": "[19]",
                    "ref_id": null
                },
                {
                    "start": 502,
                    "end": 503,
                    "text": "3",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [
                {
                    "start": 200,
                    "end": 206,
                    "text": "Fig. 1",
                    "ref_id": null
                },
                {
                    "start": 391,
                    "end": 397,
                    "text": "Fig. 1",
                    "ref_id": null
                },
                {
                    "start": 456,
                    "end": 463,
                    "text": "Fig. 1)",
                    "ref_id": null
                }
            ],
            "section": "Fig. 1. Processing dependencies"
        },
        {
            "text": "The described approach was applied to an image series of about 2600 histological serial section of lung tissue (rat, details can be found in [27] ), referred to as K2dataset. An EM UC7 microtome (Leica, Germany) was used to cut semi-thin sections with a thickness of 1 \u00b5m connected to bands of about 1 to 20 sections. These bands were placed on 177 glass slides (where possible as a single row) After staining with toluidine blue, the slides were digitalized at a magnification of 10X by an AxioScan Z1 (Zeiss, Germany) using a single-channel fluorescence camera with a very low transmission light in order to get greyscale images (in CZI format) with a dynamic range above 8-bits.",
            "cite_spans": [
                {
                    "start": 141,
                    "end": 145,
                    "text": "[27]",
                    "ref_id": "BIBREF26"
                }
            ],
            "ref_spans": [],
            "section": "Application and Results"
        },
        {
            "text": "The build and invocation system for this image series can be found in http:// gitlab.com/romangrothausmann/K2 fibrosis/. This git repository holds references to the raw-data (CZIs) in an annex (https://git-annex.branchable.com/), imports http://github.com/romangrothausmann/CZIto3D as a subtree for local adjustments as needed for the specific data and serves as processing protocol. recRegStack.py from http://github.com/romangrothausmann/elastix scripts/ is invoked via a docker-image (http://www.docker.com/) containing all the needed libraries to reproducibly register the images. There is a short (downscaled) image series for testing in tests/recRegStack/.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Application and Results"
        },
        {
            "text": "The point densities of mITs and iPFs are visualized with kernel density plots on the negative y-axis (unrelated to metric value, \u03c3 = 10). Mean of metric: \u2248 4100, Std. Dev.: \u2248 9300, some values are outside of the plot range, iPFs (52) are needed less often then mITs (621), mostly in cases of high metric values. The largest interval without any manual intervention (no mITs) is from 305 to 393 even though the default parameter file (dPF) was tuned at different locations (e.g. slice 929, 1266 and 1379). The centre xz-and yz-slice of the result stack (as shown in Fig. 5 ) are plotted for comparison. Distortions due to alignment drift can be seen, especially in the xz-slice up to slice 500.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 565,
                    "end": 571,
                    "text": "Fig. 5",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Fig. 4. Plot of metric values with markers for mIT and iPF"
        },
        {
            "text": "Fiji [6] was used to roughly mark the centre of each section in thumbnail images of the gigapixel scans (czi2stack/Makefile). These centres were then used to automatically extract the region of each slice as its own image (3000 x 3000 pixel, PNG) with bfconvert [23] (czi2stack/Makefile). In case of broken bands, the ordering implied by the centre marks had to be adjusted to match the physical order (czi2stack/slides/slideOrder.lst, discrepancies often only visible after a registration). This order was then used to register the consecutive slices (czi2stack/Makefile). The mask for registration and the default parameter file (dPF) were adjusted to fit the K2-dataset, applying rigid registration using a \"MultiResolutionRegistration\" with \"AdvancedMean-Squares\" metric and \"AdaptiveStochasticGradientDescent\" as optimizer, see czi2stack/parameterFile.txt for details. Still, 621 mITs (in average every 4th image) and 52 iPFs (in average every 50th image) were needed to align all 2607 images, see Fig. 4 . Some exemplary image pairs (good, dirt, defocus, folds) are shown in Fig. 3 . Since the registration reconstructs the spatial correspondence in the 3rd dimension, the resulting image stack can then be regarded as a 3D dataset of 3000 x 3000 x 2607 voxel (about 44 GB @ 16-bit), see Fig. 5 . The volume in lung samples occupied by tissue is only about 10%-20% [3, 7] , so there is about 90%-80% mostly non-correlating texture in image pairs which disturbs the registration process. This is one reason why the registration of serial sections of lung tissue is challenging. A possible countermeasure is to \"fill\" the non-tissue space with (roughly) correlating data. This can be achieved by first auto-thresholding the image to roughly binarize tissue and non-tissue and then generating a distance map, which is implemented in the branch ot+dm and leads to image pairs as in Fig. 6 . However, applying this version of recRegStack.py to the K2-dataset (K2 fibrosis@a5617581) showed, that more mITs are needed. 4 A reason for this might be that this approach is more sensitive to dirt, which ends up in the tissue segment and therefore causes significant disturbance in the distance transform, see Fig. 6 . Another promising approach could be registration based on landmarks generated by SIFT [14, 15] , similar to Fiji's \"Register Virtual Stack Slices\" [4] but using Elastix/ITK in order to keep the features of manual intervention (mIT and iPF) 5 . 4 A full alignment with ot+dm was not pursued further because currently SimpleITK of SimpleElastix does not allow to set a mask for the otsu-threshold calculation (ot-mask). Therefore, the continuation feature of recRegStack.py cannot be used so that after each mIT creation the registration has to start from the beginning and therefore the whole procedure needs much more time. An alternative would be to port recRegStack.py to ITKElastix. 5 The lack of the possibility for manual intervention and a trial of more than two weeks to find meta-parameters to register the K2-dataset with Fiji's \"Register Virtual Stack Slices\" was actually the motivation for implementing recRegStack.py.",
            "cite_spans": [
                {
                    "start": 5,
                    "end": 8,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 262,
                    "end": 266,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 1371,
                    "end": 1374,
                    "text": "[3,",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 1375,
                    "end": 1377,
                    "text": "7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 2018,
                    "end": 2019,
                    "text": "4",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 2300,
                    "end": 2304,
                    "text": "[14,",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 2305,
                    "end": 2308,
                    "text": "15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 2361,
                    "end": 2364,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 2458,
                    "end": 2459,
                    "text": "4",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 2900,
                    "end": 2901,
                    "text": "5",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [
                {
                    "start": 1003,
                    "end": 1009,
                    "text": "Fig. 4",
                    "ref_id": null
                },
                {
                    "start": 1081,
                    "end": 1087,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 1294,
                    "end": 1300,
                    "text": "Fig. 5",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1884,
                    "end": 1890,
                    "text": "Fig. 6",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 2205,
                    "end": 2211,
                    "text": "Fig. 6",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Fig. 4. Plot of metric values with markers for mIT and iPF"
        },
        {
            "text": "The described proof of principle combines automated alignment with manual intervention such that ideally the automation does the whole work but also ensures that \"in the worst case\" at least the result of a pure manual alignment will be achieved. This comes with a need to balance the two time consuming tasks: Either tuning the meta-parameters for the automated alignment of as many images in the series as possible (total time consumption can be unlimited) or helping the automation with initial manual alignments (total time is limited). While the current implementation with Makefiles serves as a proof of principle, it can be further improved to a more intuitive and user-friendly program. For example, by incorporating the processing done by various commands into the Python code, as well as avoiding midas and other IMOD-tools or aborting auto alignment in order to provide a manual alignment to continue with. A graphical user interface (GUI) could provide visual feedback (similar to the image viewer geeqie), incorporate the needed midas functionality and offer a \"manual intervention\" button. In principle, a threshold on the final metric value could be used to automatically trigger the suggestion of a manual alignment.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Another variant of recRegStack.py (branch combT 01) accumulates all former transforms and adds the newly found transform of the processed image pair as in [21] . While the two approaches should yield similar results, accumulation of a few hundred transforms can become problematic but in return can avoid larger differences in case of already similarly recorded image pairs. A third variant (branch reg2tra+prevTra) uses both approaches and chooses the result with the better metric value finally achieved.",
            "cite_spans": [
                {
                    "start": 155,
                    "end": 159,
                    "text": "[21]",
                    "ref_id": "BIBREF20"
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Ideally, a (non-destructive) tomogram or some form of markers should be used for guiding 3D reconstruction of serial sections (e.g. constrain local deformation corrections and avoid continuous drift), such functionality is offered by e.g. HistoloZee [1] .",
            "cite_spans": [
                {
                    "start": 250,
                    "end": 253,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "recRegStack.py provides the option to ignore some images of the series in case some slices are too distorted for registration or lost during the preparation (czi2stack/lostSlieds.lst). After aligning the next usable image of the series, a reconstruction of the lost slice can be created from the adjacent slices [14] .",
            "cite_spans": [
                {
                    "start": 312,
                    "end": 316,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "HistoloZee, Penn Image Computing and Science Laboratory (PICSL)",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Adler",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Yushkevich",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "3D reconstruction of histological sections: application to mammary gland tissue",
            "authors": [
                {
                    "first": "I",
                    "middle": [],
                    "last": "Arganda-Carreras",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Fern\u00e0ndez-Gonz\u00e0lez",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Mu\u00f1oz-Barrutia",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Ortiz-De-Solorzano",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Microsc. Res. Tech",
            "volume": "73",
            "issn": "11",
            "pages": "1019--1029",
            "other_ids": {
                "DOI": [
                    "10.1002/jemt.20829"
                ]
            }
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Assessment of the alveolar capillary network in the postnatal mouse lung in 3D using serial block-face scanning electron microscopy",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Buchacker",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Front. Physiol",
            "volume": "10",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.3389/fphys.2019.01357"
                ]
            }
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Register Virtual Stack Slices (Fiji",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Cardona",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Arganda-Carreras",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Saalfeld",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "n-SIFT: n-dimensional scale invariant feature transform",
            "authors": [
                {
                    "first": "W",
                    "middle": [],
                    "last": "Cheung",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Hamarneh",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "IEEE Trans. Image Process",
            "volume": "18",
            "issn": "9",
            "pages": "2012--2021",
            "other_ids": {
                "DOI": [
                    "10.1109/TIP.2009.2024578"
                ]
            }
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Fiji/ImageJ development team: Fiji (ImageJ)",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Digital 3D reconstructions using histological serial sections of lung tissue including the alveolar capillary network",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Grothausmann",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Knudsen",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Ochs",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "M\u00fchlfeld",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Am. J. Physiol.-Lung Cell. Mol. Physiol",
            "volume": "312",
            "issn": "2",
            "pages": "243--257",
            "other_ids": {
                "DOI": [
                    "10.1152/ajplung.00326.2016"
                ]
            }
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "ITK, see",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Ibanez",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "33",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "The Insight Software Consortium: The ITK Software Guide",
            "authors": [
                {
                    "first": "H",
                    "middle": [
                        "J"
                    ],
                    "last": "Johnson",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "M"
                    ],
                    "last": "Mccormick",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Ib\u00e0\u00f1ez",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "elastix: a toolbox for intensity-based medical image registration",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Klein",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Staring",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Murphy",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "A"
                    ],
                    "last": "Viergever",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "P"
                    ],
                    "last": "Pluim",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "IEEE Trans. Med. Imaging",
            "volume": "29",
            "issn": "1",
            "pages": "196--205",
            "other_ids": {
                "DOI": [
                    "10.1109/TMI.2009.2035616"
                ]
            }
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Computer visualization of threedimensional image data using IMOD",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Kremer",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "N"
                    ],
                    "last": "Mastronarde",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Mcintosh",
                    "suffix": ""
                }
            ],
            "year": 1996,
            "venue": "J. Struct. Biol",
            "volume": "116",
            "issn": "1",
            "pages": "71--76",
            "other_ids": {
                "DOI": [
                    "10.1006/jsbi.1996.0013"
                ]
            }
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Metadata matters: access to image data in the real world",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Linkert",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "J. Cell Biol",
            "volume": "189",
            "issn": "5",
            "pages": "777--782",
            "other_ids": {
                "DOI": [
                    "10.1083/jcb.201004104"
                ]
            }
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "The tempest in a cubic millimeter: image-based refinements necessitate the reconstruction of 3D microvasculature from a large series of damaged alternately-stained histological sections",
            "authors": [
                {
                    "first": "O",
                    "middle": [],
                    "last": "Lobachev",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1109/access.2020.2965885"
                ]
            }
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Object recognition from local scale-invariant features",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "G"
                    ],
                    "last": "Lowe",
                    "suffix": ""
                }
            ],
            "year": 1999,
            "venue": "",
            "volume": "2",
            "issn": "",
            "pages": "1150--1157",
            "other_ids": {
                "DOI": [
                    "10.1109/ICCV.1999.790410"
                ]
            }
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "SimpleElastix, see",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Marstal",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "18",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "SimpleElastix: a userfriendly, multi-lingual library for medical image registration",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Marstal",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Berendsen",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Staring",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Klein",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "International Workshop on Biomedical Image Registration (WBIR). IEEE Conference on Computer Vision and Pattern Recognition Workshops",
            "volume": "",
            "issn": "",
            "pages": "574--582",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Dual-axis tomography: an approach with alignment methods that preserve resolution",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "N"
                    ],
                    "last": "Mastronarde",
                    "suffix": ""
                }
            ],
            "year": 1997,
            "venue": "J. Struct. Biol",
            "volume": "120",
            "issn": "3",
            "pages": "343--352",
            "other_ids": {
                "DOI": [
                    "10.1006/jsbi.1997.3919"
                ]
            }
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Automated tilt series alignment and tomographic reconstruction in IMOD",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "N"
                    ],
                    "last": "Mastronarde",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "R"
                    ],
                    "last": "Held",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "J. Struct. Biol",
            "volume": "197",
            "issn": "2",
            "pages": "102--113",
            "other_ids": {
                "DOI": [
                    "10.1016/j.jsb.2016.07.011"
                ]
            }
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "Real-time deformable registration of multimodal whole slides for digital pathology",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Mueller",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Vossen",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Hulsken",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Comput. Med. Imaging Graph",
            "volume": "35",
            "issn": "7-8",
            "pages": "542--556",
            "other_ids": {
                "DOI": [
                    "10.1016/j.compmedimag.2011.06.006"
                ]
            }
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Using electron microscopes to look into the lung",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Ochs",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Knudsen",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Hegermann",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Wrede",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Grothausmann",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "M\u00fchlfeld",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Histochem. Cell Biol",
            "volume": "146",
            "issn": "6",
            "pages": "695--707",
            "other_ids": {
                "DOI": [
                    "10.1007/s00418-016-1502-z"
                ]
            }
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Open Microscopy Environment: bftools (scripts using Bio-Formats), see",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Fiji: an open-source platform for biological-image analysis",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Schindelin",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Nat. Methods",
            "volume": "9",
            "issn": "7",
            "pages": "676--682",
            "other_ids": {
                "DOI": [
                    "10.1038/nmeth.2019"
                ]
            }
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "NIH Image to ImageJ: 25 years of image analysis",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "A"
                    ],
                    "last": "Schneider",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "S"
                    ],
                    "last": "Rasband",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [
                        "W"
                    ],
                    "last": "Eliceiri",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Nat. Method",
            "volume": "9",
            "issn": "7",
            "pages": "671--675",
            "other_ids": {
                "DOI": [
                    "10.1038/nmeth.2089"
                ]
            }
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "Fast parallel image registration on CPU and GPU for diagnostic classification of Alzheimer's disease",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Shamonin",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [],
                    "last": "Bron",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Lelieveldt",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Smits",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Klein",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Staring",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Front. Neuroinform",
            "volume": "7",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.3389/fninf.2013.00050"
                ]
            }
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "Surfactant replacement therapy reduces acute lung injury and collapse induration-related lung remodeling in the bleomycin model",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Steffen",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Am. J. Physiol.-Lung Cell. Mol. Physiol",
            "volume": "313",
            "issn": "2",
            "pages": "313--327",
            "other_ids": {
                "DOI": [
                    "10.1152/ajplung.00033.2017"
                ]
            }
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "GNU parallel -the command-line power tool. Login: The USENIX Mag",
            "authors": [
                {
                    "first": "O",
                    "middle": [],
                    "last": "Tange",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "",
            "volume": "36",
            "issn": "",
            "pages": "42--47",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "GNU parallel -the command-line power tool, see",
            "authors": [
                {
                    "first": "O",
                    "middle": [],
                    "last": "Tange",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "29",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "Fully automatic and robust 3D registration of serial-section microscopic images",
            "authors": [
                {
                    "first": "C.-W",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "B"
                    ],
                    "last": "Gosno",
                    "suffix": ""
                },
                {
                    "first": "Y.-S",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Sci. Rep",
            "volume": "5",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1038/srep15051"
                ]
            }
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "Insight into Images: Principles and Practice for Segmentation, Registration, and Image Analysis. A K Peters Ltd",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Yoo",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Bands of serial sections of stained lung tissue on glass slides Some exemplary thumbnails of slide scans with bands of serial sections of lung tissue stained on glass slides. Ranging from good (left, one band well aligned and no significant staining variations) to bad (right, broken bands with unobvious order, staining variations and slice loss due to folds and extending slide border). Lines indicate different glass slide.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Exemplary image pairs Left column: fixed image, middle column: moving image, right column: Magenta-Green overlay of the image pair (similar to midas). Image pair rows: 1. ideal (no mIT or iPF needed). 2. dirt (mIT but no iPF needed). 3. defocus (no mIT or iPF needed). 4. folds (no mIT or iPF needed). Metric for 3 without mIT is 34974 and with mIT 20214. (Color figure online) see Fig. 2.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Volume rendering of the 3D stack Volume rendered visualization of the reconstructed 3rd dimension of the lung tissue block (sub-extent of 1000 \u00d7 1000 \u00d7 2607 voxel). Tissue dark, resin semi-transparent grey (airspaces and blood vessels).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Exemplary image pair for ot+dm variant Top row: image pair as is (no mIT or iPF needed), fixed image, moving image, Magenta-Green overlay. Bottom row: ot+dm image pair for images on the left (blue-white-red LUT from -50 to 50, blue: air, blood space; red: tissue, dirt). (Colorfigure online)",
            "latex": null,
            "type": "figure"
        }
    },
    "back_matter": [
        {
            "text": "Acknowledgement. Special thanks go to Susanne Fa\u00dfbender (for excellent technical assistance), Lena Ziemann (for slide scanning and creation of mITs and iPFs), Kasper Marstal, Fabien Pertuy, Stefan Klein and Marius Staring (for feedback on use of Elastix, SimpleElastix and debugging) and to David Mastronarde, Daniel Adler (for feedback on IMOD and HistoloZee details) and Oleg Lobachev (for feedback on the general approach).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "acknowledgement"
        }
    ]
}