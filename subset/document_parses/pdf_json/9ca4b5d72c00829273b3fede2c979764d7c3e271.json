{
    "paper_id": "9ca4b5d72c00829273b3fede2c979764d7c3e271",
    "metadata": {
        "title": "A nationwide deep learning pipeline to predict stroke and COVID-19 death in atrial fibrillation",
        "authors": [
            {
                "first": "Alex",
                "middle": [],
                "last": "Handy",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University College London",
                    "location": {
                        "settlement": "London",
                        "country": "UK"
                    }
                },
                "email": ""
            },
            {
                "first": "Angela",
                "middle": [],
                "last": "Wood",
                "suffix": "",
                "affiliation": {
                    "laboratory": "British Heart Foundation Cardiovascular Epidemiology Unit",
                    "institution": "University of Cambridge",
                    "location": {
                        "settlement": "Cambridge",
                        "country": "UK"
                    }
                },
                "email": ""
            },
            {
                "first": "Cathie",
                "middle": [],
                "last": "Sudlow",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Edinburgh",
                    "location": {
                        "settlement": "Edinburgh",
                        "country": "UK"
                    }
                },
                "email": ""
            },
            {
                "first": "Christopher",
                "middle": [],
                "last": "Tomlinson",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University College London",
                    "location": {
                        "settlement": "London",
                        "country": "UK"
                    }
                },
                "email": ""
            },
            {
                "first": "Frank",
                "middle": [],
                "last": "Kee",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Queens University Belfast",
                    "location": {
                        "country": "UK"
                    }
                },
                "email": ""
            },
            {
                "first": "Johan",
                "middle": [
                    "H"
                ],
                "last": "Thygesen",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University College London",
                    "location": {
                        "settlement": "London",
                        "country": "UK"
                    }
                },
                "email": ""
            },
            {
                "first": "",
                "middle": [],
                "last": "Mohammad",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "",
                "middle": [],
                "last": "Mamouei",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Reecha",
                "middle": [],
                "last": "Sofat",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University College London",
                    "location": {
                        "settlement": "London",
                        "country": "UK"
                    }
                },
                "email": ""
            },
            {
                "first": "Richard",
                "middle": [],
                "last": "Dobson",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University College London",
                    "location": {
                        "settlement": "London",
                        "country": "UK"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "Deep learning (DL) and machine learning (ML) models trained on long-term patient trajectories held as medical codes in electronic health records (EHR) have the potential to improve disease prediction. Anticoagulant prescribing decisions in atrial fibrillation (AF) offer a use case where the benchmark stroke risk prediction tool (CHA2DS2-VASc) could be meaningfully improved by including more information from a patient's medical history. In this study, we design and build the first DL and ML pipeline that uses the routinely updated, linked EHR data for 56 million people in England accessed via NHS Digital to predict first ischaemic stroke in people with AF, and as a secondary outcome, COVID-19 death. Our pipeline improves first stroke prediction in AF by 17% compared to CHA2DS2-VASc (0.61 (0.57-0.65) vs 0.52 (0.52-0.52) area under the receiver operating characteristics curves, 95% confidence interval) and provides a generalisable, opensource framework that other researchers and developers can build on.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Recent advances in artificial intelligence can provide the basis for improving medical predictions 1 . In particular, advances in modelling large sequences of text using deep learning (DL) and natural language processing 2,3 has opened up the possibility of harnessing long-term patient trajectories held as medical codes in electronic health records (EHR) 4, 5 . Unlike conventional statistical and machine learning (ML) models, DL models can learn representations by directly taking long, individual sequences of medical codes stored in EHRs as inputs and could potentially identify complex, longterm dependencies between medical events 6 . To date, the improved performance of these DL models on their selected prediction tasks is promising 4,5 but there has been limited comparison against prediction tools used routinely in clinical practice with comparisons typically made to other DL or ML methods. A direct comparison is important to demonstrate clearly where and by how much DL and ML can offer improvements and to help in integrating these methods (where appropriate) into routine clinical practice.",
            "cite_spans": [
                {
                    "start": 99,
                    "end": 100,
                    "text": "1",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 357,
                    "end": 359,
                    "text": "4,",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 360,
                    "end": 361,
                    "text": "5",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 639,
                    "end": 640,
                    "text": "6",
                    "ref_id": "BIBREF5"
                }
            ],
            "ref_spans": [],
            "section": "MAIN"
        },
        {
            "text": "Anticoagulant prescribing decisions in atrial fibrillation (AF) offer a use case where the benchmark stroke risk prediction tool (CHA2DS2-VASc 7 ) used routinely in clinical practice could be meaningfully improved by including more information from a patient's medical history. AF is a disturbance of heart rhythm affecting 37.5 million people globally 8 and significantly increases ischaemic stroke risk 9 . Anticoagulants reduce the risk of stroke 10 and are recommended for people with AF and a high risk of stroke, broadly defined as a CHA2DS2-VASc >=2 based on the National Institute for Health and Care Excellence (NICE) threshold 11, 12 . The CHA2DS2-VASc score benefits from being easy to calculate and interpret, however, it only measures 7 variables (age, sex, history of congestive heart failure, hypertension, stroke/TIA/thromboembolism, vascular disease and diabetes) and NICE's own evidence review highlights the need for improved stroke risk assessment 13 . It shows that whilst CHA2DS2-VASc is good for identifying people potentially at risk of stroke (high sensitivity) it is poor at identifying people who may not have a stroke (low specificity) 14 . The ability of CHA2DS2-VASc to discriminate an individual's future stroke risk is also only moderate (pooled area under the receiver operating characteristics curve (AUC) of 0.67 across 27 studies 14 ) and potentially lower for predicting first ever stroke based on information at the point of AF diagnosis where available evidence is significantly limited. Recent research has also observed that pre-existing use of antithrombotics, particularly anticoagulants, is associated with lower odds of people with AF dying from COVID-19 15, 16 . A model that could improve prediction of first stroke in people with AF and also identify those at greatest risk of COVID-19 death would be a potentially valuable new tool to inform anticoagulant prescribing decisions.",
            "cite_spans": [
                {
                    "start": 353,
                    "end": 354,
                    "text": "8",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 405,
                    "end": 406,
                    "text": "9",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 450,
                    "end": 452,
                    "text": "10",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 637,
                    "end": 640,
                    "text": "11,",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 641,
                    "end": 643,
                    "text": "12",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 968,
                    "end": 970,
                    "text": "13",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 1164,
                    "end": 1166,
                    "text": "14",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 1700,
                    "end": 1703,
                    "text": "15,",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 1704,
                    "end": 1706,
                    "text": "16",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "MAIN"
        },
        {
            "text": "In this study, we design and build the first DL and ML pipeline that uses the routinely updated, linked EHR data for 56 million people in England accessed via NHS Digital's Trusted Research Environment (TRE) 17 . We use this pipeline to predict first ischaemic stroke in people with AF (mean follow-up time 7.2 years), and as a secondary outcome, COVID-19 death, using individual sequences of medical codes from the entire primary and secondary care record. We compare the performance of our DL and ML pipeline directly against the CHA2DS2-VASc score to support translation to clinical practice and demonstrate a 17% improvement on predicting first stroke in AF. The code for our pipeline is generalisable, opensource and designed to provide a proof-of-concept framework that other researchers and developers can build on.",
            "cite_spans": [
                {
                    "start": 208,
                    "end": 210,
                    "text": "17",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "MAIN"
        },
        {
            "text": "We built our DL and ML pipeline within NHS Digital's TRE for England which provides secure, remote access to routinely collected, linked, person level EHR data for over 56 million people 17 . Available data sources include primary care, secondary care, pharmacy dispensing, death registrations and COVID-19 tests and vaccines.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Nationwide deep learning and machine learning pipeline"
        },
        {
            "text": "For this study, we constructed individual sequences of medical codes using all coded events from the General Practice Extraction Service Extract for Pandemic Planning and Research (GDPPR) and Hospital Episode Statistics on admissions (HES APCprimary diagnosis code) datasets. Recorded events were organised into a time ordered list (earliest first) of medical codes (e.g. [SNOMED-CT code 1, ICD-10 code 1, SNOMED-CT code 2, ICD-10 code 2\u2026SNOMED-CT n / ICD-10 code n]) up to the target inclusion event (e.g. first AF diagnosis) alongside a set of static variables that represent demographic information (e.g. female, age at first AF diagnosis, ethnicity, see Figure 1 ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 658,
                    "end": 666,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Nationwide deep learning and machine learning pipeline"
        },
        {
            "text": "To make the analysis computationally tractable, we built a sampling module which creates training, validation and test sub-samples (with cohort inclusion criteria applied) from this transformed data. Figure 1 -overview of the key data processing steps for the DL and ML pipeline within NHS Digital's TRE for England For the model components, transformer and long short-term memory (LSTM) network architectures were selected as blueprints for the DL models due to their suitability for sequence modelling both within and outside of EHRs [3] [4] [5] [18] [19] [20] . For the ML models, logistic regression, random forest and XGBoost were selected to provide a conventional benchmark (logistic regression) and a selection of models with evidence of performing well on structured, tabular data (random forest and XGboost) 21, 22 . CHA2DS2-VASc scores were also calculated for each individual (see \"Methods\" section) with CHA2DS2-VASc >= 2 used as the baseline for assessing the prediction tasks. For the ML models (logistic regression, random forest and XGBoost) individual sequences of medical codes were represented as one hot encoded variables for each unique code in the cohort sample with static variables represented as covariates in their continuous or categorical form. The DL models (transformer and LSTM) required a more sophisticated input representation and architecture (see Figure 2 and \"Methods\" section) that preserved the sequential order of medical codes for each individual. The same model architectures were used for all prediction tasks. ",
            "cite_spans": [
                {
                    "start": 536,
                    "end": 539,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 540,
                    "end": 543,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 544,
                    "end": 547,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 548,
                    "end": 552,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 553,
                    "end": 557,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 558,
                    "end": 562,
                    "text": "[20]",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 818,
                    "end": 821,
                    "text": "21,",
                    "ref_id": "BIBREF20"
                },
                {
                    "start": 822,
                    "end": 824,
                    "text": "22",
                    "ref_id": "BIBREF21"
                }
            ],
            "ref_spans": [
                {
                    "start": 200,
                    "end": 208,
                    "text": "Figure 1",
                    "ref_id": null
                },
                {
                    "start": 1384,
                    "end": 1392,
                    "text": "Figure 2",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Nationwide deep learning and machine learning pipeline"
        },
        {
            "text": "Two sample cohorts were created for the prediction tasks, an AF first stroke cohort (an AF diagnosis and no prior stroke diagnosis) and an AF+COVID-19 cohort (an AF diagnosis, no prior stroke diagnosis and a positive COVID-19 event, see \"Methods\" section for more details). ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Cohort characteristics for prediction tasks"
        },
        {
            "text": "The primary prediction task was to predict the binary outcome of first ischaemic stroke in people with AF (mean follow-up time 7.2 years). For this task, XGBoost was the top performing model (AUC=0.61 (0.57-0.65) with random forest a close second (AUC=0.60 (0.58-0.62), followed by transformer (AUC=0.58 (0.58-0.58) and logistic regression (AUC=0.58 (0.56-0.60) models. LSTM (AUC=0.53 (0.47-0.59) and CHA2DS2-VASc >=2 (AUC=0.52 (0.52-0.52) were the worst performing models (see Table 2 ). XGBoost did not have the highest overall accuracy (0.53 (0.51-0.55) vs random forest with 0.56 (0.52-0.60) but did have higher sensitivity (0.68 (0.62-0.74) vs 0.65 (0.63-0.67)).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 478,
                    "end": 485,
                    "text": "Table 2",
                    "ref_id": "TABREF2"
                }
            ],
            "section": "Prediction task performance"
        },
        {
            "text": "Models were also evaluated on sub-groups to compare predictive performance across gender, age and ethnicities (see Supplementary Table 1) . Performance was broadly consistent across sub-groups with the exception of potentially lower performance in individuals with a recorded ethnicity of \"black or black british\" (XGBoost AUC=0.30 (0.00-0.93)), \"mixed ethnicity\" (XGBoost AUC=0.33 (0.00-1.00)) or \"other ethnic group\" (XGBoost AUC=0.49 (0.00-1.00)). In contrast to the stroke prediction task, there was more divergence in model performance across sub-groups (see Supplementary Table 2 ). AUC was 4% (XGBoost) to 13% (CHA2DS2-VASc) lower for women compared to men. For people aged under 65, CHA2DS2-VASc, AUC was 33% higher than for people aged 65 or over. However, in the other models AUC was 23% (XGBoost) to 5% (Transformer / LSTM) lower for people aged under 65 compared to people aged 65 or over. Across ethnicities, performance was more consistent, with the exception of people with a \"mixed\" recorded ethnicity where AUC was on average 11% higher than for the other ethnic groups.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 115,
                    "end": 137,
                    "text": "Supplementary Table 1)",
                    "ref_id": null
                },
                {
                    "start": 564,
                    "end": 585,
                    "text": "Supplementary Table 2",
                    "ref_id": "TABREF2"
                }
            ],
            "section": "Prediction task performance"
        },
        {
            "text": "This study is the first to design and build a DL and ML pipeline that uses the routinely updated, linked EHR data for 56 million people in England accessed via NHS Digital. All the DL and ML models outperformed CHA2DS2-VASc for predicting first ischaemic stroke (AUC=0.52 (0.52-0.52)) and COVID-19 death (AUC=0.58 (0.58-0.58)) in people with AF. However, DL models did not outperform more conventional ML methods, with XGBoost the top performing model for predicting first stroke (AUC=0.61 (0.57-0.65)) and COVID-19 death (AUC=0.73 (0.73-0.73). We also provide detailed performance statistics (e.g. accuracy, sensitivity, specificity, precision) and sub-group analysis (e.g. gender, age, ethnicity) to ensure we adhere to recommended guidance for reporting on DL and ML analysis in clinical research 23,24 wherever possible and appropriate. Whilst the top performing model improves first stroke prediction by 17% compared to CHA2DS2-VASc (0.61 vs 0.52), further improvements are required before our pipeline could be considered for use in clinical practice.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DISCUSSION"
        },
        {
            "text": "Despite the rapid improvements in DL and ML, applications in routine clinical care remain challenging 25 . This is partly because DL and ML applications are developed on data and infrastructure which is often different to what is available in routine care 25 . NHS Digital's TRE for England is unique in providing a platform with widely linked, routinely collected, population-scale data that could form the foundation of a nationwide DL and ML powered EHR 17 . Motivated by this potential we have successfully developed the first proof-of-concept DL and ML pipeline that deploys advanced DL and ML models within the unique environment of NHS Digital's TRE for England. We then sought to demonstrate that this could improve a clinical use case where a prediction tool is already routinely used and where there is an opportunity to improve performance by harnessing high-dimensional information from a patient's medical history. We, therefore, selected anticoagulant prescribing decisions in AF and tested our pipeline against the CHA2DS2-VASc score for predicting first stroke after AF and COVID-19 death.",
            "cite_spans": [
                {
                    "start": 102,
                    "end": 104,
                    "text": "25",
                    "ref_id": "BIBREF24"
                },
                {
                    "start": 256,
                    "end": 258,
                    "text": "25",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "DISCUSSION"
        },
        {
            "text": "It is already recognised that CHA2DS2-VASc is an imprecise tool for stroke prediction 14 and this is reflected in the differing thresholds recommended in international clinical guidance 13, 26 . Our findings reinforce the challenges of precisely predicting stroke using CHA2DS2-VASc, particularly for predicting first ever stroke at the point of AF diagnosis, where the performance on discriminating between someone who had a stroke compared to someone who did not was little better than chance (an AUC of 0.50) in our study. The poor performance of CHA2DS2-VASc may be partly explained by its heavy weighting of previous stroke diagnoses which get 2 points in a 7 variable, 9 point system. Our DL and ML models improved prediction performance, potentially by being able to use more variables (represented as medical codes) from an individual's primary and secondary care record up to AF diagnosis. However, the sequential ordering of an individual's medical codes did not appear to improve predictions as XGBoost outperformed the DL models using only the binary information of whether a person had a recorded medical code (one-hot encoding). XGBoost has been shown to perform as well as DL models on tabular data 22 and has also been applied to a range of EHR disease prediction problems 27, 28 . Despite a 17% improvement compared to CHA2DS2-VASc, the performance was still only moderate and supports the observation that predicting first stroke in atrial fibrillation is a challenging prediction problem.",
            "cite_spans": [
                {
                    "start": 86,
                    "end": 88,
                    "text": "14",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 186,
                    "end": 189,
                    "text": "13,",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 190,
                    "end": 192,
                    "text": "26",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 1214,
                    "end": 1216,
                    "text": "22",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 1289,
                    "end": 1292,
                    "text": "27,",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 1293,
                    "end": 1295,
                    "text": "28",
                    "ref_id": "BIBREF27"
                }
            ],
            "ref_spans": [],
            "section": "DISCUSSION"
        },
        {
            "text": "The performance on prediction of COVID-19 death was more encouraging and begins to demonstrate how our DL and ML pipeline could deliver larger improvements to disease prediction and be used in clinical practice. A key driver of the improved performance of predicting COVID-19 death is likely the inclusion of more medical codes due to the later, on average, target inclusion event of a positive COVID-19 event compared to a first AF diagnosis. This meant that DL and ML models had access to, on average, 76 unique medical codes from an individual's medical history vs 20 in the first stroke cohort. Importantly, all the models except CHA2DS2-VASc showed an AUC improvement of at least 17% (vs 12%) indicating that DL and ML architectures can extract incrementally valuable information from longer sequences.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DISCUSSION"
        },
        {
            "text": "There are also several key limitations which prevented us from maximising the potential performance from DL and ML architectures. Firstly, graphical processing units (GPUs) and some parallel computing methods are currently restricted on the NHS Digital's TRE for England meaning that it was not possible to train models on larger datasets (e.g. 10,000+) or create DL architectures with more layers. This also prevented us from including an individual's full medical history (e.g. no repeating medical codes) and only allowed us to include the 100 most recent medical codes up to the target inclusion event. Secondly, the NHS Digital TRE for England does not yet facilitate the use or creation of code embeddings pre-trained with other models. This transfer learning approach was adopted by the teams behind BEHRT 4 and MedBERT 5 and builds on the performance gains demonstrated by large language models such as BERT 2 and GPT-3 29 .",
            "cite_spans": [
                {
                    "start": 928,
                    "end": 930,
                    "text": "29",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [],
            "section": "DISCUSSION"
        },
        {
            "text": "Lastly, medical codes stored in structured EHR data are just one type of data modality and do not reflect the full diversity of an individual's medical history. Even before adding new types of data to the TRE such as genetics, imaging and free text, there are observational values such as systolic blood pressure and cholesterol / HDL ratio which could be included in future models.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DISCUSSION"
        },
        {
            "text": "In addition to addressing the above, the next phase of our work will aim to improve the clinical interpretability of our DL and ML pipeline. For this study, we chose to compare model performance primarily using AUC on binary outcomes (e.g. 1 for stroke, 0 for no stroke) to support direct comparison to CHA2DS2-VASc but our pipeline is capable of producing estimated probabilities which could be used by clinicians as confidence measures and by future researchers to assess model calibrations. We will also explore adding feature assessment mechanisms (e.g. attention visualisation 30 ) to ML and DL models but recognise that this alone still falls short of the interpretability clinicians need 31 . It will also be important for future work to consider the implications of how missing data within the patients' sequence of medical codes might affect the accuracy of predictions in subgroups (e.g. deprived versus affluent) and adapt the algorithms accordingly to ensure equity 32 . Lastly, we will explore the potential to integrate adapted survival analysis models 33 which could allow more precise censoring of individuals and enhanced interpretability through mapping \"nodes\" to biological features.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DISCUSSION"
        },
        {
            "text": "In conclusion, we designed and built the first DL and ML pipeline that uses the routinely updated, linked EHR data for 56 million people in England and improved first stroke prediction by 17% compared to CHA2DS2-VASc. Further potential improvements could be achieved by using higher computation training regimes, pretrained embeddings and more data modalities.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DISCUSSION"
        },
        {
            "text": "The DL and ML pipeline was created using NHS Digital's TRE for England which provides secure, remote access to linked, person level EHR data for over 56 million people 17 ",
            "cite_spans": [
                {
                    "start": 168,
                    "end": 170,
                    "text": "17",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "Data sources"
        },
        {
            "text": "Individuals were eligible for the sample cohorts if they had five or more recorded medical codes [as in BEHRT 4 ] across GDPPR and HES APC, were >= 18 years old and alive on January 1st 2020, had available sex, ethnicity and GP practice location data (based on most recent, available data across primary care (GDPPR), secondary care (HES APC) and death registrations (Office for National Statistics)) and had a diagnosis of AF (coded in GDPPR). For the AF first stroke cohort, people who had a stroke diagnosis (including non-ischaemic strokes) prior to their AF diagnosis were excluded (see Supplementary Figure 1 for a cohort inclusion flowchart). People with AF who had an ischaemic stroke diagnosis after their AF diagnosis, were only included if their stroke occurred two or more months after the date of their first AF diagnosis to help screen out delayed coding of cases which may have occurred prior to AF diagnosis.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 592,
                    "end": 614,
                    "text": "Supplementary Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Cohort selection"
        },
        {
            "text": "For the AF+COVID-19 cohort, in addition to an AF diagnosis, individuals required a recorded COVID-19 event defined as any of a positive test (polymerase chain reaction or lateral flow), a coded diagnosis in primary or secondary care or a COVID-19 diagnosis on a death certificate 34 The entire eligible study population was then randomly split 80:20 into training and test datasets. Prevalence of first ischaemic stroke after AF was low (1.9%) which means the target class (stroke) was highly imbalanced in the training data. To address this for the training data, we created a rebalanced sample by selecting all stroke cases and randomly selecting (with replacement) controls at a ratio of 1 control to 1 stroke case. This ratio was selected after initial experimentation which showed that DL and ML models had limited ability to discriminate (based on AUC) after being trained on ratios of 1-to-3 and population prevalence. The testing dataset was kept at the population prevalence. The same approach was adopted for COVID-19 death which had moderate prevalence (23.2%) in people with AF.",
            "cite_spans": [
                {
                    "start": 280,
                    "end": 282,
                    "text": "34",
                    "ref_id": "BIBREF33"
                }
            ],
            "ref_spans": [],
            "section": "Cohort selection"
        },
        {
            "text": "As outlined in Figure 1 , a sampling module was developed to create computationally tractable sub-samples from the nationwide, eligible study population. Random subsamples of 10,000 people were selected from the rebalanced training and testing datasets. The training sub-sample was then split into model training data (n=8000) and validation data (n=2000), with the model with the highest AUC on the validation data selected for testing. To assess the reliability of model predictions, three versions of each training and test sub-sample were created with averages and confidence intervals reported in results.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 15,
                    "end": 23,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Cohort selection"
        },
        {
            "text": "The maximum length of medical codes included for each individual was also adjusted to reduce computational requirements. Models were trained and tested with a limit of 100 medical codes which included all codes for 99% of the AF first stroke cohort and >75% of AF+COVID-19 cohort.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Cohort selection"
        },
        {
            "text": "The primary prediction task was to predict the binary outcome of first ischaemic stroke in people with AF. A CHA2DS2-VASc score >=2 was used as the baseline with individuals with a score of >=2 assigned a label of 1 (prediction of future stroke) and those <2 assigned a label of 0 (prediction of no future stroke). The CHA2DS2-VASc score was calculated for each individual in the cohort based on the scoring system outlined here 7 , with \"Stroke/TIA/thromboembolism history\" excluded due to the removal of individuals with these diagnoses from the cohort given the target prediction outcome was first stroke.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Statistical analysis and model implementation"
        },
        {
            "text": "For the ML models (logistic regression, random forest and XGBoost) individual sequences of medical codes were represented as one hot encoded variables for each unique code in the cohort sample with the static variables (female, age at first AF diagnosis, ethnicity) represented as covariates in their continuous or categorical form.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Statistical analysis and model implementation"
        },
        {
            "text": "The DL models (transformer and LSTM) required a more sophisticated input representation and architecture (see Figure 2 for graphical overview). The general design principle was to keep the models as simplistic as possible for the proof-ofconcept with default configurations used where possible (refer to Pytorch documentation -https://pytorch.org/docs/stable/torch.html) and additional layers and modules kept to a minimum.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 110,
                    "end": 118,
                    "text": "Figure 2",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Statistical analysis and model implementation"
        },
        {
            "text": "A vocabulary of each unique medical code from all the individual sequences of medical codes from the cohort sample was assembled and used to create a trainable set of vector embeddings for each medical code. Individual sequences of medical codes are, therefore, input into DL models as sequences with dimensions D m*n with m the max length of an individual sequence of medical codes in the cohort (limited to 100 in this study and padded with zeros for individuals with shorter sequences) and n the size of the medical code vector embeddings (200 in this study). The transformer also has positional embeddings to ensure it has the ability to learn information from the relative position of the medical codes 3 . These sequences are then passed through a sequential module (recurrent gated cells for LSTM and multiheaded attention layers for transformer) to provide a pooled representation of each sequence. Both the LSTM and transformer have two internal layers; two hidden layers for the LSTM and two encoder layers (with two attention heads) for the transformer.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Statistical analysis and model implementation"
        },
        {
            "text": "Static variables were represented and input into the models as a vector of continuous values and passed through a separate feed forward layer with a rectified linear unit activation function prior to concatenation with the pooled outputs of the sequential module. The concatenated layer containing sequential and static information is then passed through another two feed forward layers to produce a vector the size of the number of output labels (two for a binary outcome) that is converted into logits for the loss function using the LogSoftmax. Dropout layers (with a probability of dropout of 0.20) were included in the sequential module and the concatenated outputs to help prevent the model overfitting to the data.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Statistical analysis and model implementation"
        },
        {
            "text": "Training parameters were kept consistent across both LSTM and transformer architectures with 10 epochs, a batch size of 64 and a learning rate of 0.001 (using an ADAM optimizer 35 For any further specifications please refer to the code on GitHub (https://github.com/BHFDSC/CCU004_02/tree/main/code).",
            "cite_spans": [
                {
                    "start": 177,
                    "end": 179,
                    "text": "35",
                    "ref_id": "BIBREF34"
                }
            ],
            "ref_spans": [],
            "section": "Statistical analysis and model implementation"
        },
        {
            "text": "The data used in this study are available in NHS Digital's TRE for England, but as restrictions apply they are not publicly available (https://digital.nhs.uk/coronavirus/coronavirus-data-services-updates/trustedresearch-environment-service-for-england). The CVD-COVID-UK/COVID-IMPACT programme led by the BHF Data Science Centre (https://www.hdruk.ac.uk/helpingwith-health-data/bhf-data-science-centre/) received approval to access data in NHS Digital's TRE for England from the Independent Group Advising on the Release of Data (IGARD) (https://digital.nhs.uk/about-nhs-digital/corporate-information-anddocuments/independent-group-advising-on-the-release-of-data) via an application made in the Data Access Request Service (DARS) Online system (ref. DARS-NIC-381078-Y9C5K) (https://digital.nhs.uk/services/data-access-request-servicedars/dars-products-and-services). The CVD-COVID-UK/COVID-IMPACT Approvals & Oversight Board (https://www.hdruk.ac.uk/projects/cvd-covid-uk-project/) subsequently granted approval to this project to access the data within the TRE for England. The de-identified data used in this study were made available to accredited researchers only. Analyses were conducted by approved researcher (AH) via secure remote access to the TRE. Only summarised, aggregate results were exported, following manual review by the NHS Digital 'safe outputs' escrow service, to ensure no output placed in the public domain contains information that may be used to identify an individual 17 . The North East-Newcastle and North Tyneside 2 research ethics committee provided ethical approval for the CVD-COVID-UK/COVID-IMPACT research programme (REC No 20/NE/0161). ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Ethical and regulatory approvals"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Artificial intelligence in healthcare: past, present and future",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Jiang",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Stroke Vasc. Neurol",
            "volume": "2",
            "issn": "",
            "pages": "230--243",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Pre-training of Deep Bidirectional Transformers for Language Understanding. Proc. 2019 Conf. North 4171-4186",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Devlin",
                    "suffix": ""
                },
                {
                    "first": "M.-W",
                    "middle": [],
                    "last": "Chang",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Lee",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Toutanova",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Bert",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.18653/V1/N19-1423"
                ]
            }
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Attention Is All You Need",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Vaswani",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Adv. Neural Inf. Process. Syst",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Transformer for Electronic Health Records",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Sci. Reports",
            "volume": "101",
            "issn": "",
            "pages": "1--12",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Med-BERT: pretrained contextualized embeddings on large-scale structured electronic health records for disease prediction",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Rasmy",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Xiang",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Xie",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Tao",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Zhi",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "4",
            "issn": "",
            "pages": "1--13",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Deep learning for electronic health records: A comparative review of multiple deep neural architectures",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Ayala Solares",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "J. Biomed. Inform",
            "volume": "101",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "CHA\u2082DS\u2082-VASc Score for Atrial Fibrillation Stroke Risk -MDCalc",
            "authors": [
                {
                    "first": "",
                    "middle": [],
                    "last": "Mdcalc",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Global epidemiology of atrial fibrillation: An increasing epidemic and public health challenge",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Lippi",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Sanchis-Gomar",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Cervellin",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "Int. J. Stroke",
            "volume": "16",
            "issn": "",
            "pages": "217--221",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "High prevalence of atrial fibrillation among patients with ischemic stroke",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Asplund",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Stroke",
            "volume": "45",
            "issn": "",
            "pages": "2599--2605",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "A 10 year study of hospitalized atrial fibrillationrelated stroke in England and its association with uptake of oral anticoagulation",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Campbell Cowan",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Eur. Heart J",
            "volume": "39",
            "issn": "",
            "pages": "2975--2983",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Stroke Prevention, Evaluation of Bleeding Risk, and Anticoagulant Treatment Management in Atrial Fibrillation Contemporary International Guidelines",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Proietti",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "A"
                    ],
                    "last": "Lane",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Boriani",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "Y"
                    ],
                    "last": "Lip",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Can. J. Cardiol",
            "volume": "35",
            "issn": "",
            "pages": "619--633",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Recommendations | Atrial fibrillation: diagnosis and management | Guidance | NICE",
            "authors": [],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Recommendations for research | Atrial fibrillation: diagnosis and management | Guidance | NICE",
            "authors": [],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Atrial fibrillation: diagnosis and management Evidence reviews C and D: Tools to predict stroke in people with atrial fibrillation NICE guideline NG196 Evidence reviews",
            "authors": [],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Evaluation of antithrombotic use and COVID-19 outcomes in a nationwide atrial fibrillation cohort",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Handy",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1101/2021.09.03.21263023"
                ]
            }
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Association between oral anticoagulants and COVID-19 related outcomes: two cohort studies",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Opensafely Collaborative",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1101/2021.04.30.21256119"
                ]
            }
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Linked electronic health records for research on a nationwide cohort of more than 54 million people in England: Data resource",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Wood",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "BMJ",
            "volume": "373",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Medical Concept Prediction from Clinical Narratives; MedGPT: Medical Concept Prediction from Clinical Narratives",
            "authors": [
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Kraljevic",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1145/1122445.1122456"
                ]
            }
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "A deep dynamic memory model for predictive medicine",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Pham",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Tran",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Phung",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Venkatesh",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Deepcare",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Lecture Notes in Computer Science (including subseries Lecture Notes in Artificial Intelligence and Lecture Notes in Bioinformatics)",
            "volume": "9652",
            "issn": "",
            "pages": "30--41",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Understanding LSTM Networks --colah's blog",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Olah",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "XGBoost: A Scalable Tree Boosting System",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Guestrin",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Proc. ACM SIGKDD Int. Conf. Knowl. Discov. Data Min",
            "volume": "",
            "issn": "",
            "pages": "785--794",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Revisiting Deep Learning Models for Tabular Data",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Gorishniy",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Rubachev",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Khrulkov",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Babenko",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Performance Metrics for the Comparative Analysis of Clinical Risk Prediction Models Employing Machine Learning",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Huang",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "Circ. Cardiovasc. Qual. Outcomes",
            "volume": "14",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Recommendations for reporting machine learning analyses in clinical research",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "M"
                    ],
                    "last": "Stevens",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "J"
                    ],
                    "last": "Mortazavi",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "C"
                    ],
                    "last": "Deo",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Curtis",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "P"
                    ],
                    "last": "Kao",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Circ. Cardiovasc. Qual. Outcomes",
            "volume": "13",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Key challenges for delivering clinical impact with artificial intelligence",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "J"
                    ],
                    "last": "Kelly",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Karthikesalingam",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Suleyman",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Corrado",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "King",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "BMC Med",
            "volume": "17",
            "issn": "",
            "pages": "1--9",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "ESC Guidelines for the management of atrial fibrillation developed in collaboration with EACTS",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Kirchhof",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Eur. Heart J",
            "volume": "37",
            "issn": "",
            "pages": "2893--2962",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "An optimized XGBoost based diagnostic system for effective prediction of heart disease",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Budholiya",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "K"
                    ],
                    "last": "Shrivastava",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Sharma",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "J. King Saud Univ. -Comput. Inf. Sci",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1016/J.JKSUCI.2020.10.013"
                ]
            }
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "Identification of elders at higher risk for fall with statewide electronic health records and a machine learning algorithm",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Ye",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Int. J. Med. Inform",
            "volume": "137",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Language Models are Few-Shot Learners",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "B"
                    ],
                    "last": "Brown",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Adv. Neural Inf. Process. Syst",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "Visualizing Attention in Transformer-Based Language Representation Models",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Vig",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "The false hope of current approaches to explainable artificial intelligence in health care",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Ghassemi",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Oakden-Rayner",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "L"
                    ],
                    "last": "Beam",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "Lancet Digit. Heal",
            "volume": "3",
            "issn": "",
            "pages": "745--750",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "Adjusting for selection bias due to missing data in electronic health records-based research",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "B"
                    ],
                    "last": "Peskoe",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "Stat. Methods Med. Res",
            "volume": "30",
            "issn": "",
            "pages": "2221--2238",
            "other_ids": {}
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "Interpretable deep neural network for cancer survival analysis by integrating genomic and clinical data",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Hao",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Kim",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Mallavarapu",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "H"
                    ],
                    "last": "Oh",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kang",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "BMC Med. Genomics",
            "volume": "12",
            "issn": "",
            "pages": "1--13",
            "other_ids": {}
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "Understanding COVID-19 trajectories from a nationwide linked electronic health record cohort of 56 million people: phenotypes, severity, waves & vaccination",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "H"
                    ],
                    "last": "Thygesen",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1101/2021.11.08.21265312"
                ]
            }
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "A Method for Stochastic Optimization. 3rd Int. Conf. Learn. Represent. ICLR 2015 -Conf. Track Proc",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "P"
                    ],
                    "last": "Kingma",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Ba",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Adam",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "overview of the input representation and architecture for the transformer and LSTM DL models. Note, length and number of input variables are illustrative, for precise specifications see \"Methods\" section.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "From a total of 55,903,113 people registered with a GP practice in England and alive on January 1 st 2020, 870,576 had a diagnosis of AF in their GP record (and met the other inclusion criteria) and 16,563 (1.9%) had a first ischaemic stroke after their AF diagnosis up to May 1 st 2021. The AF+COVID-19 cohort contained 76,752 people of whom 17,822 (23.2%) died of COVID-19. A flow chart with inclusion criteria is included inSupplementary Figure 1",
            "latex": null,
            "type": "figure"
        },
        "TABREF2": {
            "text": "summary of model performance statistics for predicting first ischaemic stroke after AF in all groups. 95% confidence intervals (CI) in brackets. Bold font marks highest performing model for each metric.Table 3 -summary of model performance statistics for predicting COVID-19 death in people diagnosed with AF (and no prior stroke diagnosis) in all groups. 95% CI in brackets. Bold font marks highest performing model for each metric.",
            "latex": null,
            "type": "table"
        },
        "TABREF6": {
            "text": "The UK National Institute for Health Research-BHF Cardiovascular Partnership lay panel comprising individuals affected by cardiovascular disease reviewed and approved this project.The British Heart Foundation Data Science Centre (grant No SP/19/3/34678, awarded to Health Data Research (HDR) UK) funded co-development (with NHS Digital) of the trusted research environment, provision of linked datasets, data access, user software licences, computational usage, and data management and wrangling support, with additional contributions from the HDR UK data and connectivity component of the UK governments' chief scientific adviser's national core studies programme to coordinate national covid-19 priority research. Consortium partner organisations funded the time of contributing data analysts, biostatisticians, epidemiologists, and clinicians.AH is supported by research funding from the HDR UK text analytics implementation project. AW is supported by the BHF-Turing Cardiovascular Data Science Award (BCDSA\\100005) and by core funding from UK MRC (MR/L003120/1), BHF (RG/13/13/30194; RG/18/13/33946), and NIHR Cambridge Biomedical Research Centre (BRC-1215-20014). CT is supported by a UCL UKRI Centre for Doctoral Training in AI-enabled Healthcare studentship (EP/S021612/1), MRC Clinical Top-Up and a studentship from the NIHR Biomedical Research Centre at University College London Hospital NHS Trust. MM is supported by the Oxford Martin School (OMS), funded by the National Institute for Health Research (NIHR) Oxford Biomedical Research Centre (BRC), PEAK Urban programme, funded by the UKRI's Global Challenge Research Fund Grant Ref: ES/P011055/1, and Novo Nordisk. RD is supported by the following: (1) NIHR Biomedical Research Centre at South London and Maudsley NHS Foundation Trust and King's College London, London, UK; (2) Health Data Research UK, which is funded by the UK Medical Research Council, Engineering and Physical Sciences Research Council, Economic and Social Research Council, Department of Health and Social Care (England), Chief Scientist Office of the Scottish Government Health and Social Care Directorates, Health and Social Care Research and Development Division (Welsh Government), Public Health Agency (Northern Ireland), British Heart Foundation and Wellcome Trust; (3) The BigData@Heart Consortium, funded by the Innovative Medicines Initiative-2 Joint Undertaking under grant agreement No. 116074. This Joint Undertaking receives support from the European Union's Horizon 2020 research and innovation programme and EFPIA; it is chaired by DE Grobbee and SD Anker, partnering with SupplementaryTable 1 -summary of model performance statistics (AUCs) for predicting first ischaemic stroke after AF in sub-groups. 95% confidence intervals (CI) in brackets. Bold font marks highest performing model for each metric. Supplementary Table 2 -summary of model performance statistics (AUCs) for predicting COVID-19 death after AF in sub-groups. 95% confidence intervals (CI) in brackets. Bold font marks highest performing model for each metric.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "This study was carried out with the support of the BHF Data Science Centre led by HDR UK (BHF Grant no. SP/19/3/34678). This study makes use of de-identified data held in NHS Digital's TRE for England and made available via the BHF Data Science",
            "cite_spans": [],
            "ref_spans": [],
            "section": "ACKNOWLEDGEMENTS"
        },
        {
            "text": "The authors have no financial relationships with any organisations that might have an interest in the submitted work in the previous three years and no other relationships or activities that could appear to have influenced the submitted work. *Excludes individuals with <5 recorded medical codes, any type of stroke diagnosis prior to AF diagnosis or within two months of AF diagnosis or after May 1 st 2021 study end date. **Excludes individuals without a recorded positive COVID-19 event.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "COMPETING INTERESTS"
        }
    ]
}