{"paper_id": "3e542a90a5bae1aa028ff10f63d9d93b34a5ecbb", "metadata": {"title": "Strongly Stable and Maximum Weakly Stable Noncrossing Matchings", "authors": [{"first": "Koki", "middle": [], "last": "Hamada", "suffix": "", "affiliation": {"laboratory": "", "institution": "NTT Corporation", "location": {"addrLine": "3-9-11, Midori-cho, Musashino-shi", "postCode": "180-8585", "settlement": "Tokyo", "country": "Japan"}}, "email": "koki.hamada.rb@hco.ntt.co.jp"}, {"first": "Shuichi", "middle": [], "last": "Miyazaki", "suffix": "", "affiliation": {"laboratory": "", "institution": "Kyoto University", "location": {"addrLine": "Yoshida-Honmachi, Sakyo-ku", "postCode": "606-8501", "settlement": "Kyoto", "country": "Japan"}}, "email": "shuichi@media.kyoto-u.ac.jp"}, {"first": "Kazuya", "middle": [], "last": "Okamoto", "suffix": "", "affiliation": {"laboratory": "", "institution": "Kyoto University Hospital", "location": {"addrLine": "54 Kawaharacho, Shogoin, Sakyo-ku", "postCode": "606-8507", "settlement": "Kyoto", "country": "Japan"}}, "email": "kazuya@kuhp.kyoto-u.ac.jp"}]}, "abstract": [{"text": "In IWOCA 2019, Ruangwises and Itoh introduced stable noncrossing matchings, where participants of each side are aligned on each of two parallel lines, and no two matching edges are allowed to cross each other. They defined two stability notions, strongly stable noncrossing matching (SSNM) and weakly stable noncrossing matching (WSNM), depending on the strength of blocking pairs. They proved that a WSNM always exists and presented an O(n 2 )-time algorithm to find one for an instance with n men and n women. They also posed open questions of the complexities of determining existence of an SSNM and finding a largest WSNM. In this paper, we show that both problems are solvable in polynomial time. Our algorithms are applicable to extensions where preference lists may include ties, except for one case which we show to be NP-complete.", "cite_spans": [], "ref_spans": [], "section": "Abstract"}], "body_text": [{"text": "In the classical stable marriage problem [4] , there are two sets of participants, traditionally illustrated as men and women, where each person has a preference list that orders a subset of the members of the opposite gender. A matching is a set of (man, woman)-pairs where no person appears more than once. A blocking pair for a matching M is (informally) a pair of a man and a woman who are not matched together in M but both of them become better off if they Supported by JSPS KAKENHI Grant Numbers JP16K00017 and JP19K12820. are matched. A matching that admits no blocking pair is a stable matching. The stable marriage problem is one of the recently best-studied topics, with a lot of applications to matching and assignment systems, such as high-school match [1, 2] and medical resident assignment [13] . See some textbooks [6, 11, 12, 15] for more information.", "cite_spans": [{"start": 41, "end": 44, "text": "[4]", "ref_id": "BIBREF3"}, {"start": 766, "end": 769, "text": "[1,", "ref_id": "BIBREF0"}, {"start": 770, "end": 772, "text": "2]", "ref_id": "BIBREF1"}, {"start": 805, "end": 809, "text": "[13]", "ref_id": "BIBREF13"}, {"start": 831, "end": 834, "text": "[6,", "ref_id": "BIBREF5"}, {"start": 835, "end": 838, "text": "11,", "ref_id": "BIBREF11"}, {"start": 839, "end": 842, "text": "12,", "ref_id": "BIBREF12"}, {"start": 843, "end": 846, "text": "15]", "ref_id": "BIBREF15"}], "ref_spans": [], "section": "Introduction"}, {"text": "Recently, Ruangwises and Itoh [16] incorporated the notion of noncrossing matchings to the stable marriage problem. In their model, there are two parallel lines where n men are aligned on one line and n women are aligned on the other line. A matching is noncrossing if no two edges of it cross each other. A stable noncrossing matching is a matching which is simultaneously stable and noncrossing. They defined two notions of stability: In a strongly stable noncrossing matching (SSNM), the definition of a blocking pair is the same as that of the standard stable marriage problem. Thus the set of SSNMs is exactly the intersection of the set of stable matchings and that of noncrossing matchings. In a weakly stable noncrossing matching (WSNM), a blocking pair has an additional condition that it must be noncrossing with matching edges. Ruangwises and Itoh [16] proved that a WSNM exists for any instance, and presented an O(n 2 )-time algorithm to find one. They also demonstrated that an SSNM does not always exist, and that there can be WSNMs of different sizes. Concerning these observations, they posed open questions on the complexities of the problems of determining the existence of an SSNM and finding a WSNM of maximum cardinality.", "cite_spans": [{"start": 30, "end": 34, "text": "[16]", "ref_id": "BIBREF16"}, {"start": 859, "end": 863, "text": "[16]", "ref_id": "BIBREF16"}], "ref_spans": [], "section": "Introduction"}, {"text": "Our Contributions. In this paper, we show that both problems are solvable in polynomial time. The former is solved by exploiting the well-known Rural Hospitals theorem (Proposition 1). For the latter, we design an algorithm based on dynamic programming (Theorem 2). We then consider extended problems where preference lists may include ties. We show that our algorithms are applicable to them without any modification (Corollaries 1, 2, and 3), except for one which we show to be NP-complete (Theorem 1). Table 1 summarizes previous and our results, where our results are described in bold. In the table, SSNM and WSNM stand for the problems of determining the existence of SSNM and WSNM, respectively. MAX-WSNM is the optimization problem of finding a largest WSNM. SMI and SMTI stand for the stable marriage problems without and with ties, respectively. When ties are allowed in preference lists, there are three stability notions, super, strong, and weak stabilities [7] . Formal definitions of these notions are introduced in Sect. 2.", "cite_spans": [{"start": 970, "end": 973, "text": "[7]", "ref_id": "BIBREF6"}], "ref_spans": [{"start": 505, "end": 512, "text": "Table 1", "ref_id": "TABREF0"}], "section": "Introduction"}, {"text": "In this section, we give necessary definitions and notations, some of which are taken from Ruangwises and Itoh [16] . An instance consists of n men m 1 , m 2 , . . . , m n and n women w 1 , w 2 , . . . , w n . We assume that the men are lying on a vertical line in an increasing order of indices from top to bottom, and similarly the women are lying in the same manner on another vertical line parallel to the first one. Each person has a preference list over a subset of the members of the opposite gender. For now, assume that preference lists are strict, i.e., do not contain ties. We call such an instance an SMI-instance. If a person q appears in a person p's preference list, we say that q is acceptable to p. If p and q are acceptable to each other, we say that (p, q) is an acceptable pair. We assume without loss of generality that acceptability is mutual, i.e., p is acceptable to q if and only if q is acceptable to p. If p prefers q 1 to q 2 , then we write q 1 p q 2 .", "cite_spans": [{"start": 111, "end": 115, "text": "[16]", "ref_id": "BIBREF16"}], "ref_spans": [], "section": "Preliminaries"}, {"text": "A matching is a set of acceptable pairs of a man and a woman in which each person appears at most once. If (m, w) \u2208 M , we write M (m) = w and M (w) = m. If a person p is not included in a matching M , we say that p is single in M and write M (p) = \u2205. Every person prefers to be matched with an acceptable person rather than to be single, i.e., q p \u2205 holds for any p and any q acceptable to p.", "cite_spans": [], "ref_spans": [], "section": "Preliminaries"}, {"text": "A pair in a matching can be seen as an edge on the plane, so we may use \"pair\" and \"edge\" interchangeably. Two edges (m i , w j ) and (m x , w y ) are said to cross each other if they share an interior point, or formally, if (x \u2212 i)(y \u2212 j) < 0 holds. A matching is noncrossing if it contains no pair of crossing edges. We then extend the above definitions to the case where preference lists may contain ties. A tie of a person p's preference list is a set of one or more persons who are equally preferred by p, and p's preference list is a strict order of ties. We call such an instance an SMTI-instance. In a person p's preference list, suppose that a person q 1 is in tie T 1 , q 2 is in tie T 2 , and p prefers T 1 to T 2 . Then we say that p strictly prefers q 1 to q 2 and write q 1 p q 2 . If q 1 and q 2 are in the same tie (including the case that q 1 and q 2 are the same person), we write q 1 = p q 2 . If q 1 p q 2 or q 1 = p q 2 holds, we write q 1 p q 2 and say that p weakly prefers q 1 to q 2 .", "cite_spans": [], "ref_spans": [], "section": "Preliminaries"}, {"text": "When ties are present, there are three possible definitions of blocking pairs, and accordingly, there are three stability notions, super-stability, strong stability, and weak stability [7] : -In the super-stability, a blocking pair for a matching M is an acceptable pair (m, w) \u2208 M such that w m M (m) and m w M (w). -In the strong stability, a blocking pair for a matching M is an acceptable pair (p, q) \u2208 M such that q p M (p) and p q M (q). Note that the person q, who strictly prefers the counterpart p of the blocking pair, may be either a man or a woman. -In the weak stability, a blocking pair for a matching M is an acceptable pair (m, w) \u2208 M such that w m M (m) and m w M (w).", "cite_spans": [{"start": 185, "end": 188, "text": "[7]", "ref_id": "BIBREF6"}], "ref_spans": [], "section": "Preliminaries"}, {"text": "With these definitions of blocking pairs, the terms \"noncrossing blocking pair\", \"WSNM\", and \"SSNM\" for each stability notion can be defined analogously. In the SMTI case, we extend the names of stable noncrossing matchings using the type of stability as a prefix. For example, a WSNM in super-stability is denoted super-WSNM.", "cite_spans": [], "ref_spans": [], "section": "Preliminaries"}, {"text": "Note that, in this paper, the terms \"weak\" and \"strong\" are used in two different meanings. This might be confusing but we decided not to change these terms, respecting previous literature.", "cite_spans": [], "ref_spans": [], "section": "Preliminaries"}, {"text": "In SMI, an easy observation shows that existence of an SSNM can be determined in O(n 2 ) time: Proposition 1. There exists an O(n 2 )-time algorithm to find an SSNM or to report that none exists, given an SMI-instance.", "cite_spans": [], "ref_spans": [], "section": "SMI"}, {"text": "Proof. Note that an SSNM is a stable matching in the original sense. In SMI, there always exists at least one stable matching [6] , and due to the Rural Hospitals theorem [5, 13, 14] , the set of matched agents is the same in any stable matching. These agents can be determined in O(n 2 ) time by using the Gale-Shapley algorithm [4] . There is only one way of matching them in a noncrossing manner. Hence the matching constructed in this way is stable if and only if a given instance admits an SSNM. This condition can be checked in O(n 2 ) time.", "cite_spans": [{"start": 126, "end": 129, "text": "[6]", "ref_id": "BIBREF5"}, {"start": 171, "end": 174, "text": "[5,", "ref_id": "BIBREF4"}, {"start": 175, "end": 178, "text": "13,", "ref_id": "BIBREF13"}, {"start": 179, "end": 182, "text": "14]", "ref_id": "BIBREF14"}, {"start": 330, "end": 333, "text": "[4]", "ref_id": "BIBREF3"}], "ref_spans": [], "section": "SMI"}, {"text": "In the presence of ties, super-stable and strongly stable matchings do not always exist. However, there is an O(n 2 )-time (O(n 3 )-time, respectively) algorithm that finds a super-stable (strongly stable, respectively) matching or reports that none exists [7, 10] . Also, the Rural Hospitals theorem takes over to the super-stability [8] and strong stability [9] . Therefore, the same algorithm as in Sect. 3.1 applies for these cases, implying the following corollaries: Corollary 1. There exists an O(n 2 )-time algorithm to find a super-SSNM or to report that none exists, given an SMTI-instance.", "cite_spans": [{"start": 257, "end": 260, "text": "[7,", "ref_id": "BIBREF6"}, {"start": 261, "end": 264, "text": "10]", "ref_id": "BIBREF10"}, {"start": 335, "end": 338, "text": "[8]", "ref_id": "BIBREF7"}, {"start": 360, "end": 363, "text": "[9]", "ref_id": "BIBREF8"}], "ref_spans": [], "section": "SMTI"}, {"text": "In contrast, the problem becomes NP-complete for weak stability: Theorem 1. The problem of determining if a weak-SSNM exists, given an SMTI-instance, is NP-complete, even if each tie is of length at most two.", "cite_spans": [], "ref_spans": [], "section": "Corollary 2. There exists an O(n 3 )-time algorithm to find a strong-SSNM or to report that none exists, given an SMTI-instance."}, {"text": "Proof. Membership in NP is obvious. We show NP-hardness by a reduction from 3SAT, which is well-known to be NP-complete [3] . Its instance consists of a set of variables and a set of clauses. Each variable takes either true (1) or false (0). A literal is a variable or its negation. A clause is a disjunction of at most three literals. A clause is satisfied if at least one of its literals takes the value 1, and is unsatisfied otherwise. A 0/1 assignment to variables that satisfies all the clauses is called a satisfying assignment. An instance f of 3SAT is satisfiable if it has at least one satisfying assignment; otherwise f is unsatisfiable. 3SAT asks if there exists a satisfying assignment. We may assume without loss of generality that each clause contains exactly three literals, as if not, we may simply duplicate a literal without affecting the satisfiability of the instance. Now we show the reduction. Let f be an instance of 3SAT having n variables 2 and one woman q i . These three persons are said to constitute an x i -gadget (or generally a variable gadget). For each clause C j , we create two men y j,1 , y j,2 and three women z j,1 , z j,2 , z j,3 , who are said to constitute a C j -gadget (or generally a clause gadget). Additionally, we create a man s and a woman t, who constitute a gadget called the separator. Thus, there are 2n + 2m + 1 men and n + 3m + 1 women in the created SMTI instance I(f ). We finally add dummy persons who have empty preference lists to make the numbers of men and women equal. They do not play any role in the following arguments, so we omit them.", "cite_spans": [{"start": 120, "end": 123, "text": "[3]", "ref_id": "BIBREF2"}, {"start": 964, "end": 965, "text": "2", "ref_id": "BIBREF1"}], "ref_spans": [], "section": "Corollary 2. There exists an O(n 3 )-time algorithm to find a strong-SSNM or to report that none exists, given an SMTI-instance."}, {"text": "Suppose that x i appears a i times positively in f , and for each k (1 \u2264 k \u2264 a i ), x i 's kth positive occurrence is in the d i,k th clause C d i,k as the e i,k th literal (1 \u2264 e i,k \u2264 3). Similarly, suppose x i appears b i times negatively, and for each", "cite_spans": [], "ref_spans": [], "section": "Corollary 2. There exists an O(n 3 )-time algorithm to find a strong-SSNM or to report that none exists, given an SMTI-instance."}, {"text": ". Then preference lists of three persons in the x igadget are constructed as shown in Fig. 1 . Here, each preference list is denoted as a sequence from left to right according to preference, i.e., the leftmost person(s) is the most preferred and the rightmost person(s) is the least preferred. Tied persons (i.e., persons with the equal preference) are included in parentheses.", "cite_spans": [], "ref_spans": [{"start": 86, "end": 92, "text": "Fig. 1", "ref_id": null}], "section": "Corollary 2. There exists an O(n 3 )-time algorithm to find a strong-SSNM or to report that none exists, given an SMTI-instance."}, {"text": "Preference lists of five persons in the C j -gadget are given in Fig. 2 . For k = 1, 2, 3, suppose that the kth literal of C j is x j k , and let j,k = 1 (respectively, j,k = 2) if x j k appears negatively (respectively, positively) in C j .", "cite_spans": [], "ref_spans": [{"start": 65, "end": 71, "text": "Fig. 2", "ref_id": null}], "section": "Corollary 2. There exists an O(n 3 )-time algorithm to find a strong-SSNM or to report that none exists, given an SMTI-instance."}, {"text": "Finally, each of the man and the woman in the separator includes only the other in the list (Fig. 3) . They are guaranteed to be matched together in any stable matching. Alignment of agents is depicted in Fig. 4 . Variable gadgets are placed top, then followed by the separator, clause gadgets come bottom. Within each gadget, people are aligned according to indices. The separator plays a role of prohibiting a person of a variable gadget and a person of a clause gadget to match together; if they are matched, then the corresponding edge crosses with the separator. Now the reduction is completed. It is not hard to see that the reduction can be performed in polynomial time.", "cite_spans": [], "ref_spans": [{"start": 92, "end": 100, "text": "(Fig. 3)", "ref_id": "FIGREF1"}, {"start": 205, "end": 211, "text": "Fig. 4", "ref_id": "FIGREF2"}], "section": "Corollary 2. There exists an O(n 3 )-time algorithm to find a strong-SSNM or to report that none exists, given an SMTI-instance."}, {"text": "We then show the correctness. First, suppose that f is satisfiable and let A be a satisfying assignment. We construct a weak- 1 to M . For a C j -gadget, define three matchings N j,1 = {(y j,1 , z j,2 ), (y j,2 , z j,3 )}, N j,2 = {(y j,1 , z j,1 ), (y j,2 , z j,3 )}, and N j,3 = {(y j,1 , z j,1 ), (y j,2 , z j,2 )}. If C j is satisfied by the kth literal (k = 1, 2, 3), then add N j,k to M . (If C j is satisfied by more than one literal, then choose one arbitrarily.) Finally add the pair (s, t) to M .", "cite_spans": [{"start": 126, "end": 127, "text": "1", "ref_id": "BIBREF0"}], "ref_spans": [], "section": "Corollary 2. There exists an O(n 3 )-time algorithm to find a strong-SSNM or to report that none exists, given an SMTI-instance."}, {"text": "It is not hard to see that M is noncrossing. We show that it is weakly stable. Note that all the women in the variable gadgets, all the men in the clause gadgets, and s and t in the separator are matched with the first choice person. Therefore, if there exists a blocking pair, it must be the form of (p i, , z j,k ) for some i, , j, and k. Furthermore, any person matched in M is matched with the first choice, so both p i, and z j,k are single in M . Suppose that = 1. The reason for (p i,1 , z j,k ) being an acceptable pair is that C j 's kth literal is \u00acx i , the negative occurrence of x i . Since p i,1 is single, M i,1 \u2282 M and hence x i = 1 under A. Since z j,k is single, N j,k \u2282 M and hence C j is satisfied by its kth literal \u00acx i , but this is a contradiction. The other case = 2 can be argued in the same manner.", "cite_spans": [], "ref_spans": [], "section": "Corollary 2. There exists an O(n 3 )-time algorithm to find a strong-SSNM or to report that none exists, given an SMTI-instance."}, {"text": "Conversely, suppose that I(f ) admits a weak-SSNM M . We construct a satisfying assignment A of f . Before giving construction, we observe structural properties of M in two lemmas:", "cite_spans": [], "ref_spans": [], "section": "Corollary 2. There exists an O(n 3 )-time algorithm to find a strong-SSNM or to report that none exists, given an SMTI-instance."}, {"text": "Proof. Note that preference lists of the three persons of the x i -gadget include persons of the same x i -gadget or some persons from clause gadgets. Hence, due to the separator, persons of the x i -gadget can only be matched within this gadget s: t t : s to avoid edge crossings. Since a stable matching is a maximal matching, either M i,0 or M i,1 must be a part of M .", "cite_spans": [], "ref_spans": [], "section": "Corollary 2. There exists an O(n 3 )-time algorithm to find a strong-SSNM or to report that none exists, given an SMTI-instance."}, {"text": "Proof. The proof is similar to that of Lemma 1. Note that preference lists of the five persons of the C j -gadget include persons of the same C j -gadget or some persons from variable gadgets. The maximal matchings within the C j -gadget are N j,1 , N j,2 , and N j,3 , so one of them must be in M . The above argument holds for any k \u2208 {1, 2, 3}, so none of N j,1 , N j,2 , and N j, 3 can be a part of M . But this contradicts Lemma 2. Hence A satisfies f .", "cite_spans": [{"start": 384, "end": 385, "text": "3", "ref_id": "BIBREF2"}], "ref_spans": [], "section": "Lemma 2. For each"}, {"text": "In this section, we present an algorithm to find a maximum cardinality WSNM. For an instance I, let opt(I) denote the size of the maximum cardinality WSNM.", "cite_spans": [], "ref_spans": [], "section": "Maximum Cardinality Weakly Stable Noncrossing Matchings"}, {"text": "Let I be a given instance with men m 1 , . . . , m n and women w 1 , . . . , w n . To simplify the description of the algorithm, we translate I to an instance I by adding a man m 0 and a woman w 0 , each of whom includes only the other in the preference list, and similarly a man m n+1 and a woman w n+1 , each of whom includes only the other in the preference list. It is easy to see that, for a WSNM Hence, without loss of generality, we assume that a given instance I has n + 2 men and n + 2 women, with m 0 , w 0 , m n+1 , and w n+1 having the above mentioned preference lists. w j2 ) , . . . , (m i k , w j k )} be a noncrossing matching of I such that i 1 < i 2 \u00b7 \u00b7 \u00b7 < i k and j 1 < j 2 \u00b7 \u00b7 \u00b7 < j k . We call (m i k , w j k ) the maximum pair of M . Suppose that (m x , w y ) is the maximum pair of a noncrossing matching M . We call M a semi-WSNM if each of its noncrossing blocking pair (m i , w j ) (if any) satisfies x \u2264 i \u2264 n + 1 and y \u2264 j \u2264 n + 1. Intuitively, a semi-WSNM is a WSNM up to its maximum pair. Note that any semi-WSNM must contain (m 0 , w 0 ), as otherwise it is a noncrossing blocking pair. For 0 \u2264 i \u2264 n+1 and 0 \u2264 j \u2264 n + 1, we define X(i, j) as the maximum size of a semi-WSNM of I whose maximum pair is (m i , w j ); if I does not admit a semi-WSNM with the maximum pair (m i , w j ), X(i, j) is defined to be \u2212\u221e. Lemma 3. opt(I) = X(n + 1, n + 1).", "cite_spans": [], "ref_spans": [{"start": 582, "end": 588, "text": "w j2 )", "ref_id": null}], "section": "SMI"}, {"text": "Proof. Note that any WSNM of I includes (m n+1 , w n+1 ), as otherwise it is a noncrossing blocking pair. Hence it is a semi-WSNM with the maximum pair (m n+1 , w n+1 ). Conversely, any semi-WSNM with the maximum pair (m n+1 , w n+1 ) does not include a noncrossing blocking pair and hence is also a WSNM. Therefore, the set of WSNMs is exactly the set of semi-WSNMs with the maximum pair (m n+1 , w n+1 ). This completes the proof.", "cite_spans": [], "ref_spans": [], "section": "SMI"}, {"text": "To compute X(n + 1, n + 1), we shortly define quantity Y (i, j) (0 \u2264 i \u2264 n + 1, 0 \u2264 j \u2264 n + 1) using recursive formulas, and show that Y (i, j) = X(i, j) for all i and j. We then show that these recursive formulas allow us to compute Y (i, j) in polynomial time using dynamic programming.", "cite_spans": [], "ref_spans": [], "section": "SMI"}, {"text": "We say that two noncrossing edges (m i , w j ) and (m x , w y ) (i < x, j < y) are conflicting if they contain a noncrossing blocking pair between them; precisely, if the matching {(m i , w j ), (m x , w y )} contains a blocking pair (m s , w t ) such that i \u2264 s \u2264 x and j \u2264 t \u2264 y. Otherwise, (m i , w j ) and (m x , w y ) are nonconflicting. Intuitively, two conflicting edges cannot be consecutive elements of a semi-WSNM. Now we give the definition of Y (i, j). For convenience, we assume that \u2212\u221e", "cite_spans": [], "ref_spans": [], "section": "SMI"}, {"text": "Proof. We prove the claim by induction. We first show that Y (0, 0) = X(0, 0). The matching {(m 0 , w 0 )} is the unique semi-WSNM with the maximum pair (m 0 , w 0 ), so X(0, 0) = 1 by definition. Also, Y (0, 0) = 1 by Eq. (1). Hence we are done. We then show that Y (0, j) = X(0, j) for 1 \u2264 j \u2264 n+1. Since (m 0 , w j ) is an unacceptable pair, there is no semi-WSNM with the maximum pair (m 0 , w j ), so X(0, j) = \u2212\u221e by definition. Also, Y (0, j) = \u2212\u221e by Eq. (2) . We can show that Y (i, 0) = X(i, 0) for 1 \u2264 i \u2264 n + 1 by a similar argument.", "cite_spans": [{"start": 461, "end": 464, "text": "(2)", "ref_id": "BIBREF1"}], "ref_spans": [], "section": "SMI"}, {"text": "Next we show that Y (i, j) = X(i, j) holds for 1 \u2264 i \u2264 n + 1 and 1 \u2264 j \u2264 n + 1. As an induction hypothesis, we assume that Y (a, b) = X(a, b) holds for 0 \u2264 a \u2264 i \u2212 1 and 0 \u2264 b \u2264 j \u2212 1. First, observe that if X(i, j) = \u2212\u221e, then X(i, j) \u2265 2. This is because two pairs (m 0 , w 0 ) and (m i , w j ) must present in any semi-WSNM having the maximum pair (m i , w j ).", "cite_spans": [], "ref_spans": [], "section": "SMI"}, {"text": "We first consider the case that X(i, j) \u2265 2. Let X(i, j) = k. Then, there is a semi-WSNM M with the maximum pair (m i , w j ) such that |M | = k. Let M = M \\ {(m i , w j )} and (m x , w y ) be the maximum pair of M . It is not hard to see that M is a semi-WSNM with the maximum pair (m x , w y ) and that |M | = k\u22121. Therefore, X(x, y) \u2265 k \u2212 1 by the definition of X, and Y (x, y) = X(x, y) \u2265 k \u2212 1 by the induction hypothesis. Since M is a semi-WSNM, (m i , w j ) and (m x , w y ) are nonconflicting, so (x, y) satisfies the condition for (i , j ) in Eq. (4). Hence", "cite_spans": [], "ref_spans": [], "section": "SMI"}, {"text": "and (m i , w j ) are nonconflicting, and Y (i , j ) \u2265 k. By the induction hypothesis, X(i , j ) = Y (i , j ) \u2265 k. Then there is a semi-WSNM M with the maximum pair (m i , w j ) such that |M | \u2265 k. Since M is a semi-WSNM, and (m i , w j ) and (m i , w j ) are nonconflicting, M = M \u222a {(m i , w j )} is a semi-WSNM with the maximum pair (m i , w j ) such that |M | = |M | + 1 \u2265 k + 1. This contradicts the assumption that X(i, j) = k. Hence Y (i, j) \u2264 k and therefore Y (i, j) = k as desired.", "cite_spans": [], "ref_spans": [], "section": "SMI"}, {"text": "Finally, consider the case that X(i, j) = \u2212\u221e. If (m i , w j ) is unacceptable, then the latter case of Eq. (4) is applied and Y (i, j) = \u2212\u221e. So assume that (m i , w j ) is acceptable. Then the former case of Eq. (4) is applied. It suffices to show that for any (i , j ) such that 0 \u2264 i \u2264 i \u2212 1, 0 \u2264 j \u2264 j \u2212 1, and (m i , w j ) and (m i , w j ) are nonconflicting, Y (i , j ) = \u2212\u221e holds. Assume on the contrary that there is such (i , j ) with Y (i , j ) = k. Then X(i , j ) = k by the induction hypothesis, and there is a semi-WSNM M such that |M | = k, (m i , w j ) is the maximum pair of M , and (m i , w j ) and (m i , w j ) are nonconflicting. Then M = M \u222a {(m i , w j )} is a semi-WSNM such that (m i , w j ) is the maximum pair and |M | = |M | + 1 = k + 1, implying that X(i, j) = k + 1. This contradicts the assumption that X(i, j) = \u2212\u221e and the proof is completed. Now we analyze time-complexity of the algorithm. We assume that, given persons p, q 1 , and q 2 , whether or not p prefers q 1 to q 2 can be determined in constant time using ranking arrays described in Sec. ", "cite_spans": [], "ref_spans": [], "section": "SMI"}], "bib_entries": {"BIBREF0": {"ref_id": "b0", "title": "The New York City high school match", "authors": [{"first": "A", "middle": [], "last": "Abdulkadiro\u01e7lu", "suffix": ""}, {"first": "P", "middle": ["A"], "last": "Pathak", "suffix": ""}, {"first": "A", "middle": ["E"], "last": "Roth", "suffix": ""}], "year": 2005, "venue": "Am. Econ. Rev", "volume": "95", "issn": "2", "pages": "364--367", "other_ids": {}}, "BIBREF1": {"ref_id": "b1", "title": "The Boston public school match", "authors": [{"first": "A", "middle": [], "last": "Abdulkadiro\u01e7lu", "suffix": ""}, {"first": "P", "middle": ["A"], "last": "Pathak", "suffix": ""}, {"first": "A", "middle": ["E"], "last": "Roth", "suffix": ""}, {"first": "T", "middle": [], "last": "S\u00f6nmez", "suffix": ""}], "year": 2005, "venue": "Am. Econ. Rev", "volume": "95", "issn": "2", "pages": "368--371", "other_ids": {}}, "BIBREF2": {"ref_id": "b2", "title": "The complexity of theorem-proving procedures", "authors": [{"first": "S", "middle": ["A"], "last": "Cook", "suffix": ""}], "year": 1971, "venue": "Proceedings STOC 1971", "volume": "", "issn": "", "pages": "151--158", "other_ids": {}}, "BIBREF3": {"ref_id": "b3", "title": "College admissions and the stability of marriage", "authors": [{"first": "D", "middle": [], "last": "Gale", "suffix": ""}, {"first": "L", "middle": ["S"], "last": "Shapley", "suffix": ""}], "year": 1962, "venue": "Am. Math. Mon", "volume": "69", "issn": "1", "pages": "9--15", "other_ids": {}}, "BIBREF4": {"ref_id": "b4", "title": "Some remarks on the stable matching problem", "authors": [{"first": "D", "middle": [], "last": "Gale", "suffix": ""}, {"first": "M", "middle": [], "last": "Sotomayor", "suffix": ""}], "year": 1985, "venue": "Discrete Appl. Math", "volume": "11", "issn": "3", "pages": "223--232", "other_ids": {}}, "BIBREF5": {"ref_id": "b5", "title": "The Stable Marriage Problem: Structure and Algorithms", "authors": [{"first": "D", "middle": [], "last": "Gusfield", "suffix": ""}, {"first": "R", "middle": ["W"], "last": "Irving", "suffix": ""}], "year": 1989, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF6": {"ref_id": "b6", "title": "Stable marriage and indifference", "authors": [{"first": "R", "middle": ["W"], "last": "Irving", "suffix": ""}], "year": 1994, "venue": "Discrete Appl. Math", "volume": "48", "issn": "", "pages": "261--272", "other_ids": {}}, "BIBREF7": {"ref_id": "b7", "title": "The hospitals/residents problem with ties", "authors": [{"first": "R", "middle": ["W"], "last": "Irving", "suffix": ""}, {"first": "D", "middle": ["F"], "last": "Manlove", "suffix": ""}, {"first": "S", "middle": [], "last": "Scott", "suffix": ""}], "year": 2000, "venue": "SWAT 2000", "volume": "1851", "issn": "", "pages": "259--271", "other_ids": {"DOI": ["10.1007/3-540-44985-X_24"]}}, "BIBREF8": {"ref_id": "b8", "title": "Strong stability in the hospitals/residents problem", "authors": [{"first": "R", "middle": ["W"], "last": "Irving", "suffix": ""}, {"first": "D", "middle": ["F"], "last": "Manlove", "suffix": ""}, {"first": "S", "middle": [], "last": "Scott", "suffix": ""}], "year": null, "venue": "STACS 2003", "volume": "2607", "issn": "", "pages": "439--450", "other_ids": {}}, "BIBREF10": {"ref_id": "b10", "title": "Strongly stable matchings in time O(nm) and extension to the hospitals-residents problem", "authors": [{"first": "T", "middle": [], "last": "Kavitha", "suffix": ""}, {"first": "K", "middle": [], "last": "Mehlhorn", "suffix": ""}, {"first": "D", "middle": [], "last": "Michail", "suffix": ""}, {"first": "K", "middle": [], "last": "Paluch", "suffix": ""}], "year": 2007, "venue": "ACM Trans. Algorithms", "volume": "3", "issn": "2", "pages": "", "other_ids": {}}, "BIBREF11": {"ref_id": "b11", "title": "Stable Marriage and Its Relation to Other Combinatorial Problems", "authors": [{"first": "D", "middle": ["E"], "last": "Knuth", "suffix": ""}], "year": 1976, "venue": "Mariages Stables, Les Presses de l'Universit\u00e9 Montr\u00e9al", "volume": "10", "issn": "", "pages": "", "other_ids": {}}, "BIBREF12": {"ref_id": "b12", "title": "Algorithmics of Matching Under Preferences", "authors": [{"first": "D", "middle": ["F"], "last": "Manlove", "suffix": ""}], "year": 2013, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF13": {"ref_id": "b13", "title": "The evolution of the labor market for medical interns and residents: a case study in game theory", "authors": [{"first": "A", "middle": ["E"], "last": "Roth", "suffix": ""}], "year": 1984, "venue": "J. Polit. Econ", "volume": "92", "issn": "6", "pages": "991--1016", "other_ids": {}}, "BIBREF14": {"ref_id": "b14", "title": "On the allocation of residents to rural hospitals: a general property of two-sided matching markets", "authors": [{"first": "A", "middle": ["E"], "last": "Roth", "suffix": ""}], "year": 1986, "venue": "Econometrica", "volume": "54", "issn": "2", "pages": "425--427", "other_ids": {}}, "BIBREF15": {"ref_id": "b15", "title": "Two-Sided Matching: A Study in Game-theoretic Modeling and Analysis", "authors": [{"first": "A", "middle": ["E"], "last": "Roth", "suffix": ""}, {"first": "M", "middle": [], "last": "Sotomayor", "suffix": ""}], "year": 1990, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF16": {"ref_id": "b16", "title": "Stable noncrossing matchings", "authors": [{"first": "S", "middle": [], "last": "Ruangwises", "suffix": ""}, {"first": "T", "middle": [], "last": "Itoh", "suffix": ""}], "year": 2019, "venue": "IWOCA 2019", "volume": "11638", "issn": "", "pages": "405--416", "other_ids": {"DOI": ["10.1007/978-3-030-25005-8_33"]}}}, "ref_entries": {"FIGREF0": {"text": "For a matching M , an acceptable pair (m, w) \u2208 M is called a blocking pair for M if both w m M (m) and m w M (w) hold. A noncrossing blocking pair for M is a blocking pair for M that does not cross with any edge of M . A matching M is a weakly stable noncrossing matching (WSNM) if M is noncrossing and does not admit any noncrossing blocking pair. A matching M is a strongly stable noncrossing matching (SSNM) if M is noncrossing and does not admit any blocking pair.", "latex": null, "type": "figure"}, "FIGREF1": {"text": "Preference lists of the man and the woman in the separator.", "latex": null, "type": "figure"}, "FIGREF2": {"text": "Alignment of agents.", "latex": null, "type": "figure"}, "FIGREF3": {"text": "For each i, we know that either M i,0 \u2282 M or M i,1 \u2282 M by Lemma 1. If M i,0 \u2282 M then we set x i = 0 in A, and if M i,1 \u2282 M then we set x i = 1 in A. We show that A satisfies f . Suppose not, and let C j be an unsatisfied clause. Fix an integer k \u2208 {1, 2, 3}. Suppose that the kth literal of C j is a positive occurrence of x i . Then, by construction of preference lists, (p i,2 , z j,k ) is an acceptable pair. Since C j is unsatisfied, x i = 0 under A. Then, by construction of A, M i,0 \u2282 M and hence p i,2 is single in M . If N j,k \u2282 M , then z j,k is single in M , which contradicts stability of M . For the other case, suppose that the kth literal of C j is a negative occurrence of x i . Then, by construction of preference lists, (p i,1 , z j,k ) is an acceptable pair. Since C j is unsatisfied, x i = 1 under A. Then, by construction of A, M i,1 \u2282 M and hence p i,1 is single in M . If N j,k \u2282 M , then z j,k is single in M , which contradicts stability of M .", "latex": null, "type": "figure"}, "FIGREF4": {"text": "M of I , M = M \u222a {(m 0 , w 0 ), (m n+1 , w n+1 )} is a WSNM of I. Conversely, any WSNM M of I includes the pairs (m 0 , w 0 ) and (m n+1 , w n+1 ), and M = M \\ {(m 0 , w 0 ), (m n+1 , w n+1 )} is a WSNM of I . Thus we have that opt(I) = opt(I ) + 2.", "latex": null, "type": "figure"}, "FIGREF5": {"text": "1.2.3 of [6]. Computing each Y (0, 0), Y (0, j), and Y (i, 0) can be done in constant time. For computing one Y (i, j) according to Eq. (4), there are O(n 2 ) candidates for (i , j ). For each (i , j ), checking if (m i , w j ) and (m i , w j ) are conflicting can be done in constant time with O(n 4 )-time preprocessing described in the subsequent paragraphs. Therefore one Y (i, j) can be computed in time O(n 2 ). Since there are O(n 2 ) Y (i, j)s, the time-complexity for computing all Y (i, j)s is O(n 4 ). Adding the O(n 4 )-time for preprocessing mentioned above, the total time-complexity of the algorithm is O(n 4 ).In the preprocessing, we construct three tables S, A, and B.-S is a \u0398(n 4 )-sized four-dimensionaltable that takes logical values 0 and 1. For 0 \u2264 i \u2264 i \u2264 n + 1 and 0 \u2264 j \u2264 j \u2264 n + 1, S(i , i, j , j) = 1 if and only if there exists at least one acceptable pair (m, w) such that m \u2208 {m i , m i +1 , . . . , m i } and w \u2208 {w j , w j +1 , . . . , w j }. Since S(i, i, j, j) = 1 if and only if (m i , w j ) is an acceptable pair, it can be computed in constant time. In general, S(i , i, j , j) can be computed in constant time as follows.S(i , i, j , j) = 1 (if (m i , w j ) is an acceptable pair) S(i , i \u2212 1, j , j) \u2228 S(i , i, j , j \u2212 1)(otherwise)Hence S can be constructed in O(n 4 ) time by a simple dynamic programming. -A is a \u0398(n 3 )-sized table where, for 0 \u2264 i \u2264 n + 1 and 0 \u2264 j \u2264 j \u2264 n + 1, A(i, j , j) stores the woman whom m i most prefers among {w j , . . . , w j }. Since A(i, j, j) = w j and A(i, j , j) is the better of A(i, j , j \u2212 1) and w j in m i 's list, each element can be computed in constant time and hence A can be constructed in O(n 3 ) time. -B plays a symmetric role to A; for 0 \u2264 i \u2264 i \u2264 n + 1 and 0 \u2264 j \u2264 n + 1, B(i , i, j) stores the man whom w j most prefers among {m i , . . . , m i }. B can also be constructed in O(n 3 ) time.", "latex": null, "type": "figure"}, "TABREF0": {"text": "Previous and our results.", "latex": null, "type": "table", "html": "<html><body><table><tr><td>\u00a0</td><td>SSNM </td><td>WSNM </td><td>MAX-WSNM\n</td></tr><tr><td>SMI </td><td>O(n2) [Proposition 1] </td><td>O(n2) [16] </td><td>O(n4) [Theorem 2]\n</td></tr><tr><td>SMTI Super </td><td>O(n2) [Corollary 1] </td><td>\u00a0</td><td>O(n4) [Corollary 3]\n</td></tr><tr><td>Strong </td><td>O(n3) [Corollary 2] </td><td>\u00a0</td><td>O(n4) [Corollary 3]\n</td></tr><tr><td>\u00a0</td><td>Weak </td><td>NPC [Theorem 1] </td><td>O(n4) [Corollary 3]\n</td></tr></table></body></html>"}, "TABREF1": {"text": "Fig. 1. Preference lists of persons in xi-gadget.", "latex": null, "type": "table"}}, "back_matter": [{"text": "Acknowledgments. The authors would like to thank the anonymous reviewers for their comments on an earlier version of the paper.", "cite_spans": [], "ref_spans": [], "section": "acknowledgement"}, {"text": "It is easy to see that (m i , w j ) and (m i , w j ) are conflicting if and only if one of the following conditions hold. Condition 1 can be clearly checked in constant time. Thanks to the preprocessing, Conditions 2-4 can also be checked in constant time.", "cite_spans": [], "ref_spans": [], "section": "annex"}, {"text": "There exists an O(n 4 )-time algorithm to find a maximum cardinality WSNM, given an SMI-instance.", "cite_spans": [], "ref_spans": [], "section": "Theorem 2."}, {"text": "The algorithm in Sect. 4.1 can be applied to SMTI straightforwardly. The only difference is the definition of two edges (m i , w j ) and (m x , w y ) being nonconflicting, which we need to extend depending on one of the three stability notions.According to the introduction of ties, we also need to extend the definition of the tables A and B. A(i, j , j) holds one of the women whom m i most prefers among {w j , . . . , w j }, and similarly, B(i , i, j) holds one of the men whom w j most prefers among {m i , . . . , m i }. With these modifications, checking whether two edges are conflicting or not can be done in constant time in the same manner as mentioned above. Therefore, we have the following corollary: ", "cite_spans": [], "ref_spans": [], "section": "SMTI"}, {"text": "In this paper, we have shown algorithms and complexity results for the problems of determining existence of an SSNM and finding a maximum cardinality WSNM, in the settings both with and without ties. One of interesting future directions is to consider optimization problems. For example, in SMI we have shown that it is easy to determine if there exists an SSNM with zero-crossing. What is the complexity of the problem of finding an SSNM with the minimum number of crossings, and if it is NP-hard, is there a good approximation algorithm for it? Another direction is to modify the alignment of agents to, e.g., on a circle or on general position in 2-dimensional plane.", "cite_spans": [], "ref_spans": [], "section": "Conclusion"}]}