{
    "paper_id": "aa9abef5d3d6c845acbfb5ce47d53eb6d2223133",
    "metadata": {
        "title": "SGPT: GPT Sentence Embeddings for Semantic Search",
        "authors": [
            {
                "first": "Niklas",
                "middle": [],
                "last": "Muennighoff",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Peking University",
                    "location": {}
                },
                "email": "muennighoff@stu.pku.edu.cn"
            }
        ]
    },
    "abstract": [
        {
            "text": "GPT transformers are the largest language models available, yet semantic search is dominated by BERT transformers. We present SGPT-BE and SGPT-CE for applying GPT models as Bi-Encoders or Cross-Encoders to symmetric or asymmetric search. SGPT-BE produces semantically meaningful sentence embeddings by contrastive fine-tuning of only bias tensors and a novel pooling method. A 5.8 billion parameter SGPT-BE outperforms the best available sentence embeddings by 7% setting a new state-of-the-art on BEIR. It outperforms the concurrently proposed OpenAI Embeddings of the 175 billion parameter Davinci endpoint, which fine-tunes 250,000 times more parameters. SGPT-CE uses log probabilities from GPT models without any fine-tuning. A 6.1 billion parameter SGPT-CE sets an unsupervised state-of-the-art on BEIR. It beats the supervised state-of-the-art on 7 datasets, but significantly loses on other datasets. We show how this can be alleviated by adapting the prompt. SGPT-BE and SGPT-CE performance scales with model size. Yet, increased latency, storage and compute costs should be considered. Code, models and result files are freely available at https://github.com/Muennighoff/sgpt.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Preprint. Under review.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": ": Given a query q, documents d1\u22123, SGPT ranks the documents with scores s1\u22123. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Semantic search consists of two parts: Search refers to finding the top k answers from a document corpus given a query. Semantic refers to understanding the documents and queries beyond keywords. Transformers [27] are the dominant semantic architecture [4, 26] competing with non-semantic models like BM25 [24] . However, they have been limited to BERT-like encoder transformers [5, 23, 6, 19] .",
            "cite_spans": [
                {
                    "start": 209,
                    "end": 213,
                    "text": "[27]",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 253,
                    "end": 256,
                    "text": "[4,",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 257,
                    "end": 260,
                    "text": "26]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 306,
                    "end": 310,
                    "text": "[24]",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 379,
                    "end": 382,
                    "text": "[5,",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 383,
                    "end": 386,
                    "text": "23,",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 387,
                    "end": 389,
                    "text": "6,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 390,
                    "end": 393,
                    "text": "19]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Meanwhile, GPT-like decoder transformers [20] have been the focus of recent scaling efforts of up to 580 billion parameters [13] . Yet, it remains unclear how to extract competitive GPT sentence embeddings and use them for semantic search. In this work, we investigate how to apply decoder transformers to semantic search and make use of their scale to outperform current methods. We distinguish four settings: Cross-Encoder vs Bi-Encoder, Symmetric vs Asymmetric. See Figure 1 and Section 2.",
            "cite_spans": [
                {
                    "start": 41,
                    "end": 45,
                    "text": "[20]",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 124,
                    "end": 128,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                }
            ],
            "ref_spans": [
                {
                    "start": 469,
                    "end": 477,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Introduction"
        },
        {
            "text": "In the Bi-Encoder setting, we propose SGPT-BE using position-weighted mean pooling and contrastive fine-tuning of only bias tensors (BitFit [32] ). BitFit is within +2 to -2% of full fine-tuning performance for SBERT [23] and SGPT despite changing <0.1% of pre-trained parameters. When controlling for size, SGPT is within +1 to -3% of SBERT performance. When scaling up, SGPT-BE-5.8B sets state-of-the-art results on BEIR and USEB for asymmetric and symmetric search.",
            "cite_spans": [
                {
                    "start": 140,
                    "end": 144,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 217,
                    "end": 221,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In the Cross-Encoder setting, we propose SGPT-CE using log probability extraction of pre-trained GPT models. It can be used for symmetric or asymmetric search by changing the prompt. Unsupervised SGPT-CE-6.1B is 6% worse than supervised SGPT-BE-5.8B on BEIR.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In summary, our contributions are three-fold:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "\u2022 For SGPT-BE in Section 4, we develop a new pooling method and show the usefulness of bias-only fine-tuning for embeddings. At 5.8B parameters, it produces the best natural language embeddings available by a margin of 7% for the example of semantic search.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "\u2022 For SGPT-CE in Section 3, we show how to use GPT for search via log probabilities without fine-tuning. At 6.1B parameters, it has the best unsupervised performance on BEIR by a margin of 8%.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "\u2022 We provide free, more performant alternatives to OpenAI Search or Similarity Embeddings and the OpenAI Search endpoint available at https://github.com/Muennighoff/sgpt",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In this section, we explain two dimensions fundamental to our work: Cross-Encoders vs Bi-Encoders and Symmetric vs Asymmetric Search.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Background"
        },
        {
            "text": "Cross-Encoders encode query and document at the same time. BERT is used as a Cross-Encoder by separating the query from the document with a [SEP ] token [5] . They are then passed through the transformer network together. Each new query requires k forward passes given a corpus of k documents.",
            "cite_spans": [
                {
                    "start": 153,
                    "end": 156,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "Background"
        },
        {
            "text": "Bi-Encoders encode query and document separately. SBERT [23] extends BERT to the Bi-Encoder setting via supervised fine-tuning and a pooling operation across the sequence output. The resulting document vectors can be cached. A new query requires only one forward pass through the transformer to produce the query vector. The query vector can then be scored against the cached document vectors with a similarity function. Embeddings from Bi-Encoders can be used for non-search tasks such as clustering or as input features of machine learning models.",
            "cite_spans": [
                {
                    "start": 56,
                    "end": 60,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [],
            "section": "Background"
        },
        {
            "text": "Cross-Encoders tend to outperform Bi-Encoders [25] , but are slower as vectors cannot be cached.",
            "cite_spans": [
                {
                    "start": 46,
                    "end": 50,
                    "text": "[25]",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "Background"
        },
        {
            "text": "To balance the trade-offs, multi-stage architectures have been proposed [14, 26] . In a two-stage re-ranking setup, the first model processes the entire corpus and the second model is only used on the top k documents returned by the first. In Section 3, we use Bi-Encoder (BM25) + Cross-Encoder re-ranking.",
            "cite_spans": [
                {
                    "start": 72,
                    "end": 76,
                    "text": "[14,",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 77,
                    "end": 80,
                    "text": "26]",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "Background"
        },
        {
            "text": "Asymmetric Search means queries and documents are not interchangeable. Finding answers given a question is an asymmetric search problem. Commonly, documents are much longer than queries [26] . We evaluate asymmetric search experiments on BEIR [26] , a recently proposed benchmark consisting of 19 asymmetric search datasets.",
            "cite_spans": [
                {
                    "start": 186,
                    "end": 190,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 243,
                    "end": 247,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "Background"
        },
        {
            "text": "Symmetric Search means queries and documents are interchangeable. Finding duplicate questions, where both queries and documents are questions, is a symmetric search problem. We evaluate symmetric search experiments on USEB [29] , Quora from BEIR [26] and STS-B. In Quora, queries are question titles and documents are question texts. They are often the same with average word lengths of 9.53 and 11.44, respectively [26] . Hence, we consider it more of a symmetric search task. We include Quora in both symmetric and asymmetric experiments.",
            "cite_spans": [
                {
                    "start": 223,
                    "end": 227,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                },
                {
                    "start": 246,
                    "end": 250,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 416,
                    "end": 420,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "Background"
        },
        {
            "text": "Given a query q, and a document corpus D, we are interested in the most likely document d * . Using Bayes' Theorem this can be expressed as:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Method"
        },
        {
            "text": "Note that P (q) is irrelevant as it is always the same when taking the arg max over D. Due to variable document lengths and contents it is easier to compare P (q|d) than P (d|q). We hence compute the joint probability of the query tokens q i,..,n given the document tokens embedded in a prompt P as p(q i , ..., q n |p 1 , ..., p i\u22121 ). As long as P (d) does not vary excessively across the corpus D, this simplification should produce reasonable scores.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Method"
        },
        {
            "text": "In practice, we use log probabilities [3, 21] , computed via the log of the softmax of the model output.",
            "cite_spans": [
                {
                    "start": 38,
                    "end": 41,
                    "text": "[3,",
                    "ref_id": null
                },
                {
                    "start": 42,
                    "end": 45,
                    "text": "21]",
                    "ref_id": "BIBREF20"
                }
            ],
            "ref_spans": [],
            "section": "Method"
        },
        {
            "text": "To have a constant query length n + 1 \u2212 i and avoid abrupt text changes, documents are truncated from the left until the input fits the model's maximum sequence length. We apply these methods to re-rank top k documents returned by BM25 [24] . While re-ranking with BM25 bottlenecks performance, it speeds up experiments. It is not a necessary part of the architecture and therefore not depicted in Figure 1 .",
            "cite_spans": [
                {
                    "start": 236,
                    "end": 240,
                    "text": "[24]",
                    "ref_id": "BIBREF23"
                }
            ],
            "ref_spans": [
                {
                    "start": 398,
                    "end": 406,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Method"
        },
        {
            "text": "We experiment with publicly available pre-trained decoder transformers with 125M, 1.3B, 2.7B and 6.1B parameters [1, 28] . [3] . In brackets are numbers for cpt-text models recently provided in [17] . They differ likely due to removing the language modeling head.",
            "cite_spans": [
                {
                    "start": 113,
                    "end": 116,
                    "text": "[1,",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 117,
                    "end": 120,
                    "text": "28]",
                    "ref_id": "BIBREF27"
                },
                {
                    "start": 123,
                    "end": 126,
                    "text": "[3]",
                    "ref_id": null
                },
                {
                    "start": 194,
                    "end": 198,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "Method"
        },
        {
            "text": "We sub-select 6 small datasets from BEIR [26] and perform a search over 12 prompts. The prompts and results are in Table 7 and Table 8 . We select the prompt with the best average score, P G .",
            "cite_spans": [
                {
                    "start": 41,
                    "end": 45,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [
                {
                    "start": 115,
                    "end": 122,
                    "text": "Table 7",
                    "ref_id": "TABREF10"
                },
                {
                    "start": 127,
                    "end": 134,
                    "text": "Table 8",
                    "ref_id": "TABREF11"
                }
            ],
            "section": "Results"
        },
        {
            "text": "In Table 1 , we benchmark the resulting SGPT-CE (SGPT-Cross-Encoder). We compare with OpenAI's Search endpoint, which is to be distinguished from their Embeddings endpoint. Please refer to Table  6 in the Bi-Encoder section for a benchmark with the OpenAI Embeddings endpoint. We provide parameter estimates for the OpenAI model names in Table 2 . We also compare with the current stateof-the-art on BEIR [26] , a BERT-based Cross-Encoder. BM25+CE consists of a pre-trained BERT model that is further fine-tuned on MS-MARCO [18] in a supervised fashion [26] . SGPT-CE consists solely of the pre-trained GPT model. However, SGPT-CE-6.1B has almost 15x more parameters than BM25+CE significantly increasing latency. In the Re-rank Top 100 setting, the top 100 documents as returned by BM25 are re-ranked by the respective model. While SGPT-CE-6.1B wins on more datasets than the encoder-based state-of-the-art, its average score is worse. This can be alleviated by not using the same prompt P G for all datasets. We show in Section 3.2 that SGPT-CE-6.1B can beat BM25+CE on Quora by changing the prompt. Table 9 . Dataset labels are ordered by the Max Re-rank=100 6.1B performance. The higher on the y-axis, the more bottlenecked is the Cross-Encoder by BM25's performance. Table 3 : SGPT-CE symmetric search results on Quora. The sum of log probabilities from {query} is used as the re-rank score. Overflowing tokens are truncated from the left of {doc}. Scores are nDCG@10.",
            "cite_spans": [
                {
                    "start": 405,
                    "end": 409,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 524,
                    "end": 528,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 553,
                    "end": 557,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [
                {
                    "start": 3,
                    "end": 10,
                    "text": "Table 1",
                    "ref_id": "TABREF1"
                },
                {
                    "start": 189,
                    "end": 197,
                    "text": "Table  6",
                    "ref_id": "TABREF8"
                },
                {
                    "start": 338,
                    "end": 345,
                    "text": "Table 2",
                    "ref_id": "TABREF2"
                },
                {
                    "start": 1102,
                    "end": 1109,
                    "text": "Table 9",
                    "ref_id": "TABREF13"
                },
                {
                    "start": 1272,
                    "end": 1279,
                    "text": "Table 3",
                    "ref_id": null
                }
            ],
            "section": "Results"
        },
        {
            "text": "In Figure 2 , we investigate how performance scales with model size. As we are in a re-ranking setup, the Cross-Encoder performance is bounded by the documents returned by BM25. We provide the BM25 bounds and additional model results in Table 9 . In a Re-rank Top 10 setting, the model is significantly bottlenecked by BM25. SGPT-CE-6.1B reaches around 80% of the maximum possible performance. We hence observe high jumps in performance for datasets like HotpotQA or TREC-COVID as we move to top 100. In fact, the 0.791 nDCG@10 on TREC-COVID in Table 1 is not possible in a Re-rank Top 10 setting as the bound is at 0.750, see Table 9 . From the results, we infer that performance scales both as we re-rank more documents or increase model size.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 3,
                    "end": 11,
                    "text": "Figure 2",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 237,
                    "end": 244,
                    "text": "Table 9",
                    "ref_id": "TABREF13"
                },
                {
                    "start": 545,
                    "end": 552,
                    "text": "Table 1",
                    "ref_id": "TABREF1"
                },
                {
                    "start": 627,
                    "end": 634,
                    "text": "Table 9",
                    "ref_id": "TABREF13"
                }
            ],
            "section": "Results"
        },
        {
            "text": "We use the same methods outlined in Section 3.1.1, but adapt the prompt for symmetric search. We show this on the example of Quora in Table 3 . In Section 2, we have explained why Quora is closer to symmetric search than asymmetric search. By adapting the prompt, SGPT-CE-6.1B improves by 6% outperforming all Quora results in Table 1 . Table 4 : SGPT parameter overview. Due to the removal of the final language modeling head SGPT-BE-5.8B has 206M parameters less than SGPT-CE-6.1B or GPT-J-6.1B. GPT-Neo models tie the language modeling head weights with the input embeddings, hence there is no weight difference.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 134,
                    "end": 141,
                    "text": "Table 3",
                    "ref_id": null
                },
                {
                    "start": 327,
                    "end": 334,
                    "text": "Table 1",
                    "ref_id": "TABREF1"
                },
                {
                    "start": 337,
                    "end": 344,
                    "text": "Table 4",
                    "ref_id": null
                }
            ],
            "section": "Symmetric Search"
        },
        {
            "text": "SBERT-Base SGPT-125M SGPT-1.3B SGPT-2.7B SGPT-5.8B Transformer (T.) BERT GPT-Neo GPT-Neo GPT-Neo GPT-J Total",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Model Name"
        },
        {
            "text": "Like in Section 3.1.1, we first experiment with decoder transformers that have only gone through unsupervised pre-training. In the Bi-Encoder setting, a pooling operation is commonly applied to the model's hidden states to reduce them to a vector whose size is irrespective of sequence length. SBERT [23] showed that a MEAN pooling mechanism outperforms [CLS] and MAX strategies for a BERT encoder. Due to the causal attention mask in an auto-regressive decoder transformer, tokens do not attend to future tokens like in an encoder transformer. Hence, only the last token has attended to all tokens in a sequence. To account for this information mismatch, we propose to give later tokens a higher weight using a position-weighted mean pooling method:",
            "cite_spans": [
                {
                    "start": 300,
                    "end": 304,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [],
            "section": "SGPT Bi-Encoder"
        },
        {
            "text": "where S is the sequence length, h i the ith hidden state and v the query or document embedding. We compare weighted mean pooling with last token pooling, where the hidden state of the final token is the embedding, and regular mean pooling.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SGPT Bi-Encoder"
        },
        {
            "text": "We follow recent work [9, 12, 17] and perform supervised contrastive learning with in-batch negatives. Given matching query-doc pairs",
            "cite_spans": [
                {
                    "start": 22,
                    "end": 25,
                    "text": "[9,",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 26,
                    "end": 29,
                    "text": "12,",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 30,
                    "end": 33,
                    "text": "17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "SGPT Bi-Encoder"
        },
        {
            "text": ", we optimize the cost function:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SGPT Bi-Encoder"
        },
        {
            "text": "where f \u03b8 is the SGPT model outputting a fixed-size vector, \u03c3 cosine similarity and \u03c4 a temperature parameter set to 20 in our experiments. We use GradCache [8] to train with large batch sizes in a limited memory setting. We train on SNLI [2] and MNLI [31] . We limit the model sequence length to 75 tokens during both training and inference.",
            "cite_spans": [
                {
                    "start": 157,
                    "end": 160,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 239,
                    "end": 242,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 252,
                    "end": 256,
                    "text": "[31]",
                    "ref_id": "BIBREF30"
                }
            ],
            "ref_spans": [],
            "section": "SGPT Bi-Encoder"
        },
        {
            "text": "For large models, we fine-tune only bias parameters and freeze the rest of the model. This has been recently proposed as BitFit [32] for BERT encoders. It has been shown to be competitive with full fine-tuning in various scenarios [11, 30, 15] . Table 4 shows the number of parameters trained for BitFit models. Due to fewer gradient updates, BitFit significantly reduces GPU memory and time required per step. Further, adding a BitFit checkpoint to an instance with an existing full model will only require storing the different biases. An instance already serving a 22.5GB fp32 GPT-J-6B model requires an additional 22MB of storage to serve an SGPT-5.8B-bitfit model. Figure 3 shows average precisions on USEB [29] across different methods and layers. In the unsupervised setting, decoder transformers strongly underperform encoders. However, after finetuning on the same dataset with the same hyperparameters, decoders (SGPT) with 125M parameters [29] . However, fragments may be in-domain due to the large pre-training data of the transformer models. SGPT-0.1B-weightedmean-nli performs 2% worse than SBERT-base-nli-v2 on USEB, but improves on Quora by 1%. Note that there is still a size difference of 14% between the two models. \u2666: Results from [29] except when marked with \u2020. CQADupstack and SciDocs differ from the same-name datasets in BEIR. We provide the code for running OpenAI similarity endpoints on USEB. Feel free to message the author if you would like to fund them (around 300 USD for Curie).",
            "cite_spans": [
                {
                    "start": 128,
                    "end": 132,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 231,
                    "end": 235,
                    "text": "[11,",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 236,
                    "end": 239,
                    "text": "30,",
                    "ref_id": "BIBREF29"
                },
                {
                    "start": 240,
                    "end": 243,
                    "text": "15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 712,
                    "end": 716,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                },
                {
                    "start": 950,
                    "end": 954,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                },
                {
                    "start": 1251,
                    "end": 1255,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [
                {
                    "start": 246,
                    "end": 253,
                    "text": "Table 4",
                    "ref_id": null
                },
                {
                    "start": 670,
                    "end": 678,
                    "text": "Figure 3",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "SGPT Bi-Encoder"
        },
        {
            "text": "closely trail the 110M parameter encoder (SBERT) for the 12th layer. When increasing SGPT size ten-fold, the last layer performance increases beyond that of SBERT models. Weighted mean pooling outperforms other pooling mechanisms for decoders. Table 5 provides performance on the individual USEB datasets, Quora and STS-B. STS-B scores should not be the focus of comparison due to the drawbacks highlighted in [29] . Despite training on less than 0.1% of parameters BitFit models are within +2 to -2% of fully fine-tuned ones. We investigate gradients in Figure 4 . BitFit degrades performance more for decoders than encoders. This could be due to the missing bias parameters, see Table 4 . [32] highlights the importance of the query bias vector for BERT, which is not present for SGPT models. SGPT-5.8B-weightedmeannli-bitfit sets an out-of-domain state-of-the-art on USEB, but is outperformed by models trained in-domain in [29] . We observed performance gains by increasing the training batch size. SGPT-5.8Bweightedmean-nli-bitfit is trained with a batch size of 1024. Other models use lower batch sizes, which partly explains the performance jump to the 5.8B model. In Table 12 , we provide results for a SGPT-5.8B-weightedmean-nli-bitfit trained with a lower batch size of 48.",
            "cite_spans": [
                {
                    "start": 410,
                    "end": 414,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                },
                {
                    "start": 691,
                    "end": 695,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 927,
                    "end": 931,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [
                {
                    "start": 244,
                    "end": 251,
                    "text": "Table 5",
                    "ref_id": "TABREF6"
                },
                {
                    "start": 555,
                    "end": 563,
                    "text": "Figure 4",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 681,
                    "end": 688,
                    "text": "Table 4",
                    "ref_id": null
                },
                {
                    "start": 1175,
                    "end": 1183,
                    "text": "Table 12",
                    "ref_id": "TABREF1"
                }
            ],
            "section": "Results"
        },
        {
            "text": "If not otherwise specified, we follow the same setup as in Section 4.1.1. For asymmetric search, we train on MS-MARCO [18] . We limit the model sequence length to 300 tokens during both training and inference. We follow concurrent work [17] and add enclosing brackets to help the model distinguish between query and document. We embed the tokens of query q in two brackets as [q 0\u2212n ]. For documents, we use curly brackets: {d 0\u2212n }. We add the token ids of the brackets to the already tokenized text to avoid the tokens intermingling. We refer to these special brackets as specb. Table 6 benchmarks SGPT-BE-5.8B (SGPT-5.8B-weightedmean-msmarco-specb-bitfit) on BEIR [26] with: (a) BM25 [24] , a non-semantic fast baseline (b) SGPT-CE-6.1B from Section 3 (c) BM25+CE [26] , the current overall state-of-the-art on BEIR (d) TAS-B [10] , the original Bi-Encoder state-of-the-art on BEIR (e) Contriever [12] , a similar training scheme as [17] but using an encoder transformer (f ) GTR-XXL [19] , the current Bi-Encoder state-of-the-art on BEIR with 4.8 billion parameters using the BERT-like encoder transformer of T5 [22] (g) cpt-text, a GPT-like decoder transformer architecture concurrently proposed in [17] . Corresponding parameter estimates are in Table 2 .",
            "cite_spans": [
                {
                    "start": 118,
                    "end": 122,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 236,
                    "end": 240,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 667,
                    "end": 671,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 687,
                    "end": 691,
                    "text": "[24]",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 767,
                    "end": 771,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 829,
                    "end": 833,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 900,
                    "end": 904,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 936,
                    "end": 940,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 987,
                    "end": 991,
                    "text": "[19]",
                    "ref_id": null
                },
                {
                    "start": 1116,
                    "end": 1120,
                    "text": "[22]",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 1204,
                    "end": 1208,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [
                {
                    "start": 581,
                    "end": 588,
                    "text": "Table 6",
                    "ref_id": "TABREF8"
                },
                {
                    "start": 1252,
                    "end": 1259,
                    "text": "Table 2",
                    "ref_id": "TABREF2"
                }
            ],
            "section": "Method"
        },
        {
            "text": "SGPT-5.8B achieves the best average nDCG@10 both on the BEIR subset selected in [17] and on the full BEIR benchmark. It outperforms the roughly same-sized cpt-text-L and the 30x larger cpt-text-XL by 8.1% and 4.2%, respectively. Yet, cpt-text models have gone through an additional unsupervised training stage [17] and are fully trained. SGPT-BE-5.8B fine-tunes just 700K parameters, 0.0004% of the parameters fine-tuned for cpt-text-XL [17] . See Table 2 for sizes. We suspect much of the difference to come from the cpt-text model's inferior last token pooling as shown in Figure 3 .",
            "cite_spans": [
                {
                    "start": 80,
                    "end": 84,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 310,
                    "end": 314,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 437,
                    "end": 441,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [
                {
                    "start": 448,
                    "end": 455,
                    "text": "Table 2",
                    "ref_id": "TABREF2"
                },
                {
                    "start": 575,
                    "end": 583,
                    "text": "Figure 3",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Results"
        },
        {
            "text": "SGPT-BE-5.8B improves on the overall state-of-the-art, a Cross-Encoder, by 3%. It improves on the previously best sentence embeddings (Bi-Encoder) on BEIR, GTR-XXL, by 7%. However, these improvements come at a significant cost. GTR-XXL has 20% fewer parameters and its embeddings have 768 dimensions. SGPT-BE-5.8B produces embeddings with 4096 dimensions, hence requiring about 5x more storage. It took the model six days on one Nvidia A100 GPU to encode the entire BioASQ corpus with 15M documents and an average 200 words each [26] . Its comparatively low performance on BioASQ may be improved by increasing the sequence length limit beyond 300, however, requiring additional compute. For SGPT-CE-6.1B, the sequence length limit was 2048 for the combined prompt on all datasets. The high performance on TREC-COVID for SGPT models could be due to the different pre-training datasets. The SGPT pre-training dataset, The Pile [7] , contains data until mid-2020. This may give the models an information advantage on Covid-19.",
            "cite_spans": [
                {
                    "start": 529,
                    "end": 533,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 925,
                    "end": 928,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "Lastly, we highlight that on Quora SGPT-BE-5.8B-msmarco is outperformed by SGPT-BE-5.8B-nli from Table 5 . Given our classification of Quora as a symmetric search task in Section 2, this supports our overall distinction between asymmetric and symmetric search. We advise users of our models to classify their tasks as symmetric or asymmetric and use the appropriate model. For non-classifiable embedding tasks, both may work, but we recommend experimenting with embeddings from the symmetric models in Section 4.1 first.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 97,
                    "end": 104,
                    "text": "Table 5",
                    "ref_id": "TABREF6"
                }
            ],
            "section": "Results"
        },
        {
            "text": "This work presented SGPT. Building on SBERT, we proposed modifications to GPT models to use them as Cross-or Bi-Encoders for semantic search.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion and Future Work"
        },
        {
            "text": "SGPT-BE uses position-weighted mean pooling and fine-tuning of only bias tensors. At scale, it produces new state-of-the-art sentence embeddings. The model can be used for semantic search or other embedding tasks. We recommend using SGPT-BE-5.8B when compute and storage are of high availability and maximum performance is desired.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion and Future Work"
        },
        {
            "text": "SGPT-CE extracts log probabilities of pre-trained GPT models to produce unsupervised state-ofthe-art search results. The setup presented can only be used for semantic search. Storage can be limited, but compute should be of high availability for SGPT-CE-6.1B. The prompt and max re-rank parameter can be adjusted depending on performance and latency requirements.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion and Future Work"
        },
        {
            "text": "Future research could fine-tune a GPT Cross-Encoder on MSMARCO similar to the BM25+CE model. We suspect that this should outperform the presented non-fine-tuned SGPT-CE model as well as SGPT-BE if enough documents are re-ranked. Further, the combination of SGPT with GPT for generative search results could be interesting. Possibly, SGPT embeddings could be injected into GPT models to generate answers. Lastly, a detailed study of the disadvantages of the missing biases in large GPT models could be helpful to consider their inclusion in the training of future large language models. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion and Future Work"
        },
        {
            "text": "Re-rank Top 0 Re-rank Top 10 Re-rank Top 100 Table 11 : SGPT-BE experiments on a subset of the 5 smallest BEIR datasets by corpus size. The best checkpoint for all models is displayed. specb=special brackets. bs=batch size. bitfitwte=BitFit + Word Token Embeddings are trained. The idea was to help the model learn the special role of the brackets. It did not help. asym=Two-tower model with separate transformers for queries and documents. SGPT-125M-weightedmeanmsmarco-specb performs 3% worse than SBERT-base-msmarco on average. SGPT-125M-weightedmeanmsmarco-specb-bitfit performs 1% worse than SBERT-base-msmarco-bitfit on average. Interestingly, Curie beats SGPT-5.8B on this subset, but does not on the bigger subset in Table 6 . Scores are nDCG@10. Table 12 : Additional results on USEB, Quora and STS-B. Metrics are average precision for USEB, nDCG@10 for Quora and Spearman correlation for STS-B. bf=BitFit. bs=batch size. OOD=Out-of-domain, to contrast these numbers from in-domain numbers in [29] . However, fragments may be in-domain due to the large pre-training data of the transformer models. CQADupstack and SciDocs differ from the same-name datasets in BEIR.",
            "cite_spans": [
                {
                    "start": 1002,
                    "end": 1006,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [
                {
                    "start": 45,
                    "end": 53,
                    "text": "Table 11",
                    "ref_id": "TABREF1"
                },
                {
                    "start": 725,
                    "end": 732,
                    "text": "Table 6",
                    "ref_id": "TABREF8"
                },
                {
                    "start": 755,
                    "end": 763,
                    "text": "Table 12",
                    "ref_id": "TABREF1"
                }
            ],
            "section": "Ranking (\u2192)"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Tri Songz, Phil Wang, and Samuel Weinbach. 2021. GPT-NeoX: Large Scale Autoregressive Language Modeling in PyTorch",
            "authors": [
                {
                    "first": "Alex",
                    "middle": [],
                    "last": "Andonian",
                    "suffix": ""
                },
                {
                    "first": "Quentin",
                    "middle": [],
                    "last": "Anthony",
                    "suffix": ""
                },
                {
                    "first": "Stella",
                    "middle": [],
                    "last": "Biderman",
                    "suffix": ""
                },
                {
                    "first": "Sid",
                    "middle": [],
                    "last": "Black",
                    "suffix": ""
                },
                {
                    "first": "Preetham",
                    "middle": [],
                    "last": "Gali",
                    "suffix": ""
                },
                {
                    "first": "Leo",
                    "middle": [],
                    "last": "Gao",
                    "suffix": ""
                },
                {
                    "first": "Eric",
                    "middle": [],
                    "last": "Hallahan",
                    "suffix": ""
                },
                {
                    "first": "Josh",
                    "middle": [],
                    "last": "Levy-Kramer",
                    "suffix": ""
                },
                {
                    "first": "Connor",
                    "middle": [],
                    "last": "Leahy",
                    "suffix": ""
                },
                {
                    "first": "Lucas",
                    "middle": [],
                    "last": "Nestler",
                    "suffix": ""
                },
                {
                    "first": "Kip",
                    "middle": [],
                    "last": "Parker",
                    "suffix": ""
                },
                {
                    "first": "Michael",
                    "middle": [],
                    "last": "Pieler",
                    "suffix": ""
                },
                {
                    "first": "Shivanshu",
                    "middle": [],
                    "last": "Purohit",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "4",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "A large annotated corpus for learning natural language inference",
            "authors": [
                {
                    "first": "Gabor",
                    "middle": [],
                    "last": "Samuel R Bowman",
                    "suffix": ""
                },
                {
                    "first": "Christopher",
                    "middle": [],
                    "last": "Angeli",
                    "suffix": ""
                },
                {
                    "first": "Christopher D",
                    "middle": [],
                    "last": "Potts",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Manning",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1508.05326.7"
                ]
            }
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Universal sentence encoder",
            "authors": [
                {
                    "first": "Daniel",
                    "middle": [],
                    "last": "Cer",
                    "suffix": ""
                },
                {
                    "first": "Yinfei",
                    "middle": [],
                    "last": "Yang",
                    "suffix": ""
                },
                {
                    "first": "Sheng-Yi",
                    "middle": [],
                    "last": "Kong",
                    "suffix": ""
                },
                {
                    "first": "Nan",
                    "middle": [],
                    "last": "Hua",
                    "suffix": ""
                },
                {
                    "first": "Nicole",
                    "middle": [],
                    "last": "Limtiaco",
                    "suffix": ""
                },
                {
                    "first": "Rhomni",
                    "middle": [],
                    "last": "St John",
                    "suffix": ""
                },
                {
                    "first": "Noah",
                    "middle": [],
                    "last": "Constant",
                    "suffix": ""
                },
                {
                    "first": "Mario",
                    "middle": [],
                    "last": "Guajardo-Cespedes",
                    "suffix": ""
                },
                {
                    "first": "Steve",
                    "middle": [],
                    "last": "Yuan",
                    "suffix": ""
                },
                {
                    "first": "Chris",
                    "middle": [],
                    "last": "Tar",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1803.11175.3"
                ]
            }
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Bert: Pre-training of deep bidirectional transformers for language understanding",
            "authors": [
                {
                    "first": "Jacob",
                    "middle": [],
                    "last": "Devlin",
                    "suffix": ""
                },
                {
                    "first": "Ming-Wei",
                    "middle": [],
                    "last": "Chang",
                    "suffix": ""
                },
                {
                    "first": "Kenton",
                    "middle": [],
                    "last": "Lee",
                    "suffix": ""
                },
                {
                    "first": "Kristina",
                    "middle": [],
                    "last": "Toutanova",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "3",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1810.04805"
                ]
            }
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "SPLADE v2: Sparse lexical and expansion model for information retrieval",
            "authors": [
                {
                    "first": "Thibault",
                    "middle": [],
                    "last": "Formal",
                    "suffix": ""
                },
                {
                    "first": "Carlos",
                    "middle": [],
                    "last": "Lassance",
                    "suffix": ""
                },
                {
                    "first": "Benjamin",
                    "middle": [],
                    "last": "Piwowarski",
                    "suffix": ""
                },
                {
                    "first": "St\u00e9phane",
                    "middle": [],
                    "last": "Clinchant",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2109.10086.3"
                ]
            }
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "The pile: An 800gb dataset of diverse text for language modeling",
            "authors": [
                {
                    "first": "Leo",
                    "middle": [],
                    "last": "Gao",
                    "suffix": ""
                },
                {
                    "first": "Stella",
                    "middle": [],
                    "last": "Biderman",
                    "suffix": ""
                },
                {
                    "first": "Sid",
                    "middle": [],
                    "last": "Black",
                    "suffix": ""
                },
                {
                    "first": "Laurence",
                    "middle": [],
                    "last": "Golding",
                    "suffix": ""
                },
                {
                    "first": "Travis",
                    "middle": [],
                    "last": "Hoppe",
                    "suffix": ""
                },
                {
                    "first": "Charles",
                    "middle": [],
                    "last": "Foster",
                    "suffix": ""
                },
                {
                    "first": "Jason",
                    "middle": [],
                    "last": "Phang",
                    "suffix": ""
                },
                {
                    "first": "Horace",
                    "middle": [],
                    "last": "He",
                    "suffix": ""
                },
                {
                    "first": "Anish",
                    "middle": [],
                    "last": "Thite",
                    "suffix": ""
                },
                {
                    "first": "Noa",
                    "middle": [],
                    "last": "Nabeshima",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2101.00027.10"
                ]
            }
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Scaling deep contrastive learning batch size under memory limited setup",
            "authors": [
                {
                    "first": "Luyu",
                    "middle": [],
                    "last": "Gao",
                    "suffix": ""
                },
                {
                    "first": "Yunyi",
                    "middle": [],
                    "last": "Zhang",
                    "suffix": ""
                },
                {
                    "first": "Jiawei",
                    "middle": [],
                    "last": "Han",
                    "suffix": ""
                },
                {
                    "first": "Jamie",
                    "middle": [],
                    "last": "Callan",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2101.06983.7"
                ]
            }
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Simcse: Simple contrastive learning of sentence embeddings",
            "authors": [
                {
                    "first": "Tianyu",
                    "middle": [],
                    "last": "Gao",
                    "suffix": ""
                },
                {
                    "first": "Xingcheng",
                    "middle": [],
                    "last": "Yao",
                    "suffix": ""
                },
                {
                    "first": "Danqi",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2104.08821.7"
                ]
            }
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Efficiently teaching an effective dense retriever with balanced topic aware sampling",
            "authors": [
                {
                    "first": "Sebastian",
                    "middle": [],
                    "last": "Hofst\u00e4tter",
                    "suffix": ""
                },
                {
                    "first": "Sheng-Chieh",
                    "middle": [],
                    "last": "Lin",
                    "suffix": ""
                },
                {
                    "first": "Jheng-Hong",
                    "middle": [],
                    "last": "Yang",
                    "suffix": ""
                },
                {
                    "first": "Jimmy",
                    "middle": [],
                    "last": "Lin",
                    "suffix": ""
                },
                {
                    "first": "Allan",
                    "middle": [],
                    "last": "Hanbury",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval",
            "volume": "",
            "issn": "",
            "pages": "113--122",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Lora: Low-rank adaptation of large language models",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Edward",
                    "suffix": ""
                },
                {
                    "first": "Yelong",
                    "middle": [],
                    "last": "Hu",
                    "suffix": ""
                },
                {
                    "first": "Phillip",
                    "middle": [],
                    "last": "Shen",
                    "suffix": ""
                },
                {
                    "first": "Zeyuan",
                    "middle": [],
                    "last": "Wallis",
                    "suffix": ""
                },
                {
                    "first": "Yuanzhi",
                    "middle": [],
                    "last": "Allen-Zhu",
                    "suffix": ""
                },
                {
                    "first": "Shean",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "Lu",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "Weizhu",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2106.09685.7"
                ]
            }
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Towards Unsupervised Dense Information Retrieval with Contrastive Learning",
            "authors": [
                {
                    "first": "Gautier",
                    "middle": [],
                    "last": "Izacard",
                    "suffix": ""
                },
                {
                    "first": "Mathilde",
                    "middle": [],
                    "last": "Caron",
                    "suffix": ""
                },
                {
                    "first": "Lucas",
                    "middle": [],
                    "last": "Hosseini",
                    "suffix": ""
                },
                {
                    "first": "Sebastian",
                    "middle": [],
                    "last": "Riedel",
                    "suffix": ""
                },
                {
                    "first": "Piotr",
                    "middle": [],
                    "last": "Bojanowski",
                    "suffix": ""
                },
                {
                    "first": "Armand",
                    "middle": [],
                    "last": "Joulin",
                    "suffix": ""
                },
                {
                    "first": "Edouard",
                    "middle": [],
                    "last": "Grave",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "7",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2112.09118"
                ]
            }
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Using DeepSpeed and Megatron to Train Megatron-Turing NLG 530B, the World's Largest and Most Powerful Generative Language Model",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Kharya",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Alvi",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Colbert: Efficient and effective passage search via contextualized late interaction over bert",
            "authors": [
                {
                    "first": "Omar",
                    "middle": [],
                    "last": "Khattab",
                    "suffix": ""
                },
                {
                    "first": "Matei",
                    "middle": [],
                    "last": "Zaharia",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval",
            "volume": "",
            "issn": "",
            "pages": "39--48",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Cutting down on prompts and parameters: Simple few-shot learning with language models",
            "authors": [
                {
                    "first": "I",
                    "middle": [
                        "V"
                    ],
                    "last": "Robert L Logan",
                    "suffix": ""
                },
                {
                    "first": "Ivana",
                    "middle": [],
                    "last": "Bala\u017eevi\u0107",
                    "suffix": ""
                },
                {
                    "first": "Eric",
                    "middle": [],
                    "last": "Wallace",
                    "suffix": ""
                },
                {
                    "first": "Fabio",
                    "middle": [],
                    "last": "Petroni",
                    "suffix": ""
                },
                {
                    "first": "Sameer",
                    "middle": [],
                    "last": "Singh",
                    "suffix": ""
                },
                {
                    "first": "Sebastian",
                    "middle": [],
                    "last": "Riedel",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2106.13353.7"
                ]
            }
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Www'18 open challenge: financial opinion mining and question answering",
            "authors": [
                {
                    "first": "Macedo",
                    "middle": [],
                    "last": "Maia",
                    "suffix": ""
                },
                {
                    "first": "Siegfried",
                    "middle": [],
                    "last": "Handschuh",
                    "suffix": ""
                },
                {
                    "first": "Andr\u00e9",
                    "middle": [],
                    "last": "Freitas",
                    "suffix": ""
                },
                {
                    "first": "Brian",
                    "middle": [],
                    "last": "Davis",
                    "suffix": ""
                },
                {
                    "first": "Ross",
                    "middle": [],
                    "last": "Mcdermott",
                    "suffix": ""
                },
                {
                    "first": "Manel",
                    "middle": [],
                    "last": "Zarrouk",
                    "suffix": ""
                },
                {
                    "first": "Alexandra",
                    "middle": [],
                    "last": "Balahur",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Companion Proceedings of the The Web Conference",
            "volume": "",
            "issn": "",
            "pages": "1941--1942",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Text and Code Embeddings by Contrastive Pre-Training",
            "authors": [
                {
                    "first": "Arvind",
                    "middle": [],
                    "last": "Neelakantan",
                    "suffix": ""
                },
                {
                    "first": "Tao",
                    "middle": [],
                    "last": "Xu",
                    "suffix": ""
                },
                {
                    "first": "Raul",
                    "middle": [],
                    "last": "Puri",
                    "suffix": ""
                },
                {
                    "first": "Alec",
                    "middle": [],
                    "last": "Radford",
                    "suffix": ""
                },
                {
                    "first": "Jesse",
                    "middle": [
                        "Michael"
                    ],
                    "last": "Han",
                    "suffix": ""
                },
                {
                    "first": "Jerry",
                    "middle": [],
                    "last": "Tworek",
                    "suffix": ""
                },
                {
                    "first": "Qiming",
                    "middle": [],
                    "last": "Yuan",
                    "suffix": ""
                },
                {
                    "first": "Nikolas",
                    "middle": [],
                    "last": "Tezak",
                    "suffix": ""
                },
                {
                    "first": "Jong",
                    "middle": [
                        "Wook"
                    ],
                    "last": "Kim",
                    "suffix": ""
                },
                {
                    "first": "Chris",
                    "middle": [],
                    "last": "Hallacy",
                    "suffix": ""
                }
            ],
            "year": 2022,
            "venue": "",
            "volume": "7",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2201.10005.5"
                ]
            }
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "MS MARCO: A human generated machine reading comprehension dataset",
            "authors": [
                {
                    "first": "Tri",
                    "middle": [],
                    "last": "Nguyen",
                    "suffix": ""
                },
                {
                    "first": "Mir",
                    "middle": [],
                    "last": "Rosenberg",
                    "suffix": ""
                },
                {
                    "first": "Xia",
                    "middle": [],
                    "last": "Song",
                    "suffix": ""
                },
                {
                    "first": "Jianfeng",
                    "middle": [],
                    "last": "Gao",
                    "suffix": ""
                },
                {
                    "first": "Saurabh",
                    "middle": [],
                    "last": "Tiwary",
                    "suffix": ""
                },
                {
                    "first": "Rangan",
                    "middle": [],
                    "last": "Majumder",
                    "suffix": ""
                },
                {
                    "first": "Li",
                    "middle": [],
                    "last": "Deng",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "In CoCo@ NIPS",
            "volume": "5",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Improving language understanding by generative pre",
            "authors": [
                {
                    "first": "Alec",
                    "middle": [],
                    "last": "Radford",
                    "suffix": ""
                },
                {
                    "first": "Karthik",
                    "middle": [],
                    "last": "Narasimhan",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "Language models are unsupervised multitask learners",
            "authors": [
                {
                    "first": "Alec",
                    "middle": [],
                    "last": "Radford",
                    "suffix": ""
                },
                {
                    "first": "Jeffrey",
                    "middle": [],
                    "last": "Wu",
                    "suffix": ""
                },
                {
                    "first": "Rewon",
                    "middle": [],
                    "last": "Child",
                    "suffix": ""
                },
                {
                    "first": "David",
                    "middle": [],
                    "last": "Luan",
                    "suffix": ""
                },
                {
                    "first": "Dario",
                    "middle": [],
                    "last": "Amodei",
                    "suffix": ""
                },
                {
                    "first": "Ilya",
                    "middle": [],
                    "last": "Sutskever",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "OpenAI blog",
            "volume": "1",
            "issn": "8",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Exploring the limits of transfer learning with a unified text-to-text transformer",
            "authors": [
                {
                    "first": "Colin",
                    "middle": [],
                    "last": "Raffel",
                    "suffix": ""
                },
                {
                    "first": "Noam",
                    "middle": [],
                    "last": "Shazeer",
                    "suffix": ""
                },
                {
                    "first": "Adam",
                    "middle": [],
                    "last": "Roberts",
                    "suffix": ""
                },
                {
                    "first": "Katherine",
                    "middle": [],
                    "last": "Lee",
                    "suffix": ""
                },
                {
                    "first": "Sharan",
                    "middle": [],
                    "last": "Narang",
                    "suffix": ""
                },
                {
                    "first": "Michael",
                    "middle": [],
                    "last": "Matena",
                    "suffix": ""
                },
                {
                    "first": "Yanqi",
                    "middle": [],
                    "last": "Zhou",
                    "suffix": ""
                },
                {
                    "first": "Wei",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "Peter J",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1910.10683.9"
                ]
            }
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Sentence-bert: Sentence embeddings using siamese bert-networks",
            "authors": [
                {
                    "first": "Nils",
                    "middle": [],
                    "last": "Reimers",
                    "suffix": ""
                },
                {
                    "first": "Iryna",
                    "middle": [],
                    "last": "Gurevych",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "4",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1908.10084.3"
                ]
            }
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "The probabilistic relevance framework: BM25 and beyond",
            "authors": [
                {
                    "first": "Stephen",
                    "middle": [],
                    "last": "Robertson",
                    "suffix": ""
                },
                {
                    "first": "Hugo",
                    "middle": [],
                    "last": "Zaragoza",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "",
            "volume": "5",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Augmented sbert: Data augmentation method for improving bi-encoders for pairwise sentence scoring tasks",
            "authors": [
                {
                    "first": "Nandan",
                    "middle": [],
                    "last": "Thakur",
                    "suffix": ""
                },
                {
                    "first": "Nils",
                    "middle": [],
                    "last": "Reimers",
                    "suffix": ""
                },
                {
                    "first": "Johannes",
                    "middle": [],
                    "last": "Daxenberger",
                    "suffix": ""
                },
                {
                    "first": "Iryna",
                    "middle": [],
                    "last": "Gurevych",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2010.08240.4"
                ]
            }
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "Nils Reimers, Andreas R\u00fcckl\u00e9, Abhishek Srivastava, and Iryna Gurevych. 2021. BEIR: A Heterogenous Benchmark for Zero-shot Evaluation of Information Retrieval Models",
            "authors": [
                {
                    "first": "Nandan",
                    "middle": [],
                    "last": "Thakur",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "4",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2104.08663.3"
                ]
            }
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "Attention is all you need",
            "authors": [
                {
                    "first": "Ashish",
                    "middle": [],
                    "last": "Vaswani",
                    "suffix": ""
                },
                {
                    "first": "Noam",
                    "middle": [],
                    "last": "Shazeer",
                    "suffix": ""
                },
                {
                    "first": "Niki",
                    "middle": [],
                    "last": "Parmar",
                    "suffix": ""
                },
                {
                    "first": "Jakob",
                    "middle": [],
                    "last": "Uszkoreit",
                    "suffix": ""
                },
                {
                    "first": "Llion",
                    "middle": [],
                    "last": "Jones",
                    "suffix": ""
                },
                {
                    "first": "Aidan",
                    "middle": [
                        "N"
                    ],
                    "last": "Gomez",
                    "suffix": ""
                },
                {
                    "first": "\u0141ukasz",
                    "middle": [],
                    "last": "Kaiser",
                    "suffix": ""
                },
                {
                    "first": "Illia",
                    "middle": [],
                    "last": "Polosukhin",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Advances in neural information processing systems",
            "volume": "",
            "issn": "",
            "pages": "5998--6008",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "GPT-J-6B: A 6 Billion Parameter Autoregressive Language Model",
            "authors": [
                {
                    "first": "Ben",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "Aran",
                    "middle": [],
                    "last": "Komatsuzaki",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Nils Reimers, and Iryna Gurevych. 2021. TSDAE: Using Transformer-based Sequential Denoising Auto-Encoder for Unsupervised Sentence Embedding Learning",
            "authors": [
                {
                    "first": "Kexin",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "7",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2104.06979.4"
                ]
            }
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "Ahmed Hassan Awadallah, and Jianfeng Gao. 2021. LiST: Lite Self-training Makes Efficient Few-shot Learners",
            "authors": [
                {
                    "first": "Yaqing",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "Subhabrata",
                    "middle": [],
                    "last": "Mukherjee",
                    "suffix": ""
                },
                {
                    "first": "Xiaodong",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "Jing",
                    "middle": [],
                    "last": "Gao",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2110.06274.7"
                ]
            }
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "A broad-coverage challenge corpus for sentence understanding through inference",
            "authors": [
                {
                    "first": "Adina",
                    "middle": [],
                    "last": "Williams",
                    "suffix": ""
                },
                {
                    "first": "Nikita",
                    "middle": [],
                    "last": "Nangia",
                    "suffix": ""
                },
                {
                    "first": "Samuel R",
                    "middle": [],
                    "last": "Bowman",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1704.05426.7"
                ]
            }
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "BitFit: Simple Parameter-efficient Fine-tuning for Transformer-based Masked Language-models",
            "authors": [
                {
                    "first": "Shauli",
                    "middle": [],
                    "last": "Elad Ben Zaken",
                    "suffix": ""
                },
                {
                    "first": "Yoav",
                    "middle": [],
                    "last": "Ravfogel",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Goldberg",
                    "suffix": ""
                }
            ],
            "year": 2021,
            "venue": "",
            "volume": "7",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2106.10199.3"
                ]
            }
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "(a) The Cross-Encoder concatenates queries and documents and encodes them together. Scores are extracted log probabilities. (b) The Bi-Encoder separately encodes queries and documents. Resulting document vectors v1\u22123 can be cached and retrieved at time tc, when a new query comes in. Scores are cosine similarities.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Scaling behavior across parameters and re-ranking for SGPT-CE on BEIR. Scores are rescaled nDCG@10 based on bounds defined in",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Performance on USEB[29] by taking the embeddings from certain layers. S models are fine-tuned on the same data with the same hyperparameters. Dashed, solid and dotted lines are last token, mean and weighted mean pooling, respectively. Shades of red are transformer encoders, while shades of blue are decoders. The 0th layer is the embeddings prior to the first transformer layer.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Weight and bias gradients of the attention out projection in the first transformer layer. Weight gradients are less variable than bias gradients during training in the upper graphs. Bias gradients show slightly more activity when weights are freezed in the BitFit model in the lower graph.",
            "latex": null,
            "type": "figure"
        },
        "TABREF1": {
            "text": "Re-ranking performances on BEIR[26]. OpenAI Search is to be distinguished from the OpenAI Embeddings endpoint. Please refer toTable 6in the Bi-Encoder section for a benchmark with the OpenAI Embeddings endpoint. Results on the Search endpoint were produced in October 2021. Scores are nDCG@10. L: Dataset is too large for OpenAI's endpoint. \u2021: In-domain performance. \u2663: Results from[26]. Other scores are from us. Average scores do not include MS MARCO.",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "OpenAI model parameter estimates. Based on comparing the embedding sizes from the OpenAI docs with the dimensions provided in",
            "latex": null,
            "type": "table"
        },
        "TABREF3": {
            "text": "Average scores include MS MARCO.",
            "latex": null,
            "type": "table"
        },
        "TABREF6": {
            "text": "Results on USEB, Quora and STS-B. Metrics are average precision for USEB, nDCG@10 for Quora and Spearman correlation for STS-B. bf=BitFit. OOD=Out-of-domain, to contrast these numbers from in-domain numbers in",
            "latex": null,
            "type": "table"
        },
        "TABREF8": {
            "text": "Comparison of BEIR state-of-the-art models. Keep model size, latency and training time in mind when inspecting this table. Further, this table compares 2 Cross-Encoders and 8 Bi-Encoders, whose respective trade-offs should be considered. Scores are nDCG@10. \u2021: In-domain performance. \u2663: Results from[26]. \u2660: Results from[12]. \u2666: Results from[19]. \u2665: Results from[17] except when marked with \u2020. Other scores are from us. Average scores do not include MS MARCO.",
            "latex": null,
            "type": "table"
        },
        "TABREF10": {
            "text": "Prompts searched over ordered by increasing complexity. The example is the shortest query-doc match from FiQA[16]. The sum of log probabilities from {query} is used as the re-rank score. Overflowing tokens are truncated from the left of {doc}.",
            "latex": null,
            "type": "table"
        },
        "TABREF11": {
            "text": "Prompt search results. Ids correspond toTable 7. For prompt L, softmax was only computed over the token ids for Yes and No. Scores are nDCG@10.",
            "latex": null,
            "type": "table"
        },
        "TABREF13": {
            "text": "Additional SGPT Cross-Encoder scores on BEIR. Bounds are the maximum achievable score, given the first-stage BM25 results. We report additional Max Re-rank=10 scores using OpenAI's search endpoint: TREC-COVID: 0.545 (Ada), 0.539 (Davinci); SciFact: 0.670 (Ada), 0.658 (Davinci). Scores are nDCG@10. Average scores do not include MS MARCO.",
            "latex": null,
            "type": "table"
        },
        "TABREF14": {
            "text": "Our results using the OpenAI Embeddings Endpoint in December 2021. They match closely with the results published in[17]. Scores are nDCG@10. \u2021: In-domain performance.",
            "latex": null,
            "type": "table"
        },
        "TABREF15": {
            "text": "OOD Unsupervised + OOD Supervised (NLI) SBERT-large-nli-v2",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "We thank Constantin Eichenberg and Samuel Weinbach for insightful discussions and valuable feedback throughout the project. We thank Robert Baldock, Marco Bellagente and Koen Oostermeijer for reading drafts of this paper. This work has been supported by OpenAI under the academic access program.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Acknowledgments"
        }
    ]
}